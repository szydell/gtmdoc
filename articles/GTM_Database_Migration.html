<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- Mirrored [from host tinco.pair.com [file /bhaskar/gtm/doc/articles/GTM_Database_Migration.html]] -->
<head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><title>GT.M Database Migration</title><link rel="stylesheet" href="e-novative_article.css" type="text/css"></link><meta name="generator" content="DocBook XSL Stylesheets V1.68.1"></meta><meta name="description" content="
				
									
										
                        
                        GT.M Group
                        Fidelity National Information Services, Inc.
                        2 West Liberty Boulevard, Suite 300
                        Malvern, PA  19355, 
                        United States of America
                     
									
								
									
										
											
											GT.M Support: +1 (610) 578-4226
											Switchboard: +1 (610) 296-8877
											Fax: +1 (484) 595-5101
											http://www.fis-gtm.com
											gtmsupport@fnis.com
										
									
								
			"></meta></head><body><div class="article" lang="en-US"><div class="titlepage"><div><div><h1 class="title"><a id="id3067708"></a><a id="return_to_top"></a>GT.M Database Migration</h1></div><div><h3 class="subtitle"><i>Technical Bulletin: GT.M Database Migration</i></h3></div><div><p class="copyright">Copyright (C) 2010 Fidelity National Information Services, Inc.</p></div><div><div xmlns="" align="center"><a href="legalnotice.html" target="_blank">Legal Notice</a></div></div><div><p class="pubdate">April 26, 2010</p></div><div><div xmlns="" class="revhistory"><table border="1" align="center" width="70%" summary="Revision history"><tr><th align="left" valign="top" colspan="2"><b>Revision History</b></th></tr><tr><td align="left">Revision 1.3</td><td align="left">26 April 2010</td></tr><tr><td align="left" colspan="2"><div xmlns="http://www.w3.org/1999/xhtml" class="itemizedlist"><ul><li>Improved the description of <a href="#obtaining_v5">Obtaining V5CBSU</a>, <a href="#using_v5">Using V5CBSU</a>, and <a href="#obtain_dbcert" title="Obtaining DBCERTIFY">Obtaining DBCERTIFY</a> sections.</li><li>Added <a href="#obtaining_v5">V5CBSU operational changes </a> introduced in V5.3-003.</li></ul></div></td></tr><tr><td align="left">Revision 1.2</td><td align="left">14 June 2006</td></tr><tr><td align="left">Revision 1.1</td><td align="left">03 May 2006</td></tr><tr><td align="left">Revision 1.0</td><td align="left">15 November 2005</td></tr></table></div></div><div><div class="abstract"><p class="title"><b></b></p><p>
				<div class="informaltable"><table border="0" width="100%"><colgroup><col></col><col></col></colgroup><tbody><tr><td align="left" valign="top">
									<p>
										<div class="address"><p><br></br>
                        <p></p><br></br>
                        GT.M Group<br></br>
                        Fidelity National Information Services, Inc.<br></br>
                        <span class="street">2 West Liberty Boulevard, Suite 300</span><br></br>
                        <span class="city">Malvern, </span><span class="state">PA </span><span class="postcode"> 19355, </span><br></br>
                        <span class="country">United States of America</span><br></br>
                     </p></div>
									</p>
								</td><td align="left" valign="top">
									<p>
										<div class="address"><p><br></br>
											<p></p><br></br>
											<span class="phone">GT.M Support: +1 (610) 578-4226</span><br></br>
											<span class="phone">Switchboard: +1 (610) 296-8877</span><br></br>
											<span class="fax">Fax: +1 (484) 595-5101</span><br></br>
											<a href="http://www.fis-gtm.com/" target="_top">http://www.fis-gtm.com</a><br></br>
											<a href="mailto:gtmsupport@fnis.com" target="_top">gtmsupport@fnis.com</a><br></br>
										</p></div>
									</p>
								</td></tr></tbody></table></div>
			</p></div></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#id3067776">Quick Start</a></span></dt><dd><dl><dt><span class="sect2"><a href="#traditional">Traditional</a></span></dt><dt><span class="sect2"><a href="#in_place_upgrade">In-place Upgrade</a></span></dt></dl></dd><dt><span class="sect1"><a href="#Background">Background</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id3068474">Theory</a></span></dt><dt><span class="sect2"><a href="#id3068904">Details</a></span></dt><dd><dl><dt><span class="sect3"><a href="#id3069177">Database File Header Changes</a></span></dt><dt><span class="sect3"><a href="#id3068979">Block Format Changes</a></span></dt><dt><span class="sect3"><a href="#id3069636">Approaches to Migration</a></span></dt><dt><span class="sect3"><a href="#id3068648">Logical Dual Site Operation</a></span></dt><dt><span class="sect3"><a href="#id3069356">Traditional</a></span></dt><dt><span class="sect3"><a href="#id3068173">In-place upgrade minimizing down time</a></span></dt><dt><span class="sect3"><a href="#id3070061">Memory Mapped (MM) access method database files</a></span></dt><dt><span class="sect3"><a href="#id3069553">Reverting from V5 to V4</a></span></dt></dl></dd></dl></dd><dt><span class="sect1"><a href="#id3070047">Reference Information</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id3068774">DBCERTIFY</a></span></dt><dd><dl><dt><span class="sect3"><a href="#obtain_dbcert">Obtaining DBCERTIFY</a></span></dt><dt><span class="sect3"><a href="#id3070201">Using DBCERTIFY</a></span></dt></dl></dd><dt><span class="sect2"><a href="#id3070245">V5CBSU</a></span></dt><dd><dl><dt><span class="sect3"><a href="#id3068782">Obtaining V5CBSU</a></span></dt><dt><span class="sect3"><a href="#id3069801">Using V5CBSU</a></span></dt></dl></dd><dt><span class="sect2"><a href="#id3069712">DSE Changes</a></span></dt><dd><dl><dt><span class="sect3"><a href="#id3070050">DSE dump</a></span></dt><dt><span class="sect3"><a href="#id3070731">DSE change</a></span></dt><dt><span class="sect3"><a href="#id3069995">DSE evaluate</a></span></dt></dl></dd><dt><span class="sect2"><a href="#id3070835">MUPIP Changes</a></span></dt><dd><dl><dt><span class="sect3"><a href="#id3070739">MUPIP backup</a></span></dt><dt><span class="sect3"><a href="#id3070156">MUPIP restore</a></span></dt><dt><span class="sect3"><a href="#id3070647">MUPIP create</a></span></dt><dt><span class="sect3"><a href="#id3071386">MUPIP integ</a></span></dt><dt><span class="sect3"><a href="#id3071318">MUPIP load</a></span></dt><dt><span class="sect3"><a href="#id3071422">MUPIP set</a></span></dt><dt><span class="sect3"><a href="#id3071394">MUPIP journal -show=header</a></span></dt><dt><span class="sect3"><a href="#id3070057">MUPIP journal extract</a></span></dt><dt><span class="sect3"><a href="#id3070765">MUPIP upgrade/downgrade</a></span></dt><dt><span class="sect3"><a href="#id3069734">MUPIP reorg upgrade/downgrade</a></span></dt></dl></dd></dl></dd><dt><span class="sect1"><a href="#id3070656">Messages</a></span></dt><dt><span class="sect1"><a href="#id3070660">Typographical Conventions</a></span></dt></dl></div><div class="sect1" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a xmlns="http://www.w3.org/1999/xhtml" href="#id3067708">Return to top</a></p><div><h2 class="title"><a id="id3067776"></a>Quick Start</h2></div></div></div><p>Follow these steps if you simply want to upgrade your database as expeditiously as possible. In this context, field test releases of V5 (e.g., V5.0-FT01) are considered V4 releases. For details, go to <a href="#Background">Background</a>. There are two approaches, <a href="#traditional">Traditional</a> and <a href="#in_place_upgrade">In-place Upgrade</a>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The block header in GT.M V5 databases occupies 16 bytes vs. 8 bytes [UNIX] / 7 bytes [OpenVMS] on prior releases of GT.M through V5.0-FT02. Thus, for a given block size, the maximum record size in GT.M V5.0-000 is less than with prior releases of GT.M.</p></td></tr></table></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a xmlns="http://www.w3.org/1999/xhtml" href="#id3067708">Return to top</a></p><div><h3 class="title"><a id="traditional"></a>Traditional</h3></div></div></div><p></p><p>The advantage of the traditional database migration technique is that database files created with GT.M V5 have a maximum file size limit of 134,217,728 (128M) blocks, which means that the maximum database file size using the popular 4KB block size is 512GB, and the largest possible database file size is a little less than 8TB. With GT.M V4 database files converted to V5, the maximum number of blocks is 64M, which means that with a 4KB block size, the maximum database file size is 256GB, and the largest possible database file size is a little less than 4TB.</p><p>
				<div class="orderedlist"><ol type="1"><li><p>Using <span class="emphasis"><em>DSE</em></span>, increase the <span class="emphasis"><em>Reserved Bytes</em></span> parameter in each database file header by 8 (UNIX) or 9 (OpenVMS).</p></li><li><p>Run dbcertify scan on each V4 database file to determine whether there are any records that are too large to fit in a V5 database with the same block size.  If there are, a <a href="#traditional">Traditional</a> Upgrade will be required for this database file.</p></li><li><p>Bring down all V4 GT.M processes and execute <span class="emphasis"><em>mupip rundown -file</em></span> on each database file to ensure that there are no processes accessing the database files.  Change the file permissions to read-only.</p></li><li><p>For every database region that has GT.M replication turned on, note down the Region Seqno (DSE DUMP -FILE for each database region displays this value). If upgrading to a version prior to GT.M V5.1-000, also note down the Resync Seqno (displayed alongside the Region Seqno) for each database region.</p></li><li><p>Use V4 <span class="emphasis"><em>mupip extract -format=binary</em></span> to extract data in each database file.  Archive V4 database files (and journal files, if you normally archive journal files).</p></li><li><p>Make copies of all global directory files. Use V5 <span class="emphasis"><em>GDE</em></span> to open and exit each global directory to update it to V5 format. (This step is not needed when upgrading from V5 field test releases.)</p></li><li><p>For those database files identified in step 1 as containing records too large to fit in a V5 database file with the same block size, use V5 <span class="emphasis"><em>GDE</em></span> to increase the block size, and since the initial allocation and extension sizes are in blocks, ascertain whether these should be reduced.</p></li><li><p>Use V5 <span class="emphasis"><em>mupip create</em></span> to create new database files.</p></li><li><p>Use V5 <span class="emphasis"><em>mupip load</em></span> to load the data extracted from V4 databases into the new V5 database files.</p></li><li><p>Use V5 <span class="emphasis"><em>mupip set -replication=on</em></span> to enable GT.M replication on all appropriate database files. Set the Region Seqno for each replicated database region to the value noted down from the corresponding region in Step 3a (use the <span class="emphasis"><em>DSE CHANGE -FILE -REG_SEQNO= &lt;noted-seqno-in-hexadecimal&gt;</em></span> command for this purpose). On the other hand, if as a result of the upgrade, the database regions that have replication turned on are changing, there will no longer be a one-to-one correspondence between the pre-upgrade and post-upgrade replicated database regions. In this case, compute the maximum (across all replicated database regions) of the Region Seqno values noted down in Step 4. Set the Region Seqno of ALL the post-upgrade replicated database regions to the computed maximum value. If this replication instance will be brought up as a secondary after the upgrade, it is important to note that the receiver server should be started with the <span class="emphasis"><em>-updateresync </em></span> qualifier. If upgrading to a version prior to GT.M V5.1-000, set the Resync Seqno for each replicated database region to the value noted down from the corresponding region in Step 4 (use the <span class="emphasis"><em>DSE CHANGE -FILE -RESYNC_SEQNO= &lt;noted-seqno-in-hexadecimal&gt; </em></span>command for this purpose). Just like the Region Seqno, if there is no one-to-one correspondence between the pre-upgrade and post-upgrade replicated database regions, compute the maximum of the noted Resync Seqno values and set the Resync Seqno of ALL replicated database regions to this value.</p></li><li><p>Recompile routines and rebuild shared libraries (can be done in parallel with the above).</p></li><li><p>Use GT.M V5 normally.</p></li></ol></div>
			</p></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a xmlns="http://www.w3.org/1999/xhtml" href="#id3067708">Return to top</a></p><div><h3 class="title"><a id="in_place_upgrade"></a>In-place Upgrade</h3></div></div></div><p></p><p>The advantage of an in-place upgrade is that in a single site implementation of GT.M, the time that applications are unavailable is minimized (tens of seconds to minutes in the typical case).</p><p>
				<div class="orderedlist"><ol type="1"><li><p>The following steps can be taken while GT.M V4 applications are normally active.
                <div class="orderedlist"><ol type="a"><li><p>Using <span class="emphasis"><em>DSE</em></span>, increase the <span class="emphasis"><em>Reserved Bytes</em></span> parameter in each database file header by 8 (UNIX) or 9 (OpenVMS).</p></li><li><p>Run <span class="emphasis"><em>dbcertify scan</em></span> on each V4 database file to determine whether there are any records that are too large to fit in a V5 database with the same block size.</p></li><li><p>Run V5CBSU as a V4 process (this is an M program that will compile and run on all V4 versions of GT.M).  Optionally, run V4 <span class="emphasis"><em>mupip reorg</em></span> before <span class="emphasis"><em>V5CBSU</em></span> - this may reduce the time taken by <span class="emphasis"><em>V5CBSU</em></span> in the event that the output of the preceding step is large.</p></li><li><p>Take a backup of all the database files, in the event that a backup is not planned for when the application is down.</p></li></ol></div>                
         </p></li><li><p>Bring down all V4 GT.M processes and execute <span class="emphasis"><em>mupip rundown -file</em></span> on each database file to ensure that there are no processes accessing the database files.</p></li><li><p>Take a backup of all the database files. Alternatively, use <span class="emphasis"><em>mupip journal -recover -forward</em></span> to apply journal files to backups of database files taken above.  Note that this may involve multiple generations of journal files for each database file.  Archive journal files, if the policy is to archive journal files.</p></li><li><p>Use <span class="emphasis"><em>dbcertify certify</em></span> to certify all the database files as being ready to be upgraded to V5 format.</p></li><li><p>Use V5 <span class="emphasis"><em>mupip upgrade</em></span> to upgrade the database file header from V4 format to V5 format.</p></li><li><p>Recompile routines and rebuild shared libraries (can be done in parallel with the above).</p></li><li><p>Make copies of all global directory files. Use V5 GDE to open and exit each global directory to update it to V5 format. (This step is not needed when upgrading from V5 field test releases.)</p></li><li><p>Run <span class="emphasis"><em>dse maps -restore_all</em></span> on the upgraded database. This will rebuild all the maps and reflect the blocks used in the database file. </p></li><li><p>Resume normal GT.M applications with V5.</p></li><li><p>While GT.M V5 applications are in normal use, run V5 <span class="emphasis"><em>mupip reorg -upgrade</em></span> to convert any V4 format blocks that may be read but may not be updated (e.g., history records) to V5 format.</p></li></ol></div>
			</p></div></div><div class="sect1" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a xmlns="http://www.w3.org/1999/xhtml" href="#id3067708">Return to top</a></p><div><h2 class="title"><a id="Background"></a>Background</h2></div></div></div><p></p><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a xmlns="http://www.w3.org/1999/xhtml" href="#id3067708">Return to top</a></p><div><h3 class="title"><a id="id3068474"></a>Theory</h3></div></div></div><p></p><p>At the heart of GT.M's transaction management capability is the "transaction number" (TN). Each index or data block has a "block transaction number" (BTN) field. At each database update, the BTN field of all the altered blocks has the "current transaction number" (CTN) recorded within it. When a process references a block, by comparing the BTN with the BTN the last time it referenced that block, the process can determine whether the block has changed or not. Having a monotonically increasing CTN for the database, and being able to compare this with the BTNs is therefore crucial to being able to maintain consistency and structural integrity of the database during normal operation with hundreds or thousands of concurrent processes simultaneously updating the database.</p><p></p><p>For all GT.M releases through the V4 series<sup>[<a id="id3069033" href="#ftn.id3069033">1</a>]</sup>, the TN was an unsigned 32-bit integer, which meant that the maximum transaction number was 4,294,967,295.  Before the maximum transaction number was reached, a database had to have all of its BTNs reset with a mupip integ -tn_reset command (see Chapter 6 of the GT.M Administration and Operations manual), a procedure that requires stand-alone access to the database, and which can take several hours on a large production database.  GT.M was not very user friendly in that while a MUPIP INTEG would generate a warning when the CTN was within approximately 300 million of the limit (i.e., more than 93% of the TN range was used), normal operation would not generate any warning.  Causing the transaction number to wrap around could damage the database.</p><p></p><p>Furthermore, as computer systems have become faster, production databases at large financial institutions would require a TN RESET every few months. Unless logical dual site operation of an application is implemented, a TN RESET requires that the GT.M based application not be available for those few hours.</p><p></p><p>Effective GT.M V5.0-000, the TN becomes an unsigned 64-bit number with a maximum value of 18,446,744,073,709,551,615. This means that if a financial institution needs an annual TN reset with GT.M V4, it would need a TN reset every 4,294,967,295 years with GT.M V5. A transaction processing application that runs flat out at a non-stop rate of 1,000,000 updates per second would need a TN reset approximately every 584,554 years. Thus, a 64-bit TN simplifies the operational management of a GT.M application.</p><p></p><p>Since V4 databases only reserve 32-bits of space for TNs, the GT.M V5 database format is different from the V4 format (hence the need to change the major software version number from V4 to V5, as in V4.4-004 to V5.0-000), and a database upgrade is required when migrating from GT.M V4 to GT.M V5. In V5.0-000, the block header requires 16 bytes, vs. 8 bytes in all prior releases, through V5.0-FT02. This means that any prior database file that has even a single block that contains a single record that is larger than sixteen bytes less than the block size will require a database file with larger block size in V5.0-000.</p><p></p><p>The traditional way to migrate a database is to perform a <span class="emphasis"><em>MUPIP EXTRACT</em></span> with GT.M V4, and a <span class="emphasis"><em>MUPIP LOAD</em></span> of the extracted data with GT.M V5.  However, this approach requires that the database file be unavailable for the time that it takes to extract and load - potentially several hours - during which the application is not available, unless the application is deployed in a logical dual site configuration.</p><p></p><p>GT.M V5.0 therefore provides an alternative mechanism to upgrade the database, one that allows most operations to be performed while the database is in use, and reduces the required time that the database is unavailable to - in the typical case - seconds to minutes.</p><p></p><p>Also, for those who wish to try GT.M V5 before they switch to it, GT.M V5.0-000 has the ability to run with a database format that can almost instantaneously be switched to a V4 format, albeit with some impact on performance when using this feature.</p></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a xmlns="http://www.w3.org/1999/xhtml" href="#id3067708">Return to top</a></p><div><h3 class="title"><a id="id3068904"></a>Details</h3></div></div></div><p></p><p>In order to accommodate 64-bit TNs, there are changes to the database file header, as well as to each database index and data block. In order to facilitate a database migration approach that minimizes the amount of time that an application must be unavailable, there are additional fields to support an in-place upgrade.</p><p></p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>A further enhancement effective V5.0-000 is that the maximum database file size is 134,217,728 (128M) blocks, whereas in all prior releases, through GT.M V5.0-FT02, the maximum database file size is 67,108,864 (64M) blocks. V4 databases that are upgraded to V5 retain the maximum database file size limit of 64M blocks (which means that with the popular 4KB block size, a single database file can grow to a maximum size of 256GB).</p></td></tr></table></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3069177"></a>Database File Header Changes</h4></div></div></div><p></p><p>There are a number of changes to the database file header, and these are reflected in the output of the <span class="emphasis"><em>dse dump -fileheader</em></span> command, as described below:</p><p></p><p>
					<div class="orderedlist"><ol type="1"><li><p>All transaction number fields (including CTN) are increased in size from 32 bits to 64 bits.</p></li><li><p>Master Bitmap Size - since the master bitmap size is different for databases created with V5, compared to those upgraded from V4, the master bitmap size is made explicit and visible.</p></li><li><p>Blocks to Upgrade - in order to support an incremental upgrade, there is a count of the blocks in the database that are still in V4 format.</p></li><li><p>Desired DB format - for an option to "try before you switch", as well as an incremental database downgrade for those wishing to migrate a database from V5 to V4, there is a field that specifies the format of database blocks that are written out to the database file.</p></li><li><p>Certified for Upgrade to - in order to accomplish the incremental upgrade, a database must be "pre-certified" using a new dbcertify utility that certifies that a database is ready for an incremental upgrade.</p></li><li><p>"Hard Stop" transaction number - even if a database is in V5 format with a maximum transaction number of 2<sup>64</sup> - 1, for users who wish to preserve the ability to downgrade to V4, where the maximum transaction number cannot exceed 2<sup>32</sup>-1, there is a "hard stop" TN.  In order to support journal recovery and rollback for databases in V4 format, this needs to be 2<sup>32</sup>-1-128M, or 4,160,749,567 <span class="emphasis"><em>(0xF7FFffff)</em></span>.  For  a database in V5 format, this needs to be 2<sup>64</sup>-1-256M or 18,446,744,073,441,116,159 <span class="emphasis"><em>(0xFFFFffffEFFFffff)</em></span></p></li><li><p>"Warning" transaction number - when the transaction number crosses this limit, GT.M will generate a warning, and update the warning transaction number to a new value. The new warning TN will be 256M (128M for a database with a Desired db format of V4) greater than the current warning TN unless the current warning TN is within 256M (128M for a Desired db format of V4) of the Hard Stop TN, in which case the new Warning TN will be halfway between the old Warning TN and the Hard Stop TN (so that the frequency of warnings will increase as the Hard Stop TN is approached).</p></li></ol></div>
				</p><p></p><p>The layout of the database file header has also changed, but this is not of any consequence to users since the only way to interact with the database file header is via the dse change -fileheader and mupip set commands.</p></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3068979"></a>Block Format Changes</h4></div></div></div><p></p><p>Every V5 format database and index block requires a 64-bit BTN. Furthermore, since a database can have both V4 and V5 format blocks within it, there is a need to distinguish between V4 format blocks and V5 format blocks.</p><p>The V4 block header is 8 bytes on UNIX, 7 bytes on OpenVMS, and is laid out as follows:</p><div class="itemizedlist"><ul><li><p>2 bytes - bytes currently in use in the block</p></li><li><p>1 byte - block level</p></li><li><p>4 bytes - BTN</p></li></ul></div><p></p><p>In V5, the block header is increased to 16 bytes, and is laid out as follows:</p><div class="itemizedlist"><ul><li><p>2 bytes - block version number</p></li><li><p>2 bytes - bytes currently in use in the block</p></li><li><p>1 byte - block level</p></li><li><p>8 bytes - BTN</p></li></ul></div><p></p><p>If the value in the first two bytes is 0 through 6, GT.M V5 knows that the block is a V5 block and the field is a block version number; if it is 7 or greater, GT.M V5 knows that it is a V4 block and the field is the number of bytes currently in use in the block. This feature - a true hack - permits a GT.M database to contain both V4 format blocks as well as V5 format blocks, and facilitates the incremental upgrading of V4 databases to V5 with minimal unavailability of applications.</p><p>One result of the fact that GT.M V5 has a 16-byte block header, whereas GT.M V4 has a 7 or 8 byte block header is that it is possible to have a record in a V4 database that will not fit in a V5 database with the same block size. The largest record that can fit in a V4 GT.M database on x86 GNU/Linux with a 4KB block size is 4088 bytes, whereas the largest record that can fit in a V5 GT.M database on the same platform is 4080 bytes. If there are any records whose size exceeds <span class="emphasis"><em>blocksize-16</em></span>, then a new V5 database will need to be created with a larger block size. <sup>[<a id="id3069632" href="#ftn.id3069632">2</a>]</sup></p></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3069636"></a>Approaches to Migration</h4></div></div></div><div class="sect4" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="id3069454"></a>Common to all Approaches</h5></div></div></div><div class="sect5" lang="en-US"><div class="titlepage"><div><div><h6 class="title"><a id="id3069603"></a>Global Directory</h6></div></div></div><p></p><p>Since GT.M V5 adds support for names longer than 8 characters (see <a href="GTM_Long_Names.html" class="olink">GT.M Long Names Technical Bulletin</a>), as well as optional changes to the collation of null subscripts (see <a href="GTM_Null_Subscripts.html" class="olink">GT.M Null Subscripts Technical Bulletin</a>), the V5 global directory format is different from a V4 global directory format, and must be upgraded.</p><p>Please refer to the <a href="GTM_V5.0-000D_Release_Notes.html" class="olink"> V5.0-000D Release Notes </a> to upgrade the global directory.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The global directory in use at the time of database upgrade MUST have a mapping of globals to databases that exactly matches the globals that are actually resident in those databases. Some sites have more than one global directory with some having reduced or changed mappings such that, for example, a database may have more than one global in it but the global directory mapping has only a single global in it. This situation can potentially cause the database upgrade procedure to fail because database certification was not correctly processed. A sign that this could be an issue is if MUPIP REORG UPGRADE or a GT.M process fails with the DYNUPGRDFAIL message (block has insufficient room for expansion) after the V5 upgrade.</p></td></tr></table></div></div><div class="sect5" lang="en-US"><div class="titlepage"><div><div><h6 class="title"><a id="id3069723"></a>Journal files and backups</h6></div></div></div><p></p><p>Journal files are specific to each GT.M version, and a journal file generated by one GT.M version is not compatible with another GT.M version. In particular, GT.M V4.4-004 journal files can only be processed by V4.4-004 and cannot be processed by V5.0-000. This means that a successful database backup as of the point of conversion is strongly recommended.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>An online backup that allows the application to continue operating will not suffice for such a backup, since a GT.M mupip backup command creates a snapshot of the database as of the instant that the command is issued, and not as of the time that the command completes.</p></td></tr></table></div><p></p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.html"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><a id="jrnl_tip"></a><p>mupip backup for a large database, even with the -bytestream flag, can take a non-trivial amount of time to run, perhaps more time than one might desire that the application be unavailable.  An alternative approach is to take the journal files when the application is brought down, immediately prior to a database upgrade, and to apply them to a database backup from an earlier time with a <span class="emphasis"><em>mupip journal -recover -forward</em></span> command, which should be faster than a mupip backup command.</p></td></tr></table></div></div></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3068648"></a>Logical Dual Site Operation</h4></div></div></div><p></p><p>A GT.M application that is configured for logical dual site operation can be upgraded from V4 to V5 while maintaining continuity of application availability.  Please follow the procedures in the Database Replication chapter of the GT.M Administration and Operations Guide.  Note that V4 journal files and <span class="emphasis"><em>mupip backup -bytestream</em></span> files are not compatible with V5.</p><p></p></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3069356"></a>Traditional</h4></div></div></div><p></p><p>The traditional approach to upgrading a database file is to extract it on the lower GT.M version with a mupip extract and to load it on the higher GT.M version with mupip load.  Both BINARY format (<span class="emphasis"><em>mupip extract -format=binary</em></span>) as well as the default ZWR format will work; however, the former is likely to be faster.</p><p>Since the V4 database files are not modified with this approach, they can simply be archived, and a separate backup is not needed.  The <span class="emphasis"><em>mupip extract</em></span> files can also serve as an alternative backup.</p><p>The benefits of a traditional approach are its simplicity and the fact that a database created with GT.M V5.0-000 can grow to a maximum size of 134,217,728 (128M) blocks, whereas a database created with a GT.M V4 release and upgraded to V5 retains a maximum size of 67,108,864 (64M) blocks.</p></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3068173"></a>In-place upgrade minimizing down time</h4></div></div></div><p></p><p>Since a database extract and reload can take hours for large database files, GT.M V5.0-000 provides a method to upgrade database files that, at least in the typical case, requires that the application be brought down for only seconds to minutes. The basic approach to the in-place upgrade is the ability of GT.M V5.0-000 to read database blocks in V4 or V5 format. Whenever a block is updated, it will be written in V5 format. Thus, over time, the blocks are converted from V4 format to V5 format. Conceptually, this is a three-step process:</p><div class="orderedlist"><ol type="1"><li><p>Test and Certify: Test whether a database qualifies for an in-place upgrade, and certify it if it is. Except for a small part at the end, which in the typical case is expected to take only seconds to minutes, this step can be performed while the application is operating normally.</p></li><li><p>Upgrade Database File Header: Upgrade the database file header from V4 format to V5 format. This requires stand-alone access of at most a few seconds.</p></li><li><p>Use Applications Normally: Use the application normally with GT.M V5: When a database block is read in from disk to the global buffer cache, it is converted from V4 format to V5 format.  Any V4 format blocks that are updated are automatically converted to V5 format. Since some database blocks may never be updated under normal operation (e.g., history records), a <span class="emphasis"><em>mupip reorg -upgrade</em></span> command can be executed in the background to update all V4 format blocks to V5 format blocks.</p></li></ol></div><p></p><div class="sect4" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="id3069251"></a>Test and Certify</h5></div></div></div><p></p><p>The critical requirement for being able to upgrade a database from V4 format to V5 format, whether in place or traditional, is that there must be no blocks whose records occupy more than <span class="emphasis"><em>blocksize-16</em></span> bytes.  This is because database blocks in the global buffer cache are always in V5 format - when GT.M V5 reads a V4 format block into the global buffer cache, it converts it to V5 format.  When writing out blocks, they can be written out in V5 format or converted to V4 format.  If a database has no blocks with records occupying more than <span class="emphasis"><em>blocksize-16</em></span> bytes, upgrading to V5 is a snap.  If it does have such blocks, they will need to be dealt with.</p><p>There are two types of blocks whose records occupy more than <span class="emphasis"><em>blocksize-16</em></span> bytes - those with one record and those with more than one record.  The latter can be made suitable for upgrading to V5 format blocks simply by splitting the block, but the former cannot: if a database contains even one block with one record which is larger than <span class="emphasis"><em>blocksize-16</em></span> bytes, that database cannot be upgraded in place from V4 to V5.  Such a database file will require a new database to be created in V5 with a larger block size, following which the data must be extracted in V4 and loaded in V5.</p><p>The dbcertify program is used to scan a V4 database and identify blocks with more than <span class="emphasis"><em>blocksize-16</em></span> bytes occupied.  The testing and certification process has several steps:</p><div class="orderedlist"><ol type="1"><li><p>Increase the Reserved Bytes parameter in the database file header by 8 (UNIX/Linux) or 9 (OpenVMS). Note that the Reserved Bytes field is typically zero, so the new values will typically be 8 (UNIX) or 9 (OpenVMS).  However, your database files may not be typical, so always check the value of this field with <span class="emphasis"><em>dse dump -fileheader</em></span> and increment the value accordingly.  This will ensure that no new records are created with a record size greater than <span class="emphasis"><em>blocksize-16</em></span>, even though existing records will remain unaltered.  You can run a <span class="emphasis"><em>mupip reorg</em></span> on the database after setting Reserved Bytes to the new value; this will reduce the number of blocks that <span class="emphasis"><em>dbcertify</em></span> will need to deal with in the next step.</p></li><li><p>Verify that the Maximum Record Size parameter is less than or equal to <span class="emphasis"><em>blocksize-16</em></span>, which it must be in V5.  If it is not, you must determine whether your application requires it to be greater than <span class="emphasis"><em>blocksize-16</em></span>, in which case a database upgrade is not possible: you will need to create a new database in V5 with a larger block size, into which you can load data extracted from the V4 database.  If the application permits the Maximum Record Size parameter to be reduced to be less than or equal to <span class="emphasis"><em>blocksize-16</em></span>, then reduce it accordingly.  Once the Maximum Record Size parameter is less than or equal to <span class="emphasis"><em>blocksize-16</em></span>, dbcertify can be used.</p></li><li><p>The dbcertify program has two phases, a scan phase and a certify phase.  Fidelity strongly recommends a backup before the certify phase, refer to the <a href="#jrnl_tip">Tip in the Journal Files and Backups </a> section for a suggestion on how to obtain a fast backup.
                                <div class="orderedlist"><ol type="a"><li><p>The scan phase runs concurrently with normal operation of GT.M V4.  It makes no modifications to the database, but instead produces a report of blocks that are too large to be used by GT.M V5.</p></li><li><p>The certify phase requires stand-alone access to the database.  An M program is provided with GT.M V5.0-000, V5CBSU, which can run concurrently with normal operation of GT.M V4 applications, and which can take the output of the dbcertify scan phase and help reduce the amount of work the certify phase must perform.  This reduces the amount of time that dbcertify requires stand-alone access to the database.</p></li></ol></div>
                            </p></li></ol></div><p>Once the certify phase of dbcertify completes, <span class="emphasis"><em>mupip upgrade</em></span> can be used to upgrade the database file header.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>dbcertify assumes that there is no structural damage to the database.  Therefore, Fidelity strongly recommends that a <span class="emphasis"><em>mupip integ</em></span> (without the <span class="emphasis"><em>-fast</em></span> switch) be performed on the database or a backup copy of the database as soon as possible prior to running dbcertify, and not to start dbcertify if there are any unusual events or unusual messages in the operator log after the mupip integ operation (or the backup operation that created the backup on which <span class="emphasis"><em>mupip integ</em></span> was run).</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The <span class="emphasis"><em>dbcertify certify</em></span> and <span class="emphasis"><em>mupip upgrade</em></span> steps are not journaled and are not interruptible.  In the event of a hardware or software malfunction in the dbcertify or mupip upgrade, the V4 database will need to be restored from a backup.</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Although dbcertify and V5CBSU are written to have minimal impact on running applications, the fact that they perform IO means that the impact will not be zero. Whether or not the impact is noticeable depends on the extent to which IO is limiting throughput on your system.</p></td></tr></table></div></div><div class="sect4" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="id3069968"></a>Upgrade Database File Header</h5></div></div></div><p></p><p>Once the certify phase of dbcertify has completed, the database file header can be upgraded from V4 to V5 with mupip upgrade, an operation that should take a fraction of a second on even the largest databases, since it only affects the file header. Once the database file header has been upgraded, the database can be used by GT.M V5 processes.</p><p>A GT.M V5 database has a switch in the file header that specifies whether blocks that are updated are written to the database in V4 format or V5 format.  Mupip upgrade will set the switch to cause GT.M V5 processes to write updated blocks in V5 format.  To cause GT.M V5 processes to write updated  blocks in V4 format, an option which preserves the ability to revert to GT.M V4 on short notice, use a subsequent <span class="emphasis"><em>mupip set -version=v4</em></span> command.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Using GT.M V4 blocks in GT.M V5 will incur a small performance penalty, which may or may not be noticeable depending on what is limiting the throughput of your system.</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>Mupip upgrade</em></span> will reduce the <span class="emphasis"><em>Reserved Bytes</em></span> field in the database file header by 8 bytes (UNIX) or 9 bytes (OpenVMS).</p></td></tr></table></div></div><div class="sect4" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="id3069248"></a>Use Applications Normally</h5></div></div></div><p></p><p>Once the database file header has been upgraded, the database can be used normally with GT.M V5 processes. With the default database file header upgrade, any database blocks that are updated are written in V5 format, so that over time an increasing percentage of the blocks will be in V5 format.</p><p>Since there may be blocks in V4 format that are never updated (e.g., history records), and as long as they are in V4 format, every read will incur at least a slight performance penalty, <span class="emphasis"><em>mupip reorg -upgrade</em></span> can be used in the background to convert these blocks to V5 format.</p></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3070061"></a>Memory Mapped (MM) access method database files</h4></div></div></div><p></p><p>To upgrade a database file used with the MM access method (supported on OpenVMS only), it must either have its access mode changed to <span class="emphasis"><em>Buffered Global (BG)</em></span> to use the upgrade method that minimizes access time, or the traditional upgrade method should be used.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Changing the access method from MM to BG requires stand-alone access and is accomplished by the <span class="emphasis"><em>mupip set</em></span> command.</p></td></tr></table></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3069553"></a>Reverting from V5 to V4</h4></div></div></div><p></p><p>It is feasible to revert from GT.M V5 to V4.  The database must first be downgraded to V4 format before it can be accessed by a GT.M V4 release.  This is accomplished with the steps below, assuming that the CTN of the database is less than 4,294,967,295 (0xFFFFFFFF).  If the CTN exceeds this number, a <span class="emphasis"><em>mupip integ -tn_reset</em></span> must first be performed, or the database must be extracted using V5 <span class="emphasis"><em>mupip extract</em></span> (with the default ZWR format) and loaded with V4 <span class="emphasis"><em>mupip load</em></span> into a database created with V4 <span class="emphasis"><em>mupip create</em></span>.</p><div class="orderedlist"><ol type="1"><li><p>The following steps can take place during normal operation of GT.M V5 processes.
                                <div class="orderedlist"><ol type="a"><li><p>Use <span class="emphasis"><em>mupip set -version=v4</em></span> so that any blocks that are updated are written in V4 format.</p></li><li><p>Use <span class="emphasis"><em>mupip reorg -downgrade</em></span> to convert all blocks from V5 format to V4 format.</p></li></ol></div>
                            </p></li><li><p>Bring down all V5 GT.M processes and execute <span class="emphasis"><em>mupip rundown -file</em></span> on each database file to ensure that there are no processes accessing the database files.</p></li><li><p>Use <span class="emphasis"><em>mupip downgrade</em></span> to change the database file header from V5 to V4. Note that this will increase the <span class="emphasis"><em>Reserved Bytes</em></span> field by 8 (UNIX) or 9 (OpenVMS).</p></li><li><p>Restore the copies of all the saved V4 global directory files.</p></li><li><p>Use GT.M V4 normally.</p></li></ol></div></div></div></div><div class="sect1" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a xmlns="http://www.w3.org/1999/xhtml" href="#id3067708">Return to top</a></p><div><h2 class="title"><a id="id3070047"></a>Reference Information</h2></div></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a xmlns="http://www.w3.org/1999/xhtml" href="#id3067708">Return to top</a></p><div><h3 class="title"><a id="id3068774"></a>DBCERTIFY</h3></div></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="obtain_dbcert"></a>Obtaining DBCERTIFY</h4></div></div></div><p></p><p>dbcertify is distributed with GT.M V5.0-000. Since it is intended to run against V4 databases, concurrently with GT.M V4 processes, it is not installed by the normal GT.M installation script. Instead:</p><div class="itemizedlist"><ul><li><p>On OpenVMS, dbcertify and v5cbsu are in a VMSINSTAL save set named GTDC50000. The DCL command: <span class="emphasis"><em>DBCERTIFY :== "$..[..]DBCERTIFY.EXE"</em></span> should be used to make <span class="emphasis"><em>DBCERTIFY</em></span> an executable command. The GTMDCDEFINE.COM
  command procedure contains this command.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Please note that GTCD5000 is a different GT.M component, unrelated to dbcertify, which is packaged as GTDC5000.</p></td></tr></table></div></li><li><p>On UNIX, dbcertify and v5cbsu are packaged as a separate tar file <span class="emphasis"><em>dbcertify_V50000_&lt;osname&gt;_&lt;platform&gt;_pro.tar</em></span>.</p></li></ul></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3070201"></a>Using DBCERTIFY</h4></div></div></div><p>Syntax is:</p><pre class="programlisting">dbcertify scan [-outfile=fn] [-report_only] &lt;db-region-name&gt; dbcertify certify &lt;scan-phase-outfile&gt;</pre><p></p><p>The DBCERTIFY utility certifies a V4 database as being ready for upgrade to V5. This is a 2-phase process, consisting of a scan phase and a certify phase.</p><pre class="programlisting">dbcertify scan [-o[utfile]=filename] [-r[eport_only]] region_name</pre><p>The scan phase identifies the blocks that need to be split as well as records and blocks with single records that are too long to be split. The scan phase can run concurrently with normal application operation of GT.M V4. The region must map to a V4 format database file (V5.0-FT01/V5.0-FT02 databases are V4 format databases).</p><p>Normally, <span class="emphasis"><em>dbcertify scan</em></span> will produce an output file that will be used by <span class="emphasis"><em>dbcertify certify</em></span>, and optionally by the program V5CBSU.  The use of the optional <span class="emphasis"><em>-report_only</em></span> qualifier will suppress the production of the output file. <span class="emphasis"><em>dbcertify scan</em></span> can be run as often as needed.</p><div class="itemizedlist"><ul><li><p>The <span class="emphasis"><em>Reserved Bytes</em></span> file-header setting must be at least 8 on UNIX and 9 on OpenVMS. The <span class="emphasis"><em>Maximum Record Size</em></span> of the database must be at least 16 bytes less than the database block-size. If the <span class="emphasis"><em>Maximum Record Size</em></span> is manually reduced with DSE, for any records whose length exceeds the new Maximum Record Size -  an error is raised which will prevent the successful completion of the scan phase.<sup>[<a id="id3070424" href="#ftn.id3070424">3</a>]</sup></p></li></ul></div><p>Scan phase results:</p><div class="itemizedlist"><ul><li><p>Reports on how many blocks need to be split and if any records exist which are longer than <span class="emphasis"><em>blocksize-16</em></span> bytes.</p></li><li><p>If no errors and if <span class="emphasis"><em>REPORT_ONLY</em></span> was not specified, generates an output file containing information for the certify phase. If a filename is not specified, the default filename is &lt;dbfilename&gt;.dbcertscan for UNIX and &lt;dbfilename&gt;_DBCERTSCAN for OpenVMS.</p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The V5CBSU utility can optionally be run after the scan phase and before the certify phases in order to reduce the standalone run time of the certify phase.</p></td></tr></table></div><div class="sect4" lang="en-US"><div class="titlepage"><div><div><h5 class="title"><a id="id3070389"></a>dbcertify certify scan phase output file</h5></div></div></div><p>The certify phase of DBCERTIFY runs standalone and performs block splits on the blocks identified by the scan phase. If there are no errors, the database is marked as being certified ready for an upgrade to V5 format. This certification is required before <span class="emphasis"><em>MUPIP UPGRADE</em></span> will operate on a database.</p><p>Before running DBCERTIFY, it is recommended that an integrity check be run on the databases (not with the <span class="emphasis"><em>-fast</em></span> option) or their immediate backups. If the running of the certify phase is separated from the scan phase by any appreciable amount of time, the integrity checks should be re-run. This is because dbcertify is written to ASSUME that the database's integrity is sound. Specifically, the final certify phase will not run on a database whose <span class="emphasis"><em>kill-in-progress</em></span> indicator is on. The database must not have been moved or recreated since the scan phase was run or the scan phase must be re-run. The database information is stored in the scan phase output file.</p></div><p>dbcertify certify must be run in standalone mode.</p><p>Certify phase results:</p><div class="itemizedlist"><ul><li><p>All "too large" blocks are appropriately split.</p></li><li><p>Replication and/or journaling are turned off.</p></li><li><p>The database is marked as certified.</p></li></ul></div><p>This command requires that <span class="emphasis"><em>$gtm_dist</em></span> on UNIX or <span class="emphasis"><em>GTM$DIST</em></span> on OpenVMS be set to the directory of the current GT.M V4 installation.</p><p>The dbcertify program along with the V5CBSU utility should be run on the V4 system.</p><p>For OpenVMS, gtmdcbuild.com created during install will build v5cbsu.exe if it wasn't done during the install and gtmdcdefine.com also created during the install will define the symbols DBCERTIFY and V5CBSU. The executable for V5CBSU must be built before the existing databases can be prepared for upgrade so as to be used with the new GT.M version.</p></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a xmlns="http://www.w3.org/1999/xhtml" href="#id3067708">Return to top</a></p><div><h3 class="title"><a id="id3070245"></a>V5CBSU</h3></div></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3068782"></a><a id="obtaining_v5"></a>Obtaining V5CBSU</h4></div></div></div><p>V5CBSU is a normal M routine for processing the output of dbcertify, and can be run with any V4 GT.M version. It is packaged and distributed with DBCERTIFY.</p></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3069801"></a><a id="using_v5"></a>Using V5CBSU</h4></div></div></div><p>V5CBSU optionally runs between the SCAN and CERTIFY phases of DBCERTIFY and reduces the work<span class="emphasis"><em> dbcertify -certify </em></span>must perform in standalone mode. It runs with the GT.M V4 applications and splits level 0 global variable tree blocks as identified in the report from the scan phase of <span class="emphasis"><em>DBCERTIF</em></span>.</p><p>V5CBSU splits as many blocks as it is able to and shows statistics on how successful it was when it completes. It rewrites the scan phase output file to exclude the blocks that successfully processed.</p><p>V5CBSU's input is the output file from <span class="emphasis"><em>dbcertify -scan</em></span>.</p><p>The database associated with the file must still exist and be accessible to the utility.</p><p>Syntax on UNIX:</p><pre class="programlisting">$gtm_dist/mumps -run ^v5cbsu scan-phase-output-file-name-path</pre><p>Syntax on OpenVMS:</p><p>Note that V5CBSU.m is packaged as part of the DBCERTIFY but in order to use it in OpenVMS you need an executable image. When the DBCERTIFY kit
	(that is, GTDCnnnnn.A) is installed, it creates two command procedure files, GTMDCBUILD.COM and GTMDCDEFINE.COM.  During a standard install, V5CBSU.EXE will be created using GTMDCBUILD.COM. Setup the DCL command: <span class="emphasis"><em>V5CBSU :== "$..[..]V5CBSU.EXE" </em></span> where <span class="emphasis"><em>..[..]</em></span> represents the absolute path containing the executable. GTMDCDEFINE.COM creates DCL symbols for V5CBSU and DBCERTIFY.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>For GT.M V5.3-003 through V5.4-000A, V5CBSU.m uses the utility routines <span class="emphasis"><em>%DH</em></span> and <span class="emphasis"><em>%EXP </em></span> whose M routines are <span class="emphasis"><em>_DH.m </em></span> and <span class="emphasis"><em>_EXP.m</em></span> Use <span class="emphasis"><em>MUMPS (V4 GT.M) <span class="emphasis"><em>to compile </em></span>V5CBSU.m</em></span>, <span class="emphasis"><em>_DH.m</em></span> and <span class="emphasis"><em>_EXP.m</em></span>, then use <span class="emphasis"><em>LINK V5CBSU.OBJ,_DH.OBJ,_EXP.obj </em></span>to create a <span class="emphasis"><em>V5CBSU.EXE </em></span>executable. </p></td></tr></table></div><pre class="programlisting">V5CBSU scan-phase-output-file-name</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>If <span class="emphasis"><em>MUPIP REORG</em></span> has been run with <span class="emphasis"><em>Reserved Bytes</em></span> set to at least 8 for UNIX or 9 for OpenVMS, before a <span class="emphasis"><em>dbcertify -scan</em></span>, the V5CBSU utility has little or nothing to do.</p></td></tr></table></div><p>V5CBSU operates as follows: </p><div class="itemizedlist"><ul><li><p>It renames the input scan file (created by DBCERTIFY SCAN) with a <span class="emphasis"><em>_orig </em></span> suffix (for example <span class="emphasis"><em>mumps.dbcertscan</em></span> to <span class="emphasis"><em>mumps.dbcertscan_orig</em></span>) as part of its processing. If a file with the <span class="emphasis"><em>_orig</em></span> suffix already exists, that is deleted before renaming the input scan file.</p></li><li><p>It writes bypassed records to the output scan file. This way <span class="emphasis"><em>DBCERTIFY CERTIFY</em></span> later upgrades any of those blocks requiring adjustment to the new requirements.</p></li><li><p>Invoking the entryref dump^V5CBSU (instead of the usual ^V5CBSU) allows for a diagnostic mode of operation where V5CBSU dumps the contents of the scan file. It does not touch either the database or the scan file. This is usually needed for debugging purposes.</p></li></ul></div></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a xmlns="http://www.w3.org/1999/xhtml" href="#id3067708">Return to top</a></p><div><h3 class="title"><a id="id3069712"></a>DSE Changes</h3></div></div></div><p></p><p>DSE incorporates new values, fields, and qualifiers to support 64-bit transaction numbers. The block and file header output are modified and restructured to accommodate new data elements.</p><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3070050"></a>DSE dump</h4></div></div></div><p>The <span class="emphasis"><em>dse dump</em></span> command displays the database blocks, records, or file headers.
                            </p><p>-B[LOCK]=block_number</p><p>Displays the block transaction number as a 64-bit value and outputs the version number of the block format in the block header.</p><pre class="programlisting">Example: DSE&gt; dump -block=2 V4 format output: Block 2 Size 13 Level 0 TN 1 Rec:1 Blk 2 Off 8 Size B Cmpc 0 Ptr 4 Key ^a 8 : | B 0 0 0 61 0 0 4 0 0 0 | | . . . . a . . . . . . | V5 format output: Block 2 Size 1B Level 0 TN 1 V5 Rec:1 Blk 2 Off 10 Size B Cmpc 0 Ptr 4 Key ^a 10 : | B 0 0 0 61 0 0 4 0 0 0 | | . . . . a . . . . . . |</pre><p>-F[ILEHEADER]</p><p>Outputs new fields that are associated with V5, as noted below. Existing transaction number fields that were formerly 32 bits and which are 64 bits in V5, are now displayed as 64-bit fields. Note that the sequence numbers used in replication have always been 64-bit fields whose length is unchanged in V5.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>V5.0-000 adds fields to the file header in conjunction with the use of helper processes on the secondary. This adds the qualifier <span class="emphasis"><em>-updproc</em></span> to the <span class="emphasis"><em>dump -fileheader</em></span> command to dump those additional fields. Refer to the <a href="GTM_Update_Helper_Processes.html" class="olink">GT.M Update Helper Processes Technical Bulletin </a> for details.</p></td></tr></table></div><div class="informaltable"><table border="0" width="70%"><colgroup><col></col><col></col></colgroup><tbody><tr><td align="left" valign="top">
									<p>
										<span class="bold"><strong>Data Elements</strong></span>
									</p>
								</td><td align="left" valign="top">
									<p>
										<span class="bold"><strong>Description</strong></span>
									</p>
								</td></tr><tr><td align="left" valign="top">
									<p>Master Bitmap Size</p>
								</td><td align="left" valign="top">
									<p>The number of 512-byte disk blocks in the master bitmap. This is 32 for a V4 database upgraded to V5, or 64 for a database created in V5.</p>
								</td></tr><tr><td align="left" valign="top">
									<p>Blocks to Upgrade</p>
								</td><td align="left" valign="top">
									<p>The number of database blocks, including local bit maps, which are in V4 format. Except for a database in transition from V4 format to V5 format, this will normally be zero.</p>
								</td></tr><tr><td align="left" valign="top">
									<p>Desired DB Format</p>
								</td><td align="left" valign="top">
									<p>The format to use when writing database blocks back out to disk. Values are "V4" and "V5".</p>
								</td></tr><tr><td align="left" valign="top">
									<p>Certified for Upgrade to</p>
								</td><td align="left" valign="top">
									<p>The format, if any, for which the database has been certified. The only value is "V5".</p>
								</td></tr><tr><td align="left" valign="top">
									<p>Maximum TN</p>
								</td><td align="left" valign="top">
									<p>The "hard-stop" TN for this region.</p>
								</td></tr><tr><td align="left" valign="top">
									<p>Maximum TN Warn</p>
								</td><td align="left" valign="top">
									<p>TN at which the next tn_reset warning will be sent to the operator log/console.</p>
								</td></tr></tbody></table></div><pre class="programlisting">Example: DSE&gt; dump -fileheader V4 format output: File /gtm/v44004/mumps.dat Region DEFAULT Date/Time 06 MAY 2005 14:33:42 [$H = 60026,52422] Access method BG Global Buffers 1024 Reserved Bytes 0 Block size (in bytes) 1024 Maximum record size 256 Starting VBN 49 Maximum key size 64 Total blocks 0x00000065 Null subscripts FALSE Free blocks 0x00000062 Last Record Backup 0x00000001 Extension Count 100 Last Database Bckup 0x00000001 Number of local maps 1 Last Bytestream Bckup 0x00000001 Lock space 0x00000028 In critical section 0x00000000 Timers pending 0 Cache freeze id 0x00000000 Flush timer 00:00:01:00 Freeze match 0x00000000 Flush trigger 960 Current transaction 0x00000001 No. of writes/flush 7 Create in progress FALSE Modified cache blocks 0 Reference count 1 Wait Disk 0 Journal State DISABLED Mutex Hard Spin Count 128 Mutex Sleep Spin Count 128 Mutex Spin Sleep Time 2048 KILLs in progress 0 Replication State OFF Region Seqno 0x0000000000000001 Resync Seqno 0x0000000000000001 Resync transaction 0x00000001</pre><pre class="programlisting">V5 format output: File /gtm/v50000/mumps.dat Region DEFAULT Date/Time 06 MAY 2005 14:33:47 [$H = 60026,52427] Access method BG Global Buffers 1024 Reserved Bytes 0 Block size (in bytes) 1024 Maximum record size 256 Starting VBN 129 Maximum key size 64 Total blocks 0x00000065 Null subscripts NEVER Free blocks 0x00000062 Standard Null Collation FALSE Free space 0x00006000 Last Record Backup 0x0000000000000001 Extension Count 100 Last Database Backup 0x0000000000000001 Number of local maps 1 Last Bytestream Backup 0x0000000000000001 Lock space 0x00000028 In critical section 0x00000000 Timers pending 0 Cache freeze id 0x00000000 Flush timer 00:00:01:00 Freeze match 0x00000000 Flush trigger 960 Current transaction 0x0000000000000001 No. of writes/flush 7 Maximum TN 0xFFFFFFFFDFFFFFFF Certified for Upgrade to V5 Maximum TN Warn 0xFFFFFFFF5FFFFFFF Desired DB Format V5 Master Bitmap Size 64 Blocks to Upgrade 0x00000000 Create in progress FALSE Modified cache blocks 0 Reference count 1 Wait Disk 0 Journal State DISABLED Mutex Hard Spin Count 128 Mutex Sleep Spin Count 128 Mutex Spin Sleep Time 2048 KILLs in progress 0 Replication State OFF Region Seqno 0x0000000000000001 Resync Seqno 0x0000000000000001 Resync trans 0x0000000000000001</pre></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3070731"></a>DSE change</h4></div></div></div><p>-BL[OCK]=block_number -TN[=transaction_number]</p><p>The <span class="emphasis"><em>block</em></span> command with the TN qualifier changes the transaction number for the given block. This takes in a 64-bit (16 hex digit) value, when not running in compatibility mode. In compatibility mode, the value is limited to 32-bit (8 hex digit) value. When a change command does not include a -TN=, DSE sets the transaction number to the current transaction number. Please note that manipulation of the block transaction number will affect whether <span class="emphasis"><em>mupip backup -bytestream</em></span> backs up the block. The <span class="emphasis"><em>-TN</em></span> qualifier is incompatible with all qualifiers except <span class="emphasis"><em>-block, -bsiz,</em></span> and <span class="emphasis"><em>-level</em></span>.
                                    </p><pre class="programlisting">Example: V4 format: DSE&gt; change -block=3 -tn=FFFFFFFF V5 format: DSE&gt; change -block=3 -tn=FFFFFFFFFFFFFFFF</pre><p>-FI[LEHEADER]</p><p>The <span class="emphasis"><em>dse change -fileheader</em></span> command enables modification of specific fields in the file header. The new qualifiers are: <span class="emphasis"><em>blks_to_upgrade, cert_db_ver, db_write_fmt, mbm_size, max_tn,</em></span> and <span class="emphasis"><em>warn_max_tn</em></span> allow modifications to the new file header fields, the master bitmap size, blocks to upgrade, the desired db format, certified for upgrade to, the maximum tn, and the maximum tn warn.</p><div class="informaltable"><table border="0" width="70%"><colgroup><col></col><col></col></colgroup><tbody><tr><td align="left" valign="top">
									<p>
										<span class="bold"><strong>File header field</strong></span>
									</p>
								</td><td align="left" valign="top">
									<p>
										<span class="bold"><strong>Description</strong></span>
									</p>
								</td></tr><tr><td align="left" valign="top">
									<p>blks_to_upgrade</p>
								</td><td align="left" valign="top">
									<p>Modifies the blocks to upgrade field in the file-header. Note: unless a database is damaged, e.g., in recovering from a system crash when journaling is not in use, it should never be necessary under normal operation to modify this field. If the current value of blks_to_upgrade in the file-header is suspect, a mupip integ of the database (not a mupip integ -fast) will repair the counter so long as there are no other integrity errors in the database. The value is an integer from 0 to the number of blocks in the database.</p>
								</td></tr><tr><td align="left" valign="top">
									<p>cert_db_ver</p>
								</td><td align="left" valign="top">
									<p>Modifies the certified for upgrade to version. The only accepted value is V5.</p>
								</td></tr><tr><td align="left" valign="top">
									<p>db_write_fmt</p>
								</td><td align="left" valign="top">
									<p>Modifies the desired db format for database blocks written out (to disk). Accepted values are V4 and V5.</p>
								</td></tr><tr><td align="left" valign="top">
									<p>mbm_size</p>
								</td><td align="left" valign="top">
									<p>Modifies the master bitmap size field in the file-header. Note: it should not normally be necessary to modify this field. Do not modify it except when so instructed by GT.M Support.</p>
								</td></tr><tr><td align="left" valign="top">
									<p>max_tn</p>
								</td><td align="left" valign="top">
									<p>Modifies the maximum tn field. Accepted values are:</p>
									<p>For db_write_fmt set to V5, values can be current tn up to a maximum of <span class="emphasis"><em> (2**64 - 256M)</em></span></p>
									<p>For db_write_fmt set to V4, values can be current tn up to a maximum of <span class="emphasis"><em>(2**32 - 128M)</em></span></p>
									<p>The value is specified in hex.</p>
								</td></tr><tr><td align="left" valign="top">
									<p>warn_max_tn</p>
								</td><td align="left" valign="top">
									<p>Modifies the maximum tn warn field in the file-header. This value can be set to range of the current tn up to max_tn. Note this field is updated automatically to the next warning point whenever a warning is issued or when max_tn is set. The value is specified in hex.</p>
								</td></tr></tbody></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Modify these fields only when so instructed by GT.M Support.</p></td></tr></table></div><p>The following qualifiers allow 64-bit (16 hex digit) values when not running in compatibility mode. In compatibility mode, the values are limited to 32-bit.</p><p>-CU[RRENT_TN]=transaction_number</p><p>Changes the current transaction number for the current region.  This qualifier has implications for <span class="emphasis"><em>mupip backup -bytestream</em></span>. Raising the -current_tn effectively can correct block transaction number too large errors.</p><p>-B[YTESTREAM]=transaction_number</p><p>Changes the transaction number in the file header of the last <span class="emphasis"><em>-bytestream backup</em></span> to the value specified. Use this qualifier only in conjunction with the <span class="emphasis"><em>-fileheader</em></span> qualifier. For compatibility issues with prior versions, this can still be specified as <span class="emphasis"><em>-b_incremental</em></span>.</p><p>-B_R[ECORD]=transaction_number</p><p>Changes the transaction number in the file header of the last <span class="emphasis"><em>-record backup</em></span> to the value specified. Use this qualifier only in conjunction with the <span class="emphasis"><em>-fileheader</em></span> qualifier.</p><p>-D[ATABASE]=transaction_number</p><p>Changes the transaction number in the file header of the last <span class="emphasis"><em>-database backup</em></span> to the value specified. Use this qualifier only in conjunction with the <span class="emphasis"><em>-fileheader</em></span> qualifier. For compatibility issues with prior versions, this can still be specified as <span class="emphasis"><em>-b_comprehensive</em></span>.</p></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3069995"></a>DSE evaluate</h4></div></div></div><p>
                                        Displays a number in both hexadecimal and decimal formats, use it to translate a hexadecimal number to decimal and vice versa. The <span class="emphasis"><em>-decimal</em></span> and <span class="emphasis"><em>-hexadecimal</em></span> qualifiers specify the input base for the number. The <span class="emphasis"><em>-number</em></span> qualifier is a required value. Dse eval now supports 64-bit values for all these qualifiers. 
                                        </p><pre class="programlisting">V4 format: DSE&gt; eval -h -n=FFEEFFDD Hex: FFEEFFDD Dec: 4293853149 DSE&gt; eval -d -n=4293853149 Hex: FFEEFFDD Dec: 4293853149 V5 format: DSE&gt; eval -h -n=FFFFEEEEDDDDFFFF Hex: FFFFEEEEDDDDFFFF Dec: 18446725308424781823 DSE&gt; eval -d -n=18446725308424781823 Hex: FFFFEEEEDDDDFFFF Dec: 18446725308424781823</pre></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a xmlns="http://www.w3.org/1999/xhtml" href="#id3067708">Return to top</a></p><div><h3 class="title"><a id="id3070835"></a>MUPIP Changes</h3></div></div></div><p></p><p>Mupip processing includes changes to several of its operations such as <span class="emphasis"><em>backup, restore, create, integ, load, set, journal show</em></span> and <span class="emphasis"><em>journal extract</em></span> options.</p><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3070739"></a>MUPIP backup</h4></div></div></div><p>Mupip backup now supports 64-bit transaction number qualifiers.</p><p>-T[RANSACTION]=transaction-number</p><p>Specifies a starting transaction, which causes <span class="emphasis"><em>backup -bytestream</em></span> to copy all blocks that have been changed by the specified transaction and all subsequent transactions. Transaction numbers are now 16 digit hexadecimal numbers.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>GT.M V5 <span class="emphasis"><em>mupip backup</em></span> will not work with a V4 database  If doing a bytestream backup over a TCP connection, the receiving and sending systems must both be running the same version of GT.M with the same database file header version.</p></td></tr></table></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3070156"></a>MUPIP restore</h4></div></div></div><p><span class="emphasis"><em>Mupip restore</em></span> integrates one or more <span class="emphasis"><em>backup -bytestream</em></span> files into a corresponding database. The transaction number in the first bytestream backup file must be one more than the current transaction number of the database, and the first transaction number of each file in the sequence of files must be one more than that in its predecessor. Otherwise, <span class="emphasis"><em>mupip restore</em></span> will terminate with an error and refuse to perform the restore. <span class="emphasis"><em>mupip restore</em></span> now supports 64-bit transaction number qualifiers, when running with a database with a V5 header.
                            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>Mupip restore</em></span> cannot make use of a V4 format backup (bytestream or database).</p></td></tr></table></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3070647"></a>MUPIP create</h4></div></div></div><p>Files created with V5.0-000 mupip create now support 128M GDS data and index blocks instead of the 64M in V4, resulting from the larger master bitmap.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>V4 databases upgraded to V5 retain a maximum database file-size limit of 64M blocks</p></td></tr></table></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3071386"></a>MUPIP integ</h4></div></div></div><p><span class="emphasis"><em>Mupip integ</em></span> keeps track of the number of blocks that do not have the current block version during a non-fast integ (default or full) and matches this value against the blocks to upgrade counter in the file-header. It issues an error if the values are unmatched and corrects the count in the file header if there are no other integrity errors.
                            </p></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3071318"></a>MUPIP load</h4></div></div></div><p>The <span class="emphasis"><em>-FO[RMAT]=BINARY</em></span> qualifier of <span class="emphasis"><em>mupip load</em></span> is enhanced to read both V4 format and V5 format binary extracts.</p></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3071422"></a>MUPIP set</h4></div></div></div><p>The <span class="emphasis"><em>-version</em></span> qualifier sets the desired database block format version in the file header for any new blocks being written. <span class="emphasis"><em>Mupip upgrade</em></span> and <span class="emphasis"><em>reorg -upgrade</em></span> set this field to V5 while <span class="emphasis"><em>reorg -downgrade</em></span> sets it to V4. In order to set the version to V4, the current tn of the database must be within the range of a 32-bit maximum.
                            </p><pre class="programlisting">On V5 MUPIP&gt; set -version=V4 -file mumps.dat Database file mumps.dat now has desired DB format V4 MUPIP&gt; set -version=V5 -file mumps.dat Database file mumps.dat now has desired DB format V5</pre></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3071394"></a>MUPIP journal -show=header</h4></div></div></div><p><span class="emphasis"><em>Mupip journal -show=header</em></span> displays the begin and end transaction numbers as 64-bit values. 
                            </p><pre class="programlisting">On V4: MUPIP&gt; journal -show=header -forward mumps.mjl Begin Transaction 308 [0x00000134] End Transaction 308 [0x00000134] On V5: MUPIP&gt; journal -show=header -forward mumps.mjl Begin Transaction 1 [0x0000000000000001] End Transaction 1001 [0x00000000000003E9]</pre></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3070057"></a>MUPIP journal extract</h4></div></div></div><p>Transaction numbers within a journal file extract are now 64-bit integers with a range from 0 to 18,446,744,073,709,551,615</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>This maximum "number" exceeds the precision that GT.M carries for a numeric value (18 digits). Use of this value in an arithmetic expression will result in loss of precision so it should only ever be treated as a string value in any M program designed to process mupip journal extracts. As a practical matter, it is unlikely that a database file will have a transaction number that exceeds 18 digits.</p></td></tr></table></div></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3070765"></a>MUPIP upgrade/downgrade</h4></div></div></div><p><span class="emphasis"><em>Mupip upgrade/downgrade</em></span> upgrades or downgrades the file-header. File-header fields like current transaction, maximum tn and others that contain transaction numbers will have their size increased from 4 bytes to 8 bytes on upgrade, and correspondingly reduced on downgrade. 
                            </p><p>UPGRADE</p><p>The upgrade command resets the various trace counters and changes the database format to V5. This change does not upgrade the individual database blocks but sets the database format flag to V5. It also initializes a counter of the current blocks that are still in V4 format. This counter is decremented each time an existing V4 format block is converted to V5 format. When the counter is 0, the entire database has been converted.</p><pre class="programlisting">MUPIP&gt; upgrade mumps.dat You must have a backup before you proceed!! An abnormal termination will damage the database during the operation !! Are you ready to continue the operation [y/n] ? y %GTM-I-TEXT, Mupip upgrade started %GTM-I-MUINFOUINT4, Old file header size : 24576 [0x00006000] %GTM-I-MUINFOUINT8, Old file length : 2180608 [0x0000000000214600] %GTM-I-MUINFOUINT4, Old file start_vbn : 49 [0x00000031] %GTM-I-MUINFOUINT4, Old file gds blk_size : 1024 [0x00000400] %GTM-I-MUINFOUINT4, Old file total_blks : 2105 [0x00000839] %GTM-S-MUPGRDSUCC, Database file mumps.dat successfully upgraded to GT.M V5 Linux x86</pre><p>DOWNGRADE</p><p>The downgrade changes the file header to V4 format. It sets the transaction number below the maximum 32-bit TN value and removes the database certification.</p><p>A database that was created with V5.0-000 or which has standard null collation set cannot be downgraded to V4. A mupip extract in <span class="emphasis"><em>ZWR</em></span> format on V5 followed by a <span class="emphasis"><em>mupip load</em></span> on V4 is required to effect the downgrade.</p><pre class="programlisting">MUPIP&gt; downgrade mumps.dat You must have a backup before you proceed!! An abnormal termination will damage the database during the operation !! Are you ready to continue the operation [y/n] ? y %GTM-I-TEXT, Mupip downgrade started %GTM-I-MUINFOUINT4, Old file header size : 8192 [0x00002000] %GTM-I-MUINFOUINT8, Old file length : 2180608 [0x0000000000214600] %GTM-I-MUINFOUINT4, Old file start_vbn : 49 [0x00000031] %GTM-I-MUINFOUINT4, Old file gds blk_size : 1024 [0x00000400] %GTM-I-MUINFOUINT4, Old file total_blks : 2105 [0x00000839] %GTM-S-MUPGRDSUCC, Database file mumps.dat successfully downgraded to GT.M V4</pre></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id3069734"></a>MUPIP reorg upgrade/downgrade</h4></div></div></div><p>REORG -upgrade</p><p><span class="emphasis"><em>Mupip reorg -upgrade</em></span> upgrades the GDS blocks that are still in V4 format, after completion of <span class="emphasis"><em>mupip upgrade</em></span>. This variant of the <span class="emphasis"><em>mupip reorg</em></span> command runs through the entire database (or until blocks-to-convert = 0) checking the block format of each block. If the block format is V4, it is updated to V5 format and rewritten. 
                            </p><p>A block is considered to be too long to be upgraded from V4 format to V5 format if the records occupy more than blocksize-16 bytes. The presence of even one such block will prevent a database from being upgraded.</p><p>After a database has been certified, such "too long" blocks can occur if the Reserved Bytes field is reduced with a dse change -fileheader command or if a <span class="emphasis"><em>mupip journal -recover</em></span> or <span class="emphasis"><em>mupip journal -rollback</em></span> command changes the state of the of the database to before the <span class="emphasis"><em>dbcertify certify</em></span> operation.</p><p>This condition can be detected by mupip reorg -upgrade or during normal V5.0-000 operation when blocks are upgraded from V4 to V5 format. The only way to recover from this condition is to downgrade the database to V4 format and re-run both phases of dbcertify.</p><p>This condition can be avoided by not changing <span class="emphasis"><em>Reserved Bytes</em></span> after any dbcertify step and before the mupip upgrade, and, in the event, a database has a mupip <span class="emphasis"><em>journal -recover</em></span> or <span class="emphasis"><em>mupip journal -rollback</em></span> performed on it, then to repeat the <span class="emphasis"><em>dbcertify</em></span> steps before the <span class="emphasis"><em>mupip upgrade</em></span>.</p><p>-nosafejnl</p><p>If before image journaling is active, <span class="emphasis"><em>mupip reorg -upgrade</em></span> will generate before image records for these block changes even though there is no change to the data in the block. This is to ensure that backwards recovery can recover the database correctly, in the event of a system crash or power outage.  In the event that a system has a battery-backed IO subsystem, or a SAN, it is unlikely that there will be incomplete writes to the journal files.  As long as any pending write to the journal file is completed in the event of a system crash or power outage, the before image records are not required to recover the database.  In the event your hardware guarantees that there will not be an incomplete IO write operation, you can reduce IO load on your system by suppressing the generation of these before images with the use of the -nosafejnl option.  If your hardware does not provide such a guarantee, then Fidelity strongly recommends the use of the default behavior, which is to generate the before image records.
                           </p><pre class="programlisting">MUPIP&gt; reorg -upgrade -reg DEFAULT Region DEFAULT : MUPIP REORG UPGRADE started Region DEFAULT : Desired DB Format remains at V5 after MUPIP REORG UPGRADE Region DEFAULT : Started processing from block number [0x00000000] Region DEFAULT : Stopped processing at block number [0x00000800] Region DEFAULT : Statistics : Blocks Read From Disk (Bitmap) : 0x00000005 Region DEFAULT : Statistics : Blocks Skipped (Free/Recycled) : 0x00000000 Region DEFAULT : Statistics : Blocks Read From Disk (Non-Bitmap) : 0x000007FC Region DEFAULT : Statistics : Blocks Skipped (new fmt in disk) : 0x00000017 Region DEFAULT : Statistics : Blocks Skipped (new fmt in cache) : 0x00000000 Region DEFAULT : Statistics : Blocks Converted (Bitmap) : 0x00000003 Region DEFAULT : Statistics : Blocks Converted (Non-Bitmap) : 0x000007E6 Region DEFAULT : Total Blocks = [0x00000839] : Free Blocks = [0x00000012] : Blocks to upgrade = [0x00000000] Region DEFAULT : MUPIP REORG UPGRADE finished</pre><p>REORG -downgrade</p><p>A <span class="emphasis"><em>reorg -downgrade</em></span> changes the database blocks to V4 format. The transaction number fields are reduced to 32 bits. In the event the CTN is too large to fit in 32 bits, a <span class="emphasis"><em>mupip integ -tn_reset</em></span> will need to be performed prior to performing the <span class="emphasis"><em>mupip reorg -downgrade</em></span>. The <span class="emphasis"><em>blks_to_upgrd</em></span> counter increases to signify a downgrading database.
                        </p><pre class="programlisting">MUPIP&gt; reorg -downgrade -reg DEFAULT Region DEFAULT : MUPIP REORG DOWNGRADE started Region DEFAULT : Desired DB Format set to V4 by MUPIP REORG DOWNGRADE Region DEFAULT : Started processing from block number [0x00000000] Region DEFAULT : Stopped processing at block number [0x00000839] Region DEFAULT : Statistics : Blocks Read From Disk (Bitmap) : 0x00000005 Region DEFAULT : Statistics : Blocks Skipped (Free/Recycled) : 0x00000012 Region DEFAULT : Statistics : Blocks Read From Disk (Non-Bitmap) : 0x00000822 Region DEFAULT : Statistics : Blocks Skipped (new fmt in disk) : 0x00000000 Region DEFAULT : Statistics : Blocks Skipped (new fmt in cache) : 0x00000000 Region DEFAULT : Statistics : Blocks Converted (Bitmap) : 0x00000005 Region DEFAULT : Statistics : Blocks Converted (Non-Bitmap) : 0x00000822 Region DEFAULT : Total Blocks = [0x00000839] : Free Blocks = [0x00000012] : Blocks to upgrade = [0x00000827] Region DEFAULT : MUPIP REORG DOWNGRADE finished</pre></div></div></div><div class="sect1" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a xmlns="http://www.w3.org/1999/xhtml" href="#id3067708">Return to top</a></p><div><h2 class="title"><a id="id3070656"></a>Messages</h2></div></div></div><p></p><p>All messages that include a transaction number will now output the numbers as 64-bit values. These are <span class="emphasis"><em>BOVTNGTEOVTN, DBBMLCORRUPT, DBFILEXT, DBTN, DBWCVERIFYEND, DBWCVERIFYSTART, DLCKAVOIDANCE, DUPTN, NLDBTNNOMATCH, JNLTNOUTOFSEQ, JNLTPNEST, MUJNINFO, NOTREPLICATED, TPRESTART, TRNARNDTNHI</em></span>, and <span class="emphasis"><em>WCBLOCKED</em></span>.</p><p>
			<div class="informaltable"><table border="0" width="90%"><colgroup><col></col><col></col></colgroup><tbody><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBBTUFIXED</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>The blocks-to-upgrade file-header field has been changed to the correct value</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Info</p>
							</td></tr><tr><td align="left" valign="top">
								<p>MUPIP Informational:</p>
							</td><td align="left" valign="top">
								<p>MUPIP INTEG has corrected the blocks-to-upgrade field.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Report this to the group responsible for database integrity at your operation.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBBTUWRNG</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>The blocks-to-upgrade file-header field is incorrect. Expected xxxx, found yyyy</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Warning</p>
							</td></tr><tr><td align="left" valign="top">
								<p>MUPIP INTEG Error:</p>
							</td><td align="left" valign="top">
								<p>The "Blocks to Upgrade" counter was found to be incorrect by MUPIP INTEG (this is only checked for non-FAST integs).</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>If there are no other integrity errors, MUPIP INTEG will repair the counter. If there are other integrity errors, fix those errors first, then rerun MUPIP INTEG which will repair the counter if it is still found to be in error. Although this error is not indicative of any specific kind of database damage it does represent an out-of-design condition (except following a system crash in which before image journaling was not in use) that GT.M Support would like to know about.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBCBADFILE</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Source file xxx does not appear to have been generated by DBCERTIFY SCAN - rerun SCAN or specify correct file.</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>DBCERTIFY/V5CBSU Error:</p>
							</td><td align="left" valign="top">
								<p>V5CBSU and DBCERTIFY CERTIFY require the output file from DBCERTIFY SCAN. The file, which was specified is not in the correct format.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Specify the file created by DBCERTIFY SCAN. Rerun DBCERTIFY SCAN if needed.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBCCMDFAIL</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Executed command failed with return code xxxx yyyy which executed yyyy yyyy</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>DBCERTIFY Error:</p>
							</td><td align="left" valign="top">
								<p>During processing, the DBCERTIFY attempts to execute certain DSE and/or MUPIP commands in temporary command scripts that DBCERTIFY creates. The specified command failed to execute.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>The action to take depends on the code returned by the attempt and if any associated messages were created on either the console or the operator log. Some common causes of problems could be that $gtm_dist (UNIX) or GTM$DIST (OpenVMS) are not properly pointing to the current GT.M V4 version or DBCERTIFY has no access or access to the wrong global directory for which it is executing commands.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBCDBCERTIFIED</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Database xxx has been certified for use with xxxx</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Info</p>
							</td></tr><tr><td align="left" valign="top">
								<p>DBCERTIFY Message:</p>
							</td><td align="left" valign="top">
								<p>DBCERTIFY CERTIFY has successfully completed and marked the database as certified for use by the specified GT.M version.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Either keep running GT.M V4 version or proceed immediately to GT.M V5 MUPIP UPGRADE at user's discretion.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBCINTEGERR</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Encountered integrity error in database xxxx</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>DBCERTIFY Error:</p>
							</td><td align="left" valign="top">
								<p>DBCERTIFY discovered what appears to be an integrity error while processing the specified database. This error is accompanied by a secondary message explaining the error.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Run a MUPIP INTEG (not FAST integ) on the database in question; fix damage, then re-run the phase reporting the error. If the integrity error persists, contact GT.M Support.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBCKILLIP</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Cannot proceed with kill-in-progress indicator set for database xxx</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>DBCERTIFY Error:</p>
							</td><td align="left" valign="top">
								<p>DBCERTIFY discovered that the kill in progress indicator was on for the specified database. DBCERTIFY will not process a database with this indicator on.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Run a MUPIP INTEG (FAST integ is OK) on the database in question; correct errors, then re-run the phase reporting the error. If the error persists, contact GT.M Support.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBCMODBLK2BIG</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Block 0xaaa has been modified since DCERTIFY SCAN but is still too large or has an earlier TN than in DCERTIFY SCAN - Rerun scan</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>DBCERTIFY Error:</p>
							</td><td align="left" valign="top">
								<p>DBCERTIFY reports this error when the block it is processing has a different TN than it did in the scan phase yet the block is still too large.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>This condition indicates that something has been done to the database since the scan phase was run - either it was restored from an earlier backup or the reserved bytes value was (even temporarily) reduced. DBCERTIFY SCAN must be rerun.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBCNOEXTND</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Unable to extend database xxx</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>DBCERTIFY Error:</p>
							</td><td align="left" valign="top">
								<p>DBCERTIFY attempted to use MUPIP EXTEND to extend the database but the attempt failed.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Examine the accompanying messages from the MUPIP EXTEND attempt to see why the extend failed. Some common causes for this are that $gtm_dist on UNIX or GTM$DIST on OpenVMS did not properly point to the currently installed V4 distribution, or there was insufficient disk space to perform the expansion.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBCNOFINISH</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBCERTIFY unable to finish all requested actions.</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>DBCERTIFY Error:</p>
							</td><td align="left" valign="top">
								<p>This indicates DBCERTIFY encountered an error, which prevented the requested action from completing. The action has partially completed.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Review the accompanying message(s) for additional information to identify the cause.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBCNOTSAMEDB</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Database has been moved or restored since DBCERTIFY SCAN - Rerun scan</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>DBCERTIFY Error:</p>
							</td><td align="left" valign="top">
								<p>DBCERTIFY has noted that the unique database identifiers for the database have changed since DBCERTIFY SCAN was run.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>The database is required to have not been moved around or restored or recovered since DBCERTIFY SCAN was run. DBCERTIFY SCAN must be rerun.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBCREC2BIG</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Record with key xxx is length yyy in block 0xaaa is greater than the maximum length yyy in database xxx</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>DBCERTIFY Error:</p>
							</td><td align="left" valign="top">
								<p>DBCERTIFY has identified a record with the given key in the given block with a length that exceeds the maximum length allowed in the given database.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>This is typically due to the user reducing the maximum record length to meet the DBCERTIFY requirements but not verifying that no records exist that exceeds that length. The solution is to either delete or otherwise restructure the record or to MUPIP extract/load into a database with a larger blocksize.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBCSCNNOTCMPLT</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Specified DBCERTIFY SCAN output file is not complete - Rerun scan</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>DBCERTIFY Error:</p>
							</td><td align="left" valign="top">
								<p>DBCERTIFY CERTIFY has noted that the header of the scan phase output is not filled in indicating that the scan phase did not complete normally.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Rerun DBCERTIFY SCAN to produce a complete output file for the certify phase to process.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBDSRDFMTCHNG</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Database file xxx, Desired DB Format set to yyy by zzz with pid ppp [0xppp] at transaction number [0xttt].</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Info</p>
							</td></tr><tr><td align="left" valign="top">
								<p>MUPIP Informational:</p>
							</td><td align="left" valign="top">
								<p>The desired database block format has been changed to version yyy for database file xxx by the zzz command with process number ppp at transaction number ttt.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBMAXREC2BIG</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Maximum record size (xxx) is too large for this block size (yyy) - Maximum is zzz</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>DBCERTIFY/MUPIP Error:</p>
							</td><td align="left" valign="top">
								<p>DBCERTIFY and MUPIP UPGRADE report this error when the maximum record size is too close to the database blocksize and does not allow room for the expanded V5 block header.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Reduce the maximum record size or mupip extract/load into a database with a larger blocksize. Note that if the maximum record size is reduced with DSE, it is possible that records that exceed the reduced size still exist in the database that is now an integrity error. DBCERTIFY SCAN will find these blocks and report on them if they exist.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBMINRESBYTES</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Minimum RESERVED BYTES value required for certification/upgrade is xxx - Currently is yyy</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>DBCERTIFY/MUPIP Error:</p>
							</td><td align="left" valign="top">
								<p>DBCERTIFY and MUPIP UPGRADE report this error when the reserved bytes field of the database file header (as shown by <span class="emphasis"><em>DSE DUMP -FILEHEADER</em></span>) is not at a sufficient value for the GT.M V5 upgrade.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Increase the reserved bytes value with either MUPIP or DSE so that the value is at least 8 bytes for UNIX and 9 bytes for OpenVMS. Note that the reserved bytes value is reduced by the above amounts by MUPIP UPGRADE.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBVERPERFWARN1</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBVERPERFWARN1, Performance warning: Database aaaa is running in compatibility mode that degrades performance. Run MUPIP REORG UPGRADE for best overall performance.</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Warning</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Run Time Warning:</p>
							</td><td align="left" valign="top">
								<p>This is a warning that the database is currently in compatibility (downgrade) mode. This mode causes all modified GDS blocks to be reformatted (to the downgraded database format) before they are flushed to the database file on disk. This is a very large performance hit.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>As the message indicates, run MUPIP REORG UPGRADE as soon as possible to move away from compatibility mode. This command can be run without taking the database offline. Once that completes successfully, the database is fully upgraded and there is no reformatting overhead anymore while flushing modified blocks to disk.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DBVERPERFWARN2</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Peformance warning: Database aaaa is not fully upgraded. Run MUPIP REORG UPGRADE for best overall performance.</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Warning</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Run Time Warning:</p>
							</td><td align="left" valign="top">
								<p>This is a performance warning message that indicates the database is not yet fully upgraded i.e. there are still blocks in the database file that need to be upgraded. Staying in this mode causes some inefficiencies which include (but are not limited to) reading blocks from disk.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>As the message indicates, run MUPIP REORG UPGRADE at the earliest. This command can be run without taking the database offline. Once that completes successfully, the database file is fully upgraded.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>DYNUPGRDFAIL</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Unable to dynamically upgrade block 0xaaa in database yyy due to lack of free space in block</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Runtime Error:</p>
							</td><td align="left" valign="top">
								<p>There was not enough free space in the block to convert it in place to the current format during normal database access. This indicates that the DBCERTIFY database certification procedure was not properly carried out.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Either mark the block free (making appropriate index changes) or downgrade the database and re-run DBCERTIFY (both phases).</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>MMNODYNDWNGRD</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Unable to use dynamic downgrade with MM access method for region xxx. Use BG access method for downgrade</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>MUPIP/Runtime Error:</p>
							</td><td align="left" valign="top">
								<p>An attempt was made to use MM mode on a database that has not completed being downgraded. MM mode is only supported on fully downgraded or fully upgraded databases.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Use MUPIP SET FILE or MUPIP SET REGION with the ACCESS_METHOD parameter to set the access mode to BG. Then complete the file downgrade using MUPIP REORG DOWNGRADE or file upgrade using MUPIP REORG UPGRADE. Finally set the access mode back to MM using the MUPIP SET FILE or MUPIP SET REGION command again.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>MMNODYNUPGRD</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Unable to use MM access method for region yyy until all database blocks are upgraded</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>MUPIP/Runtime Error:</p>
							</td><td align="left" valign="top">
								<p>An attempt was made to use MM mode on a database that has not completed being upgraded. MM mode is only supported on fully upgraded databases.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Use MUPIP SET FILE or MUPIP SET REGION with the ACCESS_METHOD parameter to set the access mode to BG. Then complete the file upgrade using MUPIP REORG UPGRADE. Finally set the access mode back to MM using the MUPIP SET FILE or MUPIP SET REGION command again.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>MUDWNGRDNOTPOS</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Start VBN value is [xxx] while downgraded GT.M version can support only [yyy]. Downgrade not possible</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>MUPIP Error:</p>
							</td><td align="left" valign="top">
								<p>Older versions of GT.M require the first GDS block be at Virtual Block Number yyy but it is at VBN xxx. This is likely, as the file, being created initially was using a newer version of GT.M and thus cannot be downgraded.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>To use the database with an older version of GT.M, it must be extracted with the current version and loaded into the older version both in ZWR format.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>MUDWNGRDNRDY</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Database xxx is not ready to downgrade - still yyy database blocks to downgrade</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>MUPIP Error:</p>
							</td><td align="left" valign="top">
								<p>A MUPIP DOWNGRADE was attempted when the file-header blks_to_upgrd counter was not equal to the database used block count. This means that not all database blocks have been converted to V4 format.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Before the database file-header can be downgraded, all of the blocks in the database must be downgraded to V4 format. This is normally accomplished with MUPIP REORG DOWNGRADE. If this fails to set the counter correctly, run MUPIP INTEG (not FAST) on the region that will compute and set the correct counter.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>MUDWNGRDTN</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Transaction number 0xaaa in database xxx is too big for MUPIP [REORG] DOWNGRADE. Renew database with MUPIP INTEG TN_RESET</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>MUPIP Error:</p>
							</td><td align="left" valign="top">
								<p>A MUPIP DOWNGRADE or MUPIP REORG DOWNGRADE was attempted when the database transaction number was greater than 4,026,531,839 (the TN_RESET warning limit for V4 databases).</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Before the database can be downgraded, the transaction number must be reset with the MUPIP INTEG TN_RESET command. This requires standalone access to the database and may take a significant amount of time.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>MUPGRDSUCC</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Database file xxx successfully yyy to zzz</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Success</p>
							</td></tr><tr><td align="left" valign="top">
								<p>MUPIP Informational:</p>
							</td><td align="left" valign="top">
								<p>The database file header for xxx has been upgraded or downgraded to the version zzz format.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>MUREUPDWNGRDEND</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>MUREUPDWNGRDEND, Region xxxx : MUPIP REORG UPGRADE/DOWNGRADE finished by pid aaaa [0xbbbb] at transaction number [0xcccc].</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Info</p>
							</td></tr><tr><td align="left" valign="top">
								<p>MUPIP Informational:</p>
							</td><td align="left" valign="top">
								<p>This is an informational message printed by MUPIP REORG UPGRADE or DOWNGRADE when the reorg has successfully completed its upgrade or downgrade respectively.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>None necessary.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>MUUPGRDNRDY</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Database xxx has not been certified as being ready to upgrade to yyy format</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>MUPIP Error:</p>
							</td><td align="left" valign="top">
								<p>The named database file is in an older format than is in use by this GT.M version and has not been certified as ready for use by this GT.M version.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Run DBCERTIFY to certify the database as being ready for upgrade.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>TNTOOLARGE</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Database file xxx has reached the transaction number limit (0xaaa). Renew database with MUPIP INTEG TN_RESET</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Error</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Run Time Information:</p>
							</td><td align="left" valign="top">
								<p>This indicates that GT.M detected that the transaction numbers in the named database have reached the maximum number. There are 0xFFFFFFFF ([2**32 - 1] or 4,294,967,295 decimal) possible transaction numbers for V4 or 0xFFFFFFFFFFFFFFFF ([2**64 - 1] or 18,446,744,073,709,551,615 decimal) possible transaction numbers for V5 version databases. Note that the actual maximum TN is less than this theoretical limit. <span class="emphasis"><em>DSE DUMP FILEHEADER</em></span> shows what the limit is. The actual limit reflects some overhead used, for example, during a TN_RESET operation.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Use MUPIP INTEG with the qualifier TN_RESET to reset the transaction numbers in the database. If the database is in the V4 format, consider converting it to the V5 format. The database cannot otherwise be used, until the condition is removed by either a TN_RESET or, if a V4 database, changing the output mode to V5 with MUPIP SET VERSION.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>TNWARN</em></span>
								</p>
							</td><td align="left" valign="top">
								<p>
									<span class="emphasis"><em>Database file xxx has 0xaaa more transactions to go before reaching the transaction number limit (0xaaa). Renew database with MUPIP INTEG TN_RESET</em></span>
								</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Severity:</p>
							</td><td align="left" valign="top">
								<p>Warning</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Run Time Information:</p>
							</td><td align="left" valign="top">
								<p>This indicates that GT.M detected that the transaction numbers in the named database are approaching the maximum number. There are 0xFFFFFFFF ([2**32 - 1] or 4,294,967,295 decimal) possible transaction numbers for V4 or 0xFFFFFFFFFFFFFFFF ([2**64 - 1] or 18,446,744,073,709,551,615 decimal) possible transaction numbers for V5 version databases. This message is sent to the operator log periodically at decreasing intervals as the transaction number approaches the maximum. Note that the actual maximum TN is less than this theoretical limit. <span class="emphasis"><em>DSE DUMP FILEHEADER</em></span> shows what the limit is. The actual limit reflects some overhead used,for example, during a TN_RESET operation.</p>
							</td></tr><tr><td align="left" valign="top">
								<p>Action:</p>
							</td><td align="left" valign="top">
								<p>Use MUPIP INTEG with the qualifier TN_RESET to reset the transaction numbers in the database. If the database is in the V4 format, consider converting it to the V5 format.</p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="left" valign="top">
								<p></p>
							</td><td align="left" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr><tr><td align="center" valign="top">
								<p></p>
							</td><td align="center" valign="top">
								<p></p>
							</td></tr></tbody></table></div>
		</p><p></p><p></p></div><div class="sect1" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a xmlns="http://www.w3.org/1999/xhtml" href="#id3067708">Return to top</a></p><div><h2 class="title"><a id="id3070660"></a>Typographical Conventions</h2></div></div></div><p> <span class="italic">Command Syntax:</span> UNIX syntax (i.e., lowercase text and "-" for flags/qualifiers) is used throughout this document. OpenVMS accepts both lowercase and uppercase text; flags/qualifiers should be preceded with "/".</p><p> <span class="italic">Reference Number:</span> The reference numbers used to track software enhancements and customer support requests appear in parentheses ( ).</p><p> <span class="italic">Platform Identifier:</span> If a new feature or software enhancement does not apply to all platforms, the relevant platform appears in brackets [ ].</p><p>
			<a href="#return_to_top">Return to top</a>
		</p></div><div class="footnotes"><br></br><hr width="100" align="left"></hr><div class="footnote"><p><sup>[<a id="ftn.id3069033" href="#id3069033">1</a>] </sup>All GT.M releases prior to V5.0-000, including V5 field test releases such as V5.0-FT01, have V4 database formats.  V5 field test releases however, have a V5 global directory.</p></div><div class="footnote"><p><sup>[<a id="ftn.id3069632" href="#id3069632">2</a>] </sup>Since the largest permissible database block size is 65,024 bytes, the largest record that can be stored in a V4 database is 65,016 bytes, and the largest record that can be stored in a V5 database is 65,008 bytes, which leaves open the theoretical possibility of a database that cannot be upgraded to V5.  Since Fidelity is not aware of any customer who uses a block size of 65,024 bytes, this remains just a theoretical issue.</p></div><div class="footnote"><p><sup>[<a id="ftn.id3070424" href="#id3070424">3</a>] </sup>If you reduce the maximum record size in the database file with DSE, remember to make a change to the global directory with GDE so that any new database files have the new value.</p></div></div></div><div xmlns="" id="customfooter" align="center">
For more information, see the <a href="http://www.sanchez-gtm.com/" target="_blank" style="color: #000; font-weight: bold;">GT.M</a> web site. 
</div></body>
<!-- Mirrored [from host tinco.pair.com [file /bhaskar/gtm/doc/articles/GTM_Database_Migration.html]] -->
</html>
