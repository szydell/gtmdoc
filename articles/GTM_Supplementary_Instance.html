<html>
<!-- Mirrored from tinco.pair.com/bhaskar/gtm/doc/articles/GTM_Supplementary_Instance.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 13 Mar 2019 23:00:53 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>GT.M Supplementary Instance Replication</title><link rel="stylesheet" href="gtm.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><meta name="description" content="Contact Information GT.M Group Fidelity Information Services, Inc. 2 West Liberty Boulevard, Suite 300 Malvern, PA 19355 United States of America GT.M Support for customers: +1 (610) 578-4226 gtmsupport@fisglobal.com Switchboard: +1 (610) 296-8877 Website: http://fis-gtm.com"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="en-US" class="article" title="GT.M Supplementary Instance Replication"><div class="titlepage"><div><div><div class="mediaobject"><img src="images/FIS_RGB_logo.jpg"></div></div><div><h2 class="title"><a name="id1204597"></a><a name="return_to_top"></a>GT.M Supplementary Instance Replication</h2></div><div><h3 class="subtitle"><i>Technical Bulletin: GT.M V5.5-000</i></h3></div><div><p class="copyright">Copyright © 2012 Fidelity Information Services, Inc.</p></div><div><div class="legalnotice" title="Legal Notice"><a name="id1205760"></a><p class="legalnotice-title"><b>Legal Notice</b></p><p>Copyright © 2012 Fidelity Information Services, Inc. All Rights Reserved</p><p>Permission is granted to copy, distribute and/or modify this document under the terms of the <a class="ulink" href="http://www.gnu.org/licenses/fdl.txt" target="_top">GNU Free Documentation License</a>, Version 1.3 or any later version published by the Free Software Foundation; with no Invariant Sections, no Front-Cover Texts and no Back-Cover Texts. </p><p>GT.M&#8482; is a trademark of Fidelity Information Services, Inc. Other trademarks are the property of their respective owners. </p><p>This document contains a description of GT.M and the operating instructions pertaining to the various functions that comprise the system. This document does not contain any commitment of FIS. FIS believes the information in this publication is accurate as of its publication date; such information is subject to change without notice. FIS is not responsible for any errors or defects. </p></div></div><div><p class="pubdate">March 20, 2012</p></div><div><div class="revhistory"><table border="1" width="100%" summary="Revision history"><tr><th align="left" valign="top" colspan="3"><b>Revision History</b></th></tr><tr><td align="left">Revision 1.1</td><td align="left">20 March 2012</td><td align="left">Improvements and corrections in <a class="xref" href="#up_re_in_fi" title="Upgrade Replication Instance File">&#8220;Upgrade Replication Instance File&#8221;</a> and <a class="xref" href="#new_quals" title="New Qualifiers">&#8220;New Qualifiers&#8221;</a> sections. </td></tr><tr><td align="left">Revision 1.0</td><td align="left">February 22, 2012</td><td align="left">First published version.</td></tr></table></div></div><div><div class="abstract" title="Contact Information"><p class="title"><b>Contact Information</b></p><div class="informaltable"><table border="0" width="100%"><colgroup><col><col></colgroup><tbody><tr><td>
                  <p>
</p><div class="address"><p>GT.M Group <br>
Fidelity Information Services, Inc. <br>
<span class="street">2 West Liberty Boulevard, Suite 300</span><br>
<span class="city">Malvern, </span><span class="state">PA </span><span class="postcode">19355</span><br>
<span class="country">United States of America</span></p></div><p>
</p>
                </td><td>
                  <p>
</p><div class="address"><p><br>
<span class="phone">GT.M Support for customers: +1 (610) 578-4226 </span><br>
<span class="phone">gtmsupport@fisglobal.com</span><br>
<span class="phone">Switchboard: +1 (610) 296-8877</span><br>
<span class="otheraddr">Website: <a class="ulink" href="http://fis-gtm.com/" target="_top">http://fis-gtm.com</a></span><br>
                    </p></div><p>
</p>
                </td></tr></tbody></table></div><p>
</p></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#id1204700">Summary</a></span></dt><dt><span class="sect1"><a href="#id1205851">Motivation for Supplementary Instance Replication</a></span></dt><dt><span class="sect1"><a href="#id1205939">Theory of Operation</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id1204875">Types of Sequence Numbers</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id1204994">Examples</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id1205070">Simple Example</a></span></dt><dt><span class="sect2"><a href="#id1206081">Ensuring Consistency with Rollback</a></span></dt><dt><span class="sect2"><a href="#id1208172">Rollback Not Desired or Required by Application Design</a></span></dt><dt><span class="sect2"><a href="#id1208379">Two Originating Primary Failures</a></span></dt><dt><span class="sect2"><a href="#id1209562">Replication and Online Rollback</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id1210668">Limitations</a></span></dt><dt><span class="sect1"><a href="#id1210390">Procedures</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id1209132">Overview</a></span></dt><dt><span class="sect2"><a href="#up_re_in_fi">Upgrade Replication Instance File</a></span></dt><dt><span class="sect2"><a href="#id1211174">Creating a Supplementary Instance</a></span></dt><dt><span class="sect2"><a href="#id1205405">Starting / Resuming Replication</a></span></dt><dt><span class="sect2"><a href="#id1211303">Changing the Replication Source</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id1210410">MUPIP Commands</a></span></dt><dd><dl><dt><span class="sect2"><a href="#id1208372">Modified qualifiers</a></span></dt><dt><span class="sect2"><a href="#new_quals">New Qualifiers</a></span></dt></dl></dd><dt><span class="sect1"><a href="#id1211256">Error Messages and Recovery</a></span></dt></dl></div><div class="sect1" title="Summary"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id1204700"></a>Summary</h2></div></div></div><p>Effective V5.5-000, FIS GT.M adds a new type of replication, called Supplementary Instance (SI) replication. The previous sole replication mechanism is now called Business Continuity (BC) replication in order to distinguish between them.</p><p>At the time of writing, V5.5-000 is the only GT.M release to support SI replication. Should later releases exist when you peruse this technical bulletin, please read "V5.5-000 or later, as clarified or qualified by the release notes for your release" for "V5.5-000" below.</p><p>In this document, unless more specifically designated, the term "transaction" refers to all TP transactions - updates within TSTART/TCOMMIT brackets (with nested transactions, the outermost one), and all so-called "mini transactions" - individual updates (Sets, Kills, and ZKills) not within TSTART/TCOMMIT brackets.</p></div><div class="sect1" title="Motivation for Supplementary Instance Replication"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id1205851"></a>Motivation for Supplementary Instance Replication</h2></div></div></div><p>GT.M replication was originally intended to provide business continuity for systems of record. For example with instances named <span class="bold"><strong>Ardmore</strong></span> and <span class="italic">BrynMawr</span>, business logic processed on instance <span class="bold"><strong>Ardmore</strong></span> can be streamed to instance <span class="italic">BrynMawr</span> so that should <span class="bold"><strong>Ardmore</strong></span> ever go down, <span class="italic">BrynMawr</span> can immediately take over and provide continuity. In order to ensure that <span class="italic">BrynMawr</span> produces results consistent with <span class="bold"><strong>Ardmore</strong></span>, <span class="italic">BrynMawr</span> can contain only material state information that is also in <span class="bold"><strong>Ardmore</strong></span>.<sup>[<a name="id1204903" href="#ftn.id1204903" class="footnote">1</a>]</sup> To help ensure this consistency, GT.M BC replication prohibits locally generated database updates on a replicating secondary instance. Because they are conceptually part of atomic updates from the originating primary instance, GT.M triggers on replicating secondary instances are computed and committed locally.</p><p>Now consider an application such as running a report. This may require database updates including calculating and storing aggregates, statistics and interim results, or perhaps just to record the fact that the report was run. With traditional BC Replication, to offload such reporting from the originating primary instance is not a simple matter of running it on a replicating secondary instance, since updates are not permitted on replicating secondary instances.</p><p>SI replication allows replication from an instance (either <span class="bold"><strong>Ardmore</strong></span> or <span class="italic">BrynMawr</span> in the example above) to another originating primary instance, <span class="underline">Malvern</span>. <span class="underline">Malvern</span> can execute its own business logic, computing and committing its own updates to its database, while receiving a replication stream. In turn, BC Replication from <span class="underline">Malvern</span> can provide it with its own replicating secondary instance, <span class="italicunderline"><span class="italicunderline">Newtown</span></span>. In this example, only originating primary instances <span class="bold"><strong>Ardmore</strong></span> and <span class="underline">Malvern</span> can execute business logic and compute database updates. Replicating secondary instances <span class="italic">BrynMawr</span> and <span class="italicunderline"><span class="italicunderline">Newtown</span></span> are only permitted to receive and apply replication streams from their originating primary instances.</p><p>SI replication is intended to be a general purpose mechanism whose utility includes applications such as real-time decision support, warehousing, analytics and auditing.</p></div><div class="sect1" title="Theory of Operation"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id1205939"></a>Theory of Operation</h2></div></div></div><p>This section presupposes an understanding of GT.M database replication and Logical Multi-Site (LMS) application configurations.</p><p>In order to create applications that remain available in the face of system and network failure, GT.M replication is asynchronous, which in turn means that the source and receiver ends of a replication connection are at an identical state only when there is no activity underway. To maintain consistency, and to restore it when restarting a replication connection, instances maintain a common, mutually coherent, instance-wide serial number called a journal sequence number. Since replication deals with an entire global variable name space, regardless of the mapping of global variables to database files, all updates participate in this numbering, even when modifying different database files.</p><p>When an originating primary instance and a replicating secondary instance connect, they establish the latest shared transaction (that is, the latest transaction they both have in common in their databases). If the instance configured as the secondary has any transactions in its database subsequent to that last transaction shared with the instance that is to be the primary, it rolls its database back to that last common transaction before beginning replication. The transactions that are rolled back go into an Unreplicated Transaction Log (previously known as a Lost Transaction File, a name we are retaining so as to not cause regressions). Identifying the common point for this rollback requires mutually coherent transaction ordering. Journal sequence numbers, while providing coherent transaction for BC replication do not suffice for SI replication.</p><p>To augment this capability for SI replication, journal sequence numbers are tagged with their origin- a stream # that can take on values 0 through 15 - and a stream sequence number - the journal sequence number of the update on the originating instance. Thus, of the journal sequence numbers in <span class="underline">Malvern</span> say 100, 101, and 102, if the first and third transactions are locally generated and the second is replicated, the tagged journal sequence numbers might be something like {100,0,10}, {101,1,18}, {102,0,11}. The 0 stream # for 100 and 102 indicates those transactions are 
generated locally on <span class="underline">Malvern</span> whereas stream # 1 indicates those transactions were generated in <span class="bold"><strong>Ardmore</strong></span>. It is important to note that if, as part of restarting replication with <span class="bold"><strong>Ardmore</strong></span>, <span class="underline">Malvern</span> needs to roll {101,1,18} off its database, database update serialization also requires it to roll {102,0,11} off as well, and both will appear in the Unreplicated Transactlon Log.</p><p>The same transaction that has a <span class="underline">Malvern</span> sequence number of 101 will have a different sequence number of 18 on <span class="bold"><strong>Ardmore</strong></span> and <span class="italic">BrynMawr</span>. That is, the journal sequence number on <span class="bold"><strong>Ardmore</strong></span> becomes the stream sequence number on <span class="underline">Malvern</span>. The replication instance file in <span class="underline">Malvern</span> contains information that allows GT.M to determine this mapping, so that when <span class="underline">Malvern</span> rolls {101,1,18} off its database, <span class="bold"><strong>Ardmore</strong></span> knows that <span class="underline">Malvern</span> has rolled off <span class="bold"><strong>Ardmore</strong></span>&#8217;s transaction 18.</p><p>If <span class="underline">Malvern</span> in turn implements BC replication to another instance <span class="italicunderline"><span class="italicunderline">Newtown</span></span>, the tagging is propagated to <span class="italicunderline"><span class="italicunderline">Newtown</span></span>, such that if <span class="bold"><strong>Ardmore</strong></span> and <span class="underline">Malvern</span> both go down (e.g., if they are co-located in a data center that loses electricity), <span class="italic">BrynMawr</span> and <span class="italicunderline">Newtown</span> can take over the functions of <span class="bold"><strong>Ardmore</strong></span> and <span class="underline">Malvern</span> respectively, and <span class="italicunderline">Newtown</span> can perform any synchronization needed in order to start accepting a replication stream from <span class="italic">BrynMawr</span>. as being a continuation of the updates generated by <span class="bold"><strong>Ardmore</strong></span>, and <span class="italic">BrynMawr</span> in turn accepts <span class="italicunderline">Newtown</span> as the successor to <span class="underline">Malvern</span>.</p><div class="sect2" title="Types of Sequence Numbers"><div class="titlepage"><div><div><h3 class="title"><a name="id1204875"></a>Types of Sequence Numbers</h3></div></div></div><p>SI replication adds additional types of update related sequence numbers to those already in GT.M. This is an attempt to summarize in one place what they are and how they are related.</p><div class="sect3" title="Database Transaction Number"><div class="titlepage"><div><div><h4 class="title"><a name="id1205788"></a>Database Transaction Number</h4></div></div></div><p>Every transaction applied to a database file increments the database transaction number for that file. Each block records the database transaction number at which it was updated, and the Current transaction field in the file header shows the value for the next transaction or mini-transaction to use. The following database file header fields all show database transaction numbers: Last Record Backup, Last Database Backup, Last Bytestream Backup, Maximum TN, and Maximum TN Warn.</p><p>Database transaction numbers are currently unsigned 64-bit integers.</p><p>While database activity uses database transaction numbers sequentially, not every transaction number can be found in a database block. For a Kill increments the database transaction number, but can remove blocks with earlier database transaction numbers from the database.</p><p>Note that database transaction numbers are updated in memory and only periodically flushed to secondary storage, so in cases of abnormal shutdown, the on-disk copies in the file header might be somewhat out-of-date.</p></div><div class="sect3" title="Journal Sequence Number"><div class="titlepage"><div><div><h4 class="title"><a name="id1205240"></a>Journal Sequence Number</h4></div></div></div><p>While the database transaction number is specific to a database file, replication imposes a serialization of transactions across all replicated regions. As each transaction is placed in the Journal Pool it is assigned the next journal sequence number. When a database file in a replicated instance is updated, the Region Seqno field in the file header records the journal sequence number for that transaction. The journal sequence number for an instance is the maximum Region Seqno of any database file in that instance. While it uses them in processing, GT.M stores journal sequence numbers only in journal files. In database file headers, Zqgblmod Seqno and Zqgblmod Trans are journal sequence numbers.</p><p>Except for transactions in Unreplicated Transaction Logs, the journal sequence number of a transaction uniquely identifies that transaction on the originating primary instance and on all replicating secondary instances. When replicated via SI replication, the journal sequence number becomes a stream sequence number (see below) and propagated downstream, thus maintaining the unique identity of each transaction.</p><p>Journal sequence numbers cannot have holes - missing journal sequence numbers are evidence of abnormal database activity, including possible manual manipulation of the transaction history or database state.</p><p>Journal sequence numbers are 60-bit unsigned integers.</p></div><div class="sect3" title="Stream Sequence Number"><div class="titlepage"><div><div><h4 class="title"><a name="id1205665"></a>Stream Sequence Number</h4></div></div></div><p>The receiver of a SI replication stream has both transactions that it receives via replication as well as transactions that it computes locally from business logic. As discussed earlier, while journal sequence numbers can uniquely identify a series of database updates, they cannot identify the source of those updates. Thus, V5.5-000 introduces the concept of a stream sequence number.</p><p>On an originating primary instance that is not the recipient of an SI replication stream, the journal sequence number and the stream sequence number are the same.</p><p>On a primary instance that is the recipient of an SI replication stream, the journal sequence number continues to uniquely identify and serialize all updates, whether received from replication or locally generated. However, there is also a stream sequence number, which is the journal sequence number for locally generated transactions, and for replicated updates, the combination of a non-zero 4 bit tag (i.e., with values 1 through 15) and the journal sequence number for the transaction on the system from which it was replicated. These stream sequence numbers are propagated to downstream replicating secondary instances.</p><p>Stream sequence numbers are 64-bit unsigned integers.</p></div></div></div><div class="sect1" title="Examples"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id1204994"></a>Examples</h2></div></div></div><p>To make the following scenarios easier to understand, each update is prefixed with the system where it was originally generated and the sequence number on that system and any BC replicating secondary instances.</p><div class="sect2" title="Simple Example"><div class="titlepage"><div><div><h3 class="title"><a name="id1205070"></a>Simple Example</h3></div></div></div><p>The three systems initially operate in roles O (Originating primary instance), R (BC Replicating secondary instance) and S (recipient of an SI replication stream).</p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><thead><tr><th>
              <p><span class="bold"><strong>Ardmore</strong></span></p>
            </th><th>
              <p><span class="italic">BrynMawr</span></p>
            </th><th>
              <p><span class="underline">Malvern</span></p>
            </th><th>
              <p>Comments</p>
            </th></tr></thead><tbody><tr><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="bold"><strong>A99</strong></span></p>
            </td><td>
              <p>R: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span></p>
            </td><td>
              <p>S: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M37</span>, <span class="underline">M38</span></p>
            </td><td>
              <p><span class="bold"><strong>Ardmore</strong></span> as an originating primary instance at transaction number <span class="bold"><strong>A99</strong></span>, replicates to <span class="italic">BrynMawr</span> as a BC replicating secondary instance at transaction number <span class="bold"><strong>A98</strong></span> and <span class="underline">Malvern</span> as a SI that includes transaction number <span class="bold"><strong>A97</strong></span>, interspersed with locally generated updates. Updates are recorded in each instance's journal files using before-image journaling.</p>
            </td></tr><tr><td>
              <p>Crashes</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italic">B61</span></p>
            </td><td>
              <p>... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M37</span>, <span class="underline">M38</span></p>
            </td><td>
              <p>When an event disables <span class="bold"><strong>Ardmore</strong></span>, <span class="italic">BrynMawr</span> becomes the new originating primary, with <span class="bold"><strong>A98</strong></span> as the latest transaction in its database, and starts processing application logic to maintain business continuity. In this case where <span class="underline">Malvern</span> is not ahead of <span class="italic">BrynMawr</span>, the Receiver Server at <span class="underline">Malvern</span> can remain up after <span class="bold"><strong>Ardmore</strong></span> crashes. When <span class="italic">BrynMawr</span> connects, its Source Server and <span class="underline">Malvern</span>&#8217;s Receiver Server confirms that <span class="italic">BrynMawr</span> is not behind <span class="underline">Malvern</span> with respect to updates received from <span class="bold"><strong>Ardmore</strong></span>, and SI replication from <span class="italic">BrynMawr</span> picks up where replication from <span class="bold"><strong>Ardmore</strong></span> left off.</p>
            </td></tr><tr><td>
              <p>-</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span></p>
            </td><td>
              <p>S: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M37</span>, <span class="underline">M38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">M39</span>, <span class="italic">B61</span>, <span class="underline">M40</span></p>
            </td><td>
              <p><span class="underline">Malvern</span> operating as a supplementary instance to <span class="italic">BrynMawr</span> replicates transactions processed on <span class="italic">BrynMawr</span>, and also applies its own locally generated updates. Although <span class="bold"><strong>A98</strong></span> was originally generated on <span class="bold"><strong>Ardmore</strong></span>, <span class="underline">Malvern</span> received it from <span class="italic">BrynMawr</span> because <span class="bold"><strong>A97</strong></span> was the common point between <span class="italic">BrynMawr</span> and <span class="underline">Malvern</span>.</p>
            </td></tr><tr><td>
              <p>... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="bold"><strong>A99</strong></span></p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>S: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M37</span>, <span class="underline">M38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">M39</span>, <span class="italic">B61</span>, <span class="underline">M40</span>, <span class="italic">B62</span>, <span class="italic">B63</span></p>
            </td><td>
              <p><span class="underline">Malvern</span>, continuing as a supplementary instance to <span class="italic">BrynMawr</span>, replicates transactions processed on <span class="italic">BrynMawr</span>, and also applies its own locally generated updates. <span class="bold"><strong>Ardmore</strong></span> meanwhile has been repaired and brought online. It has to roll transaction <span class="bold"><strong>A99</strong></span> off its database into an Unreplicated Transaction Log before it can start operating as a replicating secondary instance to <span class="italic">BrynMawr</span>.</p>
            </td></tr><tr><td>
              <p>R: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="italic">B64</span>, B65</p>
            </td><td>
              <p>S: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M37</span>, <span class="underline">M38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">M39</span>, <span class="italic">B61</span>, <span class="underline">M40</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="underline">M41</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>Having rolled off transactions into an Unreplicated Transaction Log, <span class="bold"><strong>Ardmore</strong></span> can now operate as a replicating secondary instance to <span class="italic">BrynMawr</span>. This is normal BC Logical Multi-Site operation. <span class="italic">BrynMawr</span> and <span class="underline">Malvern</span> continue operating as originating primary instance and supplementary instance.</p>
            </td></tr></tbody></table></div></div><div class="sect2" title="Ensuring Consistency with Rollback"><div class="titlepage"><div><div><h3 class="title"><a name="id1206081"></a>Ensuring Consistency with Rollback</h3></div></div></div><p>Whereas in the last example <span class="underline">Malvern</span> was not ahead when starting SI replication from <span class="italic">BrynMawr</span>, in this example, asynchronous processing has left it ahead and must rollback its database state before it can receive the replication stream.</p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><thead><tr><th>
              <p><span class="bold"><strong>Ardmore</strong></span></p>
            </th><th>
              <p><span class="italic">BrynMawr</span></p>
            </th><th>
              <p><span class="underline">Malvern</span></p>
            </th><th>
              <p>Comments</p>
            </th></tr></thead><tbody><tr><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="bold"><strong>A99</strong></span></p>
            </td><td>
              <p>R: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span></p>
            </td><td>
              <p>S: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M37</span>, <span class="underline">M38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">M39</span>, <span class="underline">M40</span></p>
            </td><td>
              <p><span class="bold"><strong>Ardmore</strong></span> as an originating primary instance at transaction number <span class="bold"><strong>A99</strong></span>, replicates to <span class="italic">BrynMawr</span> as a BC replicating secondary instance at transaction number <span class="bold"><strong>A97</strong></span> and <span class="underline">Malvern</span> as a SI that includes transaction number <span class="bold"><strong>A98</strong></span>, interspersed with locally generated updates. Updates are recorded in each instance's journal files using before-image journaling.</p>
            </td></tr><tr><td>
              <p>Crashes</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span></p>
            </td><td>
              <p>... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M37</span>, <span class="underline">M38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">M39</span>, <span class="underline">M40</span></p>
            </td><td>
              <p>When an event disables <span class="bold"><strong>Ardmore</strong></span>, <span class="italic">BrynMawr</span> becomes the new originating primary, with <span class="bold"><strong>A97</strong></span> the latest transaction in its database. <span class="underline">Malvern</span> cannot immediately start replicating from <span class="italic">BrynMawr</span> because the database states would not be consistent - while <span class="italic">BrynMawr</span> does not have <span class="bold"><strong>A98</strong></span> in its database and its next update may implicitly or explicitly depend on that absence, <span class="underline">Malvern</span> does, and may have relied on <span class="bold"><strong>A98</strong></span> to compute <span class="underline">M39</span> and <span class="underline">M40</span>.</p>
            </td></tr><tr><td>
              <p>-</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span></p>
            </td><td>
              <p>S: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M37</span>, <span class="underline">M38</span>, <span class="italic">B61</span></p>
            </td><td>
              <p>For <span class="underline">Malvern</span> to accept replication from <span class="italic">BrynMawr</span>, it must roll off transactions generated by <span class="bold"><strong>Ardmore</strong></span>, (in this case <span class="bold"><strong>A98</strong></span>) that <span class="italic">BrynMawr</span> does not have in its database, as well as any additional transactions generated and applied locally since transaction number <span class="bold"><strong>A98</strong></span> from <span class="bold"><strong>Ardmore</strong></span>.<sup>[<a name="id1208013" href="#ftn.id1208013" class="footnote">a</a>]</sup> This rollback is accomplished with a mupip journal -rollback -fetchresync operation on <span class="underline">Malvern</span>.<sup>[<a name="id1208105" href="#ftn.id1208105" class="footnote">b</a>]</sup> These rolled off transactions (<span class="bold"><strong>A98</strong></span>, <span class="underline">M39</span>, <span class="underline">M40</span>) go into the Unreplicated Transaction Log and can be subsequently reprocessed by application code.<sup>[<a name="id1208020" href="#ftn.id1208020" class="footnote">c</a>]</sup> Once the rollback is completed, <span class="underline">Malvern</span> can start accepting replication from <span class="italic">BrynMawr</span>.<sup>[<a name="id1208035" href="#ftn.id1208035" class="footnote">d</a>]</sup> <span class="italic">BrynMawr</span> in its Originating Primary role processes transactions and provides business continuity, resulting in transactions <span class="italic">B61</span> and <span class="italic">B62</span>.</p>
            </td></tr><tr><td>
              <p>-</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>S: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M37</span>, <span class="underline">M38</span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="underline">M39</span>a, <span class="underline">M40</span>a, <span class="italic">B63</span></p>
            </td><td>
              <p><span class="underline">Malvern</span> operating as a supplementary instance to <span class="italic">BrynMawr</span> replicates transactions processed on <span class="italic">BrynMawr</span>, and also applies its own locally generated updates. Note that <span class="underline">M39</span>a &amp; <span class="underline">M40</span>a may or may not be the same updates as the <span class="underline">M39</span> &amp; <span class="underline">M40</span> previously rolled off the database.</p>
            </td></tr></tbody><tbody class="footnotes"><tr><td colspan="4"><div class="footnote"><p><sup>[<a name="ftn.id1208013" href="#id1208013" class="para">a</a>] </sup>As this rollback is more complex, may involve more data than the regular LMS rollback, and may involve reading journal records sequentially; it may take longer.</p></div><div class="footnote"><p><sup>[<a name="ftn.id1208105" href="#id1208105" class="para">b</a>] </sup>In scripting for automating operations, there is no need to explicitly test whether <span class="italic">BrynMawr</span> is behind <span class="underline">Malvern</span> - if it is behind, the Source Server will fail to connect and report an error, which automated shell scripting can detect and effect a rollback on <span class="underline">Malvern</span> followed by a reconnection attempt by <span class="italic">BrynMawr</span>. On the other hand, there is no harm in <span class="underline">Malvern</span> routinely performing a rollback before having <span class="italic">BrynMawr</span> connect - if it is not ahead, the rollback will be a no-op. This characteristic of replication is unchanged from releases prior to V5.5-000.</p></div><div class="footnote"><p><sup>[<a name="ftn.id1208020" href="#id1208020" class="para">c</a>] </sup>GT.M's responsibility for them ends once it places them in the Unreplicated Transaction Log.</p></div><div class="footnote"><p><sup>[<a name="ftn.id1208035" href="#id1208035" class="para">d</a>] </sup>Ultimately, business logic must determine whether the rolled off transactions can simply be reapplied or whether other reprocessing is required. GT.M's $ZQGBLMOD() function can assist application code in determining whether conflicting updates may have occurred.</p></div></td></tr></tbody></table></div></div><div class="sect2" title="Rollback Not Desired or Required by Application Design"><div class="titlepage"><div><div><h3 class="title"><a name="id1208172"></a>Rollback Not Desired or Required by Application Design</h3></div></div></div><p>In the example above, for <span class="underline">Malvern</span> to start accepting SI replication from <span class="italic">BrynMawr</span> with consistency requires it to rollback its database because it is ahead of <span class="italic">BrynMawr</span>. There may be applications where the design of the application is such that this rollback neither required nor desired. GT.M provides a way for SI replication to start in this situation without rolling transactions off into an Unreplicated Transaction File.</p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><thead><tr><th>
              <p><span class="bold"><strong>Ardmore</strong></span></p>
            </th><th>
              <p><span class="italic">BrynMawr</span></p>
            </th><th>
              <p><span class="underline">Malvern</span></p>
            </th><th>
              <p>Comments</p>
            </th></tr></thead><tbody><tr><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="bold"><strong>A99</strong></span></p>
            </td><td>
              <p>R: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span></p>
            </td><td>
              <p>S: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M37</span>, <span class="underline">M38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">M39</span>, <span class="underline">M40</span></p>
            </td><td>
              <p><span class="bold"><strong>Ardmore</strong></span> as an originating primary instance at transaction number <span class="bold"><strong>A99</strong></span>, replicates to <span class="italic">BrynMawr</span> as a BC replicating secondary instance at transaction number <span class="bold"><strong>A97</strong></span> and <span class="underline">Malvern</span> as a SI that includes transaction number <span class="bold"><strong>A98</strong></span>, interspersed with locally generated updates. Updates are recorded in each instance's journal files using before-image journaling.</p>
            </td></tr><tr><td>
              <p>Crashes</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span></p>
            </td><td>
              <p>... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M37</span>, <span class="underline">M38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">M39</span>, <span class="underline">M40</span></p>
            </td><td>
              <p>When an event disables <span class="bold"><strong>Ardmore</strong></span>, <span class="italic">BrynMawr</span> becomes the new originating primary, with <span class="bold"><strong>A97</strong></span> the latest transaction in its database and starts processing application logic. Unlike the previous example, in this case, application design permits (or requires) <span class="underline">Malvern</span> to start replicating from <span class="italic">BrynMawr</span> even though <span class="italic">BrynMawr</span> does not have <span class="bold"><strong>A98</strong></span> in its database and <span class="underline">Malvern</span> may have relied on <span class="bold"><strong>A98</strong></span> to compute <span class="underline">M39</span> and <span class="underline">M40</span>.</p>
            </td></tr><tr><td>
              <p>-</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span></p>
            </td><td>
              <p>S: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M37</span>, <span class="underline">M38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">M39</span>, <span class="underline">M40</span>, <span class="italic">B61</span>, <span class="italic">B62</span></p>
            </td><td>
              <p>With its Receiver Server started with the -noresync option, <span class="underline">Malvern</span> can receive a SI replication stream from <span class="italic">BrynMawr</span>, and replication starts from the last common transaction shared by <span class="italic">BrynMawr</span> and <span class="underline">Malvern</span>. Notice that on <span class="italic">BrynMawr</span> no <span class="bold"><strong>A98</strong></span> precedes <span class="italic">B61</span>, whereas it does on <span class="underline">Malvern</span>, i.e., <span class="underline">Malvern</span> was ahead of <span class="italic">BrynMawr</span> with respect to the updates generated by <span class="bold"><strong>Ardmore</strong></span>.</p>
            </td></tr></tbody></table></div></div><div class="sect2" title="Two Originating Primary Failures"><div class="titlepage"><div><div><h3 class="title"><a name="id1208379"></a>Two Originating Primary Failures</h3></div></div></div><p>Now consider a situation where <span class="bold"><strong>Ardmore</strong></span> and <span class="underline">Malvern</span> are located in one data center, with BC replication to <span class="italic">BrynMawr</span> and <span class="italicunderline">Newtown</span> respectively, located in another data center. When the first data center fails, the SI replication from <span class="bold"><strong>Ardmore</strong></span> to <span class="underline">Malvern</span> is replaced by SI replication from <span class="italic">BrynMawr</span> to <span class="italicunderline">Newtown</span>.</p><div class="informaltable"><table border="1"><colgroup><col><col><col><col><col></colgroup><thead><tr><th>
              <p><span class="bold"><strong>Ardmore</strong></span></p>
            </th><th>
              <p><span class="italic">BrynMawr</span></p>
            </th><th>
              <p><span class="underline">Malvern</span></p>
            </th><th>
              <p><span class="italicunderline">Newtown</span></p>
            </th><th>
              <p>Comments</p>
            </th></tr></thead><tbody><tr><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="bold"><strong>A99</strong></span></p>
            </td><td>
              <p>R: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span></p>
            </td><td>
              <p>S: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">M37</span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M38</span></p>
            </td><td>
              <p>R: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">M37</span></p>
            </td><td>
              <p><span class="bold"><strong>Ardmore</strong></span> as an originating primary instance at transaction number <span class="bold"><strong>A99</strong></span>, replicates to <span class="italic">BrynMawr</span> as a BC replicating secondary instance at transaction number <span class="bold"><strong>A98</strong></span> and <span class="underline">Malvern</span> as a SI that includes transaction number <span class="bold"><strong>A97</strong></span>, interspersed with locally generated updates. <span class="underline">Malvern</span> in turn replicates to <span class="italicunderline">Newtown</span>.</p>
            </td></tr><tr><td>
              <p>Goes down with the data center</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span></p>
            </td><td>
              <p>Goes down with the data center</p>
            </td><td>
              <p>... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">M37</span></p>
            </td><td>
              <p>When a data center outage disables <span class="bold"><strong>Ardmore</strong></span>, and <span class="underline">Malvern</span>, <span class="italic">BrynMawr</span> becomes the new originating primary, with <span class="bold"><strong>A98</strong></span> as the latest transaction in its database and starts processing application logic to maintain business continuity. <span class="italicunderline">Newtown</span> can receive the SI replication stream from <span class="italic">BrynMawr</span>, without requiring a rollback since the receiver is not ahead of the source.</p>
            </td></tr><tr><td>
              <p>-</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span></p>
            </td><td>
              <p>-</p>
            </td><td>
              <p>S: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">M37</span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italicunderline">N73</span>, <span class="italic">B61</span>, <span class="italicunderline">N74</span>, <span class="italic">B62</span></p>
            </td><td>
              <p><span class="italicunderline">Newtown</span> receives SI replication from <span class="italic">BrynMawr</span> and also applies its own locally generated updates. Although <span class="bold"><strong>A97</strong></span> and <span class="bold"><strong>A98</strong></span> were originally generated on <span class="bold"><strong>Ardmore</strong></span>, <span class="italicunderline">Newtown</span> receives them from <span class="italic">BrynMawr</span>. <span class="italicunderline">Newtown</span> also computes and applies locally generated updates</p>
            </td></tr><tr><td>
              <p>... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="bold"><strong>A99</strong></span></p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">M37</span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M38</span></p>
            </td><td>
              <p>S: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">M37</span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italicunderline">N73</span>, <span class="italic">B61</span>, <span class="italicunderline">N74</span>, <span class="italic">B62</span>, <span class="italicunderline">N75</span>, <span class="italic">B63</span>, <span class="italicunderline">N76</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>While <span class="italic">BrynMawr</span> and <span class="italicunderline">Newtown</span>, keep the enterprise in operation, the first data center is recovered. Since <span class="bold"><strong>Ardmore</strong></span> has transactions in its database that were not replicated to <span class="italic">BrynMawr</span> when the latter started operating as the originating primary instance, and since <span class="underline">Malvern</span> had transactions that were not replicated to <span class="italicunderline">Newtown</span> when the latter took over, <span class="bold"><strong>Ardmore</strong></span> and <span class="underline">Malvern</span> must now rollback their databases and create Unreplicated Transaction Files before receiving BC replication streams from <span class="italic">BrynMawr</span> and <span class="italicunderline">Newtown</span> respectively. <span class="bold"><strong>Ardmore</strong></span> rolls off <span class="bold"><strong>A98</strong></span> and <span class="bold"><strong>A99</strong></span>, <span class="underline">Malvern</span> rolls off <span class="bold"><strong>A97</strong></span> and <span class="underline">M38</span>.</p>
            </td></tr><tr><td>
              <p>R: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="italic">B64</span>, B65</p>
            </td><td>
              <p>R: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">M37</span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italicunderline">N73</span>, <span class="italic">B61</span>, <span class="italicunderline">N74</span>, <span class="italic">B62</span>, <span class="italicunderline">N75</span>, <span class="italic">B63</span>, <span class="italicunderline">N76</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>S: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">M37</span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italicunderline">N73</span>, <span class="italic">B61</span>, <span class="italicunderline">N74</span>, <span class="italic">B62</span>, <span class="italicunderline">N75</span>, <span class="italic">B63</span>, <span class="italicunderline">N76</span>, <span class="italic">B64</span>, <span class="italicunderline">N77</span></p>
            </td><td>
              <p>Having rolled off transactions into an Unreplicated Transaction Log, <span class="bold"><strong>Ardmore</strong></span> can now operate as a replicating secondary instance to <span class="italic">BrynMawr</span>. This is normal BC Logical Multi-Site operation. <span class="italic">BrynMawr</span> and <span class="underline">Malvern</span> continue operating as originating primary instance and supplementary instance. Note that having rolled <span class="bold"><strong>A97</strong></span> off its database, <span class="underline">Malvern</span> receives that transaction from <span class="italicunderline">Newtown</span> as it catches up.</p>
            </td></tr></tbody></table></div></div><div class="sect2" title="Replication and Online Rollback"><div class="titlepage"><div><div><h3 class="title"><a name="id1209562"></a>Replication and Online Rollback</h3></div></div></div><p>GT.M V5.5-000 also introduces a mupip journal -rollback -backward -online feature that allows a database to be rolled back in state space <span class="italic">while an application is in operation</span>. This functionality is discussed in the release notes. Consider the following example where <span class="bold"><strong>Ardmore</strong></span> rolls back its database.</p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><thead><tr><th>
              <p><span class="bold"><strong>Ardmore</strong></span></p>
            </th><th>
              <p><span class="italic">BrynMawr</span></p>
            </th><th>
              <p><span class="underline">Malvern</span></p>
            </th><th>
              <p>Comments</p>
            </th></tr></thead><tbody><tr><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="bold"><strong>A99</strong></span></p>
            </td><td>
              <p>R: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span></p>
            </td><td>
              <p>S: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M37</span>, <span class="underline">M38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">M39</span>, <span class="underline">M40</span></p>
            </td><td>
              <p><span class="bold"><strong>Ardmore</strong></span> as an originating primary instance at transaction number <span class="bold"><strong>A99</strong></span>, replicates to <span class="italic">BrynMawr</span> as a BC replicating secondary instance at transaction number <span class="bold"><strong>A97</strong></span> and <span class="underline">Malvern</span> as a SI that includes transaction number <span class="bold"><strong>A98</strong></span>, interspersed with locally generated updates. Updates are recorded in each instance&#8217;s journal files using before-image journaling.</p>
            </td></tr><tr><td>
              <p>Rolls back to <span class="bold"><strong>A96</strong></span> with <span class="bold"><strong>A97</strong></span> through <span class="bold"><strong>A99</strong></span> in the Unreplicated Transaction Log</p>
            </td><td>
              <p>Rolls back automatically to <span class="bold"><strong>A96</strong></span> (assume Receiver Server started with -autorollback - refer to the V5.5-000 Release Notes for details.</p>
            </td><td>
              <p>-</p>
            </td><td>
              <p>Instances receiving a replication stream from <span class="bold"><strong>Ardmore</strong></span> can be configured to rollback automatically when <span class="bold"><strong>Ardmore</strong></span> performs an online rollback by starting the Receiver Server with -autorollback. If <span class="underline">Malvern</span>&#8217;s Receiver Server is so configured, it will roll <span class="bold"><strong>A97</strong></span> through <span class="underline">M40</span> into an Unreplicated Transaction Log. This scenario is straightforward. But with the -noresync qualifier, the Receiver Server can be started configured to simply resume replication without rolling back, and that scenario is developed here.</p>
            </td></tr><tr><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>a, <span class="bold"><strong>A98</strong></span>a, <span class="bold"><strong>A99</strong></span>a</p>
            </td><td>
              <p>R: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>a, <span class="bold"><strong>A98</strong></span>a</p>
            </td><td>
              <p>S: ... <span class="underline">M34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">M35</span>, <span class="underline">M36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">M37</span>, <span class="underline">M38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">M39</span>, <span class="underline">M40</span>, <span class="bold"><strong>A97</strong></span>a, <span class="underline">M41</span>, <span class="bold"><strong>A98</strong></span>a, <span class="underline">M42</span></p>
            </td><td>
              <p>Transactions <span class="bold"><strong>A97</strong></span>a through <span class="bold"><strong>A99</strong></span>a are different transactions from <span class="bold"><strong>A97</strong></span> through <span class="bold"><strong>A99</strong></span> (which are in an Unreplicated Transaction File on <span class="bold"><strong>Ardmore</strong></span> and must be reprocessed). Note that <span class="underline">Malvern</span> has both the original <span class="bold"><strong>A97</strong></span> and <span class="bold"><strong>A98</strong></span> as well as <span class="bold"><strong>A97</strong></span>a and <span class="bold"><strong>A98</strong></span>a. <span class="bold"><strong>A99</strong></span> was never replicated to <span class="underline">Malvern</span> - <span class="bold"><strong>Ardmore</strong></span> rolled back before it was replicated, and <span class="bold"><strong>A99</strong></span>a has not yet made it to <span class="underline">Malvern</span> (it will soon, unless <span class="bold"><strong>Ardmore</strong></span> rolls back again)</p>
            </td></tr></tbody></table></div></div></div><div class="sect1" title="Limitations"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id1210668"></a>Limitations</h2></div></div></div><p>SI replication is only supported on POSIX editions of GT.M - in other words, it is not supported by GT.M on OpenVMS. Furthermore, with this release, GT.M no longer supports replication between OpenVMS and POSIX platforms, or on POSIX platforms with GT.M releases prior to V5.1-000. To upgrade to GT.M V5.5-000, or to upgrade from GT.M on OpenVMS to GT.M V5.5-000 on a POSIX platform, first upgrade to GT.M V5.1-000 or later on a POSIX platform as an intermediate step.</p><p>Although a receiver of SI replication can source a BC replication stream for downstream propagation, it cannot source an SI replication stream. So, in the example above, while <span class="underline">Malvern</span> can receive SI replication from <span class="bold"><strong>Ardmore</strong></span> or <span class="italic">BrynMawr</span>, and it can source a BC replication stream to <span class="italicunderline">Newtown</span>, which can in turn source a BC replication stream to Oxford. Thus, none of <span class="underline">Malvern</span>, <span class="italicunderline">Newtown</span> or Oxford can source an SI replication stream.</p><p>Also an instance can only receive a single SI replication stream. <span class="underline">Malvern</span> cannot receive SI replication from an instance other than <span class="bold"><strong>Ardmore</strong></span> (or an instance receiving BC replication from <span class="bold"><strong>Ardmore</strong></span>, such as <span class="italic">BrynMawr</span>). <span class="italicunderline">Newtown</span> or Oxford are replicating secondary instances and can receive no updates other than from <span class="underline">Malvern</span>.</p><p>The total number of replication streams that an instance can source is sixteen, with any combination of BC and SI replication.</p></div><div class="sect1" title="Procedures"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id1210390"></a>Procedures</h2></div></div></div><div class="sect2" title="Overview"><div class="titlepage"><div><div><h3 class="title"><a name="id1209132"></a>Overview</h3></div></div></div><p>Although V5.5-000 supports only one source stream for SI replication, the architecture allows for fifteen externally sourced streams (numbers 1 through 15), with stream 0 being locally generated updates. Under normal conditions, on a supplementary instance, one will see updates from streams 0 and 1. If the recipient of an SI stream has been moved from receiving replication from one source to another, you may see other stream numbers (corresponding to updates from other streams) as well.</p><p>When adding SI replication, the rules to remember are that (a) both source and receiver sides of SI replication must be V5.5-000, (b) upgrading an instance to V5.5-000 requires a new replication instance file because the replication instance file format for SI is not compatible with those of prior releases and (c) the -updateresync qualifier requires the name of a prior replication instance file when both source and receiver are V5.5-000.</p><p>Remember that except where an instance is an unreplicated sole instance, you should upgrade replicating secondary instances rather than originating primary instances. Starting with BC replication (e.g., <span class="bold"><strong>Ardmore</strong></span> as originating primary and <span class="italic">BrynMawr</span> as replicating secondary), the simplest steps to start SI replication to <span class="underline">Malvern</span> are:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Bring <span class="italic">BrynMawr</span> down and upgrade it to V5.5-000. <span class="italic">BrynMawr</span> requires a new replication instance file. Please refer to the relevant release notes for details of upgrading database files and global directories; unless otherwise instructed by FIS, always assume that object and journal files are specific to each GT.M release.</p></li><li class="listitem"><p>Resume BC replication from <span class="bold"><strong>Ardmore</strong></span> to <span class="italic">BrynMawr</span>. Since <span class="bold"><strong>Ardmore</strong></span> is at an older GT.M release than V5.5-000, when starting the Receiver Server for the first time at <span class="italic">BrynMawr</span>, the -updateresync qualifier does not require the name of a prior replication instance file.</p></li><li class="listitem"><p>Create supplementary instance <span class="underline">Malvern</span> from a backup of <span class="italic">BrynMawr</span> or <span class="bold"><strong>Ardmore</strong></span>, if that is more convenient. <span class="underline">Malvern</span> will require a new replication instance file, created with the -supplementary qualifier.</p></li><li class="listitem"><p>Start SI replication from <span class="italic">BrynMawr</span> to <span class="underline">Malvern</span>. Since <span class="underline">Malvern</span> and <span class="italic">BrynMawr</span> are both V5.5-000, the -updateresync qualifier used when the <span class="underline">Malvern</span> Receiver Server starts for the first time requires the old replication instance file copied, perhaps as part of a BACKUP, up from <span class="italic">BrynMawr</span> as its value.</p></li></ul></div><p>At your convenience, once <span class="italic">BrynMawr</span> is upgraded you can:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Switchover so that <span class="italic">BrynMawr</span> is the originating primary instance with BC replication to <span class="bold"><strong>Ardmore</strong></span> and SI replication to <span class="underline">Malvern</span>. This is unchanged from current LMS procedures. SI replication from <span class="italic">BrynMawr</span> to <span class="underline">Malvern</span> can operate through the switchover.</p></li><li class="listitem"><p>Bring <span class="bold"><strong>Ardmore</strong></span> down and upgrade it to V5.5-000. It requires a new replication instance file.</p></li><li class="listitem"><p>Start BC replication from <span class="italic">BrynMawr</span> to <span class="bold"><strong>Ardmore</strong></span>. Since <span class="bold"><strong>Ardmore</strong></span> and <span class="italic">BrynMawr</span> are both V5.5-000, the -updateresync qualifier for <span class="bold"><strong>Ardmore</strong></span>&#8217;s first Receiver Server start requires the name of a prior replication instance file. As it cannot use <span class="bold"><strong>Ardmore</strong></span>&#8217;s pre-V5.5-000 format replication instance file, in this special case, use a backup copy from <span class="italic">BrynMawr</span> as that prior file.</p></li></ul></div></div><div class="sect2" title="Upgrade Replication Instance File"><div class="titlepage"><div><div><h3 class="title"><a name="up_re_in_fi"></a>Upgrade Replication Instance File</h3></div></div></div><p>To upgrade the replication instance file, perform the following steps:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Shut down all mumps, MUPIP and DSE processes except Source and Receiver Server processes; then shut down the Receiver Server (and with it, the Update Process) and all Source Server processes. Use MUPIP RUNDOWN to confirm that all database files of the instance are closed and there are no processes accessing them.</p></li><li class="listitem"><p>Rename the existing replication instance file after making a backup copy.</p></li><li class="listitem"><p>Create a new replication instance file (you need to provide the instance name and instance file name, either with command line options or in environment variables, as documented in the Administration and Operations Guide):</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>If this is instance is to receive SI replication (<span class="underline">Malvern</span> in the examples above) or to receive BC replication from an instance that receives SI replication (<span class="italicunderline">Newtown</span> in the examples above), use the command:</p><pre class="programlisting"> mupip replicate -instance_create -supplementary</pre></li><li class="listitem"><p>Otherwise use the command:</p><pre class="programlisting">mupip replicate -instance_create</pre></li></ul></div></li><li class="listitem"><p>Prepare it to accept a replication stream:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>Start a passive Source Server using the -updok flag.</p></li><li class="listitem">Start the Receiver Server using the updateresync flag, e.g.: mupip replicate -receiver -start -updateresync=filename flag where filename is the prior replication file if the source is V5.5-000 and no filename if it is an older GT.M release (with other required command line flags, as documented in the Administration and Operations Guide).</li></ul></div></li><li class="listitem"><p>Start a Source Server on a root or propagating primary instance to replicate to this instance. Verify that updates on the source instance are successfully replicated to the receiver instance.</p></li></ul></div><p>The -updateresync qualifier indicates that instead of negotiating a mutually agreed common starting point for synchronization the operator is guaranteeing the receiving instance has a valid state that matches the source instance currently or as some point in the past. Generally this means the receiving instance has just been updated with a backup copy from the source instance.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Note]" src="images/note.jpg"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>A GT.M V5.5-000 instance can source a BC replication stream to or receive a BC replication stream from older GT.M releases, subject to limitations as discussed in the Limitations section of this document. It is only for SI replication that both source and recipient must both be V5.5-000.</p></td></tr></table></div></div><div class="sect2" title="Creating a Supplementary Instance"><div class="titlepage"><div><div><h3 class="title"><a name="id1211174"></a>Creating a Supplementary Instance</h3></div></div></div><p>A supplementary instance cannot be the first or sole instance that you upgrade to V5.5-000 - you must already have created an instance running V5.5-000 to provide a replication stream to the supplementary instance.</p><p>You can create a supplementary instance from (a) a backup copy of another instance, a supplementary instance, an originating primary or replicating secondary by giving it a new identity, or (b) a freshly created, new instance. An instance used to create a supplementary instance must already be upgraded to V5.5-000.</p><p>Starting with a backup of another instance, follow the procedures above under <a class="link" href="#up_re_in_fi" title="Upgrade Replication Instance File"> Upgrade Replication Instance File</a> using the -supplementary flag to the mupip replicate -instance_create command.</p><p>Creating a supplementary instance from a backup of an existing instance creates an SI replication instance with all the database state in the existing instance and is perhaps the most common application need. But there may be situations when a supplementary instance only needs new data, for example if it is to provide a reporting service only for new customers, and historical data for old customers is just excess baggage. In this case, you can also create a supplementary instance by creating a new instance, pre-loading it with any data required, enabling replication for the database files (since an Update Process will only apply updates to a replicated - and journaled - database region), and following the procedures above under above under <a class="link" href="#up_re_in_fi" title="Upgrade Replication Instance File">Upgrade Replication Instance File</a> using the -supplementary=on flag to the mupip replicate -instance_create command. Ship a replication instance file from the source to provide the -updateresync=filename qualifier required when starting the Receiver Server for the first time.</p></div><div class="sect2" title="Starting / Resuming Replication"><div class="titlepage"><div><div><h3 class="title"><a name="id1205405"></a>Starting / Resuming Replication</h3></div></div></div><p>For starting SI replication on an originating primary supplementary instance (Malvern in the above example), the procedure is similar to a non-supplementary instance except that one also needs to start a receiver server (after having started a source server to set up the journal pool) to receive updates from the corresponding non-supplementary instance (Ardmore or BrynMawr in this case). Similarly, as part of shutting down the originating primary supplementary instance, an added step is to shut down the Receiver Server (if it is up and running) before shutting down the Source Server.</p><p>Remember that for GT.M replication, the Receiver Server listens at a TCP port and the Source Server connects to it. If the Receiver Server is not ahead of the Source Server, replication simply starts and streams updates from the source to the receiver. When the Receiver Server is ahead of the Source Server, the cases are different for BC and SI replication.</p><p>For either BC or SI replication, if the Receiver Server is started with the new -autorollback qualifier, it performs an online rollback of the receiving instance, so that it is not ahead of the originating instance, creating an Unreplicated Transaction Log of any transactions that are rolled off the database. When started without the -autorollback qualifier, a Receiver Server notified by its Source Server of a rollback, logs the condition and exits so an operator can initiate appropriate steps. </p><p>For SI replication the new -noresync qualifier tells the Receiver Server not to rollback the database even if the receiver is ahead of the source. In this case, the Source Server starts replication from the last journal sequence number common to the two instances.</p></div><div class="sect2" title="Changing the Replication Source"><div class="titlepage"><div><div><h3 class="title"><a name="id1211303"></a>Changing the Replication Source</h3></div></div></div><p>When changing the source of a supplementary replication stream to another in the same family of instances (for example in the example where <span class="bold"><strong>Ardmore</strong></span> and <span class="underline">Malvern</span> crash and <span class="italicunderline">Newtown</span> is to receive a replication stream from <span class="italic">BrynMawr</span>, start the Receiver Server normally (with either -autorollback or -noresync, as appropriate) and allow <span class="italic">BrynMawr</span> to connect to it. Instead of using -autorollback, you can also perform a mupip journal -rollback -backward -fetchresync before starting the Receiver Server.</p><p>To migrate a supplementary instance from receiving SI replication from one set of BC instances to a completely different set - for example, if <span class="underline">Malvern</span> is to switch from receiving SI replication from the set of {<span class="bold"><strong>Ardmore</strong></span>, <span class="italic">BrynMawr</span>} to a completely unrelated set of instances {Pottstown, Sanatoga}</p></div></div><div class="sect1" title="MUPIP Commands"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id1210410"></a>MUPIP Commands</h2></div></div></div><p>SI replication adds and modifies qualifiers to the MUPIP REPLICATE and MUPIP JOURNAL commands.</p><div class="sect2" title="Modified qualifiers"><div class="titlepage"><div><div><h3 class="title"><a name="id1208372"></a>Modified qualifiers</h3></div></div></div><pre class="programlisting">-updateresync=filename</pre><p>Used when starting a Receiver Server on an instance where the replication instance file has no history records (usually because the instance file was newly created). The -updateresync qualifier now requires the file name of a replication instance file if the source of the replication stream is running GT.M V5.5-000 or higher, but not if the source is running a GT.M release prior to GT.M V5.5-000. This helps the Receiver Server by using history records from the input instance file (instead of the receiver instance file which has no history records) to exchange history information with the source and ensure both instances are in sync before safely starting replication. Previously there was no verification of history records in case of -updateresync usage and this opened up a safely hole in GT.M replication. For example, in the case where a receiver of an SI replication stream is started for the first time (the receiver and source have not communicated since the receiver replication instance file was created), this qualifier requires the name of a replication instance file (which is not the current replication instance file of the secondary instance) that is obtained from a backup of the source instance (taken at the same time the source databases were backed up). In this case, the Receiver Server startup should happen only after ensuring the backed up source database has been loaded onto the receiver instance. Once the receiver (started with -updateresync) and source connect, the Update Process logs a message containing the string "New History Content". The -updateresync should no longer be used for future Receiver Server startups. Note that the updateresync qualifier is not upward compatible from older releases of GT.M that never required a file name. Although FIS tries hard to keep GT.M upward compatible, our judgment is that this incompatibility represents the best option for adding the new SI replication functionality as well as enhancing the robustness of existing BC replication. Note that this qualifier was needed only in uncommon situations in GT.M V5.5-000 and prior releases. V5.5-000 make the need even more uncommon by eliminating it in the case where the instance has been recreated using a backup of another instance. This is because of a change to mupip replic -editinstance command which now supports a -name qualifier. For more details, refer to <a class="ulink" href="GTM_V5.5-000_Release_Notes.html" target="_top">GT.M V5.5-000 Release notes</a>.</p></div><div class="sect2" title="New Qualifiers"><div class="titlepage"><div><div><h3 class="title"><a name="new_quals"></a>New Qualifiers</h3></div></div></div><pre class="programlisting">-autorollback</pre><p>Used when starting a Receiver Server. The command mupip replicate -receiver -start -autorollback allows the receiving instance of SI or BC replication to roll back as required when the source instance rolls back with a mupip journal -rollback -backward command. For more information on this flag, refer to  <a class="ulink" href="GTM_V5.5-000_Release_Notes.html" target="_top">GT.M V5.5-000 Release notes</a>.</p><div class="important" title="Important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Important]" src="images/important.jpg"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>As autorollback uses mupip online rollback under the covers, it should be considered field test grade functionality as long as that function is considered field test grade functionality.</p></td></tr></table></div><pre class="programlisting">-noresync - </pre><p>Used when starting a Receiver Server. The command mupip replicate -receiver -start -noresync instructs the Receiver Server to accept a SI replication stream even when the receiver is ahead of the source. In this case, the source and receiver servers exchange history records from the replication instance file to determine the common journal stream sequence number and replication resumes from that point onwards. Specifying  -noresync on a BC replication stream is disallowed with a NORESYNCSUPPLONLY error. Use of -noresync on a SI replication stream receiver server where the receiving instance was started with -UPDNOTOK (updates are disabled) is disallowed with a NORESYNCUPDATERONLY error. Note also that the noresync qualifier is not the opposite of the resync qualifier of rollback (mupip journal -rollback -resync), which is intended for use under the direction of FIS GT.M support.</p><pre class="programlisting">-resume=&lt;strm_num&gt; </pre><p>Used when starting a Receiver Server of an SI replication stream with -updateresync in case the receiver instance has previously received from the same source but had only its instance file (not database files) recreated in between (thereby erasing all information about the source instance and the stream number it corresponds to recorded in the receiver instance file). In this case, the command mupip replic -receiv -start -updateresync=&lt;instfile&gt; -resume=&lt;strm_num&gt;, where &lt;strm_num&gt; is a number from 1 to 15, instructs the receiver server to use the database file headers to find out the current stream sequence number of the receiver instance for the stream number specified as &lt;strm_num&gt;, but uses the input instance file (specified with -updateresync) to locate the history record corresponding to this stream sequence number and then exchange history with the source to verify the two instances are in sync before resuming replication. Note that in case -resume is not specified and only -updateresync is specified for a SI replication stream, it uses the input instance file name specified with -updateresync to determine the stream sequence number as well as provide history records to exchange with the source instance (and verify the two are in sync). Assuming that instance files are never recreated (unless they are also accompanied by a database recreate), this qualifier should not be required in normal usage situations.</p><pre class="programlisting">-reuse=&lt;instname&gt;</pre><p>Used when starting a Receiver Server of an SI replication stream with -updateresync in case the receiver instance has previously received from fifteen (all architecturally allowed) different externally sourced streams and is now starting to receive from yet another source stream. The command mupip replic -receiv -start -updateresync=&lt;instfile&gt; -reuse=&lt;instname&gt;, where &lt;instname&gt; is the name of a replication instance, instructs the receiver server to look for an existing stream in the replication instance file header whose &#8220;Group Instance Name&#8221; (displayed by a mupip replic -editinstance -show command on the receiver replication instance file) matches the instance name specified and if one does, reuse that stream number for the current source connection (erasing any record of the older Group using the same stream number).</p><pre class="programlisting">-rsync_strm=&lt;strm_num&gt;</pre><p>Used when starting a rollback command with the -resync qualifier. The command mupip journal -rollback -resync= -rsync_strm=&lt;strm_num&gt; instructs rollback to roll back the database to a sequence number specified with the -resync=&lt;sequence_num&gt; qualifier but that &lt;sequence_num&gt; is a journal stream sequence number (not a journal sequence number) corresponding to the stream number &lt;strm_num&gt; which can be any value from 0 to 15. Note that like the -resync qualifier, the -rsync_strm qualifier is also intended for use under the direction of your GT.M support channel.</p><pre class="programlisting">-supplementary </pre><p>Used when creating a replication instance file. The command mupip replicate -instance_create -supplementary creates a replication instance file suitable for use in a supplementary instance. To create a replication instance file that is suitable for use in a non-supplementary instance, use the same command but without the -supplementary qualifier.</p><pre class="programlisting">-updnotok </pre><p>Used when starting a Source Server. The command mupip replicate -source -start -updnotok instructs the Source Server to not allow local updates on this instance. This is a synonym for the already existing -propagateprimary qualifier but is named so it better conveys its purpose.</p><pre class="programlisting">-updok</pre><p>Used when starting a Source Server. The command mupip replicate -source -start -updok instructs the Source Server to allow local updates on this instance. This is a synonym for the already existing -rootprimary qualifier but is named so it better conveys its purpose.</p></div></div><div class="sect1" title="Error Messages and Recovery"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id1211256"></a>Error Messages and Recovery</h2></div></div></div><p>See the Error Messages and Recovery Guide and <a class="ulink" href="GTM_V5.5-000_Release_Notes.html" target="_top">V5.5-000 Release Notes</a>. </p></div><div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p><sup>[<a name="ftn.id1204903" href="#id1204903" class="para">1</a>] </sup>Non-material information in the database may be information that identifies the instance, local process ids, system load, etc.</p></div></div></div></body>
<!-- Mirrored from tinco.pair.com/bhaskar/gtm/doc/articles/GTM_Supplementary_Instance.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 13 Mar 2019 23:00:53 GMT -->
</html>
