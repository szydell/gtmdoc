

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>


<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<base target="_top">
<style type="text/css">
  

/* default css */

table {
  font-size: 1em;
  line-height: inherit;
  border-collapse: collapse;
}


tr {
  
  text-align: left;
  
}


div, address, ol, ul, li, option, select {
  margin-top: 0px;
  margin-bottom: 0px;
}

p {
  margin: 0px;
}


pre {
  font-family: Courier New;
  white-space: pre-wrap;
  margin:0;
}

body {
  margin: 6px;
  padding: 0px;
  font-family: Verdana, sans-serif;
  font-size: 10pt;
  background-color: #ffffff;
  color: #000;
}


img {
  -moz-force-broken-image-icon: 1;
}

@media screen {
  html.pageview {
    background-color: #f3f3f3 !important;
    overflow-x: hidden;
    overflow-y: scroll;
  }

  

  body {
    min-height: 1100px;
    
    counter-reset: __goog_page__;
  }
  
  * html body {
    height: 1100px;
  }
  /* Prevent repaint errors when scrolling in Safari. This "Star-7" css hack
     targets Safari 3.1, but not WebKit nightlies and presumably Safari 4.
     That's OK because this bug is fixed in WebKit nightlies/Safari 4 :-). */
  html*#wys_frame::before {
    content: '\A0';
    position: fixed;
    overflow: hidden;
    width: 0;
    height: 0;
    top: 0;
    left: 0;
  }
  
  .pageview body {
    border-top: 1px solid #ccc;
    border-left: 1px solid #ccc;
    border-right: 2px solid #bbb;
    border-bottom: 2px solid #bbb;
    width: 648px !important;
    margin: 15px auto 25px;
    padding: 40px 50px;
  }
  /* IE6 */
  * html {
    overflow-y: scroll;
  }
  * html.pageview body {
    overflow-x: auto;
  }
  

  
    
    .writely-callout-data {
      display: none;
    }
    

    .writely-footnote-marker {
      background-image: url('http://tinco.pair.com/bhaskar/gtm/doc/articles/MISSING');
      background-color: transparent;
      background-repeat: no-repeat;
      width: 7px;
      overflow: hidden;
      height: 16px;
      vertical-align: top;

      
      -moz-user-select: none;
    }
    .editor .writely-footnote-marker {
      cursor: move;
    }
    .writely-footnote-marker-highlight {
      background-position: -15px 0;
      -moz-user-select: text;
    }
    .writely-footnote-hide-selection ::-moz-selection, .writely-footnote-hide-selection::-moz-selection {
      background: transparent;
    }
    .writely-footnote-hide-selection ::selection, .writely-footnote-hide-selection::selection {
      background: transparent;
    }
    .writely-footnote-hide-selection {
      cursor: move;
    }

    /* Comments */
    .writely-comment-yellow {
      background-color: #ffffd7;
    }
    .writely-comment-orange {
      background-color: #ffe3c0;
    }
    .writely-comment-pink {
      background-color: #ffd7ff;
    }
    .writely-comment-green {
      background-color: #d7ffd7;
    }
    .writely-comment-blue {
      background-color: #d7ffff;
    }
    .writely-comment-purple {
      background-color: #eed7ff;
    }

  


  
  .br_fix span+br:not(:-moz-last-node) {
    
    position:relative;
    
    left: -1ex
    
  }

  
  #cb-p-tgt {
    font-size: 8pt;
    padding: .4em;
    background-color: #ddd;
    color: #333;
  }
  #cb-p-tgt-can {
    text-decoration: underline;
    color: #36c;
    font-weight: bold;
    margin-left: 2em;
  }
  #cb-p-tgt .spin {
    width: 16px;
    height: 16px;
    background: url(http://ssl.gstatic.com/docs/clipboard/spin_16o.gif) no-repeat;
  }
}

h6 { font-size: 8pt }
h5 { font-size: 8pt }
h4 { font-size: 10pt }
h3 { font-size: 12pt }
h2 { font-size: 14pt }
h1 { font-size: 18pt }

blockquote {padding: 10px; border: 1px #DDD dashed }

.webkit-indent-blockquote { border: none; }

a img {border: 0}

.pb {
  border-width: 0;
  page-break-after: always;
  /* We don't want this to be resizeable, so enforce a width and height
     using !important */
  height: 1px !important;
  width: 100% !important;
}

.editor .pb {
  border-top: 1px dashed #C0C0C0;
  border-bottom: 1px dashed #C0C0C0;
}

div.google_header, div.google_footer {
  position: relative;
  margin-top: 1em;
  margin-bottom: 1em;
}


/* Table of contents */
.editor div.writely-toc {
  background-color: #f3f3f3;
  border: 1px solid #ccc;
}
.writely-toc > ol {
  padding-left: 3em;
  font-weight: bold;
}
ol.writely-toc-subheading {
  padding-left: 1em;
  font-weight: normal;
}
/* IE6 only */
* html writely-toc ol {
  list-style-position: inside;
}
.writely-toc-none {
  list-style-type: none;
}
.writely-toc-decimal {
  list-style-type: decimal;
}
.writely-toc-upper-alpha {
  list-style-type: upper-alpha;
}
.writely-toc-lower-alpha {
  list-style-type: lower-alpha;
}
.writely-toc-upper-roman {
  list-style-type: upper-roman;
}
.writely-toc-lower-roman {
  list-style-type: lower-roman;
}
.writely-toc-disc {
  list-style-type: disc;
}

/* Ordered lists converted to numbered lists can preserve ordered types, and
   vice versa. This is confusing, so disallow it */
ul[type="i"], ul[type="I"], ul[type="1"], ul[type="a"], ul[type="A"] {
  list-style-type: disc;
}

ol[type="disc"], ol[type="circle"], ol[type="square"] {
  list-style-type: decimal;
}

/* end default css */


  /* default print css */
  @media print {
    body {
      padding: 0;
      margin: 0;
    }

    div.google_header, div.google_footer {
      display: block;
      min-height: 0;
      border: none;
    }

    div.google_header {
      flow: static(header);
    }

    /* used to insert page numbers */
    div.google_header::before, div.google_footer::before {
      position: absolute;
      top: 0;
    }

    div.google_footer {
      flow: static(footer);
    }

    /* always consider this element at the start of the doc */
    div#google_footer {
      flow: static(footer, start);
    }

    span.google_pagenumber {
      content: counter(page);
    }

    span.google_pagecount {
      content: counter(pages);
    }

    .endnotes {
      page: endnote;
    }

    /* MLA specifies that endnotes title should be 1" margin from the top of the page. */
    @page endnote {
      margin-top: 1in;
    }

    callout.google_footnote {
      
      display: prince-footnote;
      footnote-style-position: inside;
      /* These styles keep the footnote from taking on the style of the text
         surrounding the footnote marker. They can be overridden in the
         document CSS. */
      color: #000;
      font-family: Verdana;
      font-size: 10.0pt;
      font-weight: normal;
    }

    /* Table of contents */
    #WritelyTableOfContents a::after {
      content: leader('.') target-counter(attr(href), page);
    }

    #WritelyTableOfContents a {
      text-decoration: none;
      color: black;
    }

    /* Comments */
    .writely-comment-yellow {
      background-color: #ffffd7;
    }
    .writely-comment-orange {
      background-color: #ffe3c0;
    }
    .writely-comment-pink {
      background-color: #ffd7ff;
    }
    .writely-comment-green {
      background-color: #d7ffd7;
    }
    .writely-comment-blue {
      background-color: #d7ffff;
    }
    .writely-comment-purple {
      background-color: #eed7ff;
    }
  }

  @page {
    @top {
      content: flow(header);
    }
    @bottom {
      content: flow(footer);
    }
    @footnotes {
      border-top: solid black thin;
      padding-top: 8pt;
    }
  }
  /* end default print css */


/* custom css */


/* end custom css */

/* ui edited css */

body {
  font-family: Verdana;
  
  font-size: 10.0pt;
  line-height: normal;
  background-color: #ffffff;
}
/* end ui edited css */


/* editor CSS */
.editor a:visited {color: #551A8B}
.editor table.zeroBorder {border: 1px dotted gray}
.editor table.zeroBorder td {border: 1px dotted gray}
.editor table.zeroBorder th {border: 1px dotted gray}


.editor div.google_header, .editor div.google_footer {
  border: 2px #DDDDDD dashed;
  position: static;
  width: 100%;
  min-height: 2em;
}

.editor .misspell {background-color: yellow}

.editor .writely-comment {
  font-size: 9pt;
  line-height: 1.4;
  padding: 1px;
  border: 1px dashed #C0C0C0
}


/* end editor CSS */

</style>

  
  <title>[V5.4-001] GT.M Database Encryption Technical Bulletin</title>

</head>

<body 
    
    >
    
    
    
<h1>
  <a id=_GT_M_Database_Encryption_Tech_6455395985394716 name=_GT_M_Database_Encryption_Tech_6455395985394716></a>GT.M Database Encryption Technical Bulletin
</h1>
<div class=legalnotice>
  <font size=2>Copyright A(C) 2010 Fidelity Information Services, Inc.&nbsp; All Rights Reserved.&nbsp;</font>&nbsp;
  <div>
    &nbsp;
  </div>
  <p>
    <font size=2>Permission is granted to copy, distribute and/or modify this document under the terms of the </font><a href=http://www.gnu.org/licenses/fdl.txt id=ug5t target=_blank title="Click here to read the GNU Free Documentation License"><font size=2>GNU Free Documentation License</font></a><font size=2>, Version 1.3 or any later version published by the Free Software Foundation; with no Invariant Sections, no Front-Cover Texts and no Back-Cover Texts. </font>
  </p>
  <p>
  </p>
  <div>
    &nbsp;
  </div>
  <p>
    <span class=trademark><font size=2>GT.M</font></span><font size=2>a?c is a trademark of Fidelity Information Services, Inc.&nbsp; Other trademarks are the property of their respective owners.&nbsp;</font>&nbsp;
  </p>
  <div>
    &nbsp;
  </div>
  <p>
    <font color=#000000 size=2>This document contains a description of GT.M and the operating instructions pertaining to the various functions that comprise the system.&nbsp;</font><font size=2>This document does not contain any commitment of FIS.&nbsp; FIS believes the information in this publication is accurate as of its publication date; such information is subject to change without notice.&nbsp; FIS is not responsible for any errors or defects. </font>
  </p>
  <h2>
    <a id=Revision_History_1593003636975 name=Revision_History_1593003636975></a>Revision History</h2>
</div>
<table border=1 bordercolor=#000000 cellpadding=4 cellspacing=0>
  <tbody>
  <tr valign=top>
    <th align=middle valign=top>
      <p align=center>
        Version
      </p>
    </th>
    <th align=left valign=middle>
      <p align=left>
        Date
      </p>
    </th>
    <th>
      <p align=left>
        Summary
      </p>
    </th>
  </tr>

 <tr>
    <td style=TEXT-ALIGN:center>
      1.3
    </td>
    <td align=left valign=middle>
      October 25, 2010
    </td>
    <td style=COLOR:#000000 width=75%>
      In <a href="GTM_Database_Encryption.html#Examples_of_use_60346492159712_8078852482140064" target=_self>Examples of use</a> and under the Key Management example section, changed:<br>
<font face="Courier New">helen$ $gtm_dist/plugin/gtmcrypt/encrypt_sign_db_key.sh {helen,phil}_cust_dat.txt phil phil@gt.m</font> 
<br>to<br>
<font face="Courier New">helen$ $gtm_dist/plugin/gtmcrypt/encrypt_sign_db_key.sh helen_cust_dat.txt phil_cust_dat.txt phil@gt.m</font>

    </td>
  </tr>

  <tr>
    <td style=TEXT-ALIGN:center>
      1.2
    </td>
    <td align=left valign=middle>
      July 6, 2010
    </td>
    <td style=COLOR:#000000 width=80%>
      Added the <a href="GTM_Database_Encryption.html#prerelease_3440913910572655_52" id=oe51 target=_self title="Using the V5.4-001 Reference Implementation with Older Releases">Using the V5.4-001 Reference Implementation with Older Releases</a> section. It includes the instructions for retrofitting the field test V5.4-001 version of the revised database encryption reference plugin to older GT.M versions.<br>
      <br>
      Updated to reflect the new shell scripts for the reference implementation released with GT.M V5.4-001, including support for Gnu Privacy Guard version 2. &nbsp;Reworked examples and added more diagrams. &nbsp;Miscellaneous cleanup of vocabulary and grammar. &nbsp;Since the documentation for the new scripts replaces that of the old, in the unlikely event that you wish to continue using the reference plugin from prior versions of GT.M with newer versions, and you are an FIS GT.M support customer, please contact GT.M support for a copy of the old technical bulletin.<br>
    </td>
  </tr>
  <tr>
    <td align=middle style=TEXT-ALIGN:center valign=top>
      1.1
    </td>
    <td align=left valign=middle>
      April 14, 2010
    </td>
    <td width=80%>
      <div>
        Changed <font face="Courier New">./Configure aix64-cc</font> to <font face="Courier New">./Configure aix64-cc shared </font>in the IBM AIX 5.3 (pSeries) section of Appendix - Building Encryption Libraries.
      </div>
    </td>
  </tr>
  <tr valign=top>
    <td align=middle valign=top>
      <p align=center>
        1.0
      </p>
    </td>
    <td align=left valign=middle>
      <p align=left>
        August 7, 2009
      </p>
    </td>
    <td width=80%>
      <p align=left>
        First published version
      </p>
      <div>
        &nbsp;
      </div>
    </td>
  </tr>
  </tbody>
</table>
<h2>
  <a id=Contact_Information_3062105850 name=Contact_Information_3062105850></a>Contact Information
</h2>
<a id=Revision_History_5023846650535 name=Revision_History_5023846650535></a><br>
<table border=0 cellpadding=4 cellspacing=0 class=zeroBorder width=100%>
  <tbody>
  <tr valign=top>
    <td width=50%>
      <div>
        GT.M Group
      </div>
      <div>
        FIS
      </div>
      <div>
        2 West Liberty Boulevard, Suite 300
      </div>
      <div>
        Malvern, Pennsylvania 19355
      </div>
      <div>
        United States of America
      </div>
    </td>
    <td width=50%>
      <div>
        GT.M Support for customers: +1 (610) 578-4226 / <a href=mailto:gtmsupport@fisglobal.com title="Click here to send e-mail to the GT.M support team">gtmsupport@fisglobal.com</a>
      </div>
      <div>
        Switchboard: +1 (610) 296-8877
      </div>
      <div>
        Website: <a href=http://fis-gtm.com/ target=_blank title="Click here to visit the GT.M home page">http://fis-gtm.com</a>
      </div>
    </td>
  </tr>
  </tbody>
</table>
<h2>
  <a id=Table_of_Contents_667841659900_854298634454608 name=Table_of_Contents_667841659900_854298634454608></a>Table of Contents
</h2>
<p>
  &nbsp;
</p>
<div class=writely-toc id=WritelyTableOfContents toctype=none+none>
  <ol class=writely-toc-none>
    <li>
      <a href="GTM_Database_Encryption.html#_GT_M_Database_Encryption_Tech_6455395985394716" target=_self>GT.M Database Encryption Technical Bulletin</a>
    </li>
    <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
      <li>
        <a href="GTM_Database_Encryption.html#Revision_History_1593003636975" target=_self>Revision History</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#Contact_Information_3062105850" target=_self>Contact Information</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#Table_of_Contents_667841659900_854298634454608" target=_self>Table of Contents</a>
      </li>
    </ol>
    <li>
      <a href="GTM_Database_Encryption.html#Introduction_8075411930106976_" target=_self>Introduction</a>
    </li>
    <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
      <li>
        <a href="GTM_Database_Encryption.html#Overview_9926550489328136_7785_9394282959401608" target=_self>Overview</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#Disclaimer_29210755010304446_4_6025377316400409" target=_self>Disclaimer</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#Limitations_of_GT_M_Database_E" target=_self>Limitations of GT.M Database Encryption</a>
      </li>
      <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
        <li>
          <a href="GTM_Database_Encryption.html#Data_Not_At_Rest_Not_Protected" target=_self>Data Not At Rest Not Protected</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Long_Lived_Keys_52102823867602" target=_self>Long Lived Keys</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Voluminous_Samples_of_Encrypte" target=_self>Voluminous Samples of Encrypted Data</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Encryption_Algorithms_Neither_" target=_self>Encryption Algorithms Neither Endorsed Nor Supported by FIS</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#No_Key_Recovery_26776196548698" target=_self>No Key Recovery</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Human_Intervention_Required_64" target=_self>Human Intervention Required</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#MM_Databases_8281390758761996__5425045480951667" target=_self>MM Databases</a>
        </li>
      </ol>
      <li>
        <a href="GTM_Database_Encryption.html#Alternatives_to_Database_Encry" target=_self>Alternatives to Database Encryption</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#Device_IO" target=_self>Device IO</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#Replication_and_GT_CM" target=_self>Replication and GT.CM</a>
      </li>
    </ol>
    <li>
      <a href="GTM_Database_Encryption.html#Theory_of_Operation_1279254345" target=_self>Theory of Operation</a>
    </li>
    <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
      <li>
        <a href="GTM_Database_Encryption.html#Definition_of_Terms_9270159068" target=_self>Definition of Terms</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#Overview_594672385058402_22992_4199900245293975" target=_self>Overview</a>
      </li>
      <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
        <li>
          <a href="GTM_Database_Encryption.html#Warning_4553461350231711_34821_07235222682356834" target=_self>Warning</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Data_in_Database_Journal_Files" target=_self>Data in Database and Journal Files</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Symmetric_and_Asymmetric_Ciphe_010402709245681763" target=_self>Symmetric and Asymmetric Ciphers</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Key_Ring_on_Disk" target=_self>Key Ring on Disk</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_Master_Key_File_Key_Files_130_6287360657006502" target=_self>Master Key File and Key Files</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Memory_Key_Ring_45293131355873" target=_self>Memory Key Ring</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Database_Operation_79561009562_09247611183673143" target=_self>Database Operation</a>
        </li>
      </ol>
    </ol>
    <li>
      <a href="GTM_Database_Encryption.html#Examples_of_use_60346492159712_8078852482140064" target=_self>Examples of use</a>
    </li>
    <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
      <li>
        <a href="GTM_Database_Encryption.html#Key_Management_373813668955046_22358114272356033" target=_self>Key Management</a>
      </li>
    </ol>
    <li>
      <a href="GTM_Database_Encryption.html#_Tested_Reference_Implementati_45390316285192966" target=_self>Tested Reference Implementations</a>
    </li>
    <li>
      <a href="GTM_Database_Encryption.html#Special_note_Gnu_Privacy_Guard_2709869872778654" target=_self>Special note - Gnu Privacy Guard version 2</a>
    </li>
    <li>
      <a href="GTM_Database_Encryption.html#Installation_5668624513782561_" target=_self>Installation</a>
    </li>
    <li>
      <a href="GTM_Database_Encryption.html#Administration_and_Operation_o" target=_self>Administration and Operation of Encrypted Databases</a>
    </li>
    <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
      <li>
        <a href="GTM_Database_Encryption.html#Changes_to_Utility_Programs_19" target=_self>Changes to Utility Programs</a>
      </li>
      <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
        <li>
          <a href="GTM_Database_Encryption.html#GDE_5343911794403601_359343896_07336544990539551" target=_self>GDE</a>
        </li>
        <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
          <li>
            <a href="GTM_Database_Encryption.html#Format_Upgrade_523012131322851" target=_self>Format / Upgrade</a>
          </li>
          <li>
            <a href="GTM_Database_Encryption.html#New_functionality_462391285558" target=_self>New functionality</a>
          </li>
        </ol>
        <li>
          <a href="GTM_Database_Encryption.html#MUPIP_09699687153894765_171711_5764062218368053" target=_self>MUPIP</a>
        </li>
        <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
          <li>
            <a href="GTM_Database_Encryption.html#MUPIP_CREATE_8079332672625914__4654939016327262" target=_self>MUPIP CREATE</a>
          </li>
          <li>
            <a href="GTM_Database_Encryption.html#MUPIP_JOURNAL_0763167179923848" target=_self>MUPIP JOURNAL</a>
          </li>
          <li>
            <a href="GTM_Database_Encryption.html#MUPIP_LOAD_8810755726116727_82_13880341965705156" target=_self>MUPIP LOAD</a>
          </li>
        </ol>
        <li>
          <a href="GTM_Database_Encryption.html#DSE_5189308532820321_670505968_20174990594387054" target=_self>DSE</a>
        </li>
        <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
          <li>
            <a href="GTM_Database_Encryption.html#Changing_the_hash_in_the_datab" target=_self>Changing the hash in the database file header</a>
          </li>
        </ol>
      </ol>
      <li>
        <a href="GTM_Database_Encryption.html#Changing_Encryption_Keys_38977" target=_self>Changing Encryption Keys</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#Database_Creation_761204818680" target=_self>Database Creation</a>
      </li>
    </ol>
    <li>
      <a href="GTM_Database_Encryption.html#Plugin_Architecture_Interface_" target=_self>Plugin Architecture &amp; Interface</a>
    </li>
    <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
      <li>
        <a href="GTM_Database_Encryption.html#Packaging_7105859128870154_890_34569985792040825" target=_self>Packaging</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#Extensions_to_the_GT_M_Externa" target=_self>Extensions to the GT.M External Interface</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#Operation_9370477335828151_144_3211645195260644" target=_self>Operation</a>
      </li>
    </ol>
    <li>
      <a href="GTM_Database_Encryption.html#Messages_33553646339864174_746_22597164381295443" target=_self>Messages</a>
    </li>
    <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
      <li>
        <a href="GTM_Database_Encryption.html#_Messages_common_to_MUMPS_MUPI_4455445986241102" target=_self>Messages common to MUMPS, MUPIP and DSE</a>
      </li>
      <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
        <li>
          <a href="GTM_Database_Encryption.html#_CRYPTDLNOOPEN_Error_loading_e_030976022593677044" target=_self>CRYPTDLNOOPEN, Error loading encryption library. xxxx</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_CRYPTHASHGENFAILED_Error_gene_13180778734385967" target=_self>CRYPTHASHGENFAILED, Error generating encryption hash. xxxx</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_CRYPTINIT_Error_initializing__7881997125223279" target=_self>CRYPTINIT, Error initializing encryption library. xxxx</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_CRYPTJNLWRONGHASH_Encryption__9967091046273708" target=_self>CRYPTJNLWRONGHASH, Encryption key hash mismatch between journal file jjjj and corresponding database file dddd</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_CRYPTKEYFETCHFAILED_Cannot_ob_12433350645005703" target=_self>CRYPTKEYFETCHFAILED, Cannot obtain encryption key for ffff. xxxx</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_CRYPTKEYFETCHFAILEDNF_Cannot__22714278008788824" target=_self>CRYPTKEYFETCHFAILEDNF, Cannot obtain encryption key. xxxx</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_CRYPTNOMM_is_an_encrypted_dat_0488943150267005" target=_self>CRYPTNOMM, ffff is an encrypted database. Cannot support MM access method.</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_CRYPTNOPSWDINTP_Cannot_prompt_2684801807627082" target=_self>CRYPTNOPSWDINTP, Cannot prompt for password inside a TP transaction.</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_CRYPTNOV4_ffff_is_an_encrypte_41717368829995394" target=_self>CRYPTNOV4, ffff is an encrypted database. Cannot downgrade(to V4) with Encryption option enabled.&gt;/error/fao=2!/ansi=0</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_CRYPTOPFAILED_Encrypt_Decrypt_7221491364762187" target=_self>CRYPTOPFAILED, Encrypt/Decrypt operation failed. xxxx</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_WARNING_Currently_number_of_p_27229333855211735" target=_self>Cannot reset encryption hash in file header while ffff other processes are accessing the database</a>
        </li>
      </ol>
      <li>
        <a href="GTM_Database_Encryption.html#_Appendix_Reference_Implementa_4077480975538492" target=_self>Appendix a?? Reference Implementation Error messages</a>
      </li>
      <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
        <li>
          <a href="GTM_Database_Encryption.html#_Cannot_find_DB_keys_file_path_5653066290542483" target=_self>Cannot find DB keys file </a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_Cannot_find_MUMPS_executable__9629705250263214" target=_self>Cannot find MUMPS executable in </a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_Cannot_open_DB_keys_file_path_36404165998101234" target=_self>Cannot open DB keys file - </a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#DB_keys_file_of_unknown_file_t_08723996207118034" target=_self>DB keys file of unknown file type : </a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Database_file_path_missing_in__6947785494849086" target=_self>Database file missing in DB keys file or does not exist</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Database_file_path_not_found_6_45892876759171486" target=_self>Database file not found</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Encryption_handle_corrupted_49_11620820499956608" target=_self>Encryption handle corrupted</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Encryption_key_file_path_not_f_6825297307223082" target=_self>Encryption key file not found</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Encryption_library_has_not_bee_4642745377495885" target=_self>Encryption library has not been initialized</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_Environment_variable_environm_5492731193080544" target=_self>Environment variable not set</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Environment_variable_gtm_dbkey_07528433855623007" target=_self>Environment variable gtm_dbkeys set to empty string</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Environment_variable_gtm_dbkey_7043982185423374" target=_self>Environment variable gtm_dbkeys undefined. Cannot find /.gtm_dbkeys</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Environment_variable_gtm_passw_9836120177060366" target=_self>Environment variable gtm_passwd set to empty string. Password prompting not allowed for utilities</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Error_initializing_GpgME_reaso_9751994758844376" target=_self>Error initializing GpgME: /</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Error_parsing_database_key_fil_37895991560071707" target=_self>Error parsing database key file. At line : No matching 'dat' entry found in </a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_Error_parsing_database_key_fi_10955840535461903" target=_self>Error parsing database key file. At line : does not start with 'dat' / 'key'</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Error_parsing_database_key_fil_7676606066524982" target=_self>Error parsing database key file. At line : No matching 'key' entry found in </a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_Incorrect_password_3069894842_4565364932641387" target=_self>Incorrect password</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_libgcrypt_version_mismatch_Ex_15429985988885164" target=_self>libgcrypt version mismatch. or higher is required</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Matching_encryption_key_hash_n_4526333548128605" target=_self>Matching encryption key not found in database key file</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_No_entries_found_in_DB_keys_f_5668686674907804" target=_self>No entries found in DB keys file</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#Symmetric_key_path_found_to_be_3280994491651654" target=_self>Symmetric key found to be empty</a>
        </li>
      </ol>
    </ol>
    <li>
      <a href="GTM_Database_Encryption.html#Appendix_Building_Encryption_L" target=_self>Appendix a?? Building Encryption Libraries</a>
    </li>
    <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
      <li>
        <a href="GTM_Database_Encryption.html#Ubuntu_8_04_LTS_x86_64_4182407" target=_self>Ubuntu 8.04 LTS (x86_64)</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#Red_Hat_Enterprise_Linux_5_2_x" target=_self>Red Hat Enterprise Linux 5.4 (x86_64)</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#Red_Hat_Enterprise_Linux_4_7_x" target=_self>Red Hat Enterprise Linux 5.5 (x86)</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#Red_Hat_Enterprise_Linux_5_3_I" target=_self>Red Hat Enterprise Linux 5.3 (IA64)</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#IBM_z_OS_zSeries_2534768965301" target=_self>IBM z/OS (zSeries)</a>
      </li>
      <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
        <li>
          <a href="GTM_Database_Encryption.html#_GPG_ERROR_27773333294274327_2_42885679099708796" target=_self>GPG-ERROR</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#CRYPTO_4637019764789899_283201_41930667124688625" target=_self>GCRYPT</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#GPGME_8758319289457169_5365654_8247205913066864" target=_self>GPGME</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#GNUPG_9352701977315592_4968002" target=_self>GNUPG</a>
        </li>
      </ol>
      <li>
        <a href="GTM_Database_Encryption.html#IBM_AIX_5_3_pSeries_6214410681" target=_self>IBM AIX 5.3 (pSeries)</a>
      </li>
      <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
        <li>
          <a href="GTM_Database_Encryption.html#GPG_ERROR_823455323121752_7036_23540523927658796" target=_self>GPG-ERROR</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#CRYPTO_4637019764789899_283201_2000580532476306" target=_self>CRYPTO (From OpenSSL)</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#_GPGME_8008412796873396_430544_7444934472441673" target=_self>GPGME</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#GNUPG_9352701977315592_4968002_16115970630198717" target=_self>GNUPG</a>
        </li>
      </ol>
      <li>
        <a href="GTM_Database_Encryption.html#Solaris_9_and_10_SPARC_3104793" target=_self>Solaris 9 and 10 (SPARC)</a>
      </li>
      <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
        <li>
          <a href="GTM_Database_Encryption.html#GPG_ERROR_22278689011933595_04" target=_self>GPG-ERROR</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#GCRYPT_9250497833661064_924550" target=_self>GCRYPT</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#GPGME_2993951266743642_3275342" target=_self>GPGME</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#GNUPG_9468889342856063_5198401" target=_self>GNUPG</a>
        </li>
      </ol>
      <li>
        <a href="GTM_Database_Encryption.html#HP_UX_11_31_IA64_1829007706874" target=_self>HP-UX 11.31 (IA64)</a>
      </li>
      <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
        <li>
          <a href="GTM_Database_Encryption.html#GPG_ERROR_8732054253825327_299_23618535324931145" target=_self>GPG-ERROR</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#GCRYPT_060866412087715926_1848_7510066023096442" target=_self>GCRYPT</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#GPGME_8273790356748403_8276159_4528630506247282" target=_self>GPGME</a>
        </li>
        <li>
          <a href="GTM_Database_Encryption.html#GNUPG_24255861654347477_687197_5791980354115367" target=_self>GNUPG</a>
        </li>
      </ol>
      <li>
        <a href="GTM_Database_Encryption.html#SUSE_Linux_Enterprise_Server_1_12649072520434856" target=_self>SUSE Linux Enterprise Server 11 (x86_64)</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#SUSE_Linux_Enterprise_Server_1_001227264292538166" target=_self>SUSE Linux Enterprise Server 11 (s390x)</a>
      </li>
      <li>
        <a href="GTM_Database_Encryption.html#SUSE_Linux_Enterprise_Server_1" target=_self>SUSE Linux Enterprise Server 10 (s390x)</a>
      </li>
    </ol>
    <li>
      <a href="GTM_Database_Encryption.html#prerelease_3440913910572655_52" target=_self>Using the V5.4-001 Reference Implementation with Older Releases</a>
    </li>
    <ol class="writely-toc-none writely-toc-subheading" style=MARGIN-LEFT:0pt>
      <li>
        <a href="GTM_Database_Encryption.html#Installation_2861828101597426_" target=_self>Installation</a>
      </li>
    </ol>
  </ol>
</div>
<h1 class=western>
  <a id=Introduction_8075411930106976_ name=Introduction_8075411930106976_></a>Introduction
</h1>
<h2 class=western>
  <a id=Overview_9926550489328136_7785_9394282959401608 name=Overview_9926550489328136_7785_9394282959401608></a>Overview
</h2>
<p>
  <font size=2>Effective V5.3-004, GT.M on selected platforms can encrypt data in database and journal files.&nbsp; Encryption protects data at rest (DAR), that is it protects against unauthorized access to data by an unauthorized process that is able to access disk files. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>A plug-in architecture allows you to use your choice of encryption package. &nbsp;The characteristics of encryption are entirely determined by the package you choose a?? for example, GT.M implements no "back doors" or "key recovery", and if you want such functionality, you need to choose or construct an encryption package that provides the features you want. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>FIS distributes the source and object code for the reference implementation of a plug-in that uses popular, widely available, encryption libraries. &nbsp;If the reference implementation plug-in meets your needs, you are welcome to use it as distributed, but please read and understand the <a href="GTM_Database_Encryption.html#Disclaim" id=iwzj target=_self title="Click to see the Disclaimer">Disclaimer</a>, below.<font size=2>&nbsp;&nbsp;You can also use it as a base to implement your own plug-in.</font> </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>In the reference implementation, GT.M uses a symmetric cipher to encrypt data.&nbsp; The reference implementation encrypts the key for the symmetric cipher with an asymmetric cipher using public and private keys.&nbsp; The private keys are stored in a key ring on disk locked with a password (or passphrase a?? the terms are used interchangeably). </font>
</p>
<h2 class=western>
  <a id=Disclaimer_29210755010304446_4_6025377316400409 name=Disclaimer_29210755010304446_4_6025377316400409></a>Disclaimer
</h2>
<p>
  <font size=2>Database encryption is only useful as one component of a comprehensive security plan and is insufficient as the sole means of securing data.&nbsp; The use of database encryption should follow from a good security plan.&nbsp; This document describes implementing encrypted GT.M databases; it does not discuss security plans. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><i>Proper security protocol never places an unencrypted password, even in obfuscated form and/or in an obscure location, on disk</i>. With GT.M database encryption, unencrypted passwords exist in the address space of processes accessing the database, which means that unencrypted passwords can theoretically be written to swap files when process memory is paged out.&nbsp; To be secure, an installation must handle this by means such as: using encrypted swap devices or files, ensuring that GT.M processes are not paged out, or some other means to ensure that information in swap files is available only to the running process.&nbsp; <i>In other words, <b>even with respect to encryption, GT.M database encryption is only part of a complete security infrastructure</b>.</i></font>
</p>
<p style=FONT-STYLE:normal>
</p>
<div>
  &nbsp;
</div>
<p style=FONT-STYLE:normal>
  <font size=2>Our expertise is in GT.M, not in encryption.&nbsp; Encryption needs vary.&nbsp; Furthermore, the use of encryption may be restricted a?? or required a?? by regulations applicable to your location and circumstances.&nbsp; Therefore, our approach is to create a plug-in architecture where you can choose your preferred encryption software. In the course of development, we tested it primarily with <a href=http://gnupg.org/ target=_blank title="Click here to visit the GNU Privacy Guard home page">GNU Privacy Guard</a>, the widely available implementation of Pretty Good Privacy (see "PGP: Pretty Good Privacy" by Simson Garfinkel).&nbsp; Ensure that you have confidence in (and confidence in the support for) whichever encryption software you choose, because failure of the encryption software is likely to leave your data unrecoverable.&nbsp; GT.M itself performs no encryption, and encryption is performed exclusively by software that you install and configure.&nbsp; <i><b>FIS neither endorses nor supports any specific encryption algorithm or library.</b></i></font>
</p>
<p style=FONT-STYLE:normal>
</p>
<div>
  &nbsp;
</div>
<p style=FONT-STYLE:normal>
  <font size=2>Furthermore, just as GT.M allows for the use of your choice of encryption libraries, encryption libraries in turn require keys that must be managed.&nbsp; In its simplest form, key management requires both that only those who need a key have that key, and also that keys are not lost.&nbsp; Key management is two steps removed from GT.M's implementation of database encryption, but is important to the successful use of encrypted databases.&nbsp; It must be part of your operations policies and procedures.&nbsp; <i><b>FIS strongly recommends that you understand in detail how to implement the infrastructure for whichever specific encryption you choose.</b></i></font>
</p>
<h2 class=western>
  <a id=Limitations_of_GT_M_Database_E name=Limitations_of_GT_M_Database_E></a>Limitations of GT.M Database Encryption
</h2>
<p>
  <font size=2>Elements of your security infrastructure and management processes outside of GT.M database encryption need to manage issues discussed in the following sections.</font>
</p>
<h3 class=western>
  <a id=Data_Not_At_Rest_Not_Protected name=Data_Not_At_Rest_Not_Protected></a>Data Not At Rest Not Protected
</h3>
<p>
  <font size=2>GT.M database encryption is designed to protect data at rest.&nbsp; Applications execute business logic to manipulate and produce unencrypted data.&nbsp; Unencrypted data must exist within application processes, and can be accessed by any process with access rights to the virtual address space of a process containing unencrypted data.&nbsp; Also, data in transit between systems and between processes is not protected by GT.M database encryption.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <font size=2>Before creating a core dump, GT.M attempts to clear any keys that it is aware of within the process address space.&nbsp; The reference implementation also uses the encryption libraries so as to minimize the probability of keys appearing in core dumps.&nbsp; Since it is not possible to guarantee that keys will not appear in a process core dump, depending on your security policy, FIS recommends that you consider whether to disable the creation of core dumps by GT.M processes accessing encrypted databases, or use other means to limit access to core dumps.&nbsp; Note also that the use of random byte sequences as keys makes it harder to discern them in a core dump.</font><sup><a href="GTM_Database_Encryption.html#FOOTNOTE-1">1</a></sup>&nbsp;
  </li>
</ul>
<h3>
  Keys in the Process Address Space / Environment
</h3>
<div>
  This is a corollary of the fact that data not at rest is not protected by GT.M database encryption.
</div>
<br>
<div>
  In order to encrypt and decrypt databases, keys must exist in the address space / environment of GT.M processes. &nbsp;Furthermore, with the reference implementation, processes also need to have access to the user's private key, and to get access to the private key, they need access to the passphrase of the user's GPG keyring. &nbsp;In order to pass encryption to child processes, the passphrase also exists in the process environment, even if obfuscated. &nbsp;This means that any process that can access the address space or environment of a GT.M process accessing encrypted databases has access to the passphrases and keys.
</div>
<br>
<ul>
  <li>
    If an application provides some or all users access to a shell prompt or a GT.M direct mode prompt, or allows that user to specify arbitrary code that can be XECUTE'd, those users can find ways to view and capture keys and passphrases. &nbsp;Note that, if a key or passphrase can be captured, it can be misused - for example, a captured GPG keyring passphrase is captured, it can be used to change the passphrase. &nbsp;You must therefore ensure that your application does not provide such access to users who should not view keys and passphrases.
  </li>
  <li>
    This limitation makes it all the more important that those who have access to shell prompts, GT.M direct mode prompts, etc. not leave sessions unlocked, even briefly, if it is at all possible for someone who should not have knowledge of keys and passphrases to access the sessions during that time.
  </li>
</ul>
<h3 class=western>
  <a id=Long_Lived_Keys_52102823867602 name=Long_Lived_Keys_52102823867602></a>Long Lived Keys
</h3>
<p>
  <font size=2>A database file has an extended life.&nbsp; In typical operation, only a minuscule fraction of the data within a database changes each day. As changing an encryption key requires re-encrypting all the data, this means encryption keys for files have long lives.&nbsp; Since long-lived keys are security risks a?? for example, they cannot be changed when an employee leaves a?? key management must therefore be part of the overall security plan.&nbsp; At a minimum, long lived keys require two stage key management a?? a database key with a long life, not normally accessed or viewed by a human, stored in a form encrypted by another key that can be changed more easily. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Furthermore, a key must be retained at least as long as any backup encrypted with that key; otherwise the backup becomes useless.&nbsp; You must have appropriate procedures to retain and manage old keys.&nbsp; Since successful data recovery requires both keys and algorithms, the retention processes must also preserve the encryption algorithm. </font>
</p>
<h3 class=western>
  <a id=Voluminous_Samples_of_Encrypte name=Voluminous_Samples_of_Encrypte></a>Voluminous Samples of Encrypted Data
</h3>
<p>
  <font size=2>Database and journal files are large (GB to hundreds of GB).&nbsp; This large volume makes database encryption more amenable to attack than a small encrypted message because having many samples of encrypted material makes it easier to break a key. </font>
</p>
<h3 class=western>
  <a id=Encryption_Algorithms_Neither_ name=Encryption_Algorithms_Neither_></a>Encryption Algorithms Neither Endorsed Nor Supported by FIS
</h3>
<p>
  <font size=2><i>FIS neither endorses nor supports any specific encryption algorithm.</i></font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>The selection of an encryption algorithm is determined by many factors, including but not limited to, organizational preferences, legal requirements, industry standards, computational performance, robustness, the availability of encryption hardware, etc.&nbsp; No algorithm meets all needs. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Therefore, GT.M provides a "plug-in" architecture for encryption algorithms, which allows you to integrate your preferred encryption software with GT.M.&nbsp; In the GT.M development environment, we created variations on a reference implementation using popular encryption packages for our validation.&nbsp; We tested each reference implementation variation on at least one computing platform, and one reference implementation variation on each computing platform.&nbsp; This document lists which encryption package we tested on which platform. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><i>You take all responsibility for the selection and use of a specific encryption package.&nbsp;</i> Please be aware that: </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <p>
      <font size=2>All encryption libraries that run within the address space of a GT.M process <i><u><b>must</b></u></i> conform to the rules of any functions for GT.M, as documented, including but not limited to being single threaded, not altering GT.M's signal handlers, restricting the use of timers to the API provided by GT.M, etc.&nbsp;<a class=sdfootnoteanc href="GTM_Database_Encryption.html#sdfootnote1sym" name=sdfootnote1anc target=_self></a></font><sup><a href="GTM_Database_Encryption.html#FOOTNOTE-2">2</a></sup>&nbsp;
    </p>
  </li>
  <li>
    <p>
      <font size=2>Malfunction of encryption software or hardware can render your data irrecoverable.&nbsp; As part of your comprehensive organizational risk management strategy, please consider the use of logical multi-site application configurations, possibly with different encryption packages and certainly with different encryption keys. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>The cipher used for database encryption must not change the length of the encrypted sequence of bytes.&nbsp; In other words, if the cleartext string is <i>n</i> bytes, the encrypted string must also be <i>n</i> bytes. </font>
    </p>
  </li>
</ul>
<h3 class=western>
  <a id=No_Key_Recovery_26776196548698 name=No_Key_Recovery_26776196548698></a>No Key Recovery
</h3>
<p>
  <font size=2>The reference implementation of GT.M database encryption has no "back door" or other means to recover lost keys.&nbsp; We are also not aware of back doors in any of the packages used by the reference implementation. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><i>Lost keys make your data indistinguishable from random ones and zeros.</i><span style=FONT-STYLE:normal>&nbsp; While FIS recommends implementing a documented key management process including techniques such as key escrow, ultimately, </span><i>you</i><span style=FONT-STYLE:normal> take </span><i>all</i><span style=FONT-STYLE:normal> responsibility for managing your keys.</span></font>
</p>
<h3 class=western style=FONT-STYLE:normal>
  <a id=Human_Intervention_Required_64 name=Human_Intervention_Required_64></a>Human Intervention Required
</h3>
<p>
  <font size=2><span style=FONT-STYLE:normal>At some point in the process invocation chain, the reference implementation </span><i>requires </i><span style=FONT-STYLE:normal>a human being to provide a password that is placed (in obfuscated form) in the process environment where child processes can inherit it.&nbsp; If you want to be able to access encrypted databases without any human interaction, you must modify the reference implementation, or create your own implementation.</span></font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font face=verdana size=2><span style=FONT-STYLE:normal>For example, if you have a GT.M based application server process that is started by </span></font><font face=verdana size=2><a href=http://xinetd.org/ id=zohe target=_blank title="Click here to visit the xinetd home page">xinetd</a></font><font face=verdana size=2><span style=FONT-STYLE:normal> in response to an incoming connection request from a client, you may want to consider an approach where the client sends in a key that is used to extract an encrypted password for the master key ring from the local disk, obfuscates it, and places it in the environment of the server process started by </span></font><font face=verdana size=2><span style=FONT-STYLE:normal>xinetd</span></font><font face=verdana size=2><span style=FONT-STYLE:normal>. &nbsp;If the application protocol cannot be modified to allow the client to provide an additional password, </span></font><font face=verdana size=2><span style=FONT-STYLE:normal>xinetd</span></font><font size=2><span style=FONT-STYLE:normal> can be started with the </span></font><font face="courier new" size=2><span style=FONT-STYLE:normal>$gtm_passwd</span></font><font size=2><span style=FONT-STYLE:normal> obfuscated password in its environment, and the </span></font><font face=verdana size=2><span style=FONT-STYLE:normal>xinetd</span></font> <font face=verdana size=2><span style=FONT-STYLE:normal>passenv</span></font><font size=2><span style=FONT-STYLE:normal> parameter used to pass </span></font><font face="courier new" size=2><span style=FONT-STYLE:normal>$gtm_passwd</span></font><font face=verdana size=2><span style=FONT-STYLE:normal> from the </span></font><font face=verdana size=2><span style=FONT-STYLE:normal>xinetd</span></font><font face=verdana size=2><span style=FONT-STYLE:normal> process to the spawned server process.</span></font>
</p>
<h3 class=western style=FONT-STYLE:normal>
  <a id=MM_Databases_8281390758761996__5425045480951667 name=MM_Databases_8281390758761996__5425045480951667></a>MM Databases
</h3>
<p style=FONT-STYLE:normal>
  <font size=2>GT.M database encryption is only supported for the Buffered Global (BG) access method.&nbsp; It is not supported for the Mapped Memory (MM) access method.&nbsp; See <a href="GTM_Database_Encryption.html#Alt" id=k1wo target=_self title="Click to see Alternatives to Database Encryption">Alternatives to Database Encryption</a>, below, for other options. </font>
</p>
<h2>
  <a id=Alternatives_to_Database_Encry name=Alternatives_to_Database_Encry></a>Alternatives to Database Encryption
</h2>
<br>
<p>
  <font size=2>On some platforms, you may be able to use disk drives with built-in encryption, or encrypted file systems to protect data at rest. These may or may not be as secure as GT.M database encryption: for example, once an encrypted file system is mounted, files thereon can be accessed by any process that has appropriate permissions; with GT.M database encryption each process accessing a database file must individually have access to the keys for that database file. </font>
</p>
<h2>
  <a id=Device_IO name=Device_IO></a>Device IO
</h2>
<br>
<p>
  <font size=2>The built-in interface to encryption is implemented only for data in database, journal, backup and certain formats of extract files.&nbsp; To encrypt IO (say for sequential disk files), you can use IO to PIPE devices.&nbsp; Alternatively, you can call encryption routines from GT.M using the external call interface. </font>
</p>
<h2>
  <a id=Replication_and_GT_CM name=Replication_and_GT_CM></a>Replication and GT.CM
</h2>
<br>
<p>
  <font size=2>GT.M encrypts neither the replication stream nor GT.CM (GNP/OMI) network traffic.&nbsp; When needed, there are excellent third party products for implementing secure TCP/IP connections: software solutions as well as hardware solutions such as encrypting routers. </font>
</p>
<p>
</p>
<br>
<p>
  <font size=2>As with any GT.M process that accesses databases, the Update Process, helper processes and GT.CM server all require provisioning with keys to enable their access to encrypted databases.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>When a GT.CM server has a key for an encrypted database, any client connecting to the server can access encrypted records in that database.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <a href="GTM_Database_Encryption.html#toc" id=lbl0 target=_self title="Return to Table of Contents">Return to Table of Contents</a>
</p>
<p>
  <br>
</p>
<h1 class=western>
  <a id=Theory_of_Operation_1279254345 name=Theory_of_Operation_1279254345></a>Theory of Operation
</h1>
<p>
  <font size=2>This section describes the operation of GT.M database encryption with the reference implementation. &nbsp; A subsequent section describes the functions of the reference implementation which can be reworked or rewritten to use different encryption packages. </font>
</p>
<h2 class=western>
  <a id=Definition_of_Terms_9270159068 name=Definition_of_Terms_9270159068></a>Definition of Terms
</h2>
<table border=1 bordercolor=#000000 cellpadding=0 cellspacing=0 width=100%>
  <tbody>
  <tr valign=top>
    <th bgcolor=#ffffff>
      <p>
        <font size=2>Terms </font>
      </p>
    </th>
    <th bgcolor=#ffffff>
      <p>
        <font size=2>Description </font>
      </p>
    </th>
  </tr>
  <tr valign=top>
    <td width=28%>
      <p>
        <font size=2><b>Cipher</b></font>
      </p>
    </td>
    <td width=72%>
      <p>
        <font size=2>An encryption algorithm or the implementation of an encryption algorithm, for example, the symmetric cipher AES 256 CFB. </font>
      </p>
    </td>
  </tr>
  <tr valign=top>
    <td width=28%>
      <p>
        <font size=2><b>Hash (or Fingerprint) </b></font>
      </p>
      <div>
        &nbsp;
      </div>
    </td>
    <td width=72%>
      <p>
        <font size=2>A signature algorithmically derived from an object which is certain to a very impressive probability that uniquely identifies an object within a set of similar objects. </font>
      </p>
    </td>
  </tr>
  <tr valign=top>
    <td width=28%>
      <p>
        <font size=2><b>Key length</b></font>
      </p>
    </td>
    <td width=72%>
      <p>
        <font size=2>The number of bits comprising a key.&nbsp; Longer key lengths may result in stronger encryption (more difficult to break) but require more computation. </font>
      </p>
    </td>
  </tr>
  <tr valign=top>
    <td width=28%>
      <p>
        <font size=2><b>Key management</b></font>
      </p>
    </td>
    <td width=72%>
      <p>
        <font size=2>The generation, distribution, and access of keys.&nbsp; The reference implementation of database encryption uses: </font>
      </p>
      <ul>
        <li>
          <p>
            <font size=2>symmetric keys to encrypt data and index records. </font>
          </p>
        </li>
        <li>
          <p>
            <font size=2>public keys to encrypt symmetric keys (so they can be placed on disk). </font>
          </p>
        </li>
        <li>
          <p>
            <font size=2>private keys to decrypt symmetric keys. </font>
          </p>
        </li>
        <li>
          <p>
            <font size=2>passwords to encrypt private keys (so they can be placed on disk). </font>
          </p>
        </li>
      </ul>
    </td>
  </tr>
  <tr valign=top>
    <td width=28%>
      <p>
        <font size=2><b>Master key file</b></font>
      </p>
    </td>
    <td width=72%>
      <p>
        <font size=2>This file contains pairs of entries indicating which symmetric key is used to encrypt/decrypt database records.&nbsp; Database records can be found in database, journal, extract and backup files. </font>
      </p>
    </td>
  </tr>
  <tr valign=top>
    <td width=28%>
      <p>
        <font size=2><b>Obfuscation</b></font>
      </p>
    </td>
    <td width=72%>
      <p>
        <font size=2>A technique used to make data difficult to discern on casual observation.&nbsp; A common example is "pig Latin".&nbsp; Since the password used for the GPG keyring exists in the process' environment with the reference implementation, GT.M obfuscates it to reduce the chance that visual access to process information (say during debugging) inadvertently exposes the password. </font>
      </p>
    </td>
  </tr>
  <tr valign=top>
    <td width=28%>
      <p>
        <font size=2><b>Password (or Passphrase)</b></font>
      </p>
    </td>
    <td width=72%>
      <p>
        <font size=2>A secret word or phrase used in the reference implementation to protect a private key on disk (a password should <i>never</i> be on disk in the clear, which is the electronic equivalent of taping it to your monitor with a sticky note). </font>
      </p>
    </td>
  </tr>
  <tr valign=top>
    <td width=28%>
      <p>
        <font size=2><b>Public key / Private key (or Asymmetric keys) </b></font>
      </p>
    </td>
    <td width=72%>
      <p>
        <font size=2>A pair of keys used so what one key encrypts the other can decrypt.&nbsp; The private key is sometimes referred to as the "secret" key (because it is not shared as opposed to the public key which is; the private key should never be on disk in the clear).&nbsp; In the reference implementation, asymmetric keys are used to encrypt the symmetric database key.&nbsp; This allows a master to encrypt a symmetric database key with a usera??s public key (so only the user can decrypt it with their private key). </font>
      </p>
      <p>
        <font size=2>Encryption using a public key / private key pair is referred to as "public key encryption".&nbsp; The reference implementation uses GNU Privacy Guard with associated libraries libgpgme and libgpg-error for asymmetric key encryption. </font>
      </p>
    </td>
  </tr>
  <tr valign=top>
    <td width=28%>
      <p>
        <font size=2><b>Symmetric key</b></font>
      </p>
    </td>
    <td width=72%>
      <p>
        <font size=2>The same key used to both encrypt and decrypt.&nbsp; Symmetric ciphers are faster than asymmetric ciphers. &nbsp;Encryption using a symmetric key is referred to as "symmetric key encryption".&nbsp; Depending on the platform, the reference implementation uses either GNU Privacy Guard's libgcrypt, or libcrypto from <a href=http://openssl.org/ id=w9bj target=_blank title="Click here to visit the OpenSSL home page">OpenSSL</a>, for symmetric key encryption. </font>
      </p>
    </td>
  </tr>
  </tbody>
</table>
<h2 class=western>
  <a id=Overview_594672385058402_22992_4199900245293975 name=Overview_594672385058402_22992_4199900245293975></a>Overview
</h2>
<h3 class=western>
  <a id=Warning_4553461350231711_34821_07235222682356834 name=Warning_4553461350231711_34821_07235222682356834></a>Warning
</h3>
<p>
  <font size=2>GT.M implements database encryption with a plug-in architecture that allows for your choice of cipher.&nbsp; <i>Any code statically or dynamically linked in to a GT.M process must meet the requirements of code used for external calls</i>.&nbsp; The GT.M distribution includes a reference implementation that interfaces to several common packages and libraries.&nbsp; You are free to use the reference implementations as is, but remember that the choice of cipher and package is yours, and FIS neither recommends nor supports any specific package. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Note: In any given instance, you must use the same encryption libraries for all databases accessed by the processes of an application instance, but each database file can have its own key.&nbsp; Of course, all processes accessing a database or journal file must use the same encryption algorithm and key.</font>
</p>
<h3 class=western>
  <a id=Data_in_Database_Journal_Files name=Data_in_Database_Journal_Files></a>Data in Database and Journal Files
</h3>
<p>
  <font size=2>A GT.M database file contains several parts (details are in the <a href="../books/ao/UNIX_manual/index.html" id=z:qe title="Click here to visit the GT.M Administration and Operations Guide, UNIX edition">GT.M Administration and Operations Guide</a>): </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <p>
      <font size=2>A file header containing information pertaining to the database file itself. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>Global and local bit maps, which together specify which blocks in the file are in use and which blocks are free. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>Data blocks containing the actual data, as well as index blocks containing structural information providing paths to the actual data (there is a directory tree, and one or more global variable trees).&nbsp; Each data or index block consists of a block header, and one or more data records. </font>
    </p>
  </li>
</ul>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>In an encrypted database, GT.M encrypts only the index and data records in a database. &nbsp;The file header, bit maps, and block headers are not encrypted, i.e., information relating to database structure is not encrypted.&nbsp; This means some system administration operations such as turning journaling on and off, do not require the encryption key for a database file.&nbsp; Others, such as MUPIP EXTRACT, do. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Journal files contain data records, such as before image records, update records, and after image records, as well as structural information such as transaction markers, process records, etc.&nbsp; Again, only records that contain data a?? before image records, update records and after image records a?? are encrypted.&nbsp; Records that contain structural information remain in cleartext. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Records subject to encryption are collectively referred to in the document as <i>data records</i>. </font>
</p>
<h3 class=western>
  <a id=Symmetric_and_Asymmetric_Ciphe_010402709245681763 name=Symmetric_and_Asymmetric_Ciphe_010402709245681763></a>Symmetric and Asymmetric Ciphers
</h3>
<p>
  <font size=2>For performance, a symmetric cipher is used to encrypt and decrypt data records. &nbsp; Asymmetric ciphers are used by the reference implementation to secure the symmetric cipher keys stored on disk.&nbsp; A password is used to secure the private key which is stored on a key ring on disk.&nbsp; The following illustration is an overview of GT.M database encryption in the reference implementation using GNU Privacy Guard (GPG) to provide the ciphers.&nbsp; &nbsp;</font>
</p>
<div>
  &nbsp;
</div>
<div>
  &nbsp;
  <div id=vze5 style=TEXT-ALIGN:center>
    <img src="images/dpqq6h6_158fq7xrpdd_b.jpg" style=HEIGHT:947px;WIDTH:713px>
  </div>
</div>
<div>
  &nbsp;
  <div id=t2k6 style=TEXT-ALIGN:center>
    <div id=qv9x style=TEXT-ALIGN:center>
      <div id=d-nx style=TEXT-ALIGN:center>
        &nbsp;
      </div>
    </div>
  </div>
</div>
<div id=t:3m style=TEXT-ALIGN:center>
  <div id=xyem style=TEXT-ALIGN:center>
    &nbsp;
  </div>
</div>
<div id=kk6b style=TEXT-ALIGN:center>
  <div id=sgaz style=TEXT-ALIGN:center>
    &nbsp;
  </div>
</div>
<h3 class=western>
  <a id=Key_Ring_on_Disk name=Key_Ring_on_Disk></a>Key Ring on Disk
</h3>
<p>
  <font size=2>In the reference implementation, a password protected <i>key ring on disk</i> contains the private key of the asymmetric cipher.&nbsp; A password is required to access the key ring on disk and obtain the private key. Password acquisition happens in one of three ways: </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <p>
      <font size=2>When the environment variable </font><font face="courier new" size=2>$gtm_passwd</font><font size=2> is not set, before a GT.M mumps process needs to open an encrypted database file, the application calls a program such as </font><font face="courier new" size=2>GETPASS.m</font><font size=2> to prompt for and obtain a password for the key ring on disk. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>When the environment variable </font><font face="courier new" size=2>$gtm_passwd</font><font size=2> is set to the null string, at process startup, GT.M implicitly calls the program </font><font face="courier new" size=2>GETPASS.m</font><font size=2> to prompt for and obtain a password.&nbsp; The environment variable, </font><font face="courier new" size=2>$gtm_passwd</font><font size=2> is then set to an obfuscated version of the password required to unlock the key ring on disk. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>The environment variable </font><font face="courier new" size=2>$gtm_passwd</font><font size=2> contains an obfuscated version of the password required to unlock the key ring on disk to obtain the private key.&nbsp; The environment variable can be passed in to GT.M, or it can be prompted for and set, as described below. </font>
    </p>
  </li>
</ul>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Some graphical user interfaces, e.g., GNOME or KDE, may detect when you are being prompted for the GPG keyring password and use a graphical interface instead of the terminal interface.&nbsp; You may be able to disable this behavior if you unset the </font><font size=2><font face="courier new">$DISPLAY</font> environment variable, or use an ssh connection to localhost that disables X forwarding.&nbsp; Consult your graphical user interface documentation. </font>
</p>
<br>
<p>
  <font size=2>In order to enable the Job command, the password for the key ring on disk exists in the environment of the process in environment variable </font><font face="courier new" size=2>$gtm_passwd</font><font size=2> where it can be passed from a parent process to a child.&nbsp; In order to prevent inadvertent disclosure of the password, for example, in a dump of the environment submitted to FIS for product support purposes, the password in the environment is obfuscated using information available to processes on the system on which the process is running, but not available on other systems. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font face="courier new" size=2>$gtm_passwd</font><font size=2> is the only way for a child process to receive a password from a parent.&nbsp; In the event that the parent process does not pass </font><font face="courier new" size=2>$gtm_passwd</font><font size=2> to the child, or passes an incorrect password, there is little a child without access to an input device can do except log an error and terminate. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>An obfuscated password in the environment is the only way that other GT.M processes (MUPIP and DSE) can be provided with a password.&nbsp; If they encounter an encrypted database or journal file, and do not have an obfuscated password to the key ring on disk in the environment, they terminate with the error message "GTM-E-CRYPTINIT, Error initializing encryption library. Environment variable gtm_passwd set to empty string. Password prompting not allowed for utilities" . There are (at least) two ways t</font><font size=2>o provide MUPIP and DSE processes with obfuscated passwords in </font><font face="courier new" size=2>$gtm_passwd</font><font size=2>: </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <p>
      <font face="courier new" size=2>maskpass</font><font size=2> is a stand-alone program that prompts the user for the password to the key ring on disk, and returns an obfuscated password to which&nbsp;</font><font face="courier new" size=2>$gtm_passwd</font><font size=2> can be set. &nbsp;The environment variable <font face="courier new">$gtm_passwd</font> should be not set, set to a null value, or set to a value produced by <font face="'Courier New'">maskpass</font>.&nbsp; Setting </font><font face="courier new" size=2>$gtm_passwd</font><font size=2> to an incorrect non-null value without using <font face="courier new">maskpass</font> could result in undefined behavior of the encryption library. You can use </font><font face="courier new" size=2>maskpass</font><font size=2> in shell scripts.&nbsp; For example: </font>
    </p>
    <div>
      <font face="courier new" size=2>$ echo -n "Enter Password: ";export gtm_passwd=`$gtm_dist/plugin/gtmcrypt/maskpass|cut -f 3 -d " "`</font>
    </div>
    <div>
      <font face="courier new" size=2>Enter Password:</font>
    </div>
    <div>
      <font face="'Courier New', monospace"><font size=2>$</font></font>
    </div>
  </li>
</ul>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <p>
      <font size=2>Create a one line GT.M program as follows: </font>
    </p>
    <div>
      <font face="courier new" size=2>zcmd ZSYstem $ZCMdline Quit</font>
    </div>
    <div>
      <font size=2>and use it invoke the MUPIP or DSE command. For example:</font>
    </div>
    <div>
      <font size=2><font face="courier new">$ gtm_passwd="" mumps -run zcmd mupip backup -region \"*\"</font></font>
    </div>
    <div>
      <font size=2>The empty string value of </font><font face="courier new" size=2>$gtm_passwd</font><font size=2> causes the MUMPS process to prompt for and set an obfuscated password in its environment which it then passes to the MUPIP program.&nbsp; Shell quote processing requires the use of escapes to pass the quotes from the ZSYstem command to the shell. </font>
    </div>
  </li>
</ul>
<div>
  &nbsp;
</div>
<div style=COLOR:#000000>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The environment variable <font face="Courier New">$gtm_passwd</font> should be one of the following:
</div>
<div style=COLOR:#000000>
  &nbsp;&nbsp;
</div>
<ul style=COLOR:#000000>
  <ul>
    <li>
      <div>
        not set
      </div>
    </li>
    <li>
      <div>
        set to a null value
      </div>
    </li>
    <li>
      <div>
        set to a value corresponding to an obfuscated password (e.g., produced by maskpass)
      </div>
    </li>
  </ul>
</ul>
<p>
  &nbsp;
</p>
<div>
  <font size=2><font color=#000000>The following schematic illustrates acquisition of the password for the key ring on disk.&nbsp; Note that an error (for example from the entry of an incorrect password) may not be triggered immediately a?? for example, DSE does not need an encryption key until you attempt to access data (since the file header is not encrypted, access to it does not </font><font color=#000000>require</font><font color=#000000> a key).</font><br>
  </font>
  <div id=gkgv style=TEXT-ALIGN:center>
    <img src="images/dpqq6h6_157hfmf6mgg_b.gif" style=HEIGHT:983px;WIDTH:665px>
  </div>
  <font size=2><br>
  </font>
</div>
<div id=x951 style=TEXT-ALIGN:center>
  <br>
</div>
<div id=v5sm style=TEXT-ALIGN:center>
  <br>
</div>
<div id=l1yv style=TEXT-ALIGN:center>
  <a href=http://docs.google.com/File?id=dhpr4zmp_31wmqvh9f8_b target=_blank><img src="images/dhpr4zmp_31wmqvh9f8_b.png" style=HEIGHT:7px;WIDTH:6px></a>
</div>
<div id=x_qe style=TEXT-ALIGN:center>
  <a href=http://docs.google.com/File?id=dhpr4zmp_23cs3785cv_b target=_blank></a>
</div>
<p>
  &nbsp;&nbsp;
</p>
<h3>
  <a id=_Master_Key_File_Key_Files_130_6287360657006502 name=_Master_Key_File_Key_Files_130_6287360657006502></a>Master Key File and Key Files
</h3>
<p>
  <font size=2>The reference implementation uses a <i>master key file</i> for each user to obtain the symmetric keys for each database or journal file.&nbsp; The environment variable </font><font face="courier new" size=2>$gtm_dbkeys</font><font size=2> specifies the master key file.&nbsp; If </font><font face="courier new" size=2>$gtm_dbkeys</font><font size=2> points to a file, it is the master key file.&nbsp; If it points to a directory, the file </font><font face="courier new" size=2>.gtm_dbkeys</font><font size=2> in that directory is the master key file (<font face="courier new"><font face=verdana>that is: </font>$</font></font><font face="courier new" size=2>gtm_dbkeys/.gtm_dbkeys</font><font size=2>).</font><font size=2>&nbsp; If the environment variable is not defined, the functions look for a key file <font face="'Courier New'">~/.gtm_dbkeys</font> (i.e., in the home directory of the process' userid).</font><font size=2>&nbsp; The master key file contains sections as follows: </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p style="FONT-FAMILY:Courier New;MARGIN-LEFT:0.5in">
  <font face="courier new" size=2>dat</font> <font face="arial narrow" size=2>database_filename</font>
</p>
<p style="FONT-FAMILY:Courier New;MARGIN-LEFT:0.5in">
  <font face="courier new" size=2>key</font> <font face="arial narrow" size=2>key_filename</font>
</p>
<div>
  &nbsp;
</div>
<div>
  <font size=2>where </font><font face="arial narrow" size=2>database_filename</font><font size=2> is the name of a database file, for example, </font><font size=2><font face="courier new">/var/xyzapp/gbls/accounts.dat</font> and </font><font face="arial narrow" size=2>key_filename</font><font size=2> is the name of a key file containing a symmetric key encrypted with a public key, for example: </font><font size=2><font face="courier new">/home/sylvia/dbkeys/accounts.key</font>.&nbsp; </font>
</div>
<div>
  &nbsp;
</div>
<div>
  <font size=2>Key files are text files which can even be faxed or e-mailed: since they are secured with asymmetric encryption, you can transmit them over an insecure channel.&nbsp; As discussed below, the same </font><font face="arial narrow" size=2>database_filename</font><font size=2> can occur multiple times in a master key file. </font>
</div>
<h3>
  <a id=Memory_Key_Ring_45293131355873 name=Memory_Key_Ring_45293131355873></a>Memory Key Ring
</h3>
<p>
  <font size=2>For each </font><font face="arial narrow" size=2>key_filename</font><font size=2>, the GT.M process (MUMPS, MUPIP or DSE) builds a <i>memory key </i><span style=FONT-STYLE:normal><i>ring</i> from the key ring on disk and the master key file.&nbsp;</span> The memory key ring contains a list of elements where each element consists of a filename, a symmetric cipher key, and a cryptographic hash of that symmetric cipher key.&nbsp; Using the private key obtained from the key ring on disk, GT.M obtains the symmetric keys from key files pointed to by the master key file. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Database and journal file headers include a cryptographic hash of the encryption key and algorithm used for that file.&nbsp; When opening a file, GT.M uses the key in the memory key ring whose hash matches that in the header a?? the <font face="arial narrow">database_filename</font> in the key ring is ignored.&nbsp; Older keys need not be deleted until they are no longer required (for example, an older key may be required to access a restored backup copy of a database). Permitting the same </font><font size=2><font face="arial narrow">database_filename</font></font><font size=2> to occur multiple times in a master key file also enables one master key file to be used for multiple instances of an application.&nbsp; This ensures that the correct key for a file is always used, even if the file has been renamed, copied from another location, etc. a?? the correct key must of course be available in the memory key ring; if no such key exists, GT.M triggers a CRYPTKEYFETCHFAILED error. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Only for MUPIP CREATE does GT.M rely on the </font><font size=2><font face="arial narrow">database_filename</font></font><font size=2> in the key ring.&nbsp; MUPIP CREATE computes the cryptographic hash for the correct key to place in the database file header.&nbsp; If the same </font><font size=2><font face="arial narrow">database_filename</font></font><font size=2> occurs more than once in the master key file (and hence in the memory key ring), MUPIP CREATE uses the </font><font face="arial narrow" size=2>key_filename</font><font size=2> associated with the <i>last</i> occurrence of that </font><font size=2><font face="arial narrow">database_filename</font></font><font size=2> in the master key file.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<div>
  <font size=2>This is illustrated by the picture below. &nbsp;&nbsp;</font>
</div>
<div>
  &nbsp;
</div>
<div id=rsih style=TEXT-ALIGN:center>
  <div id=j6r. style=TEXT-ALIGN:center>
    <div id=yk3. style=TEXT-ALIGN:center>
      &nbsp;
    </div>
    <div style=TEXT-ALIGN:center>
      &nbsp;
    </div>
  </div>
</div>
<div id=pswj style=TEXT-ALIGN:center>
  <div style=TEXT-ALIGN:left>
    &nbsp;<br>
    <br>
    <div id=vhph style=TEXT-ALIGN:left>
      <img src="images/dpqq6h6_162dqb8nrc9_b.gif" style=HEIGHT:799px;WIDTH:759px>
    </div>
    <br>
  </div>
  &nbsp;
</div>
<p>
</p>
<p>
</p>
<div>
  <font size=3><b>Key Validation and Hashing</b></font>
</div>
<p style=COLOR:#000000>
  <font size=2><br>
  </font>
</p>
<p style=COLOR:#000000>
  <font size=2>As discussed earlier, a process uses that key in its memory key ring whose hash matches the hash in the database or journal file header; the file name is not checked.&nbsp; MUPIP CREATE computes the hash value for the key at database creation time, and writes it to the database file header.&nbsp; <span style=FONT-STYLE:normal>When GT.M creates a new journal file for an encrypted database file, it copies the hash from the database file header into the journal file header.&nbsp; Similarly, MUPIP EXTRACT -FORMAT=BINARY, places the database file hash in the extract, which is encrypted; indeed, since an extract can come from multiple database files, extract places the hash from the file header of each encrypted database in the extract.&nbsp; When processing each section in the extract, MUPIP LOAD uses that key in its memory key ring that matches the hash for each section of the extract.</span></font>
</p>
<p>
  &nbsp;
</p>
<h3 class=western style=FONT-STYLE:normal>
  <a id=Database_Operation_79561009562_09247611183673143 name=Database_Operation_79561009562_09247611183673143></a>Database Operation
</h3>
<p style=FONT-STYLE:normal>
  <font size=2>On disk, database and journal files are always encrypted a?? GT.M never writes unencrypted data to an encrypted database or journal file.&nbsp; GT.M uses decryption when reading data records from disk, and encryption when it writes data records to disk. </font>
</p>
<p style=FONT-STYLE:normal>
</p>
<div>
  &nbsp;
</div>
<p style=FONT-STYLE:normal>
  <font size=2>With encrypted databases, the number of global buffers allocated is automatically doubled, for example, if the database file header specifies 2000 global buffers, when the file is opened, GT.M automatically allocates 4000 global buffers.&nbsp; Global buffers are used in pairs: one global buffer has a copy of the encrypted database block as it exists on disk and the other has a copy of the unencrypted version.&nbsp; There is no change to the size of the control structures (including lock space and journal buffers) in shared memory.&nbsp; So, when using encrypted databases, you need to adjust your calculations of memory and shared memory usage accordingly: for each open database file, the shared memory usage will increase by the number of global buffers times the block size.&nbsp; For example, if the block size of a database file is 4KB, with 2048 global buffers, and the shared memory segment for that database file occupies 9MB when unencrypted, it occupies 17MB when the file is encrypted.&nbsp; Depending on your operating system you may need to change system configuration and tuning parameters.&nbsp; Other than global buffers, there is no change to memory usage with encryption. </font>
</p>
<p style=FONT-STYLE:normal>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><span style=FONT-STYLE:normal>Encrypted databases consume additional CPU resources for encryption and decryption.&nbsp; Without detailed knowledge of the chosen algorithms, the application patterns and hardware configuration, it is not possible to predict </span><span style=FONT-STYLE:normal>whether this will be appreciable, and whether application throughput will be affected. &nbsp; As far as possible, FIS has attempted to engineer GT.M database encryption so that the additional CPU resources are consumed outside software critical sections.&nbsp; The intention is to minimize the impact of encryption on application throughput, at least on computer systems that are not starved of CPU resources.&nbsp; You should determine the actual impact of encryption on your application when it runs on your system, preferably using a test environment that exactly reflects your production environment.</span></font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<a href="GTM_Database_Encryption.html#toc" id=vte1 target=_self title="Click here to return to the Table of Contents">Return to Table of Contents</a>
<p>
  <br>
</p>
<h1 class=western style=FONT-STYLE:normal>
  <a id=Examples_of_use_60346492159712_8078852482140064 name=Examples_of_use_60346492159712_8078852482140064></a>Examples of use
</h1>
<p style=FONT-STYLE:normal>
  <font size=2>The commands here are all line oriented to illustrate that they can be automated by being called from GT.M or from a shell script. &nbsp;For interactive use, there are many graphical user interfaces (GUIs) usable with GPG.&nbsp; Although these examples were generated on Linux, usage on other UNIX systems should be virtually identical.&nbsp;</font>
</p>
<h2 class=western>
  <a id=Key_Management_373813668955046_22358114272356033 name=Key_Management_373813668955046_22358114272356033></a>Key Management
</h2>
<div>
  <font size=2>This is an example of key management using GPG and the reference implementation. </font>
</div>
<div>
  &nbsp;
</div>
<div style=COLOR:#000000>
  Helen Keymaster (<font face="courier new">helen@gt.m</font>) is the master of keys, and provides a database key to Phil Keyuser <font face="courier new">(phil@gt.m</font>). Helen does not manage the database. Phil is the database manager, but he is not the master of keys.<br>
  <br>
  In order to communicate securely, Helen and Phil each set up a GPG keyring, generate a public / private key pair, and exchange &amp; authenticate each other's public keys. This permits a secure transfer of the key for the symmetric cipher used for the database.<br>
  <br>
  Warning: If you attempt key generation on a virtual machine, or other computer system that does not have a good supply of entropy, the <font face="courier new">gen_key_pair.sh</font> script could take a very, very long time. Similarly, a key quality of <font face="courier new">2 </font>for the<font face="courier new"> gen_sym_key.sh</font> script on a machine without a plentiful supply of entropy can also tax your patience. Use a physical computer system with a lot of entropy. If you are able to, use an entropy gathering daemon such as egd (<a href=http://egd.sourceforge.net/ title=http://egd.sourceforge.net>http://egd.sourceforge.net</a>), or consider acquiring an entropy source such as the Entropy Key (<a href=http://www.entropykey.co.uk/ title=http://www.entropykey.co.uk>http://www.entropykey.co.uk</a>) that you can use to distribute entropy to your virtual machines.
</div>
<div>
  &nbsp;
</div>
<div>
  &nbsp;
</div>
<p style=COLOR:#000000>
  <font size=2>&nbsp;The workflow is as follows:</font>
</p>
<p style=COLOR:#000000>
</p>
<ol>
  <li>
    <font size=2><font color=#000000>Helen and Phil each create a new GPG keyring and a new public-private key pair.</font><sup><a href="GTM_Database_Encryption.html#FOOTNOTE-3">3</a></sup><font color=#000000> &nbsp;In the </font><font color=#000000 face="'Courier New'">gen_keypair.sh</font><font color=#000000> script GPG generates the key pair,</font><sup><a href="GTM_Database_Encryption.html#FOOTNOTE-4">4</a></sup> putting public and private keys in the key ring; the latter locked with a passphrase. &nbsp;The public key is also exported to a text file, and its fingerprint is displayed in the terminal session. &nbsp;Each of them e-mails (or otherwise sends) her/his public key text file to the other.<sup><a href="GTM_Database_Encryption.html#FOOTNOTE-5">5</a></sup>&nbsp;&nbsp;<font color=#000000 size=2>This is illustrated below; f</font><font color=#000000>irst Helen, then Phil (if the <font face="courier new">GNUPGHOME</font> environment variable is not set, it will default to <font face="courier new">$HOME/.gnupg</font>).</font><br>
    <br>
    </font>
    <div id=aos_ style=TEXT-ALIGN:left>
      &nbsp;
      <div id=o4fk style=TEXT-ALIGN:left>
        <div id=razr style=TEXT-ALIGN:left>
          <div id=exun style=TEXT-ALIGN:center>
            <img src="images/dpqq6h6_116dctrqc96_b.gif" style=HEIGHT:582px;WIDTH:571px>
          </div>
        </div>
      </div>
    </div>
  </li>
  <li>
    <font color=#000000 size=2>Helen e-mails <a href=mailto:helen@gt.m_pubkey.txt>helen@gt.m_pubkey.txt</a> the file containing her exported public key to Phil, and Phil sends <a href=mailto:phil@gt.m_pubkey.txt,his>phil@gt.m_pubkey.txt, his</a> exported public key to Helen. To protect against "man in the middle" attacks, they speak on the phone to exchange keyfingerprints, or send each other the fingerprints by text message,or facsimile - a different communication channel than that used to exchange the keys. </font><font size=2><font color=#000000>Phil does likewise with Helen's key. &nbsp;They use the </font><font color=#000000 face="'Courier New'">import_and_sign_key.sh</font><font color=#000000> shell script. &nbsp;After importing and signing each other's public keys, Phil and Helen can communicate securely with each other, even in the presence of eavesdroppers. &nbsp;Helen's keyring with Phil's imported key is shown below. </font><br>
    </font>
    <div id=xzwa style=TEXT-ALIGN:left>
      <div id=mw9_ style=TEXT-ALIGN:left>
        <div id=blap style=TEXT-ALIGN:center>
          <img src="images/dpqq6h6_121djvxq8t5_b.gif" style=HEIGHT:845px;WIDTH:475px>
        </div>
        <br>
      </div>
      <br>
    </div>
  </li>
  <li style=COLOR:#000000>
    <font size=2>Using the <font face="Courier New">gen_sym_key.sh </font>script, Helen generates a symmetric cipher key for Phil to use in encrypting a new database file <font face="Courier New">cust.dat.</font> With a key strength of 2, a symmetric key is suitable for use in production and in the example is stored in file <font face="courier new">helen_cust_dat.txt</font> encrypted with Helen's public key so that only she can decrypt it.&nbsp;</font><font size=2>The gen_sym_key.sh script never displays the symmetric cipher key; the key in the text file on disk can only be decrypted with Helen's private key.<br>
    </font>
    <div id=u7.u style=TEXT-ALIGN:left>
      <div id=rv3: style=TEXT-ALIGN:left>
        &nbsp;
      </div>
    </div>
  </li>
  <li>
    <font size=2><font color=#000000>With the encrypt_sign_db_key.sh script, Helen uses her private key to decrypt the symmetric cipher key in helen_cust_dat.txt, encrypts it with Phi's public key, and signs it with her private key, creating a file called </font><font color=#000000 face="'Courier New'">phil_cust_dat.txt</font><font color=#000000>. &nbsp;She sends this file to Phil, either as an e-mail attachment, or putting it in a mutually agreed upon location on disk. &nbsp;As before, even though the key is on disk, it can be decrypted only with Phil's private key. &nbsp;Note that from this point on, even if Helen is hit by a truck, or resigns, Phil has access to the key and can use the same encrypt_sign_db_key.sh script to provide the key to, say, Xavier, Helen's successor. &nbsp;Helen preparing the key for Phil is shown below.&nbsp; </font><br>
    <br>
    </font>
    <div id=zeva style=TEXT-ALIGN:center>
      <img src="images/dpqq6h6_127drtnzgdx_b.gif">
    </div>
    <font size=2><br>
    <br>
    </font>
    <div id=opgx style=TEXT-ALIGN:center>
      &nbsp;
    </div>
  </li>
  <li>
    <font size=2>With the <font face="'Courier New'">add_db_key.sh</font> script, Phil now adds the key to his GT.M master key file. &nbsp;He can then create the encrypted database file with mupip create, load it with data and use it.<font size=2>&nbsp;&nbsp;Until the database is created and loaded with data, the key has no value and can be discarded at will. &nbsp;Once the database is created and loaded with the data, the key must be retained as long as access to the database - or even a backup thereof - is ever required. &nbsp;The entire process is&nbsp;</font></font><font size=2>illustrated below:</font>
  </li>
</ol>
<p style=FONT-STYLE:normal>
</p>
<div id=wjsj style=TEXT-ALIGN:center>
  <a href=http://docs.google.com/File?id=dhpr4zmp_26dcc6vhf4_b target=_blank><img src="images/dhpr4zmp_26dcc6vhf4_b.png" style=HEIGHT:573px;WIDTH:640px></a><br>
  <div style=TEXT-ALIGN:left>
    &nbsp;<br>
  </div>
</div>
<p style=FONT-STYLE:normal>
</p>
<a id=Tested_Reference_Implementatio name=Tested_Reference_Implementatio></a>
<p class=western style="FONT-FAMILY:Courier New">
</p>
<ol start=6>
  <li>
    As a final check to make sure that the database was created with the correct symmetric cipher key and the correct cipher, Helen can use the gen_sym_hash.sh script to compute a hash from the key in helen_cust_dat.txt while Phil uses GT.M's dse dump -fileheader -all command to print the key from the file header of the database file he creates. &nbsp;If the hashes match, the database file has been correctly created.
  </li>
</ol>
<br>
<div>
  Below are scripts of the key management example above.
</div>
<br>
<p>
  Helen creates a new GPG keyring with a public and private key pair:
</p>
<div style=COLOR:#000000>
  <font face="Courier New">helen$ export GNUPGHOME=$PWD/.helengnupg<br>
  helen$ $gtm_dist/plugin/gtmcrypt/gen_keypair.sh helen@gt.m Helen Keymaster<br>
  Passphrase for new keyring:<br>
  Verify passphrase:<br>
  Key ring will be created in /home/helen/.helengnupg<br>
  Key generation might take some time. Do something that will create entropy, like moving the mouse or typing in another session.<br>
  gpg: checking the trustdb<br>
  gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model<br>
  gpg: depth: 0 valid: 1 signed: 0 trust: 0-, 0q, 0n, 0m, 0f, 1u<br>
  /home/helen/.helengnupg/pubring.gpg<br>
  ---------------------------------<br>
  pub 1024D/BC4D0739 2010-05-07<br>
  Key fingerprint = B38B 2427 5921 FFFA 5278 8A91 1F90 4A46 BC4D 0739<br>
  uid Helen Keymaster &lt;helen@gt.m&gt;<br>
  sub 2048R/A2E8A8E8 2010-05-07<br>
  Key pair created and public key exported in ASCII to helen@gt.m_pubkey.txt</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">helen$</font><br style="FONT-FAMILY:Courier New">
</div>
<br style=COLOR:#000000>
<div style=COLOR:#000000>
  Phil creates a new GPG keyring with a public and private key pair:
</div>
<font color=#000000><br style="FONT-FAMILY:Courier New">
<font face="courier new">phil$ export GNUPGHOME=$PWD/.philgnupg</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">phil$ $gtm_dist/plugin/gtmcrypt/gen_keypair.sh phil@gt.m Phil Keyuser</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">Passphrase for new keyring:</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">Verify passphrase:</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">Key ring will be created in /home/phil/.philgnupg</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">Key generation might take some time. Do something that will create entropy, like moving the mouse or typing in another session.</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">gpg: checking the trustdb</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">gpg: depth: 0 valid: 1 signed: 0 trust: 0-, 0q, 0n, 0m, 0f, 1u</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">/home/phil/.philgnupg/pubring.gpg</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">---------------------------------</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">pub 1024D/A5719A99 2010-05-07</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">Key fingerprint = 886A BAFC E156 A9AD 7EA9 06EA 8B8B 9FAC A571 9A99</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">uid Phil Keyuser &lt;phil@gt.m&gt;</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">sub 2048R/AD37D5A0 2010-05-07</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">Key pair created and public key exported in ASCII to phil@gt.m_pubkey.txt</font><br style="FONT-FAMILY:Courier New">
<font face="courier new">phil$<br>
</font></font>
<div style=COLOR:#000000>
  &nbsp;
</div>
<div style=COLOR:#000000>
  Then Helen sends Phil the file <font face="'Courier New'">helen@gt.m_pubkey.txt</font> and Phil sends Helen the file <font face="'Courier New'">phil@gt.m_pubkey.txt</font>.
</div>
<div style=COLOR:#000000>
  &nbsp;
</div>
<div style=COLOR:#000000>
  &nbsp;
</div>
<div style=COLOR:#000000>
  Helen imports Phil's public key into her keyring, verifying the fingerprint when she imports it, and signing it to confirm that she has verified the fingerprint:&nbsp;
</div>
<div style=COLOR:#000000>
  &nbsp;
</div>
<div style=COLOR:#000000>
  <font face="Courier New">helen$ $gtm_dist/plugin/gtmcrypt/import_and_sign_key.sh phil@gt.m_pubkey.txt phil@gt.m<br style="FONT-FAMILY:Courier New">
  gpg: key A5719A99: public key "Phil Keyuser &lt;phil@gt.m&gt;" imported</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">gpg: Total number processed: 1</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">gpg: imported: 1</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">#########################################################</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">pub 1024D/A5719A99 2010-05-07</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">Key fingerprint = 886A BAFC E156 A9AD 7EA9 06EA 8B8B 9FAC A571 9A99</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">uid Phil Keyuser &lt;phil@gt.m&gt;</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">sub 2048R/AD37D5A0 2010-05-07</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">#########################################################</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">Please confirm validity of the fingerprint above (y/n/[?]): y</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">Passphrase for keyring:</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">Successfully signed public key for phil@gt.m received in phil@gt.m_pubkey.txt</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">helen$</font><br style="FONT-FAMILY:Courier New">
  <br style="FONT-FAMILY:Courier New">
  &nbsp;
</div>
<p style=COLOR:#000000>
  Phil likewise imports, verifies and sign's Helen's public key:
</p>
<div style=COLOR:#000000>
  &nbsp;
</div>
<div style=COLOR:#000000>
  <font face="Courier New">phil$ $gtm_dist/plugin/gtmcrypt/import_and_sign_key.sh helen@gt.m_pubkey.txt helen@gt.m<br style="FONT-FAMILY:Courier New">
  gpg: key BC4D0739: public key "Helen Keymaster &lt;helen@gt.m&gt;" imported</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">gpg: Total number processed: 1</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">gpg: imported: 1</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">#########################################################</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">pub 1024D/BC4D0739 2010-05-07</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">Key fingerprint = B38B 2427 5921 FFFA 5278 8A91 1F90 4A46 BC4D 0739 uid Helen Keymaster &lt;helen@gt.m&gt;</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">sub 2048R/A2E8A8E8 2010-05-07</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">#########################################################</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">Please confirm validity of the fingerprint above (y/n/[?]): y</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">Passphrase for keyring:</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">Successfully signed public key for helen@gt.m received in helen@gt.m_pubkey.txt</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">phil$</font><br>
  <br>
  Helen and Phil can now securely exchange information.
</div>
<div style=COLOR:#000000>
  &nbsp;
</div>
<p style=COLOR:#000000>
  Helen generates a symmetric cipher key for the new database file cust.dat:
</p>
<p style=COLOR:#000000>
  &nbsp;
</p>
<div style=COLOR:#000000>
  <font face="Courier New">helen$ $gtm_dist/plugin/gtmcrypt/gen_sym_key.sh 2 helen_cust_dat.txt<br style="FONT-FAMILY:Courier New">
  helen$</font>
</div>
<div style=COLOR:#000000>
  &nbsp;
</div>
<div style=COLOR:#000000>
  Then she encrypts the symmetric cipher key with Phil's public key, signs it, and produces a file phil_cust_dat.txt that she can send Phil:
</div>
<div style=COLOR:#000000>
  &nbsp;
</div>
<div style=COLOR:#000000>
  <font face="Courier New">helen$ $gtm_dist/plugin/gtmcrypt/encrypt_sign_db_key.sh helen_cust_dat.txt phil_cust_dat.txt phil@gt.m<br style="FONT-FAMILY:Courier New">
  Passphrase for keyring:</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">gpg: checking the trustdb</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">gpg: depth: 0 valid: 1 signed: 1 trust: 0-, 0q, 0n, 0m, 0f, 1u</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">gpg: depth: 1 valid: 1 signed: 0 trust: 1-, 0q, 0n, 0m, 0f, 0u</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">helen$</font>
</div>
&nbsp;
<div style=COLOR:#000000>
  Phil adds the key in <font face="courier new">phil_cust_dat.txt</font> to his master key file <font face="'Courier New'">$HOME/</font><font face="courier new">.gtm_dbkeys</font>:<br>
  <font face="courier new">phil$ export gtm_dbkeys=$HOME/.gtm_dbkeys</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">phil$ $gtm_dist/plugin/gtmcrypt/add_db_key.sh $PWD/gtm.dat phil_cust_dat.txt $gtm_dbkeys</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">phil$</font>
</div>
<div style=COLOR:#000000>
  &nbsp;
</div>
<div style=COLOR:#000000>
  <font size=2>Phil creates a global directory, where he changes the configuration parameter for the database file cust.dat specifying that it be encrypted the next time it is created. &nbsp;(Remember that except for mapping from global variable names to database file names, configuration parameters in the global directory are used only when MUPIP creates new database files.) &nbsp;He then creates the database file, runs a DSE dump fileheader to extract the hash (highlighted in the output), and sends it to Helen for verification (notice that MUPIP CREATE generates an error for the <font face="'Courier New'">mumps.dat</font> file that exists already, but creates a new encrypted <font face="'Courier New'">cust.dat</font> file):</font>
</div>
<div style=COLOR:#000000>
  &nbsp;
</div>
<div style=COLOR:#000000>
  <font face="Courier New">phil$ export gtmgbldir=gtm.gld<br style="FONT-FAMILY:Courier New">
  phil$ export gtm_passwd=""</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">phil$ $gtm_dist/mumps -dir</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">Enter Passphrase:</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">GTM&gt;zsystem "$gtm_dist/mumps -run GDE"</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">%GDE-I-LOADGD, Loading Global Directory file</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">/var/myApp/databases/gtm.gld</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">%GDE-I-VERIFY, Verification OK</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">GDE&gt; change -segment DEFAULT -encryption</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">GDE&gt; exit</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">%GDE-I-VERIFY, Verification OK</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">%GDE-I-GDUPDATE, Updating Global Directory file</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">/var/myApp/databases/gtm.gld</font><br style="FONT-FAMILY:Courier New">
  <br style="FONT-FAMILY:Courier New">
  <font face="courier new">GTM&gt;zsystem "$gtm_dist/mupip create"</font><br style="FONT-FAMILY:Courier New">
  <font face="courier new">Created file /var/myApp/databases/gtm.dat</font><br style="FONT-FAMILY:Courier New">
  <font face="'Courier New'"><font size=2>Error opening file /var/myMpp/databases/mumps.dat</font></font>
</div>
<p style=COLOR:#000000>
  <font face="'Courier New'"><font size=2>: File exists</font></font>
</p>
<p style=COLOR:#000000>
  <font face="'Courier New'"><font size=2>%GTM-F-DBNOCRE, Not all specified database files, or their associated journal files were created</font></font>
</p>
<div style=COLOR:#000000>
  &nbsp;
</div>
<p style=COLOR:#000000>
  <font face="'Courier New'"><font size=2>GTM&gt;zsystem "dse"</font></font>
</p>
<div style=COLOR:#000000>
  &nbsp;
</div>
<p style=COLOR:#000000>
  <font face="'Courier New'"><font size=2>File &nbsp; &nbsp;/var/myApp/databases/cust.dat</font></font>
</p>
<p style=COLOR:#000000>
  <font face="'Courier New'"><font size=2>Region &nbsp;CUST</font></font>
</p>
<div style=COLOR:#000000>
  &nbsp;
</div>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>DSE&gt; dump -fileheader -all</font>
</p>
<div style="COLOR:#000000;FONT-FAMILY:Courier New">
  &nbsp;
</div>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>File &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/var/myApp/databases/cust.dat</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>Region &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CUST</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>Date/Time &nbsp; &nbsp; &nbsp; 04-MAY-2010 11:24:10 [$H = 61850,41050]</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Access method &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;BG &nbsp;Global Buffers &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1024</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Reserved Bytes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp;Block size (in bytes) &nbsp; &nbsp; &nbsp; &nbsp; 1024</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Maximum record size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 256 &nbsp;Starting VBN &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 129</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Maximum key size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 64 &nbsp;Total blocks &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x00000065</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Null subscripts &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NEVER &nbsp;Free blocks &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x00000062</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Standard Null Collation &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FALSE &nbsp;Free space &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x00000000</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Last Record Backup &nbsp; &nbsp; 0x0000000000000001 &nbsp;Extension Count &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;100</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Last Database Backup &nbsp; 0x0000000000000001 &nbsp;Number of local maps &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Last Bytestream Backup 0x0000000000000001 &nbsp;Lock space &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x00000028</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;In critical section &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x00000000 &nbsp;Timers pending &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Cache freeze id &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x00000000 &nbsp;Flush timer &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00:00:01:00</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Freeze match &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x00000000 &nbsp;Flush trigger &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;960</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Current transaction &nbsp; &nbsp;0x0000000000000001 &nbsp;No. of writes/flush &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Maximum TN &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0xFFFFFFFFE3FFFFFF &nbsp;Certified for Upgrade to &nbsp; &nbsp; &nbsp; &nbsp;V5</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Maximum TN Warn &nbsp; &nbsp; &nbsp; &nbsp;0xFFFFFFFF73FFFFFF &nbsp;Desired DB Format &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; V5</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Master Bitmap Size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;112 &nbsp;Blocks to Upgrade &nbsp; &nbsp; &nbsp; 0x00000000</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Create in progress &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FALSE &nbsp;Modified cache blocks &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Reference count &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 &nbsp;Wait Disk &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 0</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp; Journal State &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DISABLED</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Mutex Hard Spin Count &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 128 &nbsp;Mutex Sleep Spin Count &nbsp; &nbsp; &nbsp; &nbsp; 128</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Mutex Spin Sleep Time &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2048 &nbsp;KILLs in progress &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Replication State &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OFF&nbsp; Region Seqno &nbsp; &nbsp;0x0000000000000001</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Zqgblmod Seqno &nbsp; &nbsp; &nbsp; &nbsp; 0x0000000000000000 &nbsp;Zqgblmod Trans &nbsp;0x0000000000000000</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Endian Format &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LITTLE &nbsp;Commit Wait Spin Count &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;16</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Database file encrypted &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TRUE</font>
</p>
<div style="COLOR:#000000;FONT-FAMILY:Courier New">
  &nbsp;
</div>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Dualsite Resync Seqno &nbsp;0x0000000000000001 &nbsp;DB Current Minor Version &nbsp; &nbsp; &nbsp; &nbsp; 8</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Blks Last Record Backup &nbsp; &nbsp; &nbsp; &nbsp;0x00000000 &nbsp;Last GT.M Minor Version &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Blks Last Stream Backup &nbsp; &nbsp; &nbsp; &nbsp;0x00000000 &nbsp;DB Creation Version &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; V5</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Blks Last Comprehensive Backup 0x00000000 &nbsp;DB Creation Minor Version &nbsp; &nbsp; &nbsp; &nbsp;8</font>
</p>
<div style="COLOR:#000000;FONT-FAMILY:Courier New">
  &nbsp;
</div>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Total Global Buffers &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x00000400 &nbsp;Phase2 commit pid count 0x00000000</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Dirty Global Buffers &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x00000000 &nbsp;Write cache timer count 0xFFFFFFFF</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Free &nbsp;Global Buffers &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x00000400 &nbsp;wcs_wtstart pid count &nbsp; 0x00000000</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Write Cache is Blocked &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FALSE &nbsp;wcs_wtstart intent cnt &nbsp;0x00000000</font>
</p>
<div style="COLOR:#000000;FONT-FAMILY:Courier New">
  &nbsp;
</div>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Actual kills in progress &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp;Abandoned Kills &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Process(es) inhibiting KILLs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0</font>
</p>
<div style="COLOR:#000000;FONT-FAMILY:Courier New">
  &nbsp;
</div>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;DB Trigger cycle of ^#t &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</font>
</p>
<div style="COLOR:#000000;FONT-FAMILY:Courier New">
  &nbsp;
</div>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;MM defer_time &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</font>
</p>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Database file encryption hash &nbsp;12D119C93E28BBA9389C6A7FD53C2373CFF7181DF48FEF213523B7B38199EF18B4BADB232D30CBDA2DBFC5F85D97D7A5C4A3E3D13276DCBB63B30EBDAA6B5DD7</font>
</p>
<div style="COLOR:#000000;FONT-FAMILY:Courier New">
  &nbsp;
</div>
<p style="COLOR:#000000;FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Full Block Writes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OFF &nbsp;Full Block Write Len &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</font>
</p>
<div style="FONT-FAMILY:Courier New">
  &nbsp;
</div>
<div style="FONT-FAMILY:Courier New">
  &nbsp;
</div>
<div style="FONT-FAMILY:Courier New">
  &nbsp;
</div>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;TP blkmod nomod &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;TP blkmod gvcst_srch &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;TP blkmod t_qread &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;TP blkmod tp_tend &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;TP blkmod tp_hist &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0</font>
</p>
<div style="FONT-FAMILY:Courier New">
  &nbsp;
</div>
<div style="FONT-FAMILY:Courier New">
  &nbsp;
</div>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Free blocks &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;992 &nbsp; &nbsp; &nbsp; &nbsp;Backup blocks &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Reformat blocks &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp;Total blocks &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 992</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Shmpool blocked &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FALSE &nbsp; &nbsp; &nbsp; &nbsp;File Offset &nbsp; &nbsp; 0x0000000000000000</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Shmpool crit holder &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp;Backup_errno &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Backup Process ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; &nbsp; &nbsp; &nbsp;Backup TN &nbsp; &nbsp; &nbsp; 0x0000000000000000</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Inc Backup TN &nbsp; 0x0000000000000000 &nbsp; &nbsp; &nbsp; &nbsp;Process Failed &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Allocs since check &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; &nbsp;Backup Image Count &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Temp File: &nbsp; &nbsp;</font>
</p>
<div style="FONT-FAMILY:Courier New">
  &nbsp;
</div>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Database is Fully Upgraded &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: &nbsp;TRUE</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Database WAS ONCE Fully Upgraded from V4 &nbsp;: &nbsp;TRUE</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Blocks to Upgrade subzero(negative) error : 0x00000000</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;TN when Blocks to Upgrade last became 0 &nbsp; : 0x0000000000000000</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;TN when Desired DB Format last changed &nbsp; &nbsp;: 0x0000000000000000</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;TN when REORG upgrd/dwngrd changed dbfmt &nbsp;: 0x0000000000000000</font>
</p>
<div style="FONT-FAMILY:Courier New">
  &nbsp;
</div>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Block Number REORG upgrd/dwngrd will restart from : 0x00000000</font>
</p>
<div style="FONT-FAMILY:Courier New">
  &nbsp;
</div>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Upd reserved area [% global buffers] &nbsp; 50 &nbsp;Avg blks read per 100 records &nbsp;200</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Pre read trigger factor [% upd rsrvd] &nbsp;50 &nbsp;Upd writer trigger [%flshTrgr] &nbsp;33</font>
</p>
<div style="FONT-FAMILY:Courier New">
  &nbsp;
</div>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Snapshot in progress &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FALSE &nbsp; Number of active snapshots &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Snapshot cycle &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp;Active snapshot PID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Snapshot TN &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp;Total blocks &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Free blocks &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp;Process failed &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Failure errno &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 &nbsp;Snapshot shared memory identifier &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-1</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>&nbsp;&nbsp;Snapshot file name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>DSE&gt; exit</font>
</p>
<div style="FONT-FAMILY:Courier New">
  &nbsp;
</div>
<p style="FONT-FAMILY:Courier New">
  <font size=2>GTM&gt;halt</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>$</font>
</p>
<div style="FONT-FAMILY:Courier New">
  <br>
</div>
<div style="FONT-FAMILY:Courier New">
  <br>
  <font face=verdana>Phil calls Helen with the hash, texts her mobile, or sends e-mail. Helen ensures that the hash of the key she generated matches the hash of the database file created by Phil, and communicates her approval to Phil. Phil can now use the database. Either Phil or Helen can provide the key to other users who are authorized to access the database and with whom they have securely exchanged keys.</font><br style=FONT-FAMILY:Verdana>
  <font face=verdana>helen$ $gtm_dist/plugin/gtmcrypt/gen_sym_hash.sh helen_cust_dat.txt</font><br style=FONT-FAMILY:Verdana>
  <br>
  <font color=#000000>Passphrase for keyring:</font><br style=COLOR:#000000>
  <font color=#000000>gpg: encrypted with 2048-bit RSA key, ID A2E8A8E8, created 2010-05-07</font><br style=COLOR:#000000>
  <font color=#000000>"Helen Keymaster &lt;helen@gt.m&gt;"</font><br style=COLOR:#000000>
  <font color=#000000>178E55E32DAD6BFF761BF917412EF31904C8FC9CEF283A26DFCD5E7138F1924C30B8A179F20E3E57ABB055A7150CD5B35B046A676EC7245C07228B5B1A9A4202<br>
  </font><font color=#000000>helen$<br>
  </font>
</div>
<div style="COLOR:#000000;FONT-FAMILY:Courier New">
  &nbsp;
</div>
<div style="COLOR:#000000;FONT-FAMILY:Courier New">
  The encrypted database file cust.dat is now ready for use. &nbsp;That file, all journal files, backups, and binary extracts will all have the same symmetric encryption cipher and key, which means that software libraries that provide that cipher and copies of the key (encrypted with the public keys of all those who are authorized to access them) must be retained as long as there may be any need to access data in that database file, its journal files, extracts and backups.
</div>
<div style=COLOR:#000000>
  &nbsp;
</div>
<div>
  <font color=#000000>The following command sequence diagram illustrates how Helen and Phil operate with one another.</font> &nbsp;
</div>
<div>
  &nbsp;
</div>
<div id=g30v style=TEXT-ALIGN:left>
  <div id=x55l style=TEXT-ALIGN:left>
    <img src="images/dpqq6h6_146f2ddzchr_b.gif" style=HEIGHT:727px;WIDTH:1001px>
  </div>
  <br>
</div>
<br>
<p class=western style="FONT-FAMILY:Courier New">
</p>
<div>
  &nbsp;
</div>
<p>
  <a href="GTM_Database_Encryption.html#toc" id=hu68 target=_self title="Click here to return to the Table of Contents">Return to Table of Contents</a>
</p>
<a href="GTM_Database_Encryption.html#Table_of_Contents_667841659900_6473095264801815" id=qnzw target=_blank title="Click here to return to the Table of Contents"></a>
<p class=western style="FONT-FAMILY:Courier New">
</p>
<h1 class=western>
  <a id=_Tested_Reference_Implementati_45390316285192966 name=_Tested_Reference_Implementati_45390316285192966></a>Tested Reference Implementations
</h1>
<p>
  <font size=2>GT.M database encryption comes with a reference implementation that should work "out of the box" with selected encryption packages.&nbsp; You can use this for your initial development and testing with GT.M database encryption.&nbsp; There are many encryption packages.&nbsp; As discussed earlier, FIS neither endorses nor supports any specific cipher or package.&nbsp; For your production use, y<i>ou</i> take responsibility for choosing, implementing and procuring support for your preferred package.&nbsp; Please remember that a malfunction in your chosen encryption package may result in unrecoverable data and FIS will be unable to help you. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>The <a href="GTM_Database_Encryption.html#Plugin" id=zh0z target=_self title="Click here to move to the Plugin Architecture and Interface section">Plugin Architecture and Interface</a> section below details the reference implementation, which is provided with full source code that you can freely modify for your own use. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>For each platform on which GT.M supports encryption, the following table lists the encryption packages and versions against which FIS tested GT.M. Note that FIS tested GT.M for operation against these packages; FIS did not test the robustness of the encryption packages themselves.&nbsp; </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<table border=1 bordercolor=#000000 cellpadding=8 cellspacing=0 width=702>
  <tbody>
  <tr valign=top>
    <th>
      <p>
        OS (HW)
      </p>
    </th>
    <th>
      <p>
        libgpgme
      </p>
    </th>
    <th>
      <p>
        libgpg-error
      </p>
    </th>
    <th>
      <p>
        <b>libgcrypt / libcrypto</b>
      </p>
    </th>
    <th>
      <p>
        <b>GPG</b>
      </p>
    </th>
  </tr>
  <tr valign=top>
    <td width=177>
      <p>
        Ubuntu 10.04 LTS (x86_64)
      </p>
    </td>
    <td width=75>
      <p>
        1.2.0-1.2
      </p>
    </td>
    <td width=92>
      <p>
        1.6-1
      </p>
    </td>
    <td width=232>
      <p>
        libgcrypt 1.4.4-5
      </p>
    </td>
    <td width=65>
      <div>
        1.4.10-2
      </div>
    </td>
  </tr>
  <tr valign=top>
    <td width=177>
      <p>
        RHEL 5.4 (x86_64)
      </p>
    </td>
    <td width=75>
      <p>
        1.1.6
      </p>
    </td>
    <td width=92>
      <p>
        1.4-2
      </p>
    </td>
    <td width=232>
      <p>
        libgcrypt 1.4.4-5
      </p>
    </td>
    <td width=65>
      <p>
        1.4.5
      </p>
    </td>
  </tr>
  <tr valign=top>
    <td width=177>
      <p>
        RHEL 5.5 (x86)
      </p>
    </td>
    <td width=75>
      <p>
        1.1.6
      </p>
    </td>
    <td width=92>
      <p>
        1.4-2
      </p>
    </td>
    <td width=232>
      <p>
        libgcrypt 1.4.4-5
      </p>
    </td>
    <td width=65>
      <p>
        1.4.5
      </p>
    </td>
  </tr>
  <tr valign=top>
    <td width=177>
      <p>
        RHEL 5.3 (IA64)
      </p>
    </td>
    <td width=75>
      <p>
        1.1.6
      </p>
    </td>
    <td width=92>
      <p>
        1.4-2
      </p>
    </td>
    <td width=232>
      <p>
        libgcrypt 1.4.4-5<br>
      </p>
    </td>
    <td width=65>
      <p>
        1.4.5
      </p>
    </td>
  </tr>
  <tr valign=top>
    <td width=177>
      <p>
        z/OS (zSeries)
      </p>
    </td>
    <td width=75>
      <p>
        1.1.8
      </p>
    </td>
    <td width=92>
      <p>
        1.7
      </p>
    </td>
    <td width=232>
      <p>
        libgcrypt 1.4.4
      </p>
    </td>
    <td width=65>
      <p>
        1.4.9
      </p>
    </td>
  </tr>
  <tr valign=top>
    <td width=177>
      <p>
        AIX 5.3 (pSeries)
      </p>
    </td>
    <td width=75>
      <p>
        1.1.8 + fix
      </p>
    </td>
    <td width=92>
      <p>
        1.7
      </p>
    </td>
    <td width=232>
      <p>
        libcrypto from openssl 0.9.8k
      </p>
    </td>
    <td width=65>
      <p>
        1.4.9
      </p>
    </td>
  </tr>
  <tr valign=top>
    <td width=177>
      <p>
        Solaris 9 and 10 (SPARC)
      </p>
    </td>
    <td width=75>
      <p>
        1.1.4 + fix
      </p>
      <div>
        &nbsp;
      </div>
    </td>
    <td width=92>
      <p>
        1.6
      </p>
    </td>
    <td width=232>
      <p>
        libgcrypt 1.4.1
      </p>
    </td>
    <td width=65>
      <p>
        1.4.9
      </p>
    </td>
  </tr>
  <tr valign=top>
    <td width=177>
      <p>
        HP-UX 11.31 (IA64)
      </p>
    </td>
    <td width=75>
      <p>
        1.1.8 + fix
      </p>
    </td>
    <td width=92>
      <p>
        1.7
      </p>
    </td>
    <td width=232>
      <p>
        libgcrypt 1.4.1
      </p>
    </td>
    <td width=65>
      <p>
        1.4.9&nbsp;
      </p>
    </td>
  </tr>
  <tr>
    <td width=177>
      SLES 11 (x86_64)<br>
    </td>
    <td width=75>
      1.1.6-25.30<br>
    </td>
    <td width=92>
      1.6-8.6<br>
    </td>
    <td width=232>
      libgcrypt 1.4.4-2.2<br>
    </td>
    <td width=65>
      2.0.9-25.25.1<br>
    </td>
  </tr>
  <tr>
    <td width=177>
      SLES 11 (s390x)
    </td>
    <td width=75>
      1.1.6-25.30
    </td>
    <td width=92>
      1.6-8.6
    </td>
    <td width=232>
      libgcrypt 1.4.1-6.7
    </td>
    <td width=65>
      2.0.9-25.25.1
    </td>
  </tr>
  <tr>
    <td width=177>
      SLES 10 (<font color=#000000>s390x</font><font face=Verdana>)</font>
    </td>
    <td style=COLOR:#000000 width=75>
      1.0.3-16.2
    </td>
    <td style=COLOR:#000000 width=92>
      1.0-16.2
    </td>
    <td style=COLOR:#000000 width=232>
      libgcrypt 1.2.2-13.2
    </td>
    <td style=COLOR:#000000 width=65>
      1.4.9-6.1
    </td>
  </tr>
  </tbody>
</table>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  Where the table lists a package version number followed by "+ fix" it means that in the process of testing, we identified issues with the package that we fixed.&nbsp; We have provided the source code for our fixes to the upstream package maintainers.&nbsp; If you have a support agreement with FIS, we will share that source code with you, upon request.
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  The reference implementation uses:
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<ul>
  <li>
    The key ring on disk implemented by GPG.
  </li>
  <li>
    <p>
      For public key encryption including the generation of public/private key pairs: RSA as implemented by GPG.
    </p>
  </li>
  <li>
    <p>
      For the cryptographic hash: SHA-512.
    </p>
  </li>
  <li>
    <p>
      For a programmatic interface to GPG: libgpgme.
    </p>
  </li>
  <li>
    <p>
      To provide error messages for GPG: libgpg-error.
    </p>
  </li>
  <li>
    <p>
      For symmetric encryption: AES 256 CFB implemented by libgcrypt on all platforms except AIX; Blowfish CFB implemented by libcrypto on AIX.
    </p>
  </li>
</ul>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  The reference implementation for AIX differs from other platforms because of certain limitations in libgcrypt as of the date of the initial release of GT.M database encryption as a consequence of the port of libgcrypt to the 64-bit environment being less mature than its port to the 32-bit environment (GT.M on AIX is a 64-bit application). Also, Blowfish is used because the implementation of AES on libcrypto from openssl requires data to be in chunks that are multiples of 16 bytes. It is possible that these limitations may no longer be an issue at such time when you consider AES on libgcrypt for your use. Nevertheless it serves to demonstrate that the plug-in architecture works with two different libraries. Note: this means that database files encrypted by the reference implementation are incompatible between AIX and other UNIX platforms.
</p>
<br>
<p>
  The sample shell scripts in the reference implementation use the standard shell (/bin/sh).
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<ul>
  <li>
    During development, in a core dump, FIS noticed a decrypted symmetric database key in buffer released by libgpgme despite the fact that GT.M made an appropriate call to the library to destroy the key. We have communicated this to the upstream developers. This emphasizes again the desirability of strong random numbers as database keys as well as the disabling of core dumps except when required. These strong keys can be created using the <font face="courier new">gen_sym_key.sh</font> script described in the "Key Management" section.
  </li>
</ul>
<div>
  &nbsp;
</div>
<p>
  <a href="GTM_Database_Encryption.html#toc" id=h3_z target=_self title="Click here to return to the Table of Contents">Return to Table of Contents</a>
</p>
<h1 class=western>
  <a id=Special_note_Gnu_Privacy_Guard_2709869872778654 name=Special_note_Gnu_Privacy_Guard_2709869872778654></a>Special note - Gnu Privacy Guard version 2
</h1>
<div>
  For the most part GPG version 2 is upward compatible with GPG version 1. &nbsp;An important difference between the two is that when GPG v2 invoked via GPGME (such as for example with a JOB command or a command such as ZSYSTEM "mupip create"), there is not a convenient way to avoid invoking an "agent" (by default in <font face="'Courier New'">/</font><font face="'Courier New'">usr</font><font face="'Courier New'">/bin/</font><font face="'Courier New'">pinentry</font>) that obtains the passphrase for the keyring from the user. &nbsp;When the reference implementation has placed an obfuscated password in the environment, the password should be derived from that obfuscated password, and the user should not be prompted for the password. &nbsp; The solution is to create a GT.M pinentry function (packaged in <font face="'Courier New'">pinentry</font><font face="'Courier New'">-</font><font face="'Courier New'">gtm</font><font face="'Courier New'">.sh</font> and <font face="'Courier New'">pinentry</font><font face="'Courier New'">.m</font>).&nbsp;<br>
  <br>
  When the <font face="'Courier New'">gen_</font><font face="'Courier New'">keypair</font><font face="'Courier New'">.sh</font> script is executed, it creates a file <font face="'Courier New'">gpg</font><font face="'Courier New'">-agent.</font><font face="'Courier New'">conf</font> in the GnuPG directory (<font face="'Courier New'">~/.</font><font face="'Courier New'">gnupg</font> or specified by the environment variable <font face="'Courier New'">$</font><font face="'Courier New'">GNUPGHOME</font>) with the line such as <font face="'Courier New'">pinentry</font><font face="'Courier New'">-program /usr/lib/fis-gtm/V5.4-000_x86/plugin/gtmcrypt/pinetry-gtm.sh</font> which causes <font face="'Courier New'">/usr/lib/fis-gtm/V5.4-000_x86/plugin/gtmcrypt/pinetry-gtm.sh</font> to be invoked by GnuPG v2 as the pinentry program. &nbsp;If the script finds the environment variable <font face="'Courier New'">$</font><font face="'Courier New'">gtm</font><font face="'Courier New'">_</font><font face="'Courier New'">passwd</font> to be set, and as well as an executable GT.M, it runs the <font face="'Courier New'">pinentry</font><font face="'Courier New'">.m</font> program which provides GnuPG v2 with the keyring password from the obfuscated password. &nbsp;Otherwise, it calls <font face="'Courier New'">/</font><font face="'Courier New'">usr</font><font face="'Courier New'">/bin/</font><font face="'Courier New'">pinentry</font>.&nbsp;<br>
  <br>
  If you are using GnuPG v2 with a <font face="'Courier New'">.gnupg</font> directory not created by <font face="'Courier New'">gen_</font><font face="'Courier New'">keypair</font><font face="'Courier New'">.sh</font>, you should create a <font face="'Courier New'">gpg</font><font face="'Courier New'">-agent.</font><font face="'Courier New'">conf</font> as described here, substituting the directory where GT.M is actually installed.<br>
  <br>
  The GT.M pinentry function should not be used while changing the keyring passphrase, e.g., the passwd subcommand of the gpg --edit-key command. One way to do this is to temporarily comment out the the pinentry-program line in gpg-agent.conf by placing a "#" in front of the line, e.g.:<br>
  #<font face="'Courier New'">/usr/lib/fis-gtm/V5.4-000_x86/plugin/gtmcrypt/pinetry-gtm.sh</font>
</div>
<div>
  &nbsp;
</div>
<div>
  <font color=#0000ee><a href="GTM_Database_Encryption.html#Revision_History_5023846650535" id=fm2z target=_self title="Return to Table of Contents">Return to Table of Contents</a></font>
</div>
<h1 class=western>
  <a id=Installation_5668624513782561_ name=Installation_5668624513782561_></a>Installation
</h1>
<p>
  <font size=2>The normal GT.M installation script (invoked by </font><font face="courier new" size=2>sh ./configure</font><font size=2> executed as root or with </font><font face="courier new" size=2>sudo sh ./configure</font><font size=2> in the directory in which you have unpacked the GT.M distribution) will automatically install GT.M with the reference implementation plug-in. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<font size=2>If the encryption libraries are not part of the automatic search path on your system, you will need to take action specific to your operating system and directory structure to make them accessible. For example, you may need to set one of the environment variables </font><font face="courier new" size=2>$LD_LIBRARY_PATH</font><font size=2> or </font><font face="courier new" size=2>$LIBPATH</font><font size=2>, for example: </font><font face="courier new" size=2>export LIBPATH="/lib:/usr/lib:/usr/local/lib"</font><font face=verdana size=2> and/or run the </font><font face="courier new" size=2>ldconfig</font><font face=verdana size=2> command.</font>
<p>
</p>
<div>
  &nbsp;
</div>
<p style=FONT-FAMILY:Verdana>
  <font size=2>You must also implement appropriate key management, including ensuring that users have appropriate values for </font><font face="courier new" size=2>$gtm_dbkeys</font><font size=2>. </font>
</p>
<p style=FONT-FAMILY:Verdana>
</p>
<div>
  &nbsp;
</div>
<p style=FONT-FAMILY:Verdana>
  <font size=2>The </font><font face="courier new" size=2>$gtm_dist/plugin</font><font size=2> directory is configured such that you can copy it to a location of your choice to customize your own encryption plug-in. After testing, simply replace the directory as distributed with your customized directory. </font>
</p>
<div>
  &nbsp;
</div>
<p class=western style="FONT-FAMILY:Courier New">
</p>
<div>
  &nbsp;
</div>
<p>
  <a href="GTM_Database_Encryption.html#toc" id=z5l6 target=_self title="Click here to return to the Table of Contents">Return to Table of Contents</a>
</p>
<p style=FONT-FAMILY:Verdana>
</p>
<h1 class=western>
  <a id=Administration_and_Operation_o name=Administration_and_Operation_o></a>Administration and Operation of Encrypted Databases
</h1>
<p>
  <font size=2>Utility programs written in M (such as </font><font face="courier new" size=2>%GO</font><font size=2>) run within mumps processes and behave like any other code written in M.&nbsp; Encryption keys are required if the mumps process accesses encrypted databases. A process running a utility program written in M that does not access encrypted databases (such as </font><font face="courier new" size=2>%RSEL</font><font size=2>) does not need encryption keys just to run the utility program. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Utility programs not written in M (e.g., MUPIP) that need access to encryption keys do not prompt for the password to the key ring on disk. They require the obfuscated password to be available in the environment.&nbsp; You can use the </font><font face="courier new" size=2>maskpass</font><font size=2> program to set the password in the environment or a mumps wrapper process as discussed earlier to set the obfuscated password in the environment. In some cases, if a required key is not supplied, or if an incorrect key is specified, the utility program defers reporting the error at process start up in case subsequent actions don't require access to encrypted data, and instead reports it when first attempting an encryption or decryption operation. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Since they do not access application data at rest, the GDE and LKE uitlities do not need access to encryption keys to operate with encrypted databases. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>MUPIP and DSE use the same plug-in architecture as mumps processes a?? </font><font face="courier new" size=2>gtmcrypt_init()</font><font size=2> to acquire keys, </font><font face="courier new" size=2>gtmcrypt_encode()</font><font size=2> to encode, etc.</font>
</p>
<h2 class=western>
  <a id=Changes_to_Utility_Programs_19 name=Changes_to_Utility_Programs_19></a>Changes to Utility Programs
</h2>
<h3 class=western>
  <a id=GDE_5343911794403601_359343896_07336544990539551 name=GDE_5343911794403601_359343896_07336544990539551></a>GDE
</h3>
<p>
  <font size=2>Since the global directory file is never encrypted, GDE does not need access to encryption keys. </font>
</p>
<h4 class=western>
  <a id=Format_Upgrade_523012131322851 name=Format_Upgrade_523012131322851></a>Format / Upgrade
</h4>
<div>
  <font size=2>The need to support encryption brings an upgrade to the global directory format, whether or not you use encryption. Simply opening an existing global directory with GDE and closing the program with an EXIT command upgrades the global directory. </font>
</div>
<p>
</p>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <p>
      <font size=2>FIS strongly recommends you make a copy of any global directory before upgrading it. There is no way to downgrade a global directory a?? you need to recreate it. </font>
    </p>
  </li>
</ul>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>If you inadvertently upgrade a global directory to the new format and wish to recreate the old global directory, execute the SHOW ALL command with the new GT.M release and capture the output. Use the information in the SHOW ALL command to create a new global directory file with the prior GT.M release, or better yet, create a script that you can feed to GDE to create a new global directory. </font>
</p>
<h4 class=western>
  <a id=New_functionality_462391285558 name=New_functionality_462391285558></a>New functionality
</h4>
<p>
  <font face="courier new" size=2>-</font><font size=2><font face="courier new">[</font></font><font face="courier new" size=2>NO</font><font size=2><font face="courier new">]</font></font><font face="courier new" size=2>ENcryption</font><font size=2> is <font color=#000000>now </font>a SEGMENT qualifier. When creating the database file for a segment that is flagged as encrypted, MUPIP CREATE acquires an encryption key for that file, and puts a cryptographic hash of the key in the database file header. </font>
</p>
<h3 class=western>
  <a id=MUPIP_09699687153894765_171711_5764062218368053 name=MUPIP_09699687153894765_171711_5764062218368053></a>MUPIP
</h3>
<p>
  <font size=2>Except for the following commands where it does not need encryption keys to operate on encrypted databases, MUPIP needs access to encryption keys to operate on encrypted databases: BACKUP -BYTESTREAM, EXIT, EXTEND, FTOK, HELP, INTRPT, REPLICATE, RUNDOWN, STOP.&nbsp; MUPIP looks for the password for the key ring on disk in the environment variable </font><font face="courier new" size=2>$gtm_passwd</font><font size=2>, terminating with an error if it is unable to get a matching key for any database, journal, backup or extract file that contains encrypted data. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Note: </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <p>
      <font size=2>MUPIP JOURNAL operations that only operate on the journal file without requiring access to the database - EXTRACT and SHOW - require only the key for the journal file, not the current database file key. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>MUPIP SET operations that require stand-alone access to the database do not need encryption keys; any command that can operate with concurrent access to the database requires encryption keys. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>All other MUPIP operations require access to database encryption keys. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>MUPIP EXTRACT -FORMAT=ZWRITE or -FORMAT=GLO and MUPIP JOURNAL -EXTRACT are intended to produce readable database content, and produce cleartext output even when database and journal files are encrypted. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>Since a MUPIP EXTRACT -FORMAT=BINARY extract file can contain encrypted data from multiple database files, the extract file contains the hashes for all database files from which extracted data was obtained. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>An encrypted database cannot be downgraded to GT.M version 4 (V4) format. </font>
    </p>
  </li>
</ul>
<h4 class=western>
  <a id=MUPIP_CREATE_8079332672625914__4654939016327262 name=MUPIP_CREATE_8079332672625914__4654939016327262></a>MUPIP CREATE
</h4>
<p>
  <font size=2>MUPIP CREATE is the only command that uses the </font><font face="arial narrow" size=2>database_filename</font><font size=2> in the master key file to obtain the key from the corresponding </font><font face="arial narrow" size=2>key_filename</font><font size=2>.&nbsp; As discussed elsewhere, all other commands use the key from the key ring in memory that matches the cryptographic hash for the encrypted data.&nbsp; If there are multiple files with the same file name, MUPIP CREATE uses the key specified in the <i>last</i> </font><font face="arial narrow" size=2>database_filename</font><font size=2> entry with that name in the master key file.</font>
</p>
<h4 class=western>
  <a id=MUPIP_JOURNAL_0763167179923848 name=MUPIP_JOURNAL_0763167179923848></a>MUPIP JOURNAL
</h4>
<p>
  <font size=2>The MUPIP JOURNAL -SHOW command now displays the cryptographic hash of the symmetric key stored in the journal file header (the output is one long line): </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p style="FONT-FAMILY:Courier New;MARGIN-LEFT:0.5in">
  <font size=2>$ mupip journal -show -backward mumps.mjl 2&gt;&amp;1 | grep hash </font>
</p>
<div>
  <font size=2>Journal file hash F226703EC502E9757848EEC733E1C3CABE5AC146C60F922D0E7D7CB5E2A37ABA005CE98D908B219249A0464F5BB622B72F5FDA0FDF04C8ECE52A4261975B89A2</font>
</div>
<div>
  <font size=2>$</font>
</div>
<h4 class=western>
  <a id=MUPIP_LOAD_8810755726116727_82_13880341965705156 name=MUPIP_LOAD_8810755726116727_82_13880341965705156></a>MUPIP LOAD
</h4>
<p style=FONT-STYLE:normal>
  <font size=2>Since an extract may contain the cryptographic hashes of multiple database files from which the data has been extracted, MUPIP LOAD may require multiple keys even to load one database file.&nbsp; Additionally, the database file into which the data is being loaded may have a different key from any data in the extract. </font>
</p>
<h3 class=western>
  <a id=DSE_5189308532820321_670505968_20174990594387054 name=DSE_5189308532820321_670505968_20174990594387054></a>DSE
</h3>
<p>
  <font size=2><i>Unless you are acting under the specific instructions of FIS GT.M support, please provide DSE with access to encryption keys by setting the value of <font face="courier new">$gtm_passwd</font> in the environment.</i></font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>DSE operations that operate on the file header (such as CHANGE -FILEHEADER) do not need access to database encryption keys, whereas DSE operations that access data blocks (such as DUMP -BLOCK) usually require access to encryption keys. However, all DSE operations potentially require access to encryption keys because if DSE is the last process to exit a database, it will need to flush dirty global buffers, for which it will need the encryption keys. &nbsp;DSE does not encrypt block dumps. There is a current misfeature, that access to the database key is needed to look at block 0 (a bitmap).&nbsp; In practical usage this is not a severe restriction since typically when a bitmap is examined data records are also examined (which require the key anyway). </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Please remember that DSE is a low level utility for use by knowledgeable users, and does not check for reasonableness of commands and values. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p style=FONT-FAMILY:Verdana>
  <font size=2>The DSE DUMP -FILEHEADER -ALL command shows the database file header, including the encryption hash (the hash is a very long line):</font>
</p>
<p style="FONT-FAMILY:Courier New;MARGIN-LEFT:0.5in">
  <font size=2>$ dse dump -fileheader -all 2&gt;&amp;1 | grep hash </font>
</p>
<div>
  <font size=2>Database file encryption hash F226703EC502E9757848EEC733E1C3CABE5AC146C60F922D0E7D7CB5E2A37ABA005CE98D908B219249A0464F5BB622B72F5FDA0FDF04C8ECE52A4261975B89A2</font>
</div>
<div>
  <font size=2>$</font>
</div>
<h4 class=western>
  <a id=Changing_the_hash_in_the_datab name=Changing_the_hash_in_the_datab></a><font face=verdana size=4>Changing the hash in the database file header</font>
</h4>
<p style=FONT-FAMILY:Verdana>
  <font size=2>Under normal operating conditions, you should not need to change the cryptographic hash of the symmetric key.&nbsp; However, since there are theoretical attacks against hashes, and because a new cryptographic hash standard (SHA-3) is under development as of this date, DSE provides the ability to change the hash of the password stored in the database file header if and when you change the hash library.</font>
</p>
<p style=FONT-FAMILY:Verdana>
</p>
<div>
  &nbsp;
</div>
<p style=FONT-FAMILY:Verdana>
  <font size=2>The DSE CHANGE -FILEHEADER -ENCRYPTION_HASH function hashes the symmetric key in the key file and replaces the hash in the database file header with this new value.&nbsp; The procedure to change the hash is:</font>
</p>
<p style=FONT-FAMILY:Verdana>
</p>
<div>
  &nbsp;
</div>
<ul style=FONT-FAMILY:Verdana>
  <li>
    <p>
      <font size=2>With the old hash function linked to your plug-in, ensure that the database is structurally sound with a MUPIP INTEG.&nbsp; Although changing the hash in the file header makes no change to any data block, you will have more confidence in your work, and easier troubleshooting in the event of subsequent problems, if you verify database wholesomeness before proceeding.</font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>Switch the plug-in to use the new hash function.</font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>Execute the DSE CHANGE -FILEHEADER -ENCRYPTION_HASH operation.</font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>Since recovery is not possible with a prior generation journal file with a different hash, if the database is journaled, create a new journal file without a back-pointer using the MUPIP SET -JOURNAL -NOPREVJNL command.&nbsp; FIS suggests backing up the database at this time.</font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>Verify the correctness of the new hash function by reading a global node or with a DSE DUMP -BLOCK command.</font>
    </p>
  </li>
</ul>
<p style=FONT-FAMILY:Verdana>
</p>
<div>
  &nbsp;
</div>
<p style=FONT-FAMILY:Verdana>
  <font size=2>As</font><font size=2> there is no way to change the hash in a journal file header, make sure that you retain access to the hash packages used for any journal file as long as you want the data in old journal files to be accessible.&nbsp; These old journal files with different hashes cannot be used for database recovery.&nbsp; The data in them can, however, be accessed with a MUPIP JOURNAL -EXTRACT command by a MUPIP process using the old hash function.</font>
</p>
<div>
  &nbsp;
</div>
<h2 class=western>
  <a id=Changing_Encryption_Keys_38977 name=Changing_Encryption_Keys_38977></a>Changing Encryption Keys
</h2>
<p>
  <font size=2>The only way to change the encryption key of a database file is to extract the data and load it into a new database file created with a different key.&nbsp; Use a logical multi site (LMS) application configuration to change keys while keeping the application available.&nbsp; For example, if A is initially the initiating (primary) instance and B the replicating (secondary) instance: </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <p>
      <font size=2>Bring down instance B and change the database keys with EXTRACT and LOAD.&nbsp; Remember to save the journal sequence numbers in the original database files, and to set the journal sequence number in all the newly created database files to the largest number in any original database file. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>Bring up instance B and let it catch up with A. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>At a convenient time, switchover.&nbsp; Now application logic executes on B and A is the replicating instance. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>Bring down instance A and change the database keys with either EXTRACT / LOAD or using a backup from B.&nbsp; Then bring it back up and let it catch up. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>To restore the original operating configuration, switchover at a convenient time.&nbsp; Now A again executes application logic which is replicated to B. </font>
    </p>
  </li>
</ul>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>FIS suggests using different encryption keys for different instances, so that if the keys for one instance are compromised, the application can be kept available from another instance whose keys are not compromised, while changing the encryption keys on the instance with compromised keys. </font>
</p>
<h2 class=western>
  <a id=Database_Creation_761204818680 name=Database_Creation_761204818680></a>Database Creation
</h2>
<p>
  <font size=2>Just as there is no way to change the encryption key of a database file, it is not possible to turn on encryption for an unencrypted database file, or to turn it off for an encrypted database file. Once a database file is created, its encryption attributes are immutable.&nbsp; To create an encrypted database, use GDE to specify encryption in the global directory file.&nbsp; Then use MUPIP CREATE to create an encrypted database and MUPIP LOAD to load data into it. </font>
</p>
<div>
  &nbsp;
</div>
<p class=western style="FONT-FAMILY:Courier New">
</p>
<div>
  &nbsp;
</div>
<p>
  <a href="GTM_Database_Encryption.html#toc" id=cc7a target=_self title="Click here to return to the Table of Contents">Return to Table of Contents</a>
</p>
<h1>
  <a id=Plugin_Architecture_Interface_ name=Plugin_Architecture_Interface_></a>Plugin Architecture &amp; Interface
</h1>
<a id=Discussion_of_the_reference_im_01968043204396963 name=Discussion_of_the_reference_im_01968043204396963></a>
<div>
  &nbsp;
</div>
<p style=MARGIN-LEFT:0px;MARGIN-RIGHT:0px>
  <font size=2>As noted in the section&nbsp;<a href="GTM_Database_Encryption.html#Tested_Reference_Implementatio" id=p5ys target=_self title="Click here to go to the Tested Reference Implementations section">Tested Reference Implementations</a>, GT.M includes a reference implementation that uses widely available encryption packages.&nbsp; It is your choice: you can decide to use the packages that FIS tested GT.M against, or you can choose to interface GT.M to another package of your choice.&nbsp; As noted earlier, FIS neither recommends nor supports any specific package (not even those that we test against) and you should ensure that you have confidence in and support for whichever package that you intend to use in production.&nbsp; The reference implementation is provided compiled as ready to run object code as well as source code that you can customize to meet your needs.</font>
</p>
<p style=MARGIN-LEFT:0px;MARGIN-RIGHT:0px>
</p>
<div>
  &nbsp;
</div>
<p style=MARGIN-LEFT:0px;MARGIN-RIGHT:0px>
  <font size=2>Building the reference implementation from source code requires standard development tools for your platform, including C compiler,&nbsp;</font><font face="'courier new'" size=2>make</font><font size=2>,&nbsp;</font><font face="'courier new'" size=2>ld</font><font size=2>, standard header files, header files for encryption libraries, etc.</font>
</p>
<p style=MARGIN-LEFT:0px;MARGIN-RIGHT:0px>
</p>
<div>
  &nbsp;
</div>
<p style=MARGIN-LEFT:0px;MARGIN-RIGHT:0px>
  <font size=2>This section discusses the architecture of and interface between GT.M and the plugin. &nbsp;<i>You must ensure that any plugin you provide presents the same interface to GT.M as the reference implementation.</i></font>
</p>
<h2 class=western>
  <a id=Packaging_7105859128870154_890_34569985792040825 name=Packaging_7105859128870154_890_34569985792040825></a>Packaging
</h2>
<p>
  <font size=2>The reference implementation by default resides in&nbsp;</font><font face="'Courier New'"><font size=2>$gtm_dist/</font></font><font face=verdana,sans-serif><font face="courier new"><font size=2>plugin/gtmcrypt</font></font><font size=2>.</font></font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>The reference implementation includes:</font>
</p>
<p>
  &nbsp;
</p>
<ul>
  <li>
    <p>
      <font size=2>A </font><font face="courier new"><font size=2>$gtm_dist/plugin/gtmcrypt</font></font><font size=2> sub-directory with all source files and scripts.&nbsp; The scripts include those needed to build/install </font><font face="courier new"><font size=2>libgtmcrypt.so</font></font><font size=2> and "helper" scripts, for example, </font><font face="courier new"><font size=2>add_db_key.sh</font></font><font size=2> (see below). </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>The plugin interface that GT.M expects is defined in&nbsp;</font><font face="'Courier New'"><font size=2>gtmcrypt_interface.h</font></font><font size=2>.</font>&nbsp;&nbsp;<i><font size=2>Never modify this file - it defines the interface that the plugin must provide.</font></i>
    </p>
  </li>
  <li>
    <p>
      <font face="courier new"><font size=2>$gtm_dist/plugin/libgtmcrypt.so</font></font><a class=sdfootnoteanc href=http://docs.google.com/Revs?id=dhpr4zmp_21cgr7m7c7&amp;tab=revlist#sdfootnote2sym name=sdfootnote2anc></a><sup><a href="GTM_Database_Encryption.html#FOOTNOTE-6">6</a></sup>&nbsp;<font size=2>&nbsp;is the shared library containing the executables&nbsp;</font><font size=2>which is dynamically linked by GT.M and which in turn calls the encryption packages.&nbsp; If the </font><font face="courier new"><font size=2>$gtm_dist/utf8</font></font><font size=2> directory exists, then it should contain a symbolic link to </font><font face="courier new"><font size=2>../plugin</font></font><font size=2>.</font>
    </p>
  </li>
</ul>
<ul>
  <li>
    <p>
      <font face="courier new"><font size=2><font face=Verdana>Source code is provided in the file </font><font face="'Courier New'">$gtm_dist/plugin/gtmcrypt/source.tar</font><font face=Verdana> which includes&nbsp;</font>build.sh</font></font><font size=2> and </font><font face="courier new"><font size=2>install.sh</font></font><font size=2> scripts to respectively compile and install </font><font face="courier new"><font size=2>libgtmcrypt.so</font></font><font size=2> from the source code</font><font size=2>. </font>
    </p>
  </li>
</ul>
<h2 class=western>
  <a id=Extensions_to_the_GT_M_Externa name=Extensions_to_the_GT_M_Externa></a>Extensions to the GT.M External Interface
</h2>
<p>
  <font size=2>GT.M now provides additional C structure types (in the </font><font face="courier new" size=2>gtmxc_types.h</font><font size=2> file): </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <p>
      <font size=2><font face="courier new">gtmcrypt_key_t</font> a?? a datatype that is a handle to a key.&nbsp; The GT.M database engine itself does not manipulate keys. The plug-in keeps the keys, and provides handles to keys that the GT.M database engine uses to refer to keys. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2><font face="courier new">xc_fileid_ptr_t</font> a?? a pointer to a structure maintained by GT.M to uniquely identify a file.&nbsp; Note that a file may have multiple names a?? not only as a consequence of absolute and relative path names, but also because of symbolic links and also because a file system can be mounted at more than one place in the file name hierarchy.&nbsp; GT.M needs to be able to uniquely identify files. </font>
    </p>
  </li>
</ul>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Although not required to be used by a customized plugin implementation, GT.M provides (and the reference implementation uses) the following functions for uniquely identifying files: </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <p>
      <font face="courier new" size=2>xc_status_t gtm_filename_to_id(xc_string_t *filename, xc_fileid_ptr_t *fileid)</font><font size=2> a?? function that takes a file name and provides the file id structure for that file. </font>
    </p>
  </li>
  <li>
    <p>
      <font face="courier new" size=2>xc_status_t gtm_is_file_identical(xc_fileid_ptr_t fileid1, xc_fileid_ptr_t fileid2)</font><font size=2> a?? function that determines whether two file ids map to the same file. </font>
    </p>
  </li>
  <li>
    <p>
      <font face="courier new" size=2>gtm_xcfileid_free(xc_fileid_ptr_t fileid)</font><font size=2> a?? function to release a file id structure.</font>
    </p>
    <div>
      &nbsp;
    </div>
  </li>
</ul>
<h2 class=western>
  <a id=Operation_9370477335828151_144_3211645195260644 name=Operation_9370477335828151_144_3211645195260644></a>Operation
</h2>
<p style=COLOR:#000000>
  <font size=2>Mumps, MUPIP and DSE processes dynamically link to the plugin interface functions that reside in the shared library.&nbsp; The functions serve as software "shims" to interface with an encryption library such as <a href=http://mcrypt.sourceforge.net/ id=h79l target=_blank title="Click here to visit the mcrypt home page"><font face="Liberation Mono, monospace">libmcrypt</font></a> or <a href=http://gnupg.org/ id=z::y target=_blank title="Click here to visti the GNU Privacy Guard home page">libgpgme / libgcrypt</a>. </font>
</p>
<p style=COLOR:#000000>
</p>
<div style=COLOR:#000000>
  &nbsp;
</div>
<div style=COLOR:#000000>
  <font size=2>The plugin interface functions are: </font>
</div>
<ul style=COLOR:#000000>
  <li>
    <div>
      <font face="courier new" size=2>gtmcrypt_init()</font>
    </div>
  </li>
  <li>
    <div>
      <font face="courier new" size=2>gtmcrypt_getkey_by_name()</font>
    </div>
  </li>
  <li>
    <div>
      <font face="courier new" size=2>gtmcrypt_getkey_by_hash()</font>
    </div>
  </li>
  <li>
    <div>
      <font face="courier new" size=2>gtmcrypt_hash_gen()</font>
    </div>
  </li>
  <li>
    <div>
      <font face="courier new" size=2>gtmcrypt_encode()</font>
    </div>
  </li>
  <li>
    <div>
      <font face="courier new" size=2>gtmcrypt_decode()</font>
    </div>
  </li>
  <li>
    <div>
      <font face="courier new" size=2>gtmcrypt_close()</font>
    </div>
  </li>
  <li>
    <div>
      <font face="courier new" size=2><font face=Verdana>and</font> gtmcrypt_strerror()</font>&nbsp;
    </div>
  </li>
</ul>
<div>
  &nbsp;
</div>
<div>
  <font size=2>A GT.M database consists of multiple database files, each of which has its own encryption key, although you can use the same key for multiple files.&nbsp; Thus, the </font><font face="courier new" size=2>gtmcrypt*</font><font size=2> functions are capable of managing multiple keys for multiple database files.&nbsp; Prototypes for these functions are in </font><font face="courier new" size=2>gtmcrypt_interface.h</font><font size=2>. </font>
</div>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>The core plugin interface functions, all of which return a value of type </font><font face="courier new" size=2>xc_status_t</font><font size=2> are: </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <p>
      <font face="courier new" size=2>gtmcrypt_init()</font><font size=2> performs initialization.&nbsp; If the environment variable </font><font face="courier new" size=2>$gtm_passwd</font><font size=2> exists and has an empty string value, GT.M calls </font><font face="courier new" size=2>gtmcrypt_init()</font><font size=2> before the first M program is loaded; otherwise it calls </font><font face="courier new" size=2>gtmcrypt_init()</font><font size=2> when it attempts the first operation on an encrypted database file. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>Generally, </font><font face="courier new" size=2>gtmcrypt_getkey_by_hash </font><font size=2>or, for MUPIP CREATE, </font><font face="courier new" size=2>gtmcrypt_getkey_by_name</font><font size=2> perform key acquisition, and place the keys where </font><font face="courier new" size=2>gtmcrypt_decode()</font><font size=2> and </font><font face="courier new" size=2>gtmcrypt_encode()</font><font size=2> can find them when they are called. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>Whenever GT.M needs to decode a block of bytes, it calls </font><font face="courier new" size=2>gtmcrypt_decode()</font><font size=2> to decode the encrypted data.&nbsp; <font face=verdana>At the level at which GT.M database encryption operates, it does not matter what the data is a?? numeric data, string data whether in M or UTF-8 mode and whether or not modified by a collation algorithm. Encryption and decryption simply operate on a series of bytes.</font>&nbsp; </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>Whenever GT.M needs to encode a block of bytes, it calls </font><font face="courier new" size=2>gtmcrypt_encode()</font><font size=2> to encode the data. </font>
    </p>
  </li>
  <li>
    <p>
      <font size=2>If encryption has been used (if </font><font face="courier new" size=2>gtmcrypt_init()</font><font size=2> was previously called and returned success), GT.M calls </font><font face="courier new" size=2>gtmcrypt_close()</font><font size=2> at process exit and before generating a core file.&nbsp; </font><font face="courier new" size=2>gtmcrypt_close()</font><font size=2> must erase keys in memory to ensure that no cleartext keys are visible in the core file. </font>
    </p>
  </li>
</ul>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>More detailed descriptions follow. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <p>
      <font face="courier new" size=2>gtmcrypt_key_t *gtmcrypt_getkey_by_name(xc_string_t *filename)</font><font size=2> - </font><font size=2>MUPIP CREATE uses this function to get the key for a database file. </font><font size=2>This function searches for the given filename in the memory key ring and returns a handle to its symmetric cipher key. If there is more than one entry for the given filename , the reference implementation returns the entry matching the last occurrence of that filename in the master key file. </font>
    </p>
  </li>
  <li>
    <p>
      <font face="courier new" size=2>xc_status_t gtmcrypt_hash_gen(gtmcrypt_key_t *key, xc_string_t *hash)</font><font size=2> -&nbsp;</font><font size=2> MUPIP CREATE uses this function to generate a hash from the key</font><font size=2> <font face="Liberation Mono, monospace">then</font></font><font size=2> copies that hash into the database file header. </font><font size=2>The first parameter is a handle to the key and the second parameter points to 256 byte buffer.&nbsp;</font><font size=2> In the event the hash algorithm used provides hashes smaller than 256 bytes, </font><font face="courier new" size=2>gtmcrypt_hash_gen()</font><font size=2> must fill any unused space in the 256 byte buffer with zeros. </font>
    </p>
  </li>
  <li>
    <p>
      <font face="courier new" size=2>gtmcrypt_key_t *gtmcrypt_getkey_by_hash(xc_string_t *hash)</font><font size=2> - </font><font size=2>GT.M uses this function at database file open time to obtain the correct key using its hash from the database file header. </font><font size=2>This function searches for the given hash in the memory key ring and returns a handle to the matching symmetric cipher key.&nbsp; MUPIP LOAD, MUPIP RESTORE, MUPIP EXTRACT, MUPIP JOURNAL and MUPIP BACKUP -BYTESTREAM all use this to find keys corresponding to the current or prior databases from which the files they use for input were derived. </font>
    </p>
  </li>
  <li>
    <p>
      <font face="courier new" size=2>xc_status_t gtmcrypt_encode(gtmcrypt_key_t *key, xc_string_t *inbuf, xc_string_t *outbuf)</font><font size=2> and </font><font face="courier new" size=2>xc_status_t gtmcrypt_decode(gtmcrypt_key_t *key, xc_string_t *inbuf, xc_string_t *outbuf)</font><font size=2>- GT.M uses these functions to encode and decode data. The first parameter is a handle to the symmetric cipher key, the second a pointer to the block of data to encode or decode, and the third a pointer to the resulting block of encoded or decoded data.&nbsp; Using the appropriate key (same key for a symmetric cipher), </font><font face="courier new" size=2>gtmcrypt_decode()</font><font size=2> <i>must</i> be able to decode any data buffer encoded by </font><font face="courier new" size=2>gtmcrypt_encode()</font><font size=2>, otherwise the encrypted data is rendered unrecoverable.<a class=sdfootnoteanc href=http://docs.google.com/Revs?id=dhpr4zmp_21cgr7m7c7&amp;tab=revlist#sdfootnote4sym name=sdfootnote4anc></a><sup><a href="GTM_Database_Encryption.html#FOOTNOTE-7">7</a></sup>&nbsp;&nbsp; As discussed earlier, GT.M requires the encrypted and cleartext versions of a string to have the same length.</font>
    </p>
    <p>
      &nbsp;
    </p>
  </li>
  <li>
    <p>
      <font face="courier new" size=2>char *gtmcrypt_strerror()</font><font size=2> - GT.M uses this function to retrieve addtional error context from the plug-in after the plug-in returns an error status. This function returns a pointer to additional text related to the last error that occurred.&nbsp; GT.M displays this text as part of an error report.&nbsp; In a case where an error has no additional context or description, this function returns a null string. </font>
    </p>
  </li>
</ul>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>The complete source code for reference implementations of these functions is provided</font><font size=2>, licensed under the same terms as GT.M. You are at liberty to modify them to suit your specific GT.M database encryption needs. Check your GT.M license if you wish to consider redistributing your changes to others. </font>
</p>
<div>
  &nbsp;
</div>
<p class=western style="FONT-FAMILY:Courier New">
</p>
<div>
  &nbsp;
</div>
<p>
  <a href="GTM_Database_Encryption.html#toc" id=a2cs target=_self title="Click here to return to the Table of Contents">Return to Table of Contents</a>
</p>
<p>
  &nbsp;
</p>
<h1 class=western>
  <a id=Messages_33553646339864174_746_22597164381295443 name=Messages_33553646339864174_746_22597164381295443></a>Messages
</h1>
<h2>
  <a id=_Messages_common_to_MUMPS_MUPI_4455445986241102 name=_Messages_common_to_MUMPS_MUPI_4455445986241102></a>Messages common to MUMPS, MUPIP and DSE
</h2>
<a id=GTM_E_CRYPTDLNOOPEN_0630927634 name=GTM_E_CRYPTDLNOOPEN_0630927634></a>
<h3>
  <a id=_CRYPTDLNOOPEN_Error_loading_e_030976022593677044 name=_CRYPTDLNOOPEN_Error_loading_e_030976022593677044></a>CRYPTDLNOOPEN, Error loading encryption library. xxxx
</h3>
<p>
  <font size=2>Run Time Error: GT.M failed to load the gtmcrypt plug-in or one of its related libraries. </font>
</p>
<div>
  &nbsp;
</div>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Action: Refer to the accompanying detail (xxxx) and verify that the gtmcrypt plug-in and related libraries are properly installed and that </font><font face="courier new" size=2>$LD_LIBRARY_PATH</font><font face="courier new" size=2> / </font><font face="courier new" size=2>$LIBPATH</font><font size=2> are properly set. </font>
</p>
<h3>
  <a id=_CRYPTHASHGENFAILED_Error_gene_13180778734385967 name=_CRYPTHASHGENFAILED_Error_gene_13180778734385967></a>CRYPTHASHGENFAILED, Error generating encryption hash. xxxx
</h3>
<p>
  <font size=2>Run Time Error: gtmcrypt plug-in reports there is problem with the hash function. </font>
</p>
<div>
  &nbsp;
</div>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Action: Examine the message (xxxx) from the plug-in and take the needed action. </font>
</p>
<h3>
  <a id=_CRYPTINIT_Error_initializing__7881997125223279 name=_CRYPTINIT_Error_initializing__7881997125223279></a>CRYPTINIT, Error initializing encryption library. xxxx
</h3>
<p>
  <font size=2>Run Time Error: The gtmcrypt plug-in reports it is unable to initialize one or more of its related libraries. </font>
</p>
<div>
  &nbsp;
</div>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Action: Examine the detailed message (xxxx) from the plug-in and take appropriate action. </font>
</p>
<h3>
  <a id=_CRYPTJNLWRONGHASH_Encryption__9967091046273708 name=_CRYPTJNLWRONGHASH_Encryption__9967091046273708></a>CRYPTJNLWRONGHASH, Encryption key hash mismatch between journal file jjjj and corresponding database file dddd
</h3>
<p>
  <font size=2>Run Time Error: gtmcrypt plug-in reports the hash of the key in the header of database file dddd does not match the hash stored in the header of journal file jjjj.&nbsp; This is most likely caused by inappropriate operator action such as replacing the current journal file with an older journal file. </font>
</p>
<div>
  &nbsp;
</div>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Action: Correct the error that caused the incorrect journal file to be pointed to by the database file. If the correct journal file has been inadvertently deleted, create new journal files with the -noprevjnl switch.&nbsp; Take a backup as soon as possible thereafter. Depending on your situation, you may need to refresh secondary instances. </font>
</p>
<h3>
  <a id=_CRYPTKEYFETCHFAILED_Cannot_ob_12433350645005703 name=_CRYPTKEYFETCHFAILED_Cannot_ob_12433350645005703></a>CRYPTKEYFETCHFAILED, Cannot obtain encryption key for ffff. xxxx
</h3>
<p>
  <font size=2>Run Time Error: gtmcrypt plug-in reports it was unable to obtain an encryption key for file ffff. </font>
</p>
<div>
  &nbsp;
</div>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Action: Examine the message (xxxx) from the plug-in and take the needed action to allow the proces to locate the correct key for the file.&nbsp; For example, with the reference implementation, verify that</font>
</p>
<ul>
  <li>
    <font size=2>the GPG key ring is in the standard location or is pointed to by the GNUPGHOME environment variable and that the key ring is not corrupt;</font>
  </li>
  <li>
    <font size=2>the master key file is pointed to by the <font face="courier new">$gtm_dbkeys</font> environment variable;</font>
  </li>
  <li>
    <font size=2>an entry in the master key file exists for this file (ffff); </font>
    <div>
      &nbsp;
    </div>
  </li>
  <li>
    <font size=2>the key file pointed to by an entry in the master key file is not corrupt and contains the key for this file;</font>
  </li>
  <li>
    <font size=2>the hash in the database file is correct;</font>
  </li>
  <li>
    <font size=2>the system/user limits allow for the creation of additional processes (libgpgme forks processes);</font>
  </li>
  <li>
    <font size=2>proper permissions exist on the directory paths and files for the database key file, encrypted database key file, and the gpg key ring</font>
  </li>
  <li>
    <font size=2>the libraries in use match those used when the file was created and/or last successfully used. </font>
    <div>
      &nbsp;
    </div>
  </li>
</ul>
<h3>
  <a id=_CRYPTKEYFETCHFAILEDNF_Cannot__22714278008788824 name=_CRYPTKEYFETCHFAILEDNF_Cannot__22714278008788824></a>CRYPTKEYFETCHFAILEDNF, Cannot obtain encryption key. xxxx
</h3>
<p>
  <font size=2>Run Time Error: gtmcrypt plug-in reports it was unable to obtain an encryption key based upon matching the hash of an encryption key. </font>
</p>
<div>
  &nbsp;
</div>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Action: See the actions for CRYPTKEYFETCHFAILED.</font>
</p>
<div>
  &nbsp;
</div>
<h3>
  <a id=_CRYPTNOMM_is_an_encrypted_dat_0488943150267005 name=_CRYPTNOMM_is_an_encrypted_dat_0488943150267005></a>CRYPTNOMM, ffff is an encrypted database. Cannot support MM access method.
</h3>
<p>
  <font size=2>MUPIP or GDE error: This error is triggered by an attempt to mark an MM database as encrypted with GDE or to switch an encrypted database from BG to MM with MUPIP SET.&nbsp; The MM access method is not supported for encrypted databases. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Action: Use the BG access method for encrypted files. </font>
</p>
<h3>
  <a id=_CRYPTNOPSWDINTP_Cannot_prompt_2684801807627082 name=_CRYPTNOPSWDINTP_Cannot_prompt_2684801807627082></a>CRYPTNOPSWDINTP, Cannot prompt for password inside a TP transaction.
</h3>
<p>
  <font size=2>Run-time error: This error occurs if an external call was used to set the <font face="courier new">$gtm_passwd</font> environment variable to the null string after starting GT.M and before the first time an encrypted database file is accessed is within a TP transaction. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<div>
  <font size=2>Action: If possible, set <font face="courier new">$gtm_passwd</font> to the obfuscated password.&nbsp; Otherwise, ensure that any TP transactions have been closed before setting <font face="courier new">$gtm_passwd</font> to the null string.&nbsp; Once that is done, immediately touch a global from an encrypted database, e.g., $DATA(^<font face="arial narrow">someglobal</font>), to ensure the prompting happens before entering another TP transaction. </font>
</div>
<div>
  &nbsp;
</div>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <font size=2>Note: with the reference implementation, it is not considered wholesome programming practice to modify <font face="courier new">$gtm_passwd</font> for a running process other than to set it to the obfuscated password.&nbsp; FIS neither support this practice nor tests for it and you may encounter unexpected results. </font>
  </li>
</ul>
<h3>
  <a id=_CRYPTNOV4_ffff_is_an_encrypte_41717368829995394 name=_CRYPTNOV4_ffff_is_an_encrypte_41717368829995394></a><font size=3>CRYPTNOV4, ffff is an encrypted database. Cannot downgrade(to V4) with Encryption option enabled.&gt;/error/fao=2!/ansi=0 </font>
</h3>
<p>
  <font size=2>MUPIP error: An attempt to downgrade file ffff which is an encrypted database to the V4 (GT.M version 4) format failed because the V4 format does not support encrypted database files. </font>
</p>
<div>
  &nbsp;
</div>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Action: Use the database in the current format.&nbsp; If a V4 format is required, extract the data in the (unencrypted) ZWRite format with MUPIP EXTRACT and load it into a newly created V4 database. </font>
</p>
<h3>
  <a id=_CRYPTOPFAILED_Encrypt_Decrypt_7221491364762187 name=_CRYPTOPFAILED_Encrypt_Decrypt_7221491364762187></a>CRYPTOPFAILED, Encrypt/Decrypt operation failed. xxxx
</h3>
<p>
  <font size=2>Run Time Error: gtmcrypt plug-in reports there is problem with encryption or decryption. </font>
</p>
<div>
  &nbsp;
</div>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Action: Examine the message (xxxx) from the plug-in and take appropriate action.</font>
</p>
<div>
  &nbsp;
</div>
<h3>
  <a id=_WARNING_Currently_number_of_p_27229333855211735 name=_WARNING_Currently_number_of_p_27229333855211735></a>Cannot reset encryption hash in file header while ffff other processes are accessing the database
</h3>
<p>
</p>
<p>
  <font size=2>DSE error: DSE detected that there are still processes using the old encryption key&nbsp; </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>Action: Restart these processes and re run the command to change the encryption hash in the file header </font>
</p>
<div>
  &nbsp;
</div>
<h2 class=western>
  <a id=_Appendix_Reference_Implementa_4077480975538492 name=_Appendix_Reference_Implementa_4077480975538492></a>Appendix a?? Reference Implementation Error messages
</h2>
<font size=2>These error messages are generated by the reference plug-in.&nbsp; If you change the plug-in, the messages will be those generated by your plug-in.&nbsp; Note that the messages from the plug-in (incorrectly) use the term "DB keys file" for the master key file.</font>
<div>
  &nbsp;
</div>
<h3>
  <a id=_Cannot_find_DB_keys_file_path_5653066290542483 name=_Cannot_find_DB_keys_file_path_5653066290542483></a><font color=#000000>Cannot find DB keys file &lt;path&gt;</font>
</h3>
<p>
  <font size=2>Plugin error: The plugin cannot find the master key file. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><font color=#000000>Action: Set the <font face="courier new">$gtm_dbkeys</font> environment variable to point to the correct master key file.</font></font>
</p>
<h3>
  <a id=_Cannot_find_MUMPS_executable__9629705250263214 name=_Cannot_find_MUMPS_executable__9629705250263214></a><font color=#000000>Cannot find MUMPS executable in &lt;path&gt;</font>
</h3>
<p>
  <font size=2>Plugin error: The plugin cannot find the MUMPS executable. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font color=#000000><font size=2>Action: Set the <font face="courier new">$gtm_dist</font> environment variable to the directory containing MUMPS executable.&nbsp; Verify proper permissions for directory path and file.</font> </font>
</p>
<div>
  &nbsp;
</div>
<h3>
  <a id=_Cannot_open_DB_keys_file_path_36404165998101234 name=_Cannot_open_DB_keys_file_path_36404165998101234></a><font color=#000000>Cannot open DB keys file - &lt;path&gt;</font>
</h3>
<p>
  <font size=2>Plugin error: The plugin cannot open the master key file. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><font color=#000000>Action: Verify the master key file exists and there are appropriate authorizations on the directory path and master key file.</font></font>
</p>
<h3>
  <a id=DB_keys_file_of_unknown_file_t_08723996207118034 name=DB_keys_file_of_unknown_file_t_08723996207118034></a><font color=#000000>DB keys file of unknown file type : &lt;path&gt;</font>
</h3>
<p>
  <font size=2>Plugin error: The plugin reports that the master key file is not the proper type file.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><font color=#000000>Action: Point the gtm_dbkeys environment variable to an appropriately formatted master key file.&nbsp;</font></font>
</p>
<h3>
  <a id=Database_file_path_missing_in__6947785494849086 name=Database_file_path_missing_in__6947785494849086></a><font color=#000000>Database file &lt;path&gt; missing in DB keys file or does not exist</font>
</h3>
<p>
  <font size=2>Plugin error: The plugin reports that the master key file does not contain a valid entry pointing to the database file.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><font color=#000000>Action: Create an entry in the master key file for the specified database file, verify that the database file exists and appropriate authorizations exist on the directory and database file name.</font></font>
</p>
<h3>
  <a id=Database_file_path_not_found_6_45892876759171486 name=Database_file_path_not_found_6_45892876759171486></a><font color=#000000>Database file &lt;path&gt; not found</font>
</h3>
<p>
  <font size=2>Plugin error: The plugin is unable to find the specified database file.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><font color=#000000>Action: Verify the database file exists, that a corresponding entry in the master key file points to the database file and that appropriate authorizations exist on the directory path and the database file.</font></font>
</p>
<h3>
  <a id=Encryption_handle_corrupted_49_11620820499956608 name=Encryption_handle_corrupted_49_11620820499956608></a><font color=#000000>Encryption handle corrupted</font>
</h3>
<p>
  <font size=2>Plugin<font color=#000000> error: The plugin detected an internal error.</font></font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><font color=#000000>Action: Indicates there is a communications error between GT.M and the gtmcrypt plug-in.&nbsp; Replace process with undamaged one.&nbsp; Report the entire incident context to your GT.M support channel.&nbsp;</font></font>
</p>
<h3>
  <a id=Encryption_key_file_path_not_f_6825297307223082 name=Encryption_key_file_path_not_f_6825297307223082></a><font color=#000000>Encryption key file &lt;path&gt; not found</font>
</h3>
<p>
  <font size=2>Plugin<font color=#000000> error: The plugin was not able to find the key file on the specified path.</font></font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><font color=#000000>Action: Verify master key file entry for this key file points to the correct path. Verify that the key file itself exists. Verify proper authorizations on directory path and file.</font></font>
</p>
<h3>
  <a id=Encryption_library_has_not_bee_4642745377495885 name=Encryption_library_has_not_bee_4642745377495885></a><font color=#000000>Encryption library has not been initialized</font>
</h3>
<p>
  <font size=2>Plugin error: A gtmcrypt function was called before gtmcrypt_init().</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font color=#000000><font size=2>Action: Call gtmcrypt_init() before calling any other encryption functions.</font> </font>
</p>
<div>
  &nbsp;
</div>
<h3>
  <a id=_Environment_variable_environm_5492731193080544 name=_Environment_variable_environm_5492731193080544></a><font color=#000000>Environment variable &lt;environment_variable&gt; not set</font>
</h3>
<p>
  <font size=2>Plugin error: An environment variable needed by the plugin was not set.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><font color=#000000>Action: Set the environment variable &lt;environment_variable&gt; to its correct value.&nbsp;</font></font>
</p>
<h3>
  <a id=Environment_variable_gtm_dbkey_07528433855623007 name=Environment_variable_gtm_dbkey_07528433855623007></a><font color=#000000>Environment variable gtm_dbkeys set to empty string</font>
</h3>
<p>
  <font size=2>Plugin error: The <font face="courier new">$gtm_dbkeys</font> environment variable was set to the empty string.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><font color=#000000>Recovery Action: Set </font><font face="courier new">$gtm_dbkeys</font><font color=#000000> to point to the master key file.</font></font>
</p>
<div>
  &nbsp;
</div>
<h3>
  <a id=Environment_variable_gtm_dbkey_7043982185423374 name=Environment_variable_gtm_dbkey_7043982185423374></a><font color=#000000>Environment variable gtm_dbkeys undefined. Cannot find &lt;path&gt;/.gtm_dbkeys</font>
</h3>
<p>
  <font size=2>Plugin error: The plugin was unable to locate the master key file.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><font color=#000000>Action: Place the master key file in the users home directory or point the gtm_dbkeys environment variable to the master key file.&nbsp;</font></font>
</p>
<h3>
  <a id=Environment_variable_gtm_passw_9836120177060366 name=Environment_variable_gtm_passw_9836120177060366></a><font color=#000000>Environment variable gtm_passwd set to empty string. Password prompting not allowed for utilities</font>
</h3>
<p>
  <font size=2>Plugin error: The plugin detected that it needed the obfuscated password but the <font face="courier new">$gtm_passwd</font> environment variable was set to the empty string.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><font color=#000000>Action: Use <font face="courier new">maskpass</font> to set <font face="courier new">$gtm_passwd</font> to the obfuscated password prior to invoking </font>MUPIP/DSE, or wrap the invocation with a MUMPS process which will prompt for the password and set the obfuscated password.&nbsp;</font>
</p>
<h3>
  <a id=Error_initializing_GpgME_reaso_9751994758844376 name=Error_initializing_GpgME_reaso_9751994758844376></a><font color=#000000>Error initializing GpgME: &lt;reason_for_error&gt;/&lt;specific_Gpg_ME_error&gt; </font>
</h3>
<p>
  <font size=2>Plugin<font color=#000000> error: libgpgme reported an error to the plugin.</font></font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><font color=#000000>Action: Consult GpgME documentation for the specific error message.&nbsp;</font></font>
</p>
<h3>
  <a id=Error_parsing_database_key_fil_37895991560071707 name=Error_parsing_database_key_fil_37895991560071707></a><font color=#000000>Error parsing database key file. At line &lt;line_number&gt;: No matching 'dat' entry found in &lt;contents_of_line&gt;</font>
</h3>
<p>
  <font size=2>Plugin error: The plugin was unable to find a matching "dat" entry for a "key" entry in the master key file.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font color=#000000><font size=2>Action: Verify that each "key" entry has a corresponding "dat" entry.</font> </font>
</p>
<div>
  &nbsp;
</div>
<h3>
  <a id=_Error_parsing_database_key_fi_10955840535461903 name=_Error_parsing_database_key_fi_10955840535461903></a><font color=#000000>Error parsing database key file. At line &lt;line_number&gt;: &lt;line_contents&gt; does not start with 'dat' / 'key'</font>
</h3>
<p>
  <font size=2>Plugin error: The plugin detected that the master key file was not properly formatted.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><font color=#000000>Action: Verify entries in the master key file start with "dat" or "key".</font></font>
</p>
<h3>
  <a id=Error_parsing_database_key_fil_7676606066524982 name=Error_parsing_database_key_fil_7676606066524982></a><font color=#000000>Error parsing database key file. At line &lt;line_number&gt;: No matching 'key' entry found in &lt;contents_of_line&gt;</font>
</h3>
<p>
  <font size=2>Plugin error: The plugin was not able to find a "key" entry for a "dat" entry.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><font color=#000000>Action: Verify the database file exists, that the corresponding entry in the master key file points to the database file, that appropriate authorizations exist on the directory path and the database file, and that each "dat" entry has a corresponding "key" entry.</font></font>
</p>
<div>
  &nbsp;
</div>
<h3>
  <a id=_Incorrect_password_3069894842_4565364932641387 name=_Incorrect_password_3069894842_4565364932641387></a><font color=#000000>Incorrect password</font>
</h3>
<p>
  <font size=2>Plugin error: The plugin detected that the correct private key password was not supplied.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font color=#000000><font size=2>Action: Provide the correct password.</font> </font>
</p>
<div>
  &nbsp;
</div>
<h3>
  <a id=_libgcrypt_version_mismatch_Ex_15429985988885164 name=_libgcrypt_version_mismatch_Ex_15429985988885164></a><font color=#000000>libgcrypt version mismatch. &lt;version&gt; or higher is required</font>
</h3>
<p>
  <font size=2>Plugin error: The plugin could not locate an appropriate libgcrypt library version.</font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2><font color=#000000>Action: Verify that libgcrypt version greater than or equal to the specified version is installed and in the library search path.</font></font>
</p>
<h3>
  <a id=Matching_encryption_key_hash_n_4526333548128605 name=Matching_encryption_key_hash_n_4526333548128605></a><font color=#000000>Matching encryption key &lt;hash&gt; not found in database key file </font>
</h3>
<p>
  <font size=2>Plugin<font face=verdana><font color=#000000> error: The plugin was not able to find a needed database file key.</font></font></font>
</p>
<p>
  &nbsp;
</p>
<p style=FONT-FAMILY:Verdana>
  <font size=2><font color=#000000>Action: Add an entry for this encryption key.&nbsp; If needed, use DSE DUMP a??FILE a??ALL on all of the database files to find the database file that matches the &lt;hash&gt;.&nbsp; With extracts and backups, multiple database files may have contributed encrypted records. </font></font>
</p>
<h3>
  <a id=_No_entries_found_in_DB_keys_f_5668686674907804 name=_No_entries_found_in_DB_keys_f_5668686674907804></a><font size=3><font color=#000000><font face=verdana>No entries found in DB keys file</font></font></font>
</h3>
<p style=FONT-FAMILY:Verdana>
  <font size=2><font color=#000000>Plugin error: The plugin was unable to find any entries in the master key file.</font></font>
</p>
<p style=FONT-FAMILY:Verdana>
</p>
<div>
  &nbsp;
</div>
<p style=FONT-FAMILY:Verdana>
</p>
<p style=FONT-FAMILY:Verdana>
  <font size=2><font color=#000000>Action: Add entries to the master key file. </font></font>
</p>
<p style=FONT-FAMILY:Verdana>
</p>
<p style=FONT-FAMILY:Verdana>
</p>
<h3>
  <a id=Symmetric_key_path_found_to_be_3280994491651654 name=Symmetric_key_path_found_to_be_3280994491651654></a><font size=3><font color=#000000><font face=verdana>Symmetric key &lt;path&gt; found to be empty</font></font></font>
</h3>
<p style=FONT-FAMILY:Verdana>
  <font size=2>Plugin<font color=#000000> error: The plugin was unable to find a valid encrypted key in the specified file.</font></font>
</p>
<p style=FONT-FAMILY:Verdana>
</p>
<div>
  &nbsp;
</div>
<p style=FONT-FAMILY:Verdana>
  <font size=2><font color=#000000>Action: Create a valid key file</font>.</font>
</p>
<div>
  &nbsp;
</div>
<p class=western style="FONT-FAMILY:Courier New">
</p>
<div>
  &nbsp;
</div>
<p>
  <a href="GTM_Database_Encryption.html#toc" id=c..c target=_self title="Click here to return to the Table of Contents">Return to Table of Contents</a>
</p>
<h1 class=western>
  <a id=Appendix_Building_Encryption_L name=Appendix_Building_Encryption_L></a>Appendix a?? Building Encryption Libraries
</h1>
<p>
  <font size=2>FIS neither encourages nor supports the use of any specific encryption library.&nbsp; In order to be helpful, here is how we created the libraries for testing GT.M in the development environment.&nbsp; </font>
</p>
<h2 class=western>
  <a id=Ubuntu_8_04_LTS_x86_64_4182407 name=Ubuntu_8_04_LTS_x86_64_4182407></a>Ubuntu 8.04 LTS (x86_64)
</h2>
<p>
  <font size=2>Packages were installed from standard repositories using the package manager. </font>
</p>
<h2 class=western>
  <a id=Red_Hat_Enterprise_Linux_5_2_x name=Red_Hat_Enterprise_Linux_5_2_x></a>Red Hat Enterprise Linux 5.4 (x86_64)
</h2>
<p>
  <font size=2>All packages except libgpgme were installed from Red Hat Network.&nbsp; libgpgme was built from source after specifying </font><font face="courier new" size=2>./configure CC=gcc CFLAGS=-m64</font>
</p>
<h2 class=western>
  <a id=Red_Hat_Enterprise_Linux_4_7_x name=Red_Hat_Enterprise_Linux_4_7_x></a>Red Hat Enterprise Linux 5.5 (x86)
</h2>
<p>
  <font size=2>Packages were installed from standard repositories using the package manager.</font>
</p>
<h2 class=western>
  <a id=Red_Hat_Enterprise_Linux_5_3_I name=Red_Hat_Enterprise_Linux_5_3_I></a>Red Hat Enterprise Linux 5.3 (IA64)
</h2>
<p>
  <font size=2>All packages except libgpgme were installed from Red Hat Network.&nbsp; libgpgme was built from source after specifying </font><font face="courier new" size=2>./configure CC=gcc</font>
</p>
<h2 class=western>
  <a id=IBM_z_OS_zSeries_2534768965301 name=IBM_z_OS_zSeries_2534768965301></a>IBM z/OS (zSeries)
</h2>
<font size=2>Warning: The configure scripts for the GnuPG libraries do not generate shared libraries, only static archive libraries.&nbsp; Owing to this limitation, the archive libraries are unpacked and recompiled back into dynamically linked libraries.&nbsp; The following example uses libgpg-error as the target.&nbsp; FIS suggests that you create a temporary directory for each DLL. </font>
<div>
  &nbsp;
</div>
<div style=FONT-FAMILY:Verdana>
  &nbsp;
</div>
<ul>
  <li>
    <font size=2><font face=verdana>Unpack the archive</font> </font><font face="Courier New" size=2><font face=verdana>: </font>ar -x /usr/local/lib/libgpg-error.a</font>
  </li>
  <li>
    <font face="Courier New" size=2><font face=verdana>Link the archive objects into a DLL:</font> xlc -qascii -q64 -W l,DLL -o libgpg-error.dll *.o</font>
  </li>
  <li>
    <font face="Courier New" size=2><font face=verdana>Copy the DLL and side deck file into the destination (assumed to be /usr/local/lib): </font>cp libgpg-error.dll </font><font face="Courier New" size=2>libgpg-error.x </font><font face="Courier New" size=2>/usr/local/lib</font>
  </li>
</ul>
<a id=GPG_ERROR_823455323121752_7036 name=GPG_ERROR_823455323121752_7036></a>
<h3 class=western>
  <a id=_GPG_ERROR_27773333294274327_2_42885679099708796 name=_GPG_ERROR_27773333294274327_2_42885679099708796></a>GPG-ERROR
</h3>
<font size=2>Apply the patch </font><font face="Courier New" size=2>libgpg-error-1.7.patch</font><font size=2> to libgpg-error sources. Then run the configuration and installation steps. </font>
<div>
  &nbsp;
</div>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <font face="courier new" size=2>./configure CC=xlc CFLAGS=<span class=code-quote>"-qchars=signed -qascii -q64 -qlanglvl=extc99 -qexportall -qrent -qnocsect -W l,DLL -D_XOPEN_SOURCE=600 -D_ENHANCED_ASCII_EXT=0xFFFFFFFF -D_IEEEV1_COMPATIBILITY -D_OPEN_MSGQ_EXT"</span> LD=xlc LDFLAGS=<span class=code-quote>"-qascii -q64 -W l,DLL"</span> CXX=xlc++ --enable-shared --prefix=/usr/local</font>
  </li>
  <li>
    <font face="courier new" size=2>make &amp;&amp; make check</font>
  </li>
  <li>
    <font face="courier new" size=2><font face=verdana>(as root)</font> make install</font>
  </li>
</ul>
<div>
  <font size=2>Follow the instructions above to turn the archive library into a dynamically linked library.</font>
</div>
<div>
  &nbsp;
</div>
<h3 class=western>
  <a id=CRYPTO_4637019764789899_283201_41930667124688625 name=CRYPTO_4637019764789899_283201_41930667124688625></a>GCRYPT
</h3>
<font size=2>Apply the patch </font><font face="Courier New" size=2>libgcrypt-1.4.4.patch</font><font face=verdana size=2> to the </font><font face=verdana size=2>libgcrypt</font><font face=verdana size=2> sources.</font><font size=2>&nbsp; Before running the configure and installation steps, you need to place some symbolic links in the sources.&nbsp; Compiling libgpgcrypt on z/OS runs afoul of a limitation of the XLC compiler's include header search path and system headers.&nbsp; Issue the following commands, verbatim, to overcome this limitation: </font>
<div>
  &nbsp;
</div>
<div style=MARGIN-LEFT:40px>
  <font face="courier new" size=2>cd mpi</font>
  <div style="FONT-FAMILY:Courier New">
    <font face="courier new" size=2>ln -s ../src/mpi.h .</font>
  </div>
  <div style="FONT-FAMILY:Courier New">
    <font face="courier new" size=2>ln -s ../src/memory.h .</font>
  </div>
  <div style="FONT-FAMILY:Courier New">
    <font face="courier new" size=2>cd -</font>
  </div>
  <div style="FONT-FAMILY:Courier New">
    <font face="courier new" size=2>cd cipher</font>
  </div>
  <div style="FONT-FAMILY:Courier New">
    <font face="courier new" size=2>ln -s ../src/mpi.h .</font>
  </div>
  <div style="FONT-FAMILY:Courier New">
    <font face="courier new" size=2>cd -</font>
  </div>
  <div>
    &nbsp;
  </div>
</div>
<div>
  <font size=2>Then</font><font face="Courier New" size=2>:</font>
</div>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <font face="Courier New" size=2>./configure CC=xlc CFLAGS=<span class=code-quote>"-qchars=signed -qascii -q64 -qlanglvl=extc99 -qexportall -qrent -qnocsect -W l,DLL -D_XOPEN_SOURCE=600 -D_ENHANCED_ASCII_EXT=0xFFFFFFFF -D_IEEEV1_COMPATIBILITY</span></font>
  </li>
  <li>
    <font face="courier new" size=2>make &amp;&amp; make check</font>
  </li>
  <li>
    <font face="courier new" size=2><font face=verdana>(as root)</font> make install</font>
  </li>
</ul>
<div>
  <font size=2>Follow the instructions from above to turn the archive library into a dynamically linked library.</font>
</div>
<div>
  &nbsp;
</div>
<h3 class=western>
  <a id=GPGME_8758319289457169_5365654_8247205913066864 name=GPGME_8758319289457169_5365654_8247205913066864></a>GPGME
</h3>
<font size=2>Apply the patch </font><font face="Courier New" size=2>gpgme-1.1.8.patch to the gpgme sources.</font><font size=2> Then run the configuration and installation steps. </font>
<div>
  &nbsp;
</div>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <font face="Courier New" size=2>./configure CC=xlc CFLAGS=<span class=code-quote>"-qchars=signed -qascii -q64 -qlanglvl=extc99 -qexportall -qrent -qnocsect -W l,DLL -D_XOPEN_SOURCE=600 -D_ENHANCED_ASCII_EXT=0xFFFFFFFF -D_IEEEV1_COMPATIBILITY</span></font>
  </li>
  <li>
    <font face="courier new" size=2>make &amp;&amp; make check</font>
  </li>
  <li>
    <font face="courier new" size=2><font face=verdana>(as root)</font> make install</font>
  </li>
</ul>
<div>
  <font size=2>Follow the instructions from above to turn the archive library into a dynamically linked library.</font>
</div>
<div>
  &nbsp;
</div>
<h3 class=western>
  <a id=GNUPG_9352701977315592_4968002 name=GNUPG_9352701977315592_4968002></a>GNUPG
</h3>
<font size=2>Apply the patch </font><font face="Courier New" size=2>gnupg-1.4.9.patch</font><font face="Courier New" size=2> to the GnuPG sources.</font><font size=2>&nbsp; Before running the configure and isntallation steps, you need to place some symbolic links in the sources. &nbsp; Compiling libgpgcrypt on z/OS runs afoul of a limitation of the XLC compiler's include header search path and system headers.&nbsp; Issue the following commands, verbatim, to overcome this limitation: </font>
<div>
  &nbsp;
</div>
<div style=MARGIN-LEFT:40px>
  <font face="Courier New" size=2>cd mpi</font>
  <div>
    <font face="Courier New" size=2>ln -s ../include/mpi.h .</font>
  </div>
  <div>
    <font face="Courier New" size=2>ln -s ../include/memory.h .</font>
  </div>
  <div>
    <font face="Courier New" size=2>cd -</font>
  </div>
  <div>
    &nbsp;
  </div>
</div>
<div>
  <font size=2>Then:</font>
</div>
<div>
  &nbsp;
</div>
<ul>
  <li>
    <font face="Courier New" size=2>./configure CC=xlc CFLAGS=<span class=code-quote>"-qchars=signed -qascii -q64 -qlanglvl=extc99 -qexportall -qrent -qnocsect -W l,DLL -D_XOPEN_SOURCE=600 -D_ENHANCED_ASCII_EXT=0xFFFFFFFF -D_IEEEV1_COMPATIBILITY -D_OPEN_MSGQ_EXT"</span> LD=xlc LDFLAGS=<span class=code-quote>"-qascii -q64 -W l,DLL"</span> CXX=xlc++ --without-pth --without-libassuan --without-ksba --prefix=/usr/local</font>
  </li>
  <li>
    <font face="courier new" size=2>make &amp;&amp; make check</font>
  </li>
  <li>
    <font face="courier new" size=2><font face=verdana>(as root)</font> make install</font>
  </li>
</ul>
<div>
  &nbsp;
</div>
<h2 class=western>
  <a id=IBM_AIX_5_3_pSeries_6214410681 name=IBM_AIX_5_3_pSeries_6214410681></a>IBM AIX 5.3 (pSeries)
</h2>
<h3 class=western>
  <a id=GPG_ERROR_823455323121752_7036_23540523927658796 name=GPG_ERROR_823455323121752_7036_23540523927658796></a>GPG-ERROR
</h3>
<p style="FONT-FAMILY:Courier New">
  <font size=2>./configure CC=cc CFLAGS=-q64 ($OBJECT_MODE=64)</font>
</p>
<h3 class=western>
  <a id=CRYPTO_4637019764789899_283201_2000580532476306 name=CRYPTO_4637019764789899_283201_2000580532476306></a>CRYPTO (From OpenSSL)
</h3>
<div>
  <font size=2>These instructions build OpenSSL which provides libcrypto.</font>
</div>
<div>
  &nbsp;
</div>
<div>
  &nbsp;
</div>
<p style="FONT-FAMILY:Courier New">
  <font size=2>./Configure aix64-cc shared # Note: it is an upper case C </font>
</p>
<div>
  <font size=2>.make</font>
</div>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font size=2>(as root) </font><font face="courier new" size=2>make install</font>
</p>
<a id=GPGME_8758319289457169_5365654 name=GPGME_8758319289457169_5365654></a>
<h3 class=western>
  <a id=_GPGME_8008412796873396_430544_7444934472441673 name=_GPGME_8008412796873396_430544_7444934472441673></a>GPGME
</h3>
<div>
  <font size=2>GPGME requires a source level fix to use the proper </font><font face="courier new" size=2>malloc()</font><font size=2> that requires an include for </font><font face="courier new" size=2>stdlib.h</font><font size=2> in the include section of </font><font face="courier new" size=2>version.c</font><font size=2>.&nbsp; Then: </font>
</div>
<div>
  &nbsp;
</div>
<p style="FONT-FAMILY:Courier New">
  <font size=2>./configure CC="xlc -q64" --disable-asm ($OBJECT_MODE=64)<font face=verdana>/ or</font> </font><font size=2>CC=cc CFLAGS=-q64</font>
</p>
<h3 class=western>
  <a id=GNUPG_9352701977315592_4968002_16115970630198717 name=GNUPG_9352701977315592_4968002_16115970630198717></a>GNUPG
</h3>
<p>
  <font size=2>GPG on AIX requires the setuid bit to be set. This can be done via </font><font face="courier new" size=2>chmod u+s</font> <font face="arial narrow" size=2>/path/to/gpg</font><font size=2>. &nbsp; Please see <a href=http://www.gnupg.org/documentation/faqs.en.html#q6.1 id=g3_r target=_blank title="Click to visit GPG FAQ">http://www.gnupg.org/documentation/faqs.en.html#q6.1</a> </font>
</p>
<div>
  &nbsp;
</div>
<p>
</p>
<div>
  &nbsp;
</div>
<p>
  <font face="courier new" size=2>./configure CC="xlc -q64" --disable-asm ($OBJECT_MODE=64)</font><font size=2> or </font><font face="courier new" size=2>CC=cc CFLAGS=-q64</font>
</p>
<h2 class=western>
  <a id=Solaris_9_and_10_SPARC_3104793 name=Solaris_9_and_10_SPARC_3104793></a>Solaris 9 and 10 (SPARC)
</h2>
<p>
  <font size=2>Set </font><font size=2><font face="courier new">$</font></font><font face="courier new" size=2>LD_LIBRARY_PATH</font><font size=2> to include </font><font face="courier new" size=2>/usr/lib/sparcv9</font><font size=2> AND </font><font face="courier new" size=2>/usr/ucblib/sparcv9</font><font size=2> for both Solaris 9 and 10.&nbsp; Solaris seems to default to the 32-bit version of </font><font face="courier new" size=2>ucblib</font><font size=2> at runtime, unless the 64-bit path is ahead of the 32-bit in </font><font size=2><font face="courier new">$</font></font><font face="courier new" size=2>LD_LIBRARY_PATH</font><font size=2>. However, using </font><font face="courier new" size=2>-R/usr/lib/sparcv9 -R/usr/ucblib/sparcv9/</font><font size=2> as a </font><font face="Liberation Mono, monospace" size=2>CFLAG</font><font size=2> at build time hard-codes the path into the library, removing the need for </font><font face="courier new" size=2>$LD_LIBRARY_PATH</font><font size=2>. </font>
</p>
<h3 class=western>
  <a id=GPG_ERROR_22278689011933595_04 name=GPG_ERROR_22278689011933595_04></a>GPG-ERROR
</h3>
<p style="FONT-FAMILY:Courier New">
  <font size=2>./configure CC=/opt/SUNWspro/bin/cc CFLAGS="-m64 -R/usr/lib/sparcv9 -R/usr/ucblib/sparcv9/"</font>
</p>
<h3 class=western>
  <a id=GCRYPT_9250497833661064_924550 name=GCRYPT_9250497833661064_924550></a>GCRYPT
</h3>
<p style="FONT-FAMILY:Courier New">
  <font size=2>./configure CC=/opt/SUNWspro/bin/cc CFLAGS="-m64 -R/usr/lib/sparcv9 -R/usr/ucblib/sparcv9/" --disable-asm --with-gpg-error-prefix=/usr/local</font>
</p>
<h3 class=western>
  <a id=GPGME_2993951266743642_3275342 name=GPGME_2993951266743642_3275342></a>GPGME
</h3>
<p>
  <font size=2>GPGME requires a source level fix to use the proper </font><font face="courier new" size=2>malloc()</font><font size=2> that requires an include for </font><font face="courier new" size=2>stdlib.h</font><font size=2> in the include section of </font><font face="courier new" size=2>version.c</font><font size=2>. </font>
</p>
<p>
</p>
<div>
  &nbsp;
</div>
<p style="FONT-FAMILY:Courier New">
  <font size=2>./configure CC="xlc -q64" --disable-asm ($OBJECT_MODE=64)<font face=verdana>/ or</font> </font><font size=2>CC=cc CFLAGS=-q64</font>
</p>
<p style="FONT-FAMILY:Courier New">
  <font size=2>./configure CC=/opt/SUNWspro/bin/cc CFLAGS="-m64 -R/usr/lib/sparcv9 -R/usr/ucblib/sparcv9/" --disable-asm --with-gpg-error-prefix=/usr/local</font>
</p>
<h3 class=western>
  <a id=GNUPG_9468889342856063_5198401 name=GNUPG_9468889342856063_5198401></a>GNUPG
</h3>
<p style="FONT-FAMILY:Courier New">
  <font size=2>./configure CC=/opt/SUNWspro/bin/cc CFLAGS="-m64 -R/usr/lib/sparcv9 -R/usr/ucblib/sparcv9/" --disable-asm</font>
</p>
<h2>
  <a id=HP_UX_11_31_IA64_1829007706874 name=HP_UX_11_31_IA64_1829007706874></a>HP-UX 11.31 (IA64)
</h2>
<font size=2>Depending on which user runs the configure command, you may or may not have to specify the <font face="courier new">--with-gpg-error-prefix</font> flag.</font>
<div>
  &nbsp;
</div>
<h3>
  <a id=GPG_ERROR_8732054253825327_299_23618535324931145 name=GPG_ERROR_8732054253825327_299_23618535324931145></a>GPG-ERROR
</h3>
<font size=2><font face="courier new">./configure CC=/usr/bin/cc CFLAGS=+DD64</font></font>
<div>
  &nbsp;
</div>
<h3>
  <a id=GCRYPT_060866412087715926_1848_7510066023096442 name=GCRYPT_060866412087715926_1848_7510066023096442></a>GCRYPT
</h3>
<font size=2><font face="courier new">./configure CC=/usr/bin/cc CFLAGS=+DD64 --with-gpg-error-prefix=/usr/local</font></font>
<div>
  &nbsp;
</div>
<h3>
  <a id=GPGME_8273790356748403_8276159_4528630506247282 name=GPGME_8273790356748403_8276159_4528630506247282></a>GPGME
</h3>
<font size=2>GPGME requires a source level fix to use the proper <font face="courier new">malloc()</font> that requires an include for <font face="courier new">stdlib.h</font> in the include section of <font face="courier new">version.c</font>. </font>
<div>
  &nbsp;
</div>
<div>
  <font size=2><font face="courier new">./configure CC=/usr/bin/cc CFLAGS=+DD64 --with-gpg-error-prefix=/usr/local</font></font>
</div>
<div>
  &nbsp;
</div>
<h3>
  <a id=GNUPG_24255861654347477_687197_5791980354115367 name=GNUPG_24255861654347477_687197_5791980354115367></a>GNUPG
</h3>
<font size=2><font face="courier new">./configure CC=/usr/bin/cc CFLAGS=+DD64 --with-gpg-error-prefix=/usr/local</font></font>
<div>
  &nbsp;
</div>
<h2>
  <a id=SUSE_Linux_Enterprise_Server_1_12649072520434856 name=SUSE_Linux_Enterprise_Server_1_12649072520434856></a>SUSE Linux Enterprise Server 11 (x86_64)
</h2>
<div>
  Packages were installed from standard repositories using the package manager.&nbsp; The libgcrypt packages have been upgraded using openSUSE 11.2 packages.<br>
  <br>
</div>
<p>
</p>
<h2>
  <a id=SUSE_Linux_Enterprise_Server_1_001227264292538166 name=SUSE_Linux_Enterprise_Server_1_001227264292538166></a>SUSE Linux Enterprise Server 11 (s390x)
</h2>
<div>
  Packages were installed from standard repositories using the package manager.
</div>
&nbsp;
<p>
</p>
<h2>
  <a id=SUSE_Linux_Enterprise_Server_1 name=SUSE_Linux_Enterprise_Server_1></a><font color=#000000>SUSE Linux Enterprise Server 10 (s390x)</font>
</h2>
<div style=COLOR:#000000>
  Packages were installed from standard repositories using the package manager.<br>
</div>
<div style=COLOR:#000000>
  <br>
  <b>To uprade the GPG package using the source RPM version 1.4.9-6.1 from openSUSE 11: </b>
</div>
<p style=COLOR:#000000>
  &nbsp;
</p>
<ol style=COLOR:#000000>
  <li>
    <div>
      Download and install gpg-1.4.9-6.1 src rpm.<br>
      <font face="Courier New">wget </font><font face="Courier New">ftp://ftp.pbone.net/mirror/ftp5.gwdg.de/pub/opensuse/repositories/home%3A/keutterling/openSUSE_11.0/src/gpg-1.4.9-6.1.src.rpm</font><br>
      <font face="Courier New">sudo rpm -i gpg-1.4.9-6.1.src.rpm</font>
    </div>
  </li>
  <li>
    <div>
      Install the required dependencies for building GPG. You can get those from the official SLES 10 CDs/DVD.<br>
      <font face="Courier New">sudo rpm -i db42-4.2.52-20.2.s390x.rpm openssl-devel-0.9.8a-18.36.s390x.rpm cyrus-sasl-devel-2.1.21-18.11.41.s390x.rpm openldap2-2.3.32-0.35.23.s390x.rpm openldap2-devel-2.3.32-0.35.23.s390x.rpm</font>
    </div>
  </li>
  <li>
    <div>
      Build GPG 1.4.9 RPM.<br>
      <font face="Courier New">rpmbuild -bb /usr/src/packages/SPECS/gpg1.spec</font>
    </div>
  </li>
  <li>
    <div>
      Upgrade to the new GPG RPM.<br>
      <font face="Courier New">sudo rpm -U /usr/src/packages/RPMS/s390x/gpg-1.4.9-6.1.s390x.rpm </font>
    </div>
  </li>
</ol>
<div style=COLOR:#000000>
  &nbsp;
</div>
<h1 style=COLOR:#000000>
  <a id=prerelease_3440913910572655_52 name=prerelease_3440913910572655_52></a>Using the V5.4-001 Reference Implementation with Older Releases
</h1>
<font color=#000000>Since the interface between GT.M and the encryption libraries is stable, encrypted databases require no special upgrade procedures beyond any that may be required for ordinary databases when upgrading GT.M versions. &nbsp;Beyond an occasional need to recompile the plugin and rebuild the shared library, a plugin other than the reference implementation should also continue to operate with new GT.M versions. &nbsp;This stable interface also means that the encryption plugins from newer GT.M versions can be retrofitted to older GT.M versions. &nbsp;This section describes interfacing the reference plugin bundled with V5.4-001 to an older GT.M version that supports encryption, such as V5.4-000A; adapt it to your needs should you wish to use a plugin from one version of GT.M with another version.</font><br style=COLOR:#000000>
<br style=COLOR:#000000>
<div style=COLOR:#000000>
  <b>Note</b>: Since the reference plugin bundled with V5.4-001 supports GPG v2 as well as v1, and since its key management is more robust from that bundled with older versions of GT.M that support encryption, FIS suggests that you consider such a retrofit if you have chosen to deploy encrypted databases on older versions of GT.M with the reference implementation.
</div>
<br style=COLOR:#000000>
<div>
  <font color=#000000>The instructions provided in this section are expert friendly and intended for someone familiar with UNIX/Linux and GT.M. &nbsp;All commands are examples, rather than intended to be executed as written. Adapt them to your specific needs and DO NOT BLINDLY EXECUTE THEM VERBATIM.</font><br style=COLOR:#000000>
  <h2 style=COLOR:#000000>
    <a id=Installation_2861828101597426_ name=Installation_2861828101597426_></a>Installation
  </h2>
  <b style=COLOR:#000000>To obtain the V5.4-001 reference implementation:</b><br style=COLOR:#000000>
  <br style=COLOR:#000000>
  <ol style=COLOR:#000000>
    <li>
      To go the GT.M project website on <a href=http://www.sourceforge.net/projects/fis-gtm title="Click here to visit the GT.M project on Source Forge">Source Forge</a>.
    </li>
    <li>
      Download the <font face="courier new">gtmcrypt_V54001.tar.gz</font> file. from the V5.4-001 release of GT.M-x86-Linux-src.
    </li>
  </ol>
  <br style=COLOR:#000000>
  <font color=#000000 face="courier new">gtmcrypt_V54001.tar.gz</font><font color=#000000> contains the source files for the reference plugin distributed with GT.M V5.4-001. &nbsp;(Depending on when you downloaded it, it may have a pre-release version.)</font><br style=COLOR:#000000>
  <br style=COLOR:#000000>
  <b style=COLOR:#000000>Before you begin: </b><br style=COLOR:#000000>
  <br style=COLOR:#000000>
  <ul style=COLOR:#000000>
    <li>
      Ensure that you have a working C compiler (<font face="courier new">cc</font>).
    </li>
    <li>
      Ensure that you have root access.
    </li>
    <li>
      The instructions provided in this section are for installing the V5.4-001 prerelease reference implementation on Ubuntu Linux on an <font face="courier new">x86_64</font> system.&nbsp; Other platform should be similar.<br>
    </li>
  </ul>
  <br style=COLOR:#000000>
  <b style=COLOR:#000000>To install the new database encryption plug-in on an older GT.M release, perform the following steps: </b><br style=COLOR:#000000>
  <br style=COLOR:#000000>
  <ol style=COLOR:#0000ff>
    <li style=COLOR:#000000>
      Unpack the distribution files in a temporary directory, for example, <font face="courier new">/tmp/tmp3</font> and change to the <font face="courier new">src</font> sub-directory within.<br>
      <font face="courier new">mkdir /tmp/tmp3</font><br style="FONT-FAMILY:Courier New">
      <font face="courier new">tar zxvf gtmcrypt_V54001.tar.gz -C /tmp/tmp3</font><br style="FONT-FAMILY:Courier New">
      <font face="courier new">cd /tmp/tmp3/src<br>
      </font>
    </li>
    <li style=COLOR:#000000>
      Run the <font face="courier new">build.sh</font> script specifying the encryption library (<font face="courier new">gcrypt</font> or <font face="courier new">openssl</font>) and the build type (<font face="courier new">d</font> for debug; <font face="courier new">p</font> for production). The script needs the environment variable <font face="'Courier New'">$gtm_dist</font> to be defined, and, depending on the way ICU is compiled on your system, may well need&nbsp;<font face="'Courier New'">$gtm_icu_version</font> to be defined as well.<br>
      <font face="courier new">export gtm_dist=/usr/lib/fis-gtm/V5.4-000A_x86_64</font><br style="FONT-FAMILY:Courier New">
      <font face="courier new">export gtm_icu_version=4.2</font><br style="FONT-FAMILY:Courier New">
      <font face="courier new">./build.sh gcrypt p<br>
      </font>
    </li>
    <li style=COLOR:#000000>
      As root, make a backup copy of the existing plugin directory.<br>
      <font face="courier new">sudo cp -a $gtm_dist/plugin{,_sav_`date +%Y%m%d%H%M%S`}<br>
      </font>
    </li>
    <li style=COLOR:#000000>
      As root, delete the Korn shell scripts and old source tarball in the existing plugin directory.<br>
      <font face="courier new">sudo rm -f $gtm_dist/plugin/gtmcrypt/{*.ksh,source.tar}<br>
      </font>
    </li>
    <li style=COLOR:#000000>
      As root, run the install script (executing via <font face="'Courier New'">sudo</font>&nbsp;will not work here, since it does not pass the $gtm_dist environment variable to the shell script).<br>
      <font face="courier new">export gtm_dist=/usr/lib/fis-gtm/V5.4-000A_x86_64</font><br style="FONT-FAMILY:Courier New">
      <font face="courier new">./install.sh</font>
    </li>
    <li style=COLOR:#000000>
      Edit the <font face="'Courier New'">gpgagent.tab</font> file to specify the correct pathname to the <font face="'Courier New'">libgtmcrypt.so</font> shared library, and as root, copy the distributed shell scripts and <font face="'Courier New'">gpgagent.tab</font> file.<br>
      <font face="courier new">cd ..</font><font face="courier new"><br>
      sudo cp *.sh gpgagent.tab $gtm_dist/plugin/gtmcrypt/<br>
      </font>
    </li>
    <li style=COLOR:#000000>
      Set ownership and permissions appropriate to your installation.<br>
      <font face="courier new">sudo chown -R bin.gtm $gtm_dist/plugin</font><br style="FONT-FAMILY:Courier New">
      <font face="courier new">sudo chmod -R o-rwx,a-w $gtm_dist/plugin<br>
      </font>
    </li>
    <li>
      <font color=#000000 face=verdana>Your new database encryption plugin should now be ready for use!</font><br>
    </li>
  </ol>
  <div>
    &nbsp;
  </div>
  <p>
    <a href="GTM_Database_Encryption.html#toc" id=y0-o target=_self title="Click here to return to the Table of Contents">Return to Table of Contents</a>
  </p>
  <p>
  </p>
  <div>
    &nbsp;
  </div>
  <div>
    &nbsp;&nbsp;
  </div>
  <div>
    &nbsp;
  </div>
  <br>
</div>
<br>
<div id=qt3e style=TEXT-ALIGN:left>
  &nbsp;
</div>
<br>
<br>
<div class=endnotes>
  <p style="page-break-before:always; TEXT-ALIGN:center">
    notes
  </p>
  <br>
  <br>
  <sup>1 </sup><a name=FOOTNOTE-1></a><font size=1><font face=verdana>In the event core dumps are needed to troubleshoot operational issues, they can always be re-enabled.<br>
  </font></font><br>
  <br>
  <sup>2 </sup><a name=FOOTNOTE-2></a><font size=2><font face=verdana>GT.M provides functions </font></font><font face="courier new" size=2>gtm_hiber_start()</font><font size=2><font face=verdana>, </font></font><font face="courier new" size=2>gtm_hiber_start_any()</font><font size=2><font face=verdana>, </font></font><font face="courier new" size=2>gtm_start_timer()</font><font size=2><font face=verdana>, </font></font><font face="courier new" size=2>gtm_cancel_timer()</font><font size=2><font face=verdana>, </font></font><font face="courier new" size=2>gtm_jnlpool_detach()</font><font size=2><font face=verdana>, </font></font><font face="courier new" size=2>gtm_malloc()</font><font size=2><font face=verdana> and </font></font><font face="courier new" size=2>gtm_free()</font><font size=2><font face=verdana> which can be freely used by plug-ins.</font> </font><br>
  <br>
  <sup>3 </sup><a name=FOOTNOTE-3></a>This step can be omitted if they already have GPG keyrings and public and private keys. &nbsp;However, see the section below on operation with Gnu Privacy Guard version 2.<br>
  <br>
  <sup>4 </sup><a name=FOOTNOTE-4></a>Generatng a public-private keypair can&nbsp; consume a significant amount of the entropy in a computer system. &nbsp;Running out of entropy can cause the operation to stall until sufficient entropy becomes available. &nbsp;You may need to consider external entropy sources or entropy gathering daemons for computer systems on which key generation will occur frequently. &nbsp;For encrypted databases on virtual machines, you may need to generate public-private keypairs on host computers and then ship the keyrings to the virtual guests.<br>
  <br>
  <sup>5 </sup><a name=FOOTNOTE-5></a><font size=2><font face=verdana>One alternative to direct sending of of public keys is to upload them to a keyserver, such as the MIT PGP Public Key Server at http://pgp.mit.edu</font></font><br>
  <br>
  <sup>6 </sup><a name=FOOTNOTE-6></a><font face=verdana>Different computing platforms may use different file extensions for shared libraries, including <font face="courier new">.sl</font> and <font face="courier new">.dll</font>.&nbsp; This document uses <font face="courier new">.so</font> for readability, but the actual name may vary on your platform.</font><br>
  <br>
  <sup>7 </sup><a name=FOOTNOTE-7></a><font size=1><font face=verdana>Such a failure in the cipher will likely appear to GT.M as a damaged database.</font></font>
</div></body>
</html>
