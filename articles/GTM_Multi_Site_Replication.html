<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><title>GT.M - Multi Site Replication Support on UNIX</title><link rel="stylesheet" href="e-novative_article.css" type="text/css"></link><meta name="generator" content="DocBook XSL Stylesheets V1.68.1"></meta><meta name="description" content="`
           		
                   
                   
                        GT.M Group
                        Fidelity National Information Services, Inc.
                        2 West Liberty Boulevard, Suite 300
                        Malvern, PA  19355, 
                        United States of America
                                        
                    
                    
                    
                    
                        GT.M Support: +1 (610) 578-4226 
                        Switchboard: +1 (610) 296-8877 
                        Fax: +1 (484) 595-5101
                        http://www.fis-gtm.com
                        gtmsupport@fnf.com
                    
                    
                    "></meta></head><body><div class="article" lang="en-US"><div class="titlepage"><div><div><h1 class="title"><a id="id880970"></a><a id="return_to_top"></a>GT.M - Multi Site Replication Support on UNIX</h1></div><div><h3 class="subtitle"><i>Technical Bulletin: GT.M - Multi Site Replication Support on UNIX</i></h3></div><div><p class="copyright">Copyright © 2006 Fidelity National Information Services, Inc.</p></div><div><div xmlns="" align="center"><a href="legalnotice.html" target="_blank">Legal Notice</a></div></div><div><p class="pubdate">June 14, 2006</p></div><div><div xmlns="" class="revhistory"><table border="1" align="center" width="70%" summary="Revision history"><tr><th align="left" valign="top" colspan="2"><b>Revision History</b></th></tr><tr><td align="left">Revision 1.0</td><td align="left">14 June 2006</td></tr></table></div></div><div><div class="abstract"><p class="title"><b></b></p><div class="informaltable"><table border="0" width="100%"><colgroup><col></col><col></col></colgroup><tbody><tr><td align="left" valign="top">
                   <p>
                   <div class="address"><p><br></br>
                        GT.M Group<br></br>
                        Fidelity National Information Services, Inc.<br></br>
                        <span class="street">2 West Liberty Boulevard, Suite 300</span><br></br>
                        <span class="city">Malvern, </span><span class="state">PA </span><span class="postcode"> 19355, </span><br></br>
                        <span class="country">United States of America</span><br></br>
                    </p></div>                    
                    </p>
                    </td><td align="left" valign="top">
                    <p>
                    <div class="address"><p><br></br>
                        <span class="phone">GT.M Support: +1 (610) 578-4226</span> <br></br>
                        <span class="phone">Switchboard: +1 (610) 296-8877 </span><br></br>
                        <span class="fax">Fax: +1 (484) 595-5101</span><br></br>
                        <a href="http://www.fis-gtm.com" target="_top">http://www.fis-gtm.com</a><br></br>
                        <a href="mailto:gtmsupport@fnf.com" target="_top">gtmsupport@fnf.com</a><br></br>
                    </p></div>
                    </p>
                    </td></tr></tbody></table></div></div></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="GTM_Multi_Site_Replication.html#id882090">Overview</a></span></dt><dt><span class="sect1"><a href="GTM_Multi_Site_Replication.html#fs">Summary</a></span></dt><dt><span class="sect1"><a href="GTM_Multi_Site_Replication.html#ui">User Interface</a></span></dt><dd><dl><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id881700">Replication Instance File</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id881242">MUPIP REPLIC &#8211;INSTANCE_CREATE &#8211;NAME</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id881603">-INSTSEC[ONDARY] qualifier</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id881654">-ROOT[PRIMARY] and &#8211;PROPAGATE[PRIMARY] Qualifiers</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id882222">Obsolete <span class="emphasis"><em>&#8211;UPDATE</em></span> Qualifier</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id882374">MUPIP REPLIC &#8211;SOURCE &#8211;START</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id881686">MUPIP REPLIC &#8211;RECEIVER &#8211;START</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id882519">MUPIP REPLIC &#8211;SOURCE &#8211;ACTIVATE</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id882658">MUPIP REPLIC &#8211;SOURCE &#8211;DEACTIVATE</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#start_inst">Starting up an instance</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#shut_inst">Shutting down an instance</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id882869">Primary and Secondary transitions</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id882897">Refreshing secondary from backup of primary</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id882796">Lost transaction processing</a></span></dt><dd><dl><dt><span class="sect3"><a href="GTM_Multi_Site_Replication.html#id882940">MUPIP REPLIC &#8211;SOURCE &#8211;NEEDREST[ART]</a></span></dt><dt><span class="sect3"><a href="GTM_Multi_Site_Replication.html#id883195">MUPIP REPLIC &#8211;SOURCE &#8211;LOSTTN[COMPLETE]</a></span></dt></dl></dd><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id882962">MUPIP REPLIC &#8211;EDIT[INSTANCE]</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id883590">MUPIP REPLIC -SOURCE &#8211;JNLPOOL</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#dse_dump_file">DSE DUMP -FILE[HEADER]</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id883442">DSE CHANGE -FILE[HEADER]</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id883849">MUPIP JOURNAL -ROLLBACK</a></span></dt><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id883812">MUPIP BACKUP</a></span></dt></dl></dd><dt><span class="sect1"><a href="GTM_Multi_Site_Replication.html#id882594">Rolling Upgrade</a></span></dt><dd><dl><dt><span class="sect2"><a href="GTM_Multi_Site_Replication.html#id883491">From a GT.M Dual-site version to a GT.M Multi-site version</a></span></dt></dl></dd><dt><span class="sect1"><a href="GTM_Multi_Site_Replication.html#id884073">Error Messages</a></span></dt><dt><span class="sect1"><a href="GTM_Multi_Site_Replication.html#id887349">Typographical Conventions</a></span></dt></dl></div><div class="sect1" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h2 class="title"><a id="id882090"></a>Overview</h2></div></div></div><p>GT.M V5.1-000 provides the capability to deploy an application in a logical multi-site configuration with multiple secondary sites to a single primary site.</p><p>Prior versions of GT.M featured the capability to deploy an application in a logical dual-site configuration with only one secondary site.</p><p>A configuration having a primary and secondary in proximity for operational efficiency, however, would not provide protection against a disruption that affects both systems. A separate and distant "disaster recovery" (DR) third system can provide the operational convenience of proximal systems for routine operations, and a distant system for continuity of business in the face of catastrophic events. Prior GT.M versions did not make it possible to set up multiple secondary and/or tertiary systems. GT.M V5.1-000 enables such multi-site configurations. For migration to the new version with continuity of business, a dual-site configuration where one site runs on a GT.M version that has multi-site replication enabled and the other site runs on a GT.M version that does not, is supported.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The terms <span class="emphasis"><em>site</em></span> and <span class="emphasis"><em>instance</em></span> are used interchangeably throughout this technical bulletin to refer to a primary or secondary system that participates in replication.  Please also note that GT.M imposes no restrictions on the number of instances that can reside on a given machine.</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>A configuration that uses GT.M replication between one primary and one secondary is henceforth termed a <span class="emphasis"><em>dual-site configuration</em></span> while a configuration that uses GT.M replication between one primary and more than one secondary and/or tertiaries is henceforth termed a <span class="emphasis"><em>multi-site configuration</em></span>. Likewise, replication between one primary and one secondary is termed <span class="emphasis"><em>dual-site replication</em></span>. Replication between one primary and more than one secondary and/or tertiaries is termed <span class="emphasis"><em>multi-site replication</em></span>.</p></td></tr></table></div></div><div class="sect1" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h2 class="title"><a id="fs"></a>Summary</h2></div></div></div><p>GT.M V5.1-000 supports replication from one primary site to multiple secondary sites. As in prior versions of GT.M, at any given instant, only one primary instance performs updates. In GT.M V5.1-000, this primary can concurrently replicate to as many as sixteen (16) additional instances. Any of the secondary sites can become the new primary, in the event of an unplanned or planned outage of the primary. </p><p>After recovering from the outage, the original primary becomes a secondary, potentially generating a lost transaction file to be sent to the new primary for (re)processing.</p><p>The multi-site configuration capability permits a secondary instance to pass the transactions to a tertiary instance. The flow of transaction data is from the primary to the secondary to the tertiary. Herein, the secondary acts as a primary for the tertiary. Thus, if each of the 16 secondary instances were to feed 16 tertiary instances, there could be 273 instances (1 primary + 16 secondaries + 256 tertiaries). If the tertiary instances fed quaternary instances, there could be 4,369 instances (1 primary + 16 secondaries + 256 tertiaries + 4096 quaternaries). And so on.</p><p>Any arbitrary reconfiguration of the instances would be feasible, as any instance in the tree of instances below the primary could potentially become a new primary, if the current primary comes down.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>A tree structure is required for replication and cycles are not supported.</p></td></tr></table></div><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Caution"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Caution]" src="images/caution.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Just because GT.M permits arbitrary reconfiguration of the instances, it does not mean that an application or a specific deployment of the application should permit such an arbitrary reconfiguration. Each application deployment should have a specific configuration and a strategy for dealing with unplanned and planned outages.</p></td></tr></table></div><p>To differentiate the real primary from the secondary that is also acting as a primary (for the tertiary), GT.M V5.1-000 introduces the notion of a root primary versus a propagating primary.</p><p>The instance on which business logic is executed, and resulting database updates are computed &amp; commited, is termed the <span class="emphasis"><em>root primary</em></span>. The secondary that acts as a primary (to a tertiary) is termed a <span class="emphasis"><em>propagating primary</em></span>. This can be further extended to allow the tertiary replicate to a quaternary and so on. In such a case, the tertiary also acts as a <span class="emphasis"><em>propagating primary</em></span>. There can be any number of propagating primaries but only <span class="emphasis"><em>ONE root primary</em></span> in GT.M V5.1-000.</p><p>GT.M process updates to replicated regions are disabled on all instances except the root primary (note that mupip reorg and database repair in the unlikely event of structural database damage needing repair with DSE, are not considered logical updates, and are permitted on the secondary). To identify whether the current instance is a root primary or a propagating primary the source server startup command now has an optional qualifier, <span class="emphasis"><em>-rootprimary</em></span> or <span class="emphasis"><em>-propagate primary</em></span>.</p><p>Central to multi-site replication support is the notion of an instance name. Each replication instance is uniquely identified by a name that can be from 1 to 15 alphanumeric characters. This name is stored in the replication instance file of that instance. The instance name uniquely identifies every site in the multi-site configuration, as each site has only one replication instance file.</p><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Caution"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Caution]" src="images/caution.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The instance name should be unique and two instances should not have the same name.</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The instance name is not changeable once the instance has served the role of either a primary (root or propagating) or a secondary since the replication instance files of all the corresponding secondaries and/or primaries connected to the instance maintain a record of the instance name.</p></td></tr></table></div><p>Since there can be multiple source servers running (one per active secondary) on a primary instance, source server commands need to specify secondary instance names to identify specific source servers.</p><p>As indicated previously, a secondary running on GT.M V5.1-000 is supported with a primary running a prior version of GT.M and vice versa, which will occur in a rolling upgrade. Multiple secondary instances are allowed only after both the primary and secondary have been upgraded to GT.M V5.1-000. Likewise, tertiaries are allowed from a secondary only after both the primary and secondary have been upgraded to GT.M V5.1-000.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Additional features of multi-site replication are available only when both the sites in an existing dual-site configuration are upgraded to GT.M V5.1-000.</p></td></tr></table></div></div><div class="sect1" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h2 class="title"><a id="ui"></a>User Interface</h2></div></div></div><p>The changes to the user interface in V5.1-000 apply in both multi-site and dual-site configurations (e.g., if an instance name is required by a command, it is required even when operating in a dual-site configuration.</p><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id881700"></a>Replication Instance File</h3></div></div></div><p>In order to use replication in dual-site or multi-site mode on UNIX, new replication instance files need to be created. A <span class="emphasis"><em>REPLINSTFMT</em></span> error occurrs if a replication instance file from a previous version of GT.M is used. A <span class="emphasis"><em>FILENOTFND</em></span> error occurs if the instance file does not exist and replication is attempted.</p><p>The name given at the time of creating the instance file uniquely identifies the instance and is stored in the replication instance file.</p><p>The instance file serves as a repository of the history of the journal sequence numbers that are generated locally or received from other instances. The history is maintained as a set of records. Every record identifies a range of journal sequence numbers and the name of the root primary instance that generated those journal records. The first history record starts with the current journal sequence number of the instance. When a root primary and secondary communicate, the primary instance name is recorded in the replication instance file history of both the primary and the secondary as the instance that generated the transmitted journal sequence numbers. When a tertiary connects to a secondary, it is still the root primary instance name (not that of the secondary which serves as a propagating primary) that gets recorded in the tertiary instance file since that is the instance that actually generated the records. History records are always added to the tail of the instance file, the only exception being records removed from the tail of the instance file when updates are rolled back from the database as part of a <span class="emphasis"><em>mupip journal &#8211;rollback</em></span>.</p><p>This history is crucial to determining the journal sequence numbers through which both instances are synchronized when a primary and secondary (or secondary and tertiary) attempt to connect. This journal sequence number is determined by going back in the history of both the instance files and finding the earliest shared journal sequence number that was generated by the same root primary instance. The receiver server on the secondary continues with normal replication only if the shared journal sequence number determined above matches the current journal sequence number of the secondary instance. Otherwise, a <span class="emphasis"><em>mupip journal &#8211;rollback &#8211;fetchresync</em></span> must be performed on the secondary to rollback the secondary to a common synchronization point from which the primary can transmit updates to allow it to catch up. To avoid a possible out-of-sync situation, it is advisable, and safe even if it is not strictly necessary, so it can be unconditionally scripted, to perform a <span class="emphasis"><em>mupip journal -rollback -fetchresync</em></span> prior to starting any source servers on the secondary instance.</p><p>Processes such as source servers, receiver server, and <span class="emphasis"><em>mupip rollback</em></span> access this history. A <span class="emphasis"><em>REPLINSTNOHIST</em></span> error message is generated if they attempt to look up a history record corresponding to a sequence number (for example, as part of a <span class="emphasis"><em>-rollback</em></span> operation) that is less than the earliest sequence number recorded in the instance file.</p><p>A replication instance file maintains the current state of the instance and it is necessary to take a backup of this file that is consistent with the snapshot of the database files in the backup. <span class="emphasis"><em>Mupip journal -backup</em></span> allows for the backup of the instance files at the same time that it backs up the database files.</p><p>The replication instance file on the primary stores the information pertaining to each secondary for which a source server is started and the journal sequence number that was last transmitted to that secondary. In prior versions of GT.M, this journal sequence number was maintained as <span class="emphasis"><em>Resync Seqno</em></span> in the database file headers of all replicated regions and a <span class="emphasis"><em>dse dump -fileheader</em></span> would display this information. With GT.M V5.1-000, this information is only available in the replication instance file and <span class="emphasis"><em>mupip replic &#8211;source &#8211;showbacklog</em></span> command uses this information to display the backlogs for secondary instances.</p><p>The instance file has 16 slots to store information pertaining to a maximum of 16 secondary instances. Initially, all the slots are unused. A source server replicating to a secondary for the first time utilizes an unused slot to store the information related to that secondary and any future source server process replicating to the same secondary will update this information.</p><p>If an unused slot is not available, the first time the source server starts, the slot for the least recently started secondary is reused, assuming of course that the source server for the secondary is not alive, and the information that is previously stored in that slot is overwritten. Any subsequent <span class="emphasis"><em>mupip replic &#8211;source</em></span> on the preempted secondary instance generates a <span class="emphasis"><em>REPLINSTSECNONE</em></span> message. </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Preemption of slots is not an issue if the primary does not connect to more than 16 different secondaries throughout its lifetime.</p></td></tr></table></div><p>If the replication instance file is damaged or deleted, a new instance file must be created, and all secondaries downstream must be recreated from backups.</p></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id881242"></a>MUPIP REPLIC &#8211;INSTANCE_CREATE &#8211;NAME</h3></div></div></div><p>An instance name must be specified when the replication instance file is being created using the &#8211;name qualifier in the command line. </p><p>The name identifies the replication instance to other instances, and it is immutable.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>In this rare instance, a GT.M command from a prior version is not upward compatible in GT.M V5.1-000.</p></td></tr></table></div><p>If -name is not specified, mupip uses the environment variable gtm_repl_instname for the name. If that variable is not defined, the command issues a <span class="emphasis"><em>REPLINSTNMUNDEF</em></span> error message. Using the environment variable allows pre-existing user replication scripts to run without any changes. Explicitly specifying the qualifier in the scripts improves clarity.</p><p>The name can be from 1 to 15 characters. Specifying a name longer than 15 characters or an empty string will issue a <span class="emphasis"><em>REPLINSTNMLEN</em></span> error message.</p><p>If an instance file already exists, it is renamed with a timestamp suffix, and a new one is created. This behavior is similar to the manner in which GT.M renames existing journal files while creating new journal files.</p><p>Creating an instance file requires standalone access. A <span class="emphasis"><em>REPLINSTSTNDALN</em></span> message is issued if the instance file is being used (i.e. the journal pool for that instance exists), while attempting to (re)create that instance file.</p></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id881603"></a>-INSTSEC[ONDARY] qualifier</h3></div></div></div><p>On a primary instance, a source server process runs for each secondary instance. The <span class="emphasis"><em>&#8211;instsecondary</em></span> qualifier identifies the secondary instance to which a source server replicates the data. In GT.M V5.1-000, the following commands have been modified to include the <span class="emphasis"><em>&#8211;instsecondary</em></span> qualifier. It is mandatory to specify the &#8211;instsecondary qualifier while issuing these commands.</p><pre class="programlisting">
   	mupip replic &#8211;source &#8211;start
   	mupip replic &#8211;source &#8211;deactivate
   	mupip replic &#8211;source &#8211;activate
   	mupip replic &#8211;source &#8211;stopsourcefilter
   	mupip replic &#8211;source &#8211;changelog
   	mupip replic &#8211;source &#8211;statslog
   	mupip replic -source -needrestart
	</pre><p>If the <span class="emphasis"><em>&#8211;instsecondary</em></span> qualifier is not specified, mupip uses the environment variable <span class="emphasis"><em>gtm_repl_instsecondary</em></span> for the name of the secondary instance. If that variable is not defined, a <span class="emphasis"><em>REPLINSTSECUNDF</em></span> error is issued.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>In this rare instance, a GT.M command from a prior version is not upward compatible in GT.M V5.1-000.</p></td></tr></table></div><p>Specifying a name longer than 15 characters or an empty string issues a <span class="emphasis"><em>REPLINSTSECLEN</em></span> error message.</p><p>The following source server commands now allow the <span class="emphasis"><em>&#8211;instsecondary</em></span> qualifier as an optional qualifier:</p><pre class="programlisting">
	mupip replic &#8211;source &#8211;checkhealth
	mupip replic &#8211;source &#8211;showbacklog
	mupip replic &#8211;source &#8211;shutdown 
	</pre><p>If the <span class="emphasis"><em>&#8211;instsecondary</em></span> is not specified with the above commands or if the environment variable <span class="emphasis"><em>gtm_repl_instsecondary</em></span> is not defined, the commands operate on ALL current active and passive source servers.</p><p>The secondary instance name needs to be specified explicitly (through the qualifier) or implicitly (through the environment variable) even for starting a passive source server. It is this secondary instance name that the passive source server will later connect to when it is activated.</p><p>If the secondary instance is unnamed, for example if the secondary instance is running an older version of GT.M, a dummy name suffices.</p><p>The above source server commands excepting the <span class="emphasis"><em>&#8211;start</em></span> command look for an existing slot corresponding to the specified secondary instance in the replication instance file. If none is found, a <span class="emphasis"><em>REPLINSTSECNONE</em></span> error is issued. In case of <span class="emphasis"><em>&#8211;start</em></span>, GT.M looks for a previously used slot for that secondary instance. Failing that, it looks for an empty slot, and if none is available, it takes over the slot from the least recently used secondary instance. If there are already 16 source servers, there are no open slots, and a <span class="emphasis"><em>SRCSRVTOOMANY</em></span> error is issued. If the name does not match the name sent by the receiver server on connection, a <span class="emphasis"><em>REPLINSTSECMTCH</em></span> error is issued.</p><p>Defining the environment variable appropriately allows pre-existing user replication scripts to run without any changes. Explicitly specifying the qualifier in the scripts improves clarity.</p></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id881654"></a>-ROOT[PRIMARY] and &#8211;PROPAGATE[PRIMARY] Qualifiers</h3></div></div></div><p>The following source server commands now support <span class="emphasis"><em>&#8211;rootprimary</em></span> and <span class="emphasis"><em>&#8211;propagateprimary</em></span> qualifiers:</p><pre class="programlisting">
	mupip replic &#8211;source &#8211;start &#8211;secondary=...
 	mupip replic &#8211;source &#8211;activate
	mupip replic &#8211;source &#8211;start &#8211;passive
 	mupip replic &#8211;source &#8211;deactivate
 	</pre><p>These are optional qualifiers. If not specified, a default value of <span class="emphasis"><em>&#8211;propagateprimary</em></span> is used for the passive source server startup command as well as the deactivate command and a default value of <span class="emphasis"><em>&#8211;rootprimary</em></span> is used for the other two commands. These default values enable users who are planning to limit themselves to one primary and multiple secondaries (without any tertiaries) to perform minimal changes, if any, to their replication scripts. However, it is recommended that these qualifiers be specified explicitly in the scripts, for clarity.</p><p>The <span class="emphasis"><em>&#8211;rootprimary</em></span> or the <span class="emphasis"><em>&#8211;propagateprimary</em></span> qualifiers are mutually exclusive.</p><p>Specifying &#8211;rootprimary either explicitly or implicitly enables GT.M updates on the specified replication instance.</p><p>Specifying <span class="emphasis"><em>&#8211;propagateprimary</em></span> explicitly or implicitly disables GT.M updates on the replication instance. An attempt by a GT.M process to update a replicated region issues a <span class="emphasis"><em>SCNDDBNOUPD</em></span> error.</p></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id882222"></a>Obsolete <span class="emphasis"><em>&#8211;UPDATE</em></span> Qualifier</h3></div></div></div><p>GT.M V5.1-000 does not support the <span class="emphasis"><em>&#8211;update</em></span> qualifier in the mupip replic <span class="emphasis"><em>&#8211;source</em></span> command. In prior GT.M versions, <span class="emphasis"><em>mupip replic &#8211;source &#8211;deactivate</em></span> disabled updates while <span class="emphasis"><em>&#8211;activate</em></span> enabled updates. In GT.M V5.1-000, <span class="emphasis"><em>&#8211;rootprimary</em></span> and <span class="emphasis"><em>&#8211;propagateprimary</em></span> control whether updates are enabled or disabled.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>GT.M updates to replicated regions are permitted only on the root primary instance and disabled on ALL other instances (including secondary, tertiary, etc.).</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>In this rare instance, a GT.M command from a prior version is not upward compatible in GT.M V5.1-000.</p></td></tr></table></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id882374"></a>MUPIP REPLIC &#8211;SOURCE &#8211;START</h3></div></div></div><p>If <span class="emphasis"><em>&#8211;rootprimary</em></span> is specified either explicitly or implicitly and the journal pool already exists and has updates disabled (i.e. journal pool was created by a source server startup command that explicitly or implicitly specified <span class="emphasis"><em>&#8211;propagateprimary</em></span>), a <span class="emphasis"><em>PRIMARYNOTROOT</em></span> error is issued. To transition a propagating primary instance to a root primary instance without bringing down the journal pool, issue a <span class="emphasis"><em>mupip replic -source -activate -rootprimary</em></span> for an already running passive source server (start one with <span class="emphasis"><em>-propagateprimary</em></span> if none is running).</p><p>If <span class="emphasis"><em>&#8211;propagateprimary</em></span> is either explicitly or implicitly specified, the journal pool already exists and has updates enabled (i.e. journal pool was created by a source server startup command that explicitly or implicitly specified <span class="emphasis"><em>&#8211;rootprimary</em></span>), a <span class="emphasis"><em>PRIMARYISROOT</em></span> error is issued. It is not possible to transition a root primary instance to a propagating primary instance without bringing down the journal pool.</p><p>If journal pool already exists when source server startup is issued, prior versions of GT.M would issue a <span class="emphasis"><em>&#8220;Source Server already exists&#8221;</em></span> error message. In GT.M V5.1-000, multiple source servers can be started from the same replication instance as long as each of them specify a different name for the <span class="emphasis"><em>&#8211;instsecondary</em></span> qualifier. If a source server is started with a secondary instance name that matches the primary instance name, a <span class="emphasis"><em>REPLINSTNMSAME</em></span> error message is issued. If a source server is started with a secondary instance name that has a corresponding source server already up and running, a <span class="emphasis"><em>SRCSRVEXISTS</em></span> error message is issued.</p><p>On a root primary or propagating primary instance, multiple source servers cannot be started as long as there is one source server actively connected to a dual-site secondary (i.e. a secondary running on a version of GT.M that does not support multi-site functionality). An attempt to do so results in a <span class="emphasis"><em>REPLUPGRADESEC</em></span> error. If an active source server on an instance finds more than one source server (active or passive) running on that instance at the time it connects to a dual-site secondary it issues a <span class="emphasis"><em>REPLUPGRADESEC</em></span> error.</p><p>On a propagating primary instance, a source server that connects to a dual-site tertiary issues a <span class="emphasis"><em>REPLUPGRADESEC</em></span> error. In addition, starting an active source server or activating a passive source server in a propagating primary issues a <span class="emphasis"><em>REPLUPGRADEPRI</em></span> error if the receiver server is actively connected to a dual-site primary.</p><p>In an instance, a maximum of 16 active and/or passive source servers are allowed at any point in time. If 16 source servers are already running and another source server startup is attempted, it issues a <span class="emphasis"><em>SRCSRVTOOMANY</em></span> error message.</p><p>To transition an instance from being a root primary to a secondary, it must first be brought back up as a secondary of the current (new) root primary instance. Bringing it up as a secondary causes a lost transaction file to be created. This lost transaction file needs to be applied on the current root primary instance followed by running a <span class="emphasis"><em>mupip replic -source -losttncomplete</em></span> command on the current root primary instance (as discussed elsewhere, during this time, either the former root primary should be running as a secondary to the current root primary, or the <span class="emphasis"><em>mupip replic -source -losttncomplete</em></span> command should be separately run on the former root primary). Once the <span class="emphasis"><em>mupip replic -source -losttncomplete</em></span> command has been run, the former root primary instance can be brought up as the secondary of any propagating primary. An attempt to bring a former root primary up as a secondary of a propagating primary instance prior to the <span class="emphasis"><em>mupip replic -source -losttncomplete</em></span> command causes the receiver server and the source server (running respectively on the secondary and primary instances) to issue a <span class="emphasis"><em>PRIMARYNOTROOT</em></span> error, when they first communicate with each other. </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The former root primary instance can be brought up as the secondary of any propagating primary, once a <span class="emphasis"><em>mupip replic -source -losttncomplete</em></span> command has been successfully run, either on the current (new) primary when the former root primary instance is connected to the current root primary, or when the command has been run separately on both the current primary and the former primary.</p></td></tr></table></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id881686"></a>MUPIP REPLIC &#8211;RECEIVER &#8211;START</h3></div></div></div><p>If the journal pool has updates enabled (i.e. journal pool was created by a source server startup command that explicitly specified or implicitly assumed &#8211;rootprimary), starting the receiver server on that instance issues a <span class="emphasis"><em>PRIMARYISROOT</em></span> error message.</p><p>If the receiver server finds any active source server running on the secondary instance at the time it connects to a primary running a prior version of GT.M, which does not support multi-site replication, it issues a <span class="emphasis"><em>REPLUPGRADEPRI</em></span> error.</p><p>If an instance transitions from being a root primary to a secondary, it is necessary that it be brought up as a secondary of the current root primary instance until a <span class="emphasis"><em>mupip replic -source -losttncomplete</em></span> command has been run implicitly or explicitly on that instance. Not doing so causes the receiver server and the source server (running respectively on the secondary and primary instances) to issue a <span class="emphasis"><em>PRIMARYNOTROOT</em></span> error, when they first communicate with each other. </p><p>Effective GT.M V5.1-000, the receiver server is an additional process attaching to the journal pool, which, means that the last source server running on any instance should be shutdown only after shutting down the running receiver server. Otherwise, a message is logged in the source server log indicating that the journal pool shared memory was not removed as processes were still attached to it.</p></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id882519"></a>MUPIP REPLIC &#8211;SOURCE &#8211;ACTIVATE</h3></div></div></div><p>If no source server is running for the secondary instance name specified in the activation command (the new <span class="emphasis"><em>-instsecondary</em></span> qualifier), a <span class="emphasis"><em>SRCSRVNOTEXIST</em></span> error is issued.</p><p>Assuming the passive source server is already running, there are four cases:</p><div class="orderedlist"><ol type="1"><li><p>If <span class="emphasis"><em>&#8211;rootprimary</em></span> is specified explicitly or implicitly and the journal pool has updates enabled, this command sets a flag in the journal pool to document the impending activation and returns successfully. This flag is detected within a few seconds by the concurrently running passive source server, which then transitions to being an active source server.</p></li><li><p>If <span class="emphasis"><em>&#8211;rootprimary</em></span> is specified explicitly or implicitly and the journal pool has updates disabled, this command checks if there are any processes attached to the journal pool other than just the single passive source server. If yes, then it issues a <span class="emphasis"><em>JNLPOOLACTIVATE</em></span> error message and exits. If not, this command enables updates in the journal pool, updates the replication instance file to indicate that the instance is henceforth a root primary, sets a flag in the journal pool to document the impending source server activation and returns successfully. This flag is detected within a few seconds by the concurrently running passive source server, which then transitions to being an active source server.</p></li><li><p>If <span class="emphasis"><em>&#8211;propagateprimary</em></span> is specified explicitly  or implicitly and the journal pool has updates enabled, this command issues a <span class="emphasis"><em>PRIMARYISROOT</em></span> error message.</p></li><li><p>If <span class="emphasis"><em>&#8211;propagateprimary</em></span> is specified explicitly or implicitly and the journal pool has updates disabled, this command sets a flag in the journal pool to document the impending activation and returns successfully. This flag is detected within a few seconds by the concurrently running passive source server, which then transitions to being an active source server.</p></li></ol></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id882658"></a>MUPIP REPLIC &#8211;SOURCE &#8211;DEACTIVATE</h3></div></div></div><p>If no source server is running for the secondary instance name specified in the activation command (the new <span class="emphasis"><em>-instsecondary</em></span> qualifier), a <span class="emphasis"><em>SRCSRVNOTEXIST</em></span> error is issued.</p><p>Assuming the active source server is already running, there are four cases.</p><div class="orderedlist"><ol type="1"><li><p>If <span class="emphasis"><em>&#8211;rootprimary</em></span> is specified explicitly or implicitly and the journal pool has updates enabled, this command sets a flag in the journal pool to document the impending deactivation and returns successfully. This flag is detected within a few seconds by the concurrently running active source server, which then transitions to being a passive source server.</p></li><li><p>If <span class="emphasis"><em>&#8211;rootprimary</em></span> is specified explicitly or implicitly and the journal pool has updates disabled, this command issues a <span class="emphasis"><em>PRIMARYNOTROOT</em></span> error message.</p></li><li><p>If <span class="emphasis"><em>&#8211;propagateprimary</em></span> is specified explicitly or implicitly and the journal pool has updates enabled, this command issues a <span class="emphasis"><em>PRIMARYISROOT</em></span> error message.</p></li><li><p>If <span class="emphasis"><em>&#8211;propagateprimary</em></span> is specified explicitly or implicitly and the journal pool has updates disabled, this command sets a flag in the journal pool to document the impending deactivation and returns successfully. This flag is detected within a few seconds by the concurrently running active source server, which then transitions to being a passive source server.</p></li></ol></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="start_inst"></a>Starting up an instance</h3></div></div></div><p>In the GT.M user documentation, unless the distinction is important in the context, a root primary is referred to simply as primary and a propagating primary is referred to simply as secondary. Note that any secondary can also be a propagating primary.</p><p>In order to bring up an instance as a primary, user startup scripts run the same steps they previously did to bring up the instance as primary. In addition, they can now bring up multiple source servers. As before, to create the journal pool, at least one source server must be brought up before any GT.M processes are activated. However, additional source servers can be brought up any time.</p><p>In order to bring up an instance as a secondary, user startup scripts run the same steps they previously did to bring up the instance as secondary. In addition, they can now bring up one or more active or passive source servers as well if they want to replicate to a tertiary. Note that the tertiary, if needed, can be brought up at any convenient time before or after the secondary is brought up. The replication stream between the secondary and tertiary is established when both are up &amp; running, and connected to each other.</p><p>When a primary or secondary is upgraded to GT.M V5.1-000 and is brought up for the first time, the receiver server startup command on the secondary should additionally specify the <span class="emphasis"><em>&#8211;updateresync</em></span> qualifier. Not specifying this qualifier causes the receiver server to fail at startup with a <span class="emphasis"><em>REPLINSTNOHIST</em></span> message. The secondary can be shut down and brought up without the <span class="emphasis"><em>-updateresync</em></span> qualifier only after at least one database update has been sent through the replication pipe and processed by the update process.</p></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="shut_inst"></a>Shutting down an instance</h3></div></div></div><p>In order to bring down an instance that is running as primary ALL source servers (active or passive) running on the instance must be shut down. This means that one needs to first shut down all GT.M, mupip reorg, mupip load etc. processes that could be attached to the journal pool and then shut down all active and/or passive source servers (using individual <span class="emphasis"><em>mupip replic &#8211;source &#8211;shutdown -instsecondary</em></span> commands or one <span class="emphasis"><em>mupip replic -source -shutdown</em></span> command without an <span class="emphasis"><em>-instsecondary</em></span> qualifier).</p><p>In order to bring down an instance that is running as secondary there is no change unless that secondary is also acting as a primary (i.e. that is a propagating primary). In such a case, after shutting down the secondary related servers (receiver server, update process and its helper processes), one also needs to shutdown the primary related servers (all active and/or passive source servers). In the secondary, there should not be any other GT.M or MUPIP processes attached to the journal pool as updates are disabled (they are enabled only on the primary). If there are processes like mupip reorg that operate on the database but do not attach to the journal pool, these processes also need to be brought down and finally a <span class="emphasis"><em>mupip rundown &#8211;reg *</em></span> needs to be performed to ensure the database, journal pool and receive pool shared memory is all rundown.</p><p>At shut down, at least one source server &#8211; not necessarily, the one originally brought up first &#8211; must be the last GT.M process to be shut down, and it cleans up the journal pool when it exits.</p></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id882869"></a>Primary and Secondary transitions</h3></div></div></div><p>Any instance can undergo one of the following four state transitions:</p><div class="orderedlist"><ol type="1"><li><p>primary coming up as primary</p></li><li><p>secondary coming up as primary</p></li><li><p>primary coming up as secondary</p></li><li><p>secondary coming up as secondary</p></li></ol></div><p>There is no change to the sequence of commands to shutdown a primary or secondary and bring it back as a primary or a secondary other than those already outlined in <a href="GTM_Multi_Site_Replication.html#start_inst">Starting up an instance</a> or <a href="GTM_Multi_Site_Replication.html#shut_inst">Shutting down an instance</a>.</p><p>Some points to note are:</p><div class="orderedlist"><ol type="1"><li><p>A primary must be shut down before it can be brought up as a secondary i.e. it is not possible to run <span class="emphasis"><em>mupip replic &#8211;source &#8211;deactivate</em></span> on the primary to transition it on the fly to a secondary.</p></li><li><p>A secondary on the other hand can be brought up as a primary without being shut down. To do that, one needs to issue a <span class="emphasis"><em>mupip replic &#8211;receiv &#8211;shut</em></span> (to shut down the receiver server, update process and helper processes) followed by a <span class="emphasis"><em>mupip replic &#8211;source &#8211;activate &#8211;secondary=</em></span> command to make a passive source server active.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>If an active source server is propagating updates, it can be deactivated to make it passive and then activated with the -rootprimary qualifier. </p></td></tr></table></div><p>This also makes it the root primary (unless the &#8211;propagateprimary flag is used, in which case it remains a secondary). Note that this works only if there is a single source server running on the secondary and it is a passive server. If not, all active source servers and all passive source servers except for one passive source server are to be brought down before being activated.</p></li><li><p>Any instance coming up as secondary must do a <span class="emphasis"><em>mupip journal &#8211;rollback &#8211;fetchresync</em></span> with the current primary, regardless of whether it was previously a secondary or primary. Not doing this could cause errors (secondary ahead of primary etc.) during receiver server startup.</p></li></ol></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id882897"></a>Refreshing secondary from backup of primary</h3></div></div></div><p>With GT.M V5.1-000, there are minor changes in the procedures used to recover the secondary when the databases/journals get out-of-sync with the primary.</p><p>The procedure to recover the secondary was to take an online backup of the primary databases, ship it to the secondary, create fresh journals on the secondary and start the receiver server on the secondary with the <span class="emphasis"><em>-updateresync</em></span> qualifier. With GT.M V5.1-000, there is an additional step, which is to recreate the replication instance file (at the time fresh journals are created) with the same name, as before. Also, there are more choices in selecting the backup source. One can take an online backup from either the root primary or another secondary.</p><p>Optionally, to reduce network bandwidth and system load on the primary from which the new instance has to catch up, the <span class="emphasis"><em>mupip journal -recover -forward</em></span> command was used to apply updates from journal files created on the primary subsequent to the backup before bringing the new instance up as a secondary. This procedure is now changed.</p><p>The new procedure to bring up a secondary instance from a backup is described below:</p><div class="orderedlist"><ol type="1"><li><p>Restore the backup (from a primary or another secondary instance). Note that in the event of a multi-region database, the backup must be consistent across all regions.</p></li><li><p>Optionally, apply the journal files (from the same instance where the database backup was taken from) with a <span class="emphasis"><em>mupip journal -recover -forward</em></span> command. There can be multiple journal files for each database region. For each region, perform a <span class="emphasis"><em>mupip journal -show=header -forward</em></span> on the latest journal file, and note the largest <span class="emphasis"><em>End Region Sequence Number</em></span> displayed. Use the <span class="emphasis"><em>dse change -file -reg_seqno</em></span> command on the corresponding region to set the region sequence number to be equal to the noted number. Perform the same for all replicated regions in the instance.</p></li><li><p>Create new journal files for the restored database regions.</p></li><li><p>Create a new instance file with the same name as the previous instance file on the secondary instance.</p></li><li><p>Start a receiver server with the <span class="emphasis"><em>-updateresync</em></span> qualifier</p></li></ol></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id882796"></a>Lost transaction processing</h3></div></div></div><p>A <span class="emphasis"><em>mupip journal -rollback -fetchresync</em></span> command is now always required whenever a secondary is brought up. Consider the case where A is replicating to B and C; B is replicating to D and C is replicating to E. After a failover in which B becomes the new primary, C needs to use the <span class="emphasis"><em>-fetchresync</em></span> qualifier before coming up as a secondary to B. D continues operating normally. In the event C's <span class="emphasis"><em>-fetchresync</em></span> requires it to rollback some transactions, E (and any other instances that are part of a tree with C as its root) also need to be brought down, and a <span class="emphasis"><em>mupip journal -rollback -fetchresync</em></span> performed, before it can be brought back up again. When the original primary, A, becomes a new secondary (to B), it first needs to execute a <span class="emphasis"><em>mupip journal -rollback -fetchresync</em></span> before it can become the secondary. These <span class="emphasis"><em>mupip journal -rollback -fetchresync</em></span> commands potentially generate lost transaction files on the respective secondaries, but the only one that needs to be applied to B is the lost transaction file from A, the original primary. The format of the lost transaction file has therefore been altered to make it easy to distinguish whether the file needs to be sent to the new primary for reprocessing.</p><p>A new field in the first line of the lost transaction file identifies a lost transaction file that needs to be applied. Previously, the first line featured the format of the file as the first and only field and it was a string of the form <span class="emphasis"><em>GDSJEXnn</em></span> where nn was the existing format of the lost transaction file.</p><p>The current version features multiple fields in the first line. These are as follows:</p><div class="itemizedlist"><ul><li><p>The first field displays <span class="emphasis"><em>GDSJEX03</em></span> signifying the file format version.</p></li><li><p>The second field indicates whether it is rollback or recover that created the lost transaction file.</p><div class="itemizedlist"><ul><li><p>If the second field is rollback, a third field indicates whether the instance was a primary or secondary immediately prior to the lost transaction file being generated. If it was a primary, the lost transaction file is termed a primary lost transaction file and it needs to be applied on the new primary. A fourth field holds the name of the replication instance on which the lost transactions were generated. This instance name should be used as the <span class="emphasis"><em>-instsecondary</em></span> qualifier in the <span class="emphasis"><em>mupip replic -source -needrestart</em></span> command when the lost transactions are applied at the new primary.</p></li></ul></div></li></ul></div><p>Except following a failover when the backlog is zero, whenever a former primary comes up as a new secondary, there is a lost transaction file. This lost transaction file should be applied at the new primary as soon as practicable, as, there could be additional lost transaction files in the event of other failovers, e.g., triggered by a failure of the new primary, before the lost transaction file is processed. These additional lost transaction files can complicate the logic needed for lost transaction processing.</p><p>Lost transactions can be applied on the new primary either manually or in a semi-automated fashion using the M-intrinsic function <span class="emphasis"><em>$ZQGBLMOD()</em></span>. If <span class="emphasis"><em>$ZQGBLMOD()</em></span> is used, two additional steps ( <span class="emphasis"><em>mupip replicate -source -needrestart </em></span> and  <span class="emphasis"><em>mupip replicate -source -losttncomplete </em></span>) are to be performed as part of lost transaction processing, regardless of whether replication is configured in dual-site or multi-site mode. Failure to run these steps can cause <span class="emphasis"><em>$ZQGBLMOD()</em></span> to return false negatives that in turn can result in application data consistency issues.</p><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id882940"></a>MUPIP REPLIC &#8211;SOURCE &#8211;NEEDREST[ART]</h4></div></div></div><p>The <span class="emphasis"><em>mupip replic &#8211;source &#8211;needrestart</em></span> command should be invoked once for each lost transaction file that needs to be applied. It should be invoked on the new primary before applying lost transactions from that file. The <span class="emphasis"><em>&#8211;instsecondary</em></span> qualifier needs to be specified in this command to provide the instance name of the secondary where this lost transaction file were generated. If not, the environment variable <span class="emphasis"><em>gtm_repl_instsecondary</em></span> is implicitly assumed to hold the name of the secondary instance. If that is not defined either, a <span class="emphasis"><em>REPLINSTSECUNDF</em></span> error is issued.</p><pre class="programlisting">
 mupip replic &#8211;source &#8211;needrestart &#8211;instsecondary=...
 </pre><p>The purpose of this command is to check whether the primary ever communicated with the specified secondary instance (if the receiver server or a fetchresync rollback on the secondary instance communicated with the source server) since the primary was brought up. If so, this command displays the message <span class="emphasis"><em>SECONDARY INSTANCE xxxx DOES NOT NEED TO BE RESTARTED</em></span> indicating that the secondary instance did communicate with the primary and hence does not need to be restarted. If not, this command displays the message <span class="emphasis"><em>SECONDARY INSTANCE xxxx NEEDS TO BE RESTARTED FIRST</em></span>. In this case, the specified replication instance needs to be brought up as a secondary before the lost transactions from this file are applied. Failure to do so before applying the corresponding lost transactions causes $ZQGBLMOD() to return false negatives which can result in application data inconsistencies as mentioned earlier.</p><p>In the event the lost transaction file was generated from the same instance to which it is to be applied, a <span class="emphasis"><em>mupip replicate -source -needrestart</em></span> command is not required, and if attempted results in a <span class="emphasis"><em>REPLINSTNMSAME</em></span> error.</p><p>It is necessary for the secondary instance (specified in the -needrestart command) to be brought up as an immediate secondary of the current primary. If it is brought up as a tertiary to the current primary (through a different intermediate secondary instance), the <span class="emphasis"><em>-needrestart</em></span> command unconditionally considers the tertiary instance as not having communicated with the primary even though the tertiary might be up and running.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The source server on the primary and/or receiver server or fetchresync rollback on that particular secondary need not be up and running at the time this command is run. However, it is adequate if they were up at some point in time after the primary instance was brought up. </p></td></tr></table></div><p>This command protects against a case where the primary instance when the lost transaction file is generated is different from the primary instance when the lost transactions are applied (note that even though they can never be different in case of a dual-site configuration, use of this command is nevertheless still required). </p><p><span class="emphasis"><em>$ZQGBLMOD()</em></span> relies on two fields in the database file header of the primary instance to be set appropriately. Prior versions of GT.M displayed one of these fields as <span class="emphasis"><em>Resync Trans</em></span> (using the <span class="emphasis"><em>dse dump &#8211;fileheader</em></span> command). This is now changed to <span class="emphasis"><em>Zqgblmod Trans</em></span> in GT.M V5.1-000. A new field <span class="emphasis"><em>Zqgblmod Seqno</em></span> has been introduced in GT.M V5.1-000 and it is displayed by the <span class="emphasis"><em>dse dump -fileheader</em></span> command. </p><p>In a dual-site configuration, there are only two instances and both of them participate in the determination of the journal sequence number to which to roll back the secondary when a <span class="emphasis"><em>rollback &#8211;fetchresync</em></span> is run. This makes it possible for both the instances to record the same sequence number information (<span class="emphasis"><em>Zqgblmod Seqno</em></span> and the corresponding transaction number <span class="emphasis"><em>Zqgblmod Trans</em></span>) in their respective file headers at the same time that lost transactions are generated without requiring any additional commands. </p><p>In a multi-site configuration, there are more than two instances, and no instances other than the primary and secondary involved in the <span class="emphasis"><em>rollback &#8211;fetchresync</em></span> participate in the sequence number determination. Hence, they do not have their <span class="emphasis"><em>Zqgblmod Seqno</em></span> (and hence <span class="emphasis"><em>Zqgblmod Trans</em></span>) set when that particular lost transaction file is generated. If any of the non-participating instances is brought up as the new primary and that particular lost transaction file is applied on the primary, the return values of <span class="emphasis"><em>$ZQGBLMOD()</em></span> will be unreliable since the reference point (<span class="emphasis"><em>Zqgblmod Trans</em></span>) was not set appropriately. Hence, this command checks whether the secondary instance where the lost transaction was previously generated has communicated with the current primary instance after it came up as the primary. If it is affirmative, the <span class="emphasis"><em>Zqgblmod Seqno</em></span> and <span class="emphasis"><em>Zqgblmod Trans</em></span> fields would have been appropriately set and hence <span class="emphasis"><em>$ZQGBLMOD()</em></span> values will be correct.</p><p>The <span class="emphasis"><em>-needrestart</em></span> qualifier is incompatible with all source server qualifiers except <span class="emphasis"><em>-instsecondary</em></span>.</p></div><div class="sect3" lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id883195"></a>MUPIP REPLIC &#8211;SOURCE &#8211;LOSTTN[COMPLETE]</h4></div></div></div><p>Once lost transaction files from ALL secondaries that went down as primaries and came up as secondaries have been applied on the new primary, the following command should be run on the new primary to record the fact that lost transaction processing using <span class="emphasis"><em>$ZQGBLMOD()</em></span> is complete.</p><pre class="programlisting">
  mupip replic &#8211;source &#8211;losttncomplete
  </pre><p>This command updates the <span class="emphasis"><em>Zqgblmod Seqno</em></span> and <span class="emphasis"><em>Zqgblmod Trans</em></span> fields (displayed by a <span class="emphasis"><em>dse dump &#8211;fileheader</em></span> command) in the database file headers of all regions in the global directory to the value 0. Doing so causes a subsequent <span class="emphasis"><em>$ZQGBLMOD()</em></span> to return the safe value of one unconditionally until the next lost transaction file is created.</p><p>This command should ideally be also run on each of the secondary instances.</p><p>However, the command need not be run explicitly as the same effect is implicitly achieved, if the following conditions are true:</p><div class="itemizedlist"><ul><li><p>The secondary is already connected to the primary at the time the command is run on the primary.</p></li><li><p>The secondary is not connected at the time the command is run. However, it will eventually connect to the primary, before the primary is brought down after running the command.</p></li></ul></div><p>The command has to be run on an instance either explicitly or implicitly to prevent a future <span class="emphasis"><em>$ZQGBLMOD()</em></span> on that instance from returning false positives when applying future lost transactions. This ensures accuracy of future <span class="emphasis"><em>$ZQGBLMOD()</em></span>.</p><p>Running <span class="emphasis"><em>mupip replic -source -losttncomplete</em></span> command explicitly or implicitly on a former primary instance is required before that instance can be started as a tertiary; otherwise <span class="emphasis"><em>Zqgblmod Seqno</em></span> remains non-zero, and this could cause a <span class="emphasis"><em>PRIMARYNOTROOT</em></span> error to be issued while starting a receiver server on that instance against a propagating primary source server.</p><p>The <span class="emphasis"><em>-losttncomplete</em></span> qualifier is incompatible with all other <span class="emphasis"><em>mupip replicate -source</em></span> qualifiers.</p></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id882962"></a>MUPIP REPLIC &#8211;EDIT[INSTANCE]</h3></div></div></div><p>This command is used to display or edit the contents of the replication instance file. The instance file name should be specified as the last parameter in this command. Not specifying the instance file name causes a <span class="emphasis"><em>MUPCLIERR</em></span> error to be issued. Although editing the instance file does not require standalone access to the instance file, it should be avoided as far as possible when concurrent processes are reading/writing from/to it.</p><p>This command issues a <span class="emphasis"><em>FILENOTFND</em></span> error if the instance file is not found and a <span class="emphasis"><em>REPLINSTFMT</em></span> error message if the replication instance file was created by a GT.M version prior to V5.1-000.</p><p>The <span class="emphasis"><em>-editinstance</em></span> qualifier is incompatible with other <span class="emphasis"><em>mupip replic</em></span> qualifiers i.e. <span class="emphasis"><em>-receiver, -source, -updateproc, -updhelper, or -instance_create</em></span>. To display the contents of the instance file use the <span class="emphasis"><em>-show qualifier</em></span> i.e. a <span class="emphasis"><em>mupip replic &#8211;edit &#8211;show &lt;instance-file&gt;</em></span> command. This command displays each of the following sections.</p><div class="orderedlist"><ol type="1"><li><p>File Header</p></li><li><p>Source Server Slots</p></li><li><p>History Records</p></li></ol></div><p>If an optional <span class="emphasis"><em>-detail</em></span> qualifier is additionally specified, all fields within each section are displayed along with their offset from the beginning of the file and the size of each field. This is used when there is a need to edit the instance file. To edit any displayed field, use the <span class="emphasis"><em>-change</em></span> qualifier. In addition, one can specify the offset to change using the <span class="emphasis"><em>-offset</em></span> qualifier, the size of the change using the <span class="emphasis"><em>-size</em></span> qualifier and the new value with the <span class="emphasis"><em>-value</em></span> qualifier.</p><p>The entire command to effect any edits is <span class="emphasis"><em>mupip replic &#8211;edit &#8211;change &#8211;offset= -size= -value= &lt;instance-file&gt;</em></span>.</p><p>The <span class="emphasis"><em>-size</em></span> qualifier can be either 1, 2, 4, or 8 indicating the bytes to be changed. Specifying any other values causes a <span class="emphasis"><em>SIZENOTVALID8</em></span> error to be issued. </p><p>The <span class="emphasis"><em>-offset</em></span> qualifier takes a hexadecimal value that is a multiple of the size qualifier; otherwise, an appropriate error message is issued. Similarly, if the offset specified is greater than the size of the instance file, an appropriate error message is issued. </p><p>The <span class="emphasis"><em>-value</em></span> qualifier specifies the new hexadecimal value at the specified offset. Not specifying the <span class="emphasis"><em>-value</em></span> qualifier displays the current value at the specified offset and does not perform any changes. Specifying <span class="emphasis"><em>&#8211;value</em></span> makes the changes and both the old and new values are displayed.</p><p>The <span class="emphasis"><em>-detail</em></span> qualifier is incompatible with <span class="emphasis"><em>&#8211;change</em></span>. Only one of <span class="emphasis"><em>-change</em></span> or <span class="emphasis"><em>-show</em></span> can be specified in a single command line. The <span class="emphasis"><em>-offset</em></span>, <span class="emphasis"><em>-size</em></span> and <span class="emphasis"><em>-value</em></span> qualifiers are only compatible with <span class="emphasis"><em>-change</em></span>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The instance file should be edited only when so instructed by Fidelity GT.M Support.</p></td></tr></table></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id883590"></a>MUPIP REPLIC -SOURCE &#8211;JNLPOOL</h3></div></div></div><p>The <span class="emphasis"><em>mupip replic -source -jnlpool</em></span> command allows one to display and edit the contents of the journal pool. The <span class="emphasis"><em>-show</em></span> qualifier displays the contents of the journal pool. The optional qualifier <span class="emphasis"><em>-detail</em></span> prints offsets and size of each field.</p><p><span class="emphasis"><em>Mupip replic -source -jnlpool -show &#8211;detail</em></span> displays the contents of the journal pool along with the offsets.</p><p>The <span class="emphasis"><em>-change</em></span> qualifier allows one to edit the journal pool contents. The additional qualifiers <span class="emphasis"><em>-offset</em></span>, <span class="emphasis"><em>-size</em></span>, <span class="emphasis"><em>-value</em></span> specify the actual changes as in the <span class="emphasis"><em>mupip replic &#8211;edit[instance]</em></span> command.</p><p>The <span class="emphasis"><em>-detail</em></span> qualifier is incompatible with <span class="emphasis"><em>&#8211;change</em></span>. Only one of <span class="emphasis"><em>-change</em></span> or <span class="emphasis"><em>-show</em></span> can be specified in a single command line. The <span class="emphasis"><em>-offset</em></span>, <span class="emphasis"><em>-size</em></span> and <span class="emphasis"><em>-value</em></span> qualifiers are only compatible with <span class="emphasis"><em>-change</em></span>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>This command should be used only when so instructed by Fidelity GT.M Support.</p></td></tr></table></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="dse_dump_file"></a>DSE DUMP -FILE[HEADER]</h3></div></div></div><p>In previous versions, <span class="emphasis"><em>dse dump -fileheader</em></span> printed the field <span class="emphasis"><em>Resync Seqno</em></span>, which represented the journal sequence number up to which both the primary and secondary are synchronized. With logical dual-site, there were only two instances at any point in time and hence from the perspective of each instance there is only one other instance. This made it possible to store the synchronization point with respect to the other instance in the database file headers of each instance. With multi-site, a given instance can act as a primary for more than one secondary instance and each secondary can be synchronized at different sequence numbers with respect to the primary. This information has been moved to the replication instance file where it is maintained separately for each secondary instance. In GT.M V5.1-000, <span class="emphasis"><em>dse dump -fileheader</em></span> no longer prints the <span class="emphasis"><em>Resync Seqno</em></span> field.</p><p>In prior versions of GT.M, <span class="emphasis"><em>Resync Trans</em></span> was printed on the same line as <span class="emphasis"><em>Resync Seqno</em></span>. This field is named <span class="emphasis"><em>Zqgblmod Trans</em></span> in GT.M V5.1-000 and it serves as the reference transaction number for the M function <span class="emphasis"><em>$ZQGBLMOD()</em></span>. In addition, the journal sequence number corresponding to <span class="emphasis"><em>Zqgblmod Trans</em></span> is displayed in the place earlier occupied by <span class="emphasis"><em>Resync Seqno</em></span> as <span class="emphasis"><em>Zqgblmod Seqno</em></span>.</p><p>Thus, the last line of the <span class="emphasis"><em>dse dump -fileheader</em></span> output will change from:</p><pre class="programlisting">
  Resync Seqno           0x0000000000000001  Resync Trans    0x0000000000000001
  </pre><p>to</p><pre class="programlisting">
  Zqgblmod Seqno         0x0000000000000001  Zqgblmod Trans  0x0000000000000001
  </pre></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id883442"></a>DSE CHANGE -FILE[HEADER]</h3></div></div></div><p>Due to the changes discussed in <a href="GTM_Multi_Site_Replication.html#dse_dump_file">DSE DUMP -FILE</a>, the <span class="emphasis"><em>dse change -fileheader</em></span> command no longer supports the <span class="emphasis"><em>-resync_seqno</em></span> and <span class="emphasis"><em>-resync_tn</em></span> qualifiers. Instead, it supports <span class="emphasis"><em>-zqgblmod_seqno</em></span> and <span class="emphasis"><em>-zqgblmod_tn</em></span> in order to modify the <span class="emphasis"><em>Zqgblmod Seqno</em></span> and <span class="emphasis"><em>Zqgblmod Trans</em></span> fields of the database file header, respectively.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>In this rare instance, a GT.M command from a prior version is not upward compatible in GT.M V5.1-000.</p></td></tr></table></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id883849"></a>MUPIP JOURNAL -ROLLBACK</h3></div></div></div><p>If an instance transitions from being a root primary to a secondary, it is necessary that it be brought up as a secondary of the current root primary instance until a mupip replic -source -losttncomplete command has been run implicitly or explicitly on that instance. Not doing so, causes a <span class="emphasis"><em>PRIMARYNOTROOT</em></span> error to be issued by any <span class="emphasis"><em>mupip journal -rollback -fetchresync</em></span> command that is run on this former primary instance trying to start up as a tertiary. The source server on the propagating primary instance that the rollback communicates with also issues the same error. Note that once a <span class="emphasis"><em>mupip replic -source -losttncomplete</em></span> command has been successfully run on the instance, the rollback command can be run to enable bringing up the instance as a tertiary instance.</p></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id883812"></a>MUPIP BACKUP</h3></div></div></div><p>With GT.M V5.1-000, <span class="emphasis"><em>mupip backup</em></span> has the ability to take a consistent online or offline backup of the replication instance file through a new optional qualifier <span class="emphasis"><em>-replinstance=&lt;destination-file-or-directory&gt;</em></span>. </p><p>If a destination directory is specified, the instance file is backed up in the destination directory with the same name as the instance file. This qualifier can be specified along with a list of database regions to backup in which case a consistent backup of the instance file as well as all the database regions specified is obtained as of the start of the backup. This qualifier can also be specified without any other database regions in which case only the replication instance file is backed up. In this case, none of the other mupip backup qualifiers is applicable.</p></div></div><div class="sect1" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h2 class="title"><a id="id882594"></a>Rolling Upgrade</h2></div></div></div><div class="sect2" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h3 class="title"><a id="id883491"></a>From a GT.M Dual-site version to a GT.M Multi-site version</h3></div></div></div><p>Before using any features of the multi-site version of GT.M, both the primary and secondary in the existing dual-site configuration must be upgraded to the new version of GT.M that supports multi-site replication. This GT.M version upgrade can be done using a rolling software upgrade procedure that provides continuous application availability during the upgrade as discussed in the documentation and as summarized below.</p><p>Assuming that Site A and Site B are the two sites and that Site A is the primary before the upgrade, here are the steps to perform the rolling upgrade:</p><div class="itemizedlist"><ul><li><p>Site A continues to operate normally.</p></li><li><p>On Site B: </p><div class="itemizedlist"><ul><li><p>Shut down application processes, and the receiver &amp; source servers.</p></li><li><p>Run down the database and make a backup copy. </p></li><li><p>Upgrade GT.M to the new version that supports multi-site replication. </p></li><li><p>If this is a version upgrade from GT.M V4 to GT.M V5, the database also needs to be upgraded using the procedure in the <a href="GTM_Database_Migration.html" class="olink"> GT.M Database Migration Technical Bulletin</a>. Note that for the sake of simplicity, Fidelity recommends separating the two upgrades. </p></li><li><p>Recreate the replication instance file using <span class="emphasis"><em>mupip replic -instance_create</em></span> from the new GT.M version. This is required as the format of the instance file has changed. Note that an instance name now has to be specified while creating a replication instance file. </p></li><li><p>Bring up the secondary on Site B. The receiver server should be started with the <span class="emphasis"><em>-updateresync</em></span> qualifier. </p></li></ul></div></li><li><p>At this point, dual-site replication is restored with Site B running the new GT.M multi-site version and Site A running the old GT.M dual-site version. Operate in this mode as needed to verify correct operation. </p></li><li><p>Perform a controlled failover. Make Site A the secondary and Site B the primary.</p></li><li><p>Site B continues to operate normally as the new primary. </p></li><li><p>Upgrade Site A following the same procedure used to upgrade Site B.</p></li><li><p>At this point, dual-site replication is restored with both sites running the new GT.M multi-site version, Operate in this mode as needed to verify correct operation. </p></li><li><p>Perform a controlled failover. Make Site A the primary and Site B the secondary. Operate in this mode as needed to verify correct operation.</p></li><li><p>You can now add additional secondaries, and tertiaries as appropriate. </p></li></ul></div></div></div><div class="sect1" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h2 class="title"><a id="id884073"></a>Error Messages</h2></div></div></div><p>
            <div class="informaltable"><table border="0" width="90%"><colgroup><col></col><col></col></colgroup><tbody><tr><td align="left" valign="top"><p><span class="emphasis"><em>ACTIVATEFAIL</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Failed to activate passive source server for secondary instance name xxxx</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued by a <span class="emphasis"><em>mupip replic &#8211;source &#8211;activate</em></span> command when it tries to activate a passive source server and at the same time switch the instance from being a secondary (propagating primary) to a root primary. It is possible to switch an instance from being a secondary to a root primary by activating an already running passive source server on that instance at the same time specifying the <span class="emphasis"><em>rootprimary</em></span> qualifier. But there should be no process other than the one passive source server running on that instance. If not the above error is issued.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Shutdown all processes other than the passive source server that are running on that replication instance (source servers, receiver server, update process, GT.M processes etc.) and are accessing the journal pool and then reissue the <span class="emphasis"><em>mupip replic &#8211;source &#8211;activate</em></span> command.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>PRIMARYISROOT</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Attempted operation not valid on root primary instance xxxx</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>If a replication instance is a root primary (the journal pool already exists and was created by a source server command that specified <span class="emphasis"><em>rootprimary</em></span>), issuing a source server command with the <span class="emphasis"><em>start</em></span>, <span class="emphasis"><em>activate</em></span> or <span class="emphasis"><em>deactivate</em></span> qualifiers that has the <span class="emphasis"><em>propagateprimary</em></span> qualifier explicitly specified (or implicitly assumed) or attempting to start a receiver server on this instance will cause this error to be issued.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Do not start receiver server on a root primary instance. Use <span class="emphasis"><em>rootprimary</em></span> qualifier instead of <span class="emphasis"><em>propagateprimary</em></span> in the source server command.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>PRIMARYNOTROOT</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Attempted operation not valid on non-root primary instance xxxx</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>If a replication instance is not a root primary (the journal pool already exists and was created by a source server command that specified <span class="emphasis"><em>propagateprimary</em></span>), issuing a source server command with the <span class="emphasis"><em>start</em></span> or <span class="emphasis"><em>deactivate</em></span> qualifiers that has the <span class="emphasis"><em>rootprimary</em></span> qualifier explicitly specified (or implicitly assumed) on this instance will cause this error to be issued.  This error can also be issued by the receiver server or mupip rollback if the instance that the source server is running on is not a root primary and it connects to a receiver server or a <span class="emphasis"><em>mupip journal -rollback -fetchresync</em></span> running on an instance that was formerly a root primary and has not yet had a <span class="emphasis"><em>mupip replic -source -losttncomplete</em></span> command run either explicitly or implicitly on it.  </p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Use <span class="emphasis"><em>propagateprimary</em></span> qualifier instead of <span class="emphasis"><em>rootprimary</em></span> in the source server command.  If this error is issued by the receiver server or fetchresync rollback, the secondary instance has to be brought up as the secondary of a root primary since it was a root primary immediately before this.  The rule is that any instance that was previously a root primary should be brought up as a secondary of the new root primary.  This will create a lost transaction file that needs to be applied on the new root primary.  Once that is done, a <span class="emphasis"><em>mupip replic -source -losttncomplete</em></span> command should be run either explicitly or implicitly on this instance before trying to bring this up as a secondary of a propagating primary.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTDBMATCH</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Replication instance file xxxx has seqno xxxx while database has a different seqno yyyy</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued by the first source server that is started on a replication instance or a <span class="emphasis"><em>mupip journal -rollback</em></span> command if the journal sequence numbers stored in the instance file does not match that stored in the database file header. This is possible if the database was recreated or refreshed from a backup on another instance without correspondingly recreating the instance file.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>If this instance is not the root primary, this error can be handled by restoring both the database and the instance file from a previous backup (consistent backup of the instance file AND database files taken together at the same time) and restarting the instance.  Subsequent to such a restore, all transactions since the last backup will be sent across from this instance's primary.  Alternatively, this can be handled by shipping a copy of the database from any other instance (either the primary or any other secondary/tertiary), recreating the instance file and starting this instance as a secondary with the <span class="emphasis"><em>-updateresync</em></span> qualifier.  In either case, this procedure has to be repeated on all tertiary instances etc. that descend from this instance ensuring that for every primary-secondary instance pair, the secondary is not ahead of the primary in terms of journal sequence number.  If this instance is the root primary, restoring from a prior backup may not be viable as it may mean loss of transactions that occurred after the backup.  The alternative way to handle this error is to recreate the instance file on the root primary, ship a copy of the database from the primary and recreate instance files on ALL secondaries (tertiaries etc.) and restart the secondaries with the <span class="emphasis"><em>-updateresync</em></span> qualifier.  In addition, report this occurrence to Fidelity GT.M Support.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTFMT</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Format error encountered while reading replication instance file xxxx.  Expected yyyy.  Found zzzz. </em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>Runtime Error:</p></td><td align="left" valign="top"><p>This error is issued by GT.M or MUPIP whenever it tries to open the replication instance file and finds that it was created with a format that the current version of GT.M cannot interpret</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Recreate the instance file using the <span class="emphasis"><em>mupip replic &#8211;instance_create</em></span> command with the current version of GT.M.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></img></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The <span class="emphasis"><em>REPLINSTCORRV</em></span> message that was displayed in V5.0-000 has now been replaced by <span class="emphasis"><em>REPLINSTFMT</em></span></p></td></tr></table></div></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTNMLEN</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Replication instance name xxxx should be 1 to 15 characters long</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued by the <span class="emphasis"><em>mupip replic instance_create</em></span> command if the instance name was specified either through the <span class="emphasis"><em>name</em></span> qualifier or through the environment variable <span class="emphasis"><em>gtm_repl_instname</em></span> and if name was longer than 15 characters or was the empty string.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Specify a valid instance name that is 1 to 15 characters long.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTNMSAME</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Primary and Secondary instances have the same replication instance name xxxx</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued by any source server command where the <span class="emphasis"><em>-instsecondary</em></span> qualifier specifies a secondary instance name that matches the name of the primary instance the command is started from. </p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Two instances should never have the same name. Recreate the instance file on the secondary with a different name and restart the receiver server with the <span class="emphasis"><em>updateresync</em></span> qualifier.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTNMUNDEF</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Replication instance name not defined </em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued by the <span class="emphasis"><em>mupip replic -instance_create</em></span> command if the <span class="emphasis"><em>-name</em></span> qualifier was not specified and if the environment variable <span class="emphasis"><em>gtm_repl_instname</em></span> is not defined either.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Specify the instance name using the <span class="emphasis"><em>-name</em></span> qualifier</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTNOHIST</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>History record for xxxx not found in replication instance file yyyy</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error or Warning</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>The source server or receiver server issue this message as an error while mupip rollback issues this message as a warning when they scan the replication instance file looking for a history record corresponding to a journal sequence number that is lesser than the earliest sequence number or greater than the latest sequence number stored in the instance file. This means that the replication instance files on the primary and secondary have differing level of history detail (possible if the instance file was later recreated in one instance) and that it is no longer possible to determine the sync point (<span class="emphasis"><em>resync seqno</em></span>) between the two instances.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>If mupip rollback issues this error, it truncates the replication instance file history.  This means that if this instance is a secondary, it should be brought up with the <span class="emphasis"><em>-updateresync</em></span> qualifier.  If the source or receiver server issue this error, this error needs to be handled by ensuring the primary and secondary databases are in sync (by shipping a copy of the database from the primary to the secondary if not already done), recreating the instance file on the secondary (if not already done) and start the receiver server on the secondary with the <span class="emphasis"><em>-updateresync</em></span> qualifier.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTSECLEN</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Secondary replication instance name xxxx should be 1 to 15 characters long</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued by any <span class="emphasis"><em>mupip replic -source</em></span> command that specifies a secondary instance name. This error is issued if the secondary instance name was specified either through the <span class="emphasis"><em>-instsecondary</em></span> qualifier or through the environment variable <span class="emphasis"><em>gtm_repl_instsecondary</em></span> and if the name was longer than 15 characters or was the empty string.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Specify a valid secondary instance name that is 1 to 15 characters long.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTSECMTCH</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Secondary replication instance name xxxx sent by receiver does not match yyyy specified at source server startup</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued by a source server that connects to a receiver server on the secondary and finds that the secondary instance name sent by the receiver does not match the secondary instance name specified (INSTSECONDARY qualifier) when the source server was started.  The source server terminates after issuing this error.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Restart the source server with the correct <span class="emphasis"><em>-instsecondary</em></span> qualifier value.  Also make sure the instance name in the <span class="emphasis"><em>-instsecondary</em></span> qualifier and the host/port information in the <span class="emphasis"><em>secondary</em></span> qualifier of the source server startup command correspond to each other.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTSECNONE</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>No slot found for secondary instance xxxx in instance file yyyy</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued by any <span class="emphasis"><em>mupip replic source</em></span> command that specifies a secondary instance name (except for the one which specifies <span class="emphasis"><em>&#8211;start</em></span>). There are 16 slots in the instance file to store information pertaining to 16 different secondary instances. When the secondary instance name is specified, an attempt is made to find an unused or already used slot corresponding to the specified secondary instance in the replication instance file. If such a slot is not available, this error is issued. </p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Ensure the primary instance does not connect to more than 16 secondaries for the life of the instance file.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTSECUNDF</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Secondary replication instance name not defined</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued by any <span class="emphasis"><em>mupip replic -source</em></span> command that requires a secondary instance name to be specified. The source server commands that require this qualifier are those that have any of <span class="emphasis"><em>-activate</em></span>, <span class="emphasis"><em>changelog</em></span>, <span class="emphasis"><em>deactivate</em></span>, <span class="emphasis"><em>needrestart</em></span>, <span class="emphasis"><em>start</em></span>, <span class="emphasis"><em>statslog</em></span> or <span class="emphasis"><em>stopsourcefilter</em></span> specified. The secondary name can be specified either through the INSTSECONDARY qualifier or through the environment variable gtm_repl_instsecondary. If neither of them is specified, this error is issued.  </p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Specify the secondary instance name using the INSTSECONDARY qualifier.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTSEQORD</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>ssss has seqno xxxx which is less than last record seqno yyyy in replication instance file zzzz</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued in one of two scenarios. The instance file consists of a sequence of history records that should correspond to an increasing range of sequence numbers. They need to hence have their starting sequence number in increasing order.  If an attempt is made to append a history record with a starting sequence number that is lesser than the last history record currently existing in the instance file, the source or receiver server issues this error.  In this case ssss would be the string New history record.  This error is also issued if at journal pool creation time, the source server notices that the instance file header has a value of the current seqno that is lesser than the starting seqno of the last history record in the instance file.  In this case ssss would be the string Instance file header.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>If this instance is not the root primary, this error can be handled by restoring both the database and the instance file from a previous backup (consistent backup of the instance file AND database files taken together at the same time) and restarting the instance.  Subsequent to such a restore, all transactions since the last backup will be sent across from this instance's primary.  Alternatively, this can be handled by shipping a copy of the database from any other instance (either the primary or any other secondary/tertiary), recreating the instance file and starting this instance as a secondary with the UPDATERESYNC qualifier.  In either case, this procedure has to be repeated on all tertiary instances etc. that descend from this instance ensuring that for every primary-secondary instance pair, the secondary is not ahead of the primary in terms of journal seqno.  If this instance is the root primary, restoring from a prior backup may not be viable as it may mean loss of transactions that occurred after the backup.  The alternative way to handle this error is to recreate the instance file on the root primary, ship a copy of the database from the primary and recreate instance files on ALL secondaries (tertiaries etc.) and restart the secondaries with the UPDATERESYNC qualifier.  In addition, report this occurrence to Fidelity GT.M Support.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTSTNDALN</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Could not get exclusive access to replication instance file xxxx</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued by MUPIP REPLIC INSTANCE_CREATE if it finds that the replication instance file it is attempting to create already exists and is being used (the journal pool for that instance exists) by GTM and/or MUPIP process(es). </p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Shutdown all GTM and/or MUPIP processes that are using the replication instance file and reissue the command.  If it fails even though you know for sure there is no other GT.M or MUPIP process accessing the replication instance file, delete the instance file and reissue the command.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLREQROLLBACK</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Replication instance file xxxx indicates abnormal shutdown.  Run MUPIP JOURNAL ROLLBACK first.</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued by MUPIP REPLIC SOURCE &#8211;START if it is about to create the journal pool and finds that the replication instance file header indicates the journal pool was not cleanly shutdown previously.  This may cause the instance file not to correspond to the database and/or journals.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Run MUPIP JOURNAL ROLLBACK to cleanup the instance file, database and journal files before starting a source server on this instance.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLUPGRADEPRI</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Attempted operation requires primary instance xxxx to support multi-site replication</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued if an attempt is made to start an active source server or activate a passive source server on a propagating primary instance while the receiver server on that instance is connected to a primary that has not yet been upgraded to the multi-site version of GT.M. This error is also issued when the receiver server on a propagating primary finds that the primary it connects to does not support multi-site replication and that there is at least one active source server running on the instance at that time.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>An active source server cannot be running on a secondary instance at the same time that the receiver server on this instance is connected to a primary that does not support multi-site functionality.  Upgrade the primary instance identified in the message to the version of GT.M that supports multi-site replication functionality and then start active source servers.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLUPGRADESEC</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Attempted operation requires secondary instance xxxx to support multi-site replication</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued in three cases.  1) If a source server is currently connected to a dual-site secondary (i.e. a secondary running on a version of GT.M that does not support multi-site functionality), starting additional source servers will issue this error.  2) If a source server finds more than one source server (active or passive) running on the same instance at the time it connects to a dual-site secondary it will issue this error.  3) On a propagating primary instance, a source server that connects to a dual-site tertiary instance will issue a this error at connection time.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Upgrade the secondary instance identified in the message to the version of GT.M that supports multi-site replication functionality and then start multiple source servers.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>SRCSRVEXISTS</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Source server for secondary instance xxxx is already running with pid yyyy</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued by a source server startup command if there is already a source server up and running for the secondary instance name specified in the command.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Do not start multiple source servers for the same secondary instance.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>SRCSRVNOTEXIST</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Source server for secondary instance xxxx is not alive</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>This error is issued by a <span class="emphasis"><em>mupip replic -source</em></span> command that specifies any one of <span class="emphasis"><em>activate, changelog, checkhealth, deactivate, shutdown, statslog,  stopsourcefilter</em></span> if it finds no source server up and running for the secondary instance name specified in the command.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Make sure source server for the specified secondary instance name is up and running before attempting any of the above commands.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>SRCSRVTOOMANY</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Cannot start more than xxxx source servers in primary instance file yyyy</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Error:</p></td><td align="left" valign="top"><p>A maximum of 16 active and/or passive source servers are allowed at any point in time per instance.  If 16 source servers are already running and another source server startup is attempted, it will issue this error.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Shutdown any active or passive source server to allow the new source server to start up.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>JNLPOOLBADSLOT</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Source server slot for secondary instance xxxx is in an inconsistent state. Pid = pppp, State = ssss, SlotIndex = iiii</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Warning</p></td></tr><tr><td align="left" valign="top"><p>MUPIP Warning:</p></td><td align="left" valign="top"><p>This is a debugging message sent to the syslog (operator log) whenever a source server startup or showbacklog command finds a structure in the journal pool holding inconsistent information.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Forward the information to GT.M Support.  No action otherwise necessary.  The source server command will automatically fix the inconsistency of that structure.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTOPEN</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Error opening replication instance file xxxx</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>Runtime Error:</p></td><td align="left" valign="top"><p>There was an error when GT.M or MUPIP tried to open the replication instance file.  The error detail accompanies this message.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Look at the accompanying error detail.  Possible causes are file permissions, system quotas, etc.  Fix the cause if possible.  If not report to GT.M Support along with the error detail.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTCLOSE</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Error closing replication instance file xxxx</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>Runtime Error:</p></td><td align="left" valign="top"><p>There was an error when GT.M or MUPIP tried to close the replication instance file.  The error detail accompanies this message.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Look at the accompanying error detail.  Possible causes are file permissions, system quotas, etc.  Fix the cause if possible.  If not report to GT.M Support along with the error detail.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTREAD</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Error reading xxxx bytes at offset yyyy from replication instance file ffff</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>Runtime Error:</p></td><td align="left" valign="top"><p>There was an error when GT.M or MUPIP tried to read from the replication instance file.  The error detail accompanies this message.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Look at the accompanying error detail.  Possible causes are file permissions, system quotas, etc.  Fix the cause if possible.  If not report to GT.M Support along with the error detail.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTWRITE</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Error writing xxxx bytes at offset yyyy from replication instance file ffff</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>Runtime Error:</p></td><td align="left" valign="top"><p>There was an error when GT.M or MUPIP tried to write to the replication instance file.  The error detail accompanies this message.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Look at the accompanying error detail.  Possible causes are file permissions, system quotas, etc.  Fix the cause if possible.  If not report to GT.M Support along with the error detail.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTFSYNC</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Error fsyncing replication instance file xxxx</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>Runtime Error:</p></td><td align="left" valign="top"><p>There was an error when GT.M or MUPIP tried to sync the replication instance file (using the fsync() call).  The error detail accompanies this message.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Look at the accompanying error detail.  Possible causes are file permissions, system quotas, etc.  Fix the cause if possible.  If not report to GT.M Support along with the error detail.</p></td></tr><tr><td align="left" valign="top"><p></p></td><td align="left" valign="top"><p></p></td></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>REPLINSTCREAT</em></span></p></td><td align="left" valign="top"><p><span class="emphasis"><em>Error creating replication instance file xxxx</em></span></p></td></tr><tr><td align="left" valign="top"><p>Severity:</p></td><td align="left" valign="top"><p>Error</p></td></tr><tr><td align="left" valign="top"><p>Runtime Error:</p></td><td align="left" valign="top"><p>There was an error when GT.M or MUPIP tried to create the replication instance file.  The error detail accompanies this message.</p></td></tr><tr><td align="left" valign="top"><p>Action:</p></td><td align="left" valign="top"><p>Look at the accompanying error detail.  Possible causes are file permissions, system quotas, etc.  Fix the cause if possible.  If not report to GT.M Support along with the error detail.</p></td></tr></tbody></table></div>
            </p></div><div class="sect1" lang="en-US"><div class="titlepage"><div><p xmlns="" class="returntotop"><a href="GTM_Multi_Site_Replication.html#id880970">Return to top</a></p><div><h2 class="title"><a id="id887349"></a>Typographical Conventions</h2></div></div></div><p></p><p><span class="italic">Command Syntax: </span> UNIX syntax (i.e., lowercase text and "-" for flags/qualifiers) is used throughout this document. OpenVMS accepts both lowercase and uppercase text; flags/qualifiers on OpenVMS should be preceded with "/".</p><p><span class="italic">Reference Number:</span> The reference numbers used to track software enhancements and customer support requests appear in parentheses ( ).</p><p><span class="italic">Platform Identifier:</span> If a new feature or software enhancement does not apply to all platforms, the relevant platform or platforms appear in brackets [ ].</p><p></p><p>
          <a href="GTM_Multi_Site_Replication.html#return_to_top">Return to top</a>
        </p></div></div><div xmlns="" id="customfooter" align="center">
For more information, see the <a href="http://www.sanchez-gtm.com" target="_blank" style="color: #000; font-weight: bold;">GT.M</a> web site. 
</div></body></html>
