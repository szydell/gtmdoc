<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>GT.M V7.1-004 Release Notes</title><link rel="stylesheet" href="gtm.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><meta name="description" content="Contact Information GT.M Group Fidelity National Information Services, Inc. 347 Riverside Drive Jacksonville, FL 13220 United States of America GT.M Support for customers: gtmsupport@fisglobal.com Automated attendant for 24 hour support: +1 (484) 302-3248 Switchboard: +1 (484) 302-3160"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article" title="GT.M V7.1-004 Release Notes"><div class="titlepage"><div><div><div class="mediaobject"><img src="images/FIS_RGB_logo.jpg"></div></div><div><h2 class="title"><a name="idm45829642593104"></a>GT.M V7.1-004 Release Notes</h2></div><div><h3 class="subtitle"><i>Release Notes: GT.M V7.1-004</i></h3></div><div><p class="copyright">Copyright (C) 2024 Fidelity National Information Services, Inc.</p></div><div><div class="legalnotice" title="Legal Notice"><a name="idm45829642469920"></a><p class="legalnotice-title"><b>Legal Notice</b></p><p>Copyright (C)2024 Fidelity National Information Services, Inc. and/or its subsidiaries. All Rights Reserved.</p><p>Permission is granted to copy, distribute and/or modify this document under the terms of the <a class="ulink" href="http://www.gnu.org/licenses/fdl.txt" target="_blank">GNU Free Documentation License</a>, Version 1.3 or any later version published by the Free Software Foundation; with no Invariant Sections, no Front-Cover Texts and no Back-Cover Texts. </p><p>GT.M&#8482; is a trademark of Fidelity National Information Services, Inc. Other trademarks are the property of their respective owners. </p><p>This document contains a description of GT.M and the operating instructions pertaining to the various functions that comprise the system. This document does not contain any commitment of FIS. FIS believes the information in this publication is accurate as of its publication date; such information is subject to change without notice. FIS is not responsible for any errors or defects. </p></div></div><div><p class="pubdate">27 June 2024</p></div><div><div class="revhistory"><table border="1" width="100%" summary="Revision history"><tr><th align="left" valign="top" colspan="3"><b>Revision History</b></th></tr><tr><td align="left">Revision 1.0</td><td align="left">27 June 2024</td><td align="left">V7.1-004 </td></tr></table></div></div><div><div class="abstract" title="Contact Information"><p class="title"><b>Contact Information</b></p><div class="informaltable"><table border="0" width="100%"><colgroup><col><col></colgroup><tbody><tr><td>
                  <p>
</p><div class="address"><p>GT.M Group <br>
Fidelity National Information Services, Inc. <br>
<span class="street">347 Riverside Drive</span> <br>
<span class="city">Jacksonville, </span><span class="state">FL </span><span class="postcode">13220</span><br>
<span class="country">United States of America</span></p></div><p>
</p>
                </td><td>
                  <p>
</p><div class="address"><p><br>
<span class="phone">GT.M Support for customers: gtmsupport@fisglobal.com </span><br>
<span class="phone">Automated attendant for 24 hour support: +1 (484) 302-3248</span><br>
<span class="phone">Switchboard: +1 (484) 302-3160</span><br>
</p></div><p> 
</p>
                </td></tr></tbody></table></div><p>
</p></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="GTM_V7.1-004_Release_Notes.html#GTMrel_overview">V7.1-004</a></span></dt><dd><dl><dt><span class="sect2"><a href="GTM_V7.1-004_Release_Notes.html#overview"> Overview </a></span></dt><dt><span class="sect2"><a href="GTM_V7.1-004_Release_Notes.html#conventions">Conventions</a></span></dt><dt><span class="sect2"><a href="GTM_V7.1-004_Release_Notes.html#platforms"> Platforms </a></span></dt><dt><span class="sect2"><a href="GTM_V7.1-004_Release_Notes.html#addn_instr">Additional Installation Instructions</a></span></dt><dt><span class="sect2"><a href="GTM_V7.1-004_Release_Notes.html#upgrade"> Upgrading to V7.1-004</a></span></dt><dt><span class="sect2"><a href="GTM_V7.1-004_Release_Notes.html#mng_mode">Managing M mode and UTF-8 mode</a></span></dt><dt><span class="sect2"><a href="GTM_V7.1-004_Release_Notes.html#setterm">Setting the environment variable TERM</a></span></dt><dt><span class="sect2"><a href="GTM_V7.1-004_Release_Notes.html#install_comp_lib"> Installing Compression Libraries</a></span></dt></dl></dd><dt><span class="sect1"><a href="GTM_V7.1-004_Release_Notes.html#GTMchng_hist"> Change History</a></span></dt><dd><dl><dt><span class="sect2"><a href="GTM_V7.1-004_Release_Notes.html#GTMtaV71-004ble">V7.1-004</a></span></dt></dl></dd><dt><span class="sect1"><a href="GTM_V7.1-004_Release_Notes.html#idm45829642220704">Database </a></span></dt><dt><span class="sect1"><a href="GTM_V7.1-004_Release_Notes.html#idm45829642178544">Language </a></span></dt><dt><span class="sect1"><a href="GTM_V7.1-004_Release_Notes.html#idm45829642308416">System Administration </a></span></dt><dt><span class="sect1"><a href="GTM_V7.1-004_Release_Notes.html#idm45829642171008">Other </a></span></dt><dt><span class="sect1"><a href="GTM_V7.1-004_Release_Notes.html#idm45829642158256">Error and Other Messages</a></span></dt><dd><dl></dl></dd></dl></div><div class="sect1" title="V7.1-004"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="GTMrel_overview"></a>V7.1-004</h2></div></div></div><div class="sect2" title="Overview"><div class="titlepage"><div><div><h3 class="title"><a name="overview"></a> Overview </h3></div></div></div><p>V7.1-004 provides additional database statistics GVSTATS) as well as numerous changes aimed at improving ease of use and also a number of fixes. </p><p>Items marked with the <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="New Feature"></span>
 symbol document new or different capabilities.</p><p>Please pay special attention to the items marked with the <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="Alert"></span>
 symbol. as those document items that have a possible impact on existing code, practice or process. Please be sure to recompile all objects to ensure all the updates are in place.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Note"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Note]" src="images/note.jpg"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>While FIS keeps message IDs and mnemonics quite stable, message texts change more frequently as we strive to improve them, especially in response to user feedback. Please ensure you review any automated scripting that parses GT.M messages.</p></td></tr></table></div></div><div class="sect2" title="Conventions"><div class="titlepage"><div><div><h3 class="title"><a name="conventions"></a>Conventions</h3></div></div></div><p>This document uses the following conventions:</p><div class="informaltable"><table border="1" width="70%"><colgroup><col><col><col></colgroup><tbody><tr><td>
            
<p>              <span class="bold"><strong>Flag/Qualifiers</strong></span>            </p>
          </td><td colspan="2">            
<p>- (dash)</p>
          </td></tr><tr><td>
            
<p>              <span class="bold"><strong>Program Names or Functions</strong></span>            </p>
          </td><td colspan="2">            
<p>upper case. For example, MUPIP BACKUP</p>
          </td></tr><tr><td>
            
<p>              <span class="bold"><strong>Examples</strong></span>            </p>
          </td><td colspan="2">            
<p>lower case. For example: <br> mupip backup -database ACN,HIST /backup</p>
          </td></tr><tr><td>
            
<p>              <span class="bold"><strong>Reference Number</strong></span>            </p>
          </td><td colspan="2">            
<p>A reference number enclosed between parentheses () used to track software <br> enhancements and support requests. <br></p>
          </td></tr><tr><td>
            
<p>              <span class="bold"><strong>Platform Identifier</strong></span>            </p>
          </td><td colspan="2">            
<p>Where an item affects only specific platforms, the platforms are listed in square brackets, e.g., [AIX]</p>
          </td></tr></tbody></table></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Note"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Note]" src="images/note.jpg"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The term UNIX refers to the general sense of all platforms on which GT.M uses a POSIX API. As of this date, this includes: AIX and GNU/Linux x86_64.</p></td></tr></table></div><p>Effective V6.0-000, GT.M documentation adopted IEC standard <a class="ulink" href="http://physics.nist.gov/cuu/Units/binary.html" target="_blank">Prefixes for binary multiples</a>. This document therefore uses prefixes Ki, Mi and Ti (e.g., 1MiB for 1,048,576 bytes). Over time, we'll update all GT.M documentation to this standard.</p><p><span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="New Feature"></span>
 denotes a new feature that requires updating the manuals. </p><p><span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="New Feature"></span>
 denotes a new feature or an enhancement that may not be upward compatible and may affect an existing application. </p><p><span class="inlinemediaobject"><img src="images/deprecated.png" alt="-Deprecated Message-"></span>
 denotes deprecated messages.</p><p><span class="inlinemediaobject"><img src="images/revised.png" alt="-Revised Message-"></span>
 denotes revised messages.</p><p><span class="inlinemediaobject"><img src="images/new.png" alt="-New Message-"></span>
 denotes added messages.</p></div><div class="sect2" title="Platforms"><div class="titlepage"><div><div><h3 class="title"><a name="platforms"></a> Platforms </h3></div></div></div><p> Over time, computing platforms evolve. Vendors obsolete hardware architectures. New versions of operating systems replace old ones. We at FIS continually evaluate platforms and versions of platforms that should be Supported for GT.M. In the table below, we document not only the ones that are currently Supported for this release, but also alert you to our future plans given the evolution of computing platforms. If you are an FIS customer, and these plans would cause you hardship, please contact your FIS account executive promptly to discuss your needs. </p><p>Each GT.M release is extensively tested by FIS on a set of specific versions of operating systems on specific hardware architectures, we refer to the combination of operating system and hardware architecture as a platform. We deem this set of specific versions: Supported. There may be other versions of the same operating systems on which a GT.M release may not have been tested, but on which the FIS GT.M Group knows of no reason why GT.M would not work. We deem this larger set of versions: Supportable. There is an even larger set of platforms on which GT.M may well run satisfactorily, but where the FIS GT.M team lacks the knowledge to determine whether GT.M is Supportable and therefore deem them: Unsupported. Contact FIS GT.M Support with inquiries about your preferred platform.</p><p>As of the publication date, FIS supports this release on the hardware and operating system versions below. Contact FIS for a current list of Supported platforms. The reference implementation of the encryption reference plugin has its own additional requirements.</p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>
            <p class="bold"> Platform </p>
          </th><th>
            <p class="bold"> Supported Versions </p>
          </th><th>
            <p class="bold"> Notes </p>
          </th></tr></thead><tbody><tr><td>
            
<p> IBM Power Systems AIX </p>
          </td><td>
            
<p> 7.1 TL 5, 7.2 TL 5, 7.3 TL 1</p>
          </td><td>
            
<p>Only 64-bit versions of AIX with POWER7 as the minimum required CPU architecture level are Supported.</p>
            
<p> While GT.M supports both UTF-8 mode and M mode on this platform, there are problems with the AIX ICU utilities that prevent FIS from testing 4-byte UTF-8 characters as comprehensively on this platform as we do on others. </p>
            
<p> Running GT.M on AIX 7.1 requires APAR IZ87564, a fix for the POW() function, to be applied. To verify that this fix has been installed, execute <code class="code"> instfix -ik IZ87564. </code> </p>
            
<p>Only the AIX jfs2 filesystem is Supported. Other filesystems, such as jfs1 are Supportable, but not Supported. FIS strongly recommends use of the jfs2 filesystem on AIX; use jfs1 only for existing databases not yet migrated to a jfs2 filesystem.</p>
          </td></tr><tr><td>
            
<p> x86_64 GNU/Linux </p>
          </td><td>
            
<p>Red Hat Enterprise Linux 7.9, 8.9, 9.4; Ubuntu 20.04 LTS, and 22.04 LTS; Amazon Linux 2</p>
          </td><td>
            
<p> To run 64-bit GT.M processes requires both a 64-bit kernel as well as 64-bit hardware. As of V7.1-001, GT.M on x86-64 requires hardware/virtualized support for AVX instructions. </p>
            
<p> GT.M should also run on recent releases of other major Linux distributions with a contemporary Linux kernel (2.6.32 or later), glibc (version 2.12 or later) and ncurses (version 5.7 or later). </p>
            
<p>Due to build optimization and library incompatibilities, GT.M versions older than V6.2-000 are incompatible with glibc 2.24 and up. This incompatibility has not been reported by a customer, but was observed on internal test systems that use the latest Linux software distributions from Fedora (26), Debian (unstable), and Ubuntu (17.10). In internal testing, processes either hung or encountered a segmentation violation (SIG-11) during operation. Customers upgrading to Linux distributions that utilize glibc 2.24+ must upgrade their GT.M version at the same time as or before the OS upgrade.</p>
            
<p> GT.M requires a compatible version of the libtinfo library. On Red Hat, the ncurses-libs and ncurses-compat-libs packages contain the libtinfo library. On Debian/Ubuntu, libtinfo5 and libncurses5 packages contain the libtinfo library. If any of these packages is not already installed on your system, please install using an appropriate package manager. </p>
            
<p>To support the optional WRITE /TLS fifth argument (the ability to provide / override options in the tlsid section of the encryption configuration file), the reference implementation of the encryption plugin requires libconfig 1.4.x or later.</p>
            
<p>Only the ext4 and xfs filesystems are Supported. Other filesystems are Supportable, but not Supported. Furthermore, if you use the NODEFER_ALLOCATE feature, FIS strongly recommends that you use xfs. If you must use NODEFER_ALLOCATE with ext4, you <span class="bold"><strong>must</strong></span> ensure that your kernel includes commit d2dc317d564a46dfc683978a2e5a4f91434e9711 (search for d2dc317d564a46dfc683978a2e5a4f91434e9711 at <a class="ulink" href="https://www.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.0.3" target="_blank">https://www.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.0.3</a>). The Red Hat Bugzilla identifier for the bug is 1213487. With NODEFER_ALLOCATE, do not use any filesystem other than ext4 and a kernel with the fix, or xfs.</p>
            
<p>Our testing has shown an interaction between glibc 2.36 and all versions of GT.M on Linux/x86_64 systems without AVX2 support. This can cause segmentation violations (SIG-11) in processes performing concurrent updates to the same database block, which terminate the process, but do not damage the database. The issue is due to the way glibc performs certain memory operations when using SSE2 instructions. The glibc behavior was subsequently modified to avoid this issue, and the change was included in glibc 2.37. Linux/x86_64 systems with support for AVX2 instructions are not vulnerable, as glibc chooses its AVX2 implementation, when available, over its SSE2 implementation, and the problematic behavior is specific to SSE2. Note, depending on how CPU virtualization is configured, that virtual environments may not support AVX2 even if the underlying hardware does.</p>
            
<p>Ubuntu 24.04 LTS is Supportable.</p>
            <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Note"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Note]" src="images/note.jpg"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>FIS recommends recompiling the reference encryption plugins to match the target platform. See <a class="link" href="GTM_V7.1-004_Release_Notes.html#GTMCompile_RefImpPlugin" title="Compiling the Reference Implementation Plugin">Compiling the Reference Implementation Plugin</a> section for instructions. </p><p>OpenSSL 3.0 by default does not allow client-side initiated TLSv1.2 renegotiation requests due to potential DoS attacks. Because of this, the reference TLS implementation in GT.M versions before V7.0-004 do not use the appropriate OpenSSL 3.0 API to enable support for client-side initiated TLSv1.2 renegotiation. Customers needing to replicate to/from GT.M versions before V7.0-004 with OpenSSL 3.0 must use -RENEGOTIATE_INTERVAL=0 in the Source Server startup. This limitation only affects database replication and not SOCKET devices.</p></td></tr></table></div>          </td></tr></tbody></table></div><div class="important" title="Important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important: Important"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Important]" src="images/important.jpg"></td><th align="left">Important</th></tr><tr><td align="left" valign="top"><p>Effective V7.0-003, GT.M is no longer Supportable on the 32 bit x86 platform. Please contact your FIS account manager if you need ongoing support for GT.M on this platform.</p></td></tr></table></div><div class="sect3" title="Platform support lifecycle"><div class="titlepage"><div><div><h4 class="title"><a name="GTMplatform_lifecycle"></a> Platform support lifecycle </h4></div></div></div><p> FIS usually supports new operating system versions six months or so after stable releases are available, and we usually support each version for a two-year window. </p><p>We support GT.M releases in a rolling support model based on two years of certified releases. A release becomes no longer officially supported once a given release is more than one release beyond the two year window. Historically we have produced GT.M releases on a quarterly basis, subject to change. Note: customers always get the best support by staying current with releases as they are made available.</p><p>FIS will continue to attempt to support any release of GT.M in use by a Profile customer under that client's maintenance agreement, while that agreement is still in effect.  FIS's ability to provide an appropriate level of support may become increasingly costly to the client. In other words, FIS may need to enact a special maintenance agreement to continue to provide support. The additional costs required would be maintain client release level specific servers, operating systems and other ancillary software for a given and reasonable time frame beyond the normal window. </p><p>FIS policy is only to provide remediation, in the current release, for identified issues in generally available and supported releases. It is not FIS policy to provide ongoing support of client specific release levels of unsupported software.  </p><p> GT.M cannot be patched, and bugs are only fixed in new releases of software.</p></div></div><div class="sect2" title="Additional Installation Instructions"><div class="titlepage"><div><div><h3 class="title"><a name="addn_instr"></a>Additional Installation Instructions</h3></div></div></div><p>To install GT.M, see the "Installing GT.M" section in the GT.M Administration and Operations Guide. For minimal down time, upgrade a current replicating instance and restart replication. Once that replicating instance is current, switch it to become the originating instance. Upgrade the prior originating instance to become a replicating instance, and perform a switchover when you want it to resume an originating primary role.</p><div class="caution" title="Caution" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Caution: Caution"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Caution]" src="images/caution.jpg"></td><th align="left">Caution</th></tr><tr><td align="left" valign="top"><p>Never replace the binary image on disk of any executable file while it is in use by an active process. It may lead to unpredictable results. Depending on the operating system, these results include but are not limited to denial of service (that is, system lockup) and damage to files that these processes have open (that is, database structural damage). </p></td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>FIS strongly recommends installing each version of GT.M in a separate (new) directory, rather than overwriting a previously installed version. If you have a legitimate need to overwrite an existing GT.M installation with a new version, you must first shut down all processes using the old version. FIS suggests installing GT.M V7.1-004 in a Filesystem Hierarchy Standard compliant location such as /usr/lib/fis-gtm/V7.1-004_arch (for example, /usr/lib/fis-gtm/V7.1-004_x86_64 on Linux systems). A location such as /opt/fis-gtm/V7.1-004_arch would also be appropriate. </p></li><li class="listitem"><p>Use the appropriate MUPIP command (e.g. ROLLBACK, RECOVER,  RUNDOWN) of the old GT.M version to ensure all database files are cleanly closed.</p></li><li class="listitem"><p>Make sure gtmsecshr is not running. If gtmsecshr is running, first stop all GT.M processes including the DSE, LKE and MUPIP utilities and then perform a <code class="code">MUPIP STOP</code> <em class="replaceable"><code>pid_of_gtmsecshr</code></em>.</p></li><li class="listitem"><p>Starting with V6.2-000, GT.M no longer supports the use of the deprecated $gtm_dbkeys and the master key file it points to for database encryption. To convert master files to the libconfig format, please click <a class="ulink" href="downloadables/CONVDBKEYS.m.html" target="_blank"><span class="inlinemediaobject"><img src="images/download.png" alt="Download CONVDBKEYS.m"></span>
</a> to download the CONVDBKEYS.m program and follow instructions in the comments near the top of the program file. You can also download CONVDBKEYS.m from http://tinco.pair.com/bhaskar/gtm/doc/articles/downloadables/CONVDBKEYS.m. If you are using $gtm_dbkeys for database encryption, please convert master key files to libconfig format immediately after upgrading to V6.2-000 or later. Also, modify your environment scripts to include the use of gtmcrypt_config environment variable. </p></li></ul></div><div class="sect3" title="Recompile"><div class="titlepage"><div><div><h4 class="title"><a name="idm45829642387056"></a> Recompile </h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> Recompile all M and C source files.</p></li></ul></div></div><div class="sect3" title="Rebuild Shared Libraries or Images"><div class="titlepage"><div><div><h4 class="title"><a name="idm45829642385008"></a>Rebuild Shared Libraries or Images</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Rebuild all Shared Libraries after recompiling all M and C source files.</p></li><li class="listitem"><p>If your application is not using object code shared using GT.M's auto-relink functionality, please consider using it.</p></li></ul></div></div><div class="sect3" title="Compiling the Reference Implementation Plugin"><div class="titlepage"><div><div><h4 class="title"><a name="GTMCompile_RefImpPlugin"></a>Compiling the Reference Implementation Plugin </h4></div></div></div><p>If you plan to use the example / reference implementation plugin in support of database encryption, TLS replication, or TLS sockets, you must compile the reference  plugin in order to match the shared library dependencies specific to your platform. The instructions for compiling the Reference Implementation plugin are as follows:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Install the development headers and libraries for libgcrypt, libgpgme, libconfig, and libssl. On Linux, the package names of development libraries usually have a suffix such as -dev or -devel and are available through the package manager. For example, on Ubuntu_x86_64 a command like the following installs the required development libraries:</p><pre class="programlisting">sudo apt-get install libgcrypt11-dev libgpgme11-dev libconfig-dev libssl-dev</pre><p>Note that the package names may vary by distribution / version. For example, on RHEL 9 the libraries required to recompile the reference implementation encryption plugin are libgcrypt-devel, gpgme-devel, libconfig-devel, and openssl-devel. </p></li><li class="listitem"><p>Unpack $gtm_dist/plugin/gtmcrypt/source.tar to a temporary directory. </p><pre class="programlisting">mkdir /tmp/plugin-build
cd /tmp/plugin-build
cp $gtm_dist/plugin/gtmcrypt/source.tar . 
tar -xvf source.tar</pre></li><li class="listitem"><p>Follow the instructions in the README.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Open Makefile with your editor; review and edit the common header (IFLAGS) and library paths (LIBFLAGS) in the Makefile to reflect those on your system.</p></li><li class="listitem"><p>Define the gtm_dist environment variable to point to the absolute path for the directory where you have GT.M installed</p></li><li class="listitem"><p>Copy and paste the commands from the README to compile and install the encryption plugin with the permissions defined at install time</p></li></ul></div></li><li class="listitem"><p>When reinstalling or upgrading GT.M, stop existing gpg-agents. The agents may be working with information about the prior GT.M installation, such as GNUPGHOME, that will not work with the new version. Additionally, if the process deletes the GPG agent's socket, proper operation requires a new agent.</p></li><li class="listitem"><p>It is a good idea to read the Administration and Operations Guide section entitled "Special note - GNU Privacy Guard and Agents" and re-evaluate the GPG configuration options in use.</p></li></ol></div></div><div class="sect3" title="Re-evaluate TLS configuration options"><div class="titlepage"><div><div><h4 class="title"><a name="idm45829642370928"></a>Re-evaluate TLS configuration options </h4></div></div></div><p>The GT.M TLS reference encryption plugin implements a subset of options as documented in the OpenSSL man page for SSL_set_options which modify the default behavior of OpenSSL. Future versions of the plugin will enable new options as and when the OpenSSL library adds them. To enable options not supported by the GT.M TLS reference plugin, it is possible to create an OpenSSL configuration for GT.M processes. See the OpenSSL man page for "config".</p>
    &lt;para/&gt;  </div></div><div class="sect2" title="Upgrading to V7.1-004"><div class="titlepage"><div><div><h3 class="title"><a name="upgrade"></a> Upgrading to V7.1-004</h3></div></div></div><div class="note" title="Before you begin" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Before you begin"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Note]" src="images/note.jpg"></td><th align="left">Before you begin</th></tr><tr><td align="left" valign="top"><p>GT.M supports upgrade from V5*, V6.* and V7.* versions to V7.1-004. </p><p>GT.M does not support upgrading from V4* versions. Please upgrade V4 databases using instruction in the release notes of an appropriate GT.M V6.* version. </p></td></tr></table></div><p>The GT.M database consists of four types of components- database files, journal files, global directories, and replication instance files. </p><p> GT.M upgrade procedure for V7.1-004 consists of 5 stages:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>        <a class="link" href="GTM_V7.1-004_Release_Notes.html#GTMstage_1" title="Stage 1: Global Directory Upgrade">Stage 1: Global Directory Upgrade</a>      </p></li><li class="listitem"><p>        <a class="link" href="GTM_V7.1-004_Release_Notes.html#GTMstage_2" title="Stage 2: Database Files Upgrade">Stage 2: Database Files Upgrade</a>      </p></li><li class="listitem"><p>        <a class="link" href="GTM_V7.1-004_Release_Notes.html#GTMstage_3" title="Stage 3: Replication Instance File Upgrade">Stage 3: Replication Instance File Upgrade</a>      </p></li><li class="listitem"><p>        <a class="link" href="GTM_V7.1-004_Release_Notes.html#GTMstage_4" title="Stage 4: Journal Files Upgrade">Stage 4: Journal Files Upgrade</a>      </p></li><li class="listitem"><p>        <a class="link" href="GTM_V7.1-004_Release_Notes.html#GTMstage_5" title="Stage 5: Trigger Definitions Upgrade">Stage 5: Trigger Definitions Upgrade</a>      </p></li></ul></div><p> Before starting, read the upgrade instructions of all stages carefully. Your upgrade procedure for GT.M V7.1-004 depends on your GT.M upgrade history and your current version.</p><div class="sect3" title="Stage 1: Global Directory Upgrade"><div class="titlepage"><div><div><h4 class="title"><a name="GTMstage_1"></a> Stage 1: Global Directory Upgrade</h4></div></div></div><p> FIS strongly recommends you back up your Global Directory file before upgrading. There is no one-step method for downgrading a Global Directory file to an older format.</p><p>      <span class="bold"><strong>To upgrade from any previous version of GT.M:</strong></span>    </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> Open your Global Directory with the GDE utility program of GT.M V7.1-004.</p></li><li class="listitem"><p> Execute the EXIT command. This command automatically upgrades the Global Directory.</p></li><li class="listitem"><p> If you inadvertently open a Global Directory of an old format with no intention of upgrading it, execute the QUIT command rather than the EXIT command.</p></li></ul></div><p> If you inadvertently upgrade a global directory, perform the following steps to downgrade to an old GT.M release:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> Open the global directory with the GDE utility program of V7.1-004.</p></li><li class="listitem"><p> Execute the SHOW -COMMAND -FILE=file-name command. This command stores the current Global Directory settings in the file-name command file. If the old version is significantly out of date, edit the command file to remove the commands that do not apply to the old format. Alternatively, you can use the output from SHOW -ALL or SHOW -COMMAND as a guide to manually enter equivalent GDE commands for the old version. </p></li></ul></div><p> An analogous procedure applies in the reverse direction. </p></div><div class="sect3" title="Stage 2: Database Files Upgrade"><div class="titlepage"><div><div><h4 class="title"><a name="GTMstage_2"></a> Stage 2: Database Files Upgrade</h4></div></div></div><p>Before starting the database file upgrade, use the prior GT.M version to perform an appropriate MUPIP action (i.e. ROLLBACK, RECOVER, RUNDOWN) to remove abandoned GT.M database semaphores and release any IPC resources.</p><p>There are three upgrade paths available when you upgrade to V7.1-004.</p><p>      <span class="bold"><strong>V7 Upgrade Path 1: In-place Upgrade</strong></span>    </p><p>To upgrade from GT.M V7*:</p><p>There is no explicit procedure to upgrade a V7 database file when upgrading to a newer V7 version. After upgrading the Global Directory, opening a V7 database with a newer V7 GT.M process automatically upgrades the fields in the database file header.</p><p>To upgrade from GT.M V6* (or V5*):</p><p>There are two phases to upgrade from V6 to V7:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Phase 1: MUPIP UPGRADE phase; requires standalone access</p></li><li class="listitem"><p>Phase 2: MUPIP REORG -UPGRADE (GVT Index Block Upgrade); may optionally run with concurrent access if performance is acceptable </p></li></ul></div><p>Both phases operate once per region. Phase 1 is not restartable. Phase 2 is restartable. </p><p>While these are the basic steps, customers must integrate them with appropriate operational practice and risk mitigating procedures, such as comprehensive testing, backup, integrity checks, journal and replication management, and so on based on their environments and risk tolerance. FIS strongly recommends performing a MUPIP INTEG (-FAST), of the database and creating a backup prior to upgrade. Customers must test these utilities against copies of their own production files, using their planned procedures, before undertaking the conversion of current production files.</p><p>Using MUPIP UPGRADE and MUPIP REORG -UPGRADE should be a significantly faster alternative to using MUPIP EXTRACT and LOAD. FIS favors using a "rolling" upgrade using a replicated instance. Whatever the approach you choose, FIS requests capturing all logs in case there are issues or questions leading to support requests.</p><p>      <span class="bold"><strong>Phase 1: Standalone MUPIP UPGRADE</strong></span>    </p><p>MUPIP UPGRADE performs Phase 1 actions of upgrading a database to V7. The format of the UPGRADE command is:</p><pre class="programlisting">MUPIP UPGRADE {-FILE &lt;file name&gt;; | [-REGION] &lt;region list&gt;}</pre><p>As the GT.M version upgrade changes the journal format to support 64-bit block pointers, MUPIP UPGRADE does not maintain journal files or replication; configured journaling and replication resumes for activity after MUPIP UPGRADE.</p><p>UPGRADE:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Requires standalone access</p></li><li class="listitem"><p>Turns off journaling and replication for the duration of UPGRADE</p></li><li class="listitem"><p>When encountering an error where the command specifies multiple regions, UPGRADE moves on to the next region, while for a single file/region, it terminates; avoid any unnecessary &lt;CTRL_C&gt; or MUPIP STOP (or kill) of an active MUPIP UPGRADE process, as such an action leaves the database region effectively unusable</p></li><li class="listitem"><p>Estimates and reports the space required for its work</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p> UPGRADE estimates are intended to be generous, and, particularly for small databases, they may seem unnecessarily large</p></li><li class="listitem"><p>If MUPIP is not authorized to perform a required file extension, that is, the extension amount is defined as zero (0), it produces an error before it does anything that would damage the selected database file</p></li></ul></div></li><li class="listitem"><p>Moves blocks from immediately after the existing master map to make room for a V7 master map</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>Depending on the block size and the GT.M version with which it was created, the new starting Virtual Block Number (VBN), the location of block zero for the database file, may exceed the starting VBN for a database created with V7, which causes a minor waste of space </p></li><li class="listitem"><p>UPGRADE relocates blocks in multiples of 512 to align blocks with their local bitmaps </p></li></ul></div></li><li class="listitem"><p>Eliminates any globals that previously existed, but have been KILL'd at the name level; these global variable trees (GVTs) contain only a level one (1) root block and an empty data (level zero) block and are "invisible" to the GT.M process run-time</p></li><li class="listitem"><p>Stores the offset GT.M must apply to the original block pointers as a consequence of the relocation of the starting VBN</p></li><li class="listitem"><p>Upgrades the directory tree (DT) block pointers from 32- to 64-bits; this requires splitting any blocks that do not have sufficient space to accommodate the larger block pointers</p></li><li class="listitem"><p>Ensures that all is work is flushed to secondary storage</p></li><li class="listitem"><p>Reports completion of its activity on a database file with a "MUPIP MASTERMAP UPGRADE completed" message</p></li></ul></div><p>At this point, after a successful MUPIP UPGRADE:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>All DT blocks are in V7m format and all GVT index blocks remain in V6/V6p format</p></li><li class="listitem"><p>Subsequent activity that updates index blocks for existing GVTs implicitly converts any V6 index blocks to V6p format after applying the offset</p></li><li class="listitem"><p>No process other than MUPIP REORG -UPGRADE converts GVT index blocks from V6p format to V7m format; in other words, adding new nodes does not create GVT index blocks with V7 format - adding new nodes splits existing index blocks and such block splits retain the pre-existing block format</p></li><li class="listitem"><p>Newly created GVTs, storing new global names, have V7m format</p></li><li class="listitem"><p>Data blocks, at level zero (0), and local bit map blocks have the same format in V6 and V7, so, for consistency, normal updates also give those blocks a V7m format designation</p></li></ul></div><p>These database changes are physical rather than logical, and thus do not require replication beyond noting the increase in transaction numbers.</p><p><span class="bold"><strong>Phase 2: MUPIP REORG -UPGRADE</strong></span> (GVT Index Block Upgrade)    </p><p>MUPIP REORG -UPGRADE performs Phase 2 actions of upgrading a database to V7 format. The format of MUPIP REORG -UPGRADE is:</p><pre class="programlisting">MUPIP REORG -UPGRADE {-FILE &lt;file_name&gt; | [-REGION] &lt;region_list&gt;}</pre><p>Before image journaling with MUPIP REORG upgrade provides maximum resiliency. MUPIP REORG -UPGRADE reports it has completed its actions for a region with a MUPGRDSUCC message, at which point all index blocks have V7m format with 64-bit block pointers. You can resume and complete a MUPIP REORG -UPGRADE stopped with a MUPIP STOP (or &lt;Ctrl-C&gt;); avoid a kill -9, which carries a high risk of database damage.</p><p>MUPIP REORG -UPGRADE:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Requires standalone access</p></li><li class="listitem"><p>Runs on an entire region; as a result, MUPIP REORG -UPGRADE prevents multiple concurrent REORG -UPGRADE runs per region </p></li><li class="listitem"><p>Stops execution when a concurrent Online ROLLBACK is detected because that operation changes the block content of the database</p></li><li class="listitem"><p>Can be subject to stopping and restarting at any point</p></li><li class="listitem"><p>Processes the GVTs within a database file</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>Splitting any index blocks that do not have sufficient space to accommodate the  block pointer upgrade from 32 to 64 bits</p></li><li class="listitem"><p>Updating the block pointers from 32 to 64 bits, also changing the version of the block to V7m</p></li><li class="listitem"><p>Journaling its work as before images (if so configured) and INCTN records</p></li></ul></div></li></ul></div><p>      <span class="bold"><strong>Phase 3: Optional GVT Data and Local Bit Map Block Upgrade</strong></span>    </p><p>While it makes no operational or processing difference, GT.M does not consider the database "fully upgraded" until the block version format of all data blocks becomes V7m. Any of the following operations upgrade some or all of the remaining data blocks:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>MUPIP REORG</p><p>Because this operation may not visit every block in the database it may fail to upgrade static/unchanging blocks</p></li><li class="listitem"><p>MUPIP REORG -ENCRYPT</p></li><li class="listitem"><p>MUPIP INTEG -TN_RESET</p><p>This operation requires standalone access and resets the transaction number on all blocks in the database.</p></li></ul></div><p>Failure to perform Phase 3 has <span class="bold"><strong>NO</strong></span> implications for V7.1-004 but might be an issue for any as-yet unplanned further enhancement.</p><div class="important" title="Important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important:  Important"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Important]" src="images/important.jpg"></td><th align="left"> Important</th></tr><tr><td align="left" valign="top"><p> Taking the steps in the following list that use MUPIP REORG -MIN_LEVEL=1 significantly reduce upgrade time. </p></td></tr></table></div><p>The following lists the recommended ordered steps for the full upgrade process:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Offline Upgrade instance to use new GT.M V7.1-002+ version - at this point, customers can use the upgraded the GT.M version without any DB changes</p></li><li class="listitem"><p>Online MUPIP SET -INDEX_RESERVED_BYTES=n - where n is 1/3 the block size</p></li><li class="listitem"><p>Online MUPIP REORG -MIN_LEVEL=1 -NOSWAP - free up space in all index blocks to ease the block reference change from 32bits (4bytes) to 64bits (8bytes); this operation alters only index blocks (-MIN_LEVEL=1), and so generates a much lower volume of before image journal records.</p></li><li class="listitem"><p>Offline MUPIP UPGRADE -move blocks around to make space for the expanded master bitmap and upgrade the index blocks in the directory tree (tree of Global names).</p></li><li class="listitem"><p>Online MUPIP REORG -UPGRADE - upgrade the remaining index blocks</p></li><li class="listitem"><p>Online MUPIP SET -INDEX_RESERVED_BYTES=0 - remove the previously applied reservation as it is no longer needed; some application may find it produces a continuing performance benefit.</p></li><li class="listitem"><p>(optional) Online REORG -MIN_LEVEL=1 -NOSWAP -NOSPLIT - coalesce the index blocks to leave index blocks in a less fragmented state</p></li></ol></div><p>      <span class="bold"><strong>V7 Upgrade Path 2: EXTRACT and LOAD</strong></span>    </p><p>Two commonly used mechanisms are as follows. We recommend you use replication to stage the conversion and minimize down time.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>MUPIP EXTRACT -FREEZE followed by a MUPIP LOAD</p><p>Using MUPIP EXTRACT with -FREEZE ensures that the V6 database files are frozen at the point of the extract, preventing updates without administrative action to unfreeze the database. MUPIP LOAD the extracts into newly created V7 database files</p><p>Use this operation when there is insufficient space to make a database extract</p></li><li class="listitem"><p>MERGE command with two global directories and Extended References</p><p>Using this approach to transfer data from a V6 database file to a V7 database, administrators must take some action to prevent updates during the transfer</p><p>This operation consumes less disk space and disk I/O. As a result the operation is faster than an EXTRACT and LOAD.</p></li></ul></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Note]" src="images/note.jpg"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>If you are using triggers, extract the triggers from the V6 database and load them in the new V7 database.</p></td></tr></table></div><p>      <span class="bold"><strong>V7 Upgrade Path 3: No change</strong></span>    </p><p>Continue using your V6 databases with GT.M V7.1-004. In case you do not wish to operate with files of differing format, specify the -V6 qualifier when invoking MUPIP CREATE.</p><p>      <span class="bold"><strong>Choosing the right upgrade path</strong></span>    </p><p>Choose V7 Upgrade Path 1 or 2 if you anticipate a database file to grow to over 994Mi blocks or require trees of over 7 levels as V7.1-004 supports 16Gi blocks and 11 levels. Note that the maximum size of a V7 database file having 8KiB block size is 114TiB (8KiB*16Gi).</p><p>Choose the V7 Upgrade Path 3 if you do not anticipate a database file to grow beyond the V6 database limit of 994Mi blocks or a tree depth limit of 7 levels. Note that the maximum size of a V6 database file having 8KiB block size is 7TiB (8KiB*992Mi).</p><p>Other than the new maximum database file size and greater tree depth that comes with V7 Upgrade Path 1 and 2, there is no difference between V7 Upgrade Path 1 and 2 and V7 Upgrade Path 3. You can choose V7 Upgrade Path 3 first and then later choose V7 Upgrade Path 1 or 2 if a need arises.</p><p>For additional details on differences in factors involved in the V6 to V7 upgrade refer to Appendix G in the GT.M Administration and Operations Guide.</p><div class="sect4" title="Database Compatibility Notes"><div class="titlepage"><div><div><h5 class="title"><a name="GTMdatabase_comp"></a> Database Compatibility Notes</h5></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Changes to the database file header may occur in any release. GT.M automatically upgrades database file headers as needed. Any changes to database file headers are upward and downward compatible within a major database release number, that is, although processes from only one GT.M release can access a database file at any given time, processes running different GT.M releases with the same major release number can access a database file at different times.</p></li><li class="listitem"><p>Databases created with V5.3-004 through V5.5-000 can grow to a maximum size of 224Mi (234,881,024) blocks. This means, for example, that with an 8KiB block size, the maximum database file size is 1,792GiB; this is effectively the size of a single global variable that has a region to itself and does not itself span regions; a database consists of any number of global variables. A database created with GT.M versions V5.0-000 through V5.3-003 can be upgraded with the V5 version of MUPIP UPGRADE to increase the limit on database file size from 128Mi to 224Mi blocks.</p></li><li class="listitem"><p>Databases created with V5.0-000 through V5.3-003 have a maximum size of 128Mi (134, 217,728) blocks. GT.M versions V5.0-000 through V5.3-003 can access databases created with V5.3-004 and later as long as they remain within a 128Mi block limit.</p></li><li class="listitem"><p>Database created with V6.0-000 through V6.3-014 have a maximum size of 1,040,187,392 (992Mi) blocks.</p></li><li class="listitem"><p>Database created with V7.0-000 and up have a maximum size of 17,179,869,184 (16Gi) blocks.</p></li></ul></div></div></div><div class="sect3" title="Stage 3: Replication Instance File Upgrade"><div class="titlepage"><div><div><h4 class="title"><a name="GTMstage_3"></a> Stage 3: Replication Instance File Upgrade</h4></div></div></div><p> GT.M V7.1-004 does not require new replication instance files when upgrading from any version after V6.0-000.</p></div><div class="sect3" title="Stage 4: Journal Files Upgrade"><div class="titlepage"><div><div><h4 class="title"><a name="GTMstage_4"></a> Stage 4: Journal Files Upgrade</h4></div></div></div><p> On every GT.M upgrade:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> Create a fresh backup of your database</p></li><li class="listitem"><p> Generate new journal files (without back-links), typically by turning journaling OFF and then back ON</p></li></ul></div><div class="important" title="Important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important:  Important"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Important]" src="images/important.jpg"></td><th align="left"> Important</th></tr><tr><td align="left" valign="top"><p> This is necessary because MUPIP JOURNAL cannot use journal files from a release other than its own for e.g. RECOVER, ROLLBACK, or EXTRACT. </p><p>MUPIP UPGRADE temporarily disables journaling and replication settings for the duration of its activity. Once complete, MUPIP UPGRADE restores prior settings.</p></td></tr></table></div></div><div class="sect3" title="Stage 5: Trigger Definitions Upgrade"><div class="titlepage"><div><div><h4 class="title"><a name="GTMstage_5"></a> Stage 5: Trigger Definitions Upgrade</h4></div></div></div><p> GT.M V7.1-004 does not require trigger definition upgrade when upgrading GT.M from any version after V6.3-000. If upgrading from a prior GT.M release, please see the instructions in the release notes for V6.3-014.</p></div></div><div class="sect2" title="Managing M mode and UTF-8 mode"><div class="titlepage"><div><div><h3 class="title"><a name="mng_mode"></a>Managing M mode and UTF-8 mode</h3></div></div></div><p>With <a class="ulink" href="http://icu-project.org" target="_blank">International Components for <span class="trademark">Unicode</span>(R)</a> (ICU) version 3.6 or later installed, GT.M's UTF-8 mode provides support for <span class="trademark">Unicode</span>(R) (ISO/IEC-10646) character strings. On a system that does not have ICU 3.6 or later installed, GT.M only supports M mode.</p><p>On a system that has ICU installed, GT.M optionally installs support for both M mode and UTF-8 mode, including a utf8 subdirectory of the directory where GT.M is installed. From the same source file, depending upon the value of the environment variable gtm_chset, the GT.M compiler generates an object file either for M mode or UTF-8 mode. GT.M generates a new object file when it finds both a source and an object file, and the object predates the source file and was generated with the same setting of $gtm_chset/$ZCHset. A GT.M process generates an error if it encounters an object file generated with a different setting of $gtm_chset/$ZCHset than that processes' current value.</p><p>Always generate an M object module with a value of $gtm_chset/$ZCHset matching the value processes executing that module will have. As the GT.M installation itself contains utility programs written in M, their object files also conform to this rule. In order to use utility programs in both M mode and UTF-8 mode, the GT.M installation ensures that both M and UTF-8 versions of object modules exist, the latter in the utf8 subdirectory. This technique of segregating the object modules by their compilation mode prevents both frequent recompiles and errors in installations where both modes are in use. If your installation uses both modes, consider a similar pattern for structuring application object code repositories.</p><p>GT.M is installed in a parent directory and a utf8 subdirectory as follows:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Actual files for GT.M executable programs (mumps, mupip, dse, lke, and so on) are in the parent directory, that is, the location specified for installation.</p></li><li class="listitem"><p>Object files for programs written in M (GDE, utilities) have two versions - one compiled with support for UTF-8 mode in the utf8 subdirectory, and one compiled without support for UTF-8 mode in the parent directory. Installing GT.M generates both versions of object files, as long as ICU 3.6 or greater is installed and visible to GT.M when GT.M is installed, and you choose the option to install UTF-8 mode support. During installation, GT.M provides an option that allows placing the object code in shared libraries in addition to individual files in the directory.</p></li><li class="listitem"><p>The utf8 subdirectory has files called mumps, mupip, dse, lke, and so on, which are relative symbolic links to the executables in the parent directory (for example, mumps is the symbolic link ../mumps).</p></li><li class="listitem"><p>When a shell process sources the file gtmprofile, the behavior is as follows:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>If $gtm_chset is "m", "M" or undefined, there is no change from the previous GT.M versions to the value of the environment variable $gtmroutines.</p></li><li class="listitem"><p>If $gtm_chset is "UTF-8" (the check is case-insensitive),</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem"><p>$gtm_dist is set to the utf8 subdirectory (that is, if GT.M is installed in /usr/lib/fis-gtm/gtm_V7.1-004_i686, then gtmprofile sets $gtm_dist to /usr/lib/fis-gtm/gtm_V7.1-004_i686/utf8).</p></li><li class="listitem"><p>On platforms where the object files have not been placed in a libgtmutil.so shared library, the last element of $gtmroutines is $gtm_dist($gtm_dist/..) so that the source files in the parent directory for utility programs are matched with object files in the utf8 subdirectory. On platforms where the object files are in libgtmutil.so, that shared library is the one with the object files compiled in the mode for the process.</p></li></ul></div></li></ul></div></li></ul></div><p>For more information on gtmprofile, refer to the <a class="ulink" href="../books/ao/UNIX_manual/ch03.html" target="_blank">Basic Operations</a> chapter of GT.M Administration and Operations Guide.</p><p>Although GT.M uses ICU for UTF-8 operation, ICU is not FIS software and FIS does not support ICU.</p></div><div class="sect2" title="Setting the environment variable TERM"><div class="titlepage"><div><div><h3 class="title"><a name="setterm"></a>Setting the environment variable TERM</h3></div></div></div><p>The environment variable TERM must specify a terminfo entry that accurately matches the terminal (or terminal emulator) settings. Refer to the terminfo man pages for more information on the terminal settings of the platform where GT.M needs to run.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Some terminfo entries may seem to work properly but fail to recognize function key sequences or fail to position the cursor properly in response to escape sequences from GT.M. GT.M itself does not have any knowledge of specific terminal control characteristics. Therefore, it is important to specify the right terminfo entry to let GT.M communicate correctly with the terminal. You may need to add new terminfo entries depending on your specific platform and implementation. The terminal (emulator) vendor may also be able to help.</p></li><li class="listitem"><p>GT.M uses the following terminfo capabilities. The full variable name is followed by the capname in parenthesis:</p><pre class="programlisting">auto_right_margin(am), clr_eos(ed), clr_eol(el), columns(cols), cursor_address(cup), cursor_down(cud1), cursor_left(cub1), cursor_right(cuf1), cursor_up(cuu1), eat_newline_glitch(xenl), key_backspace(kbs), key_dc(kdch1),key_down(kcud1), key_left(kcub1), key_right(kcuf1), key_up(kcuu1), key_insert(kich1), keypad_local(rmkx),keypad_xmit(smkx), lines(lines).</pre></li></ul></div><p>GT.M sends keypad_xmit before terminal reads for direct mode and READs (other than READ *) if EDITING is enabled. GT.M sends keypad_local after these terminal reads.</p></div><div class="sect2" title="Installing Compression Libraries"><div class="titlepage"><div><div><h3 class="title"><a name="install_comp_lib"></a> Installing Compression Libraries</h3></div></div></div><p> If you plan to use the optional compression facility for replication, you must provide the compression library. The GT.M interface for compression libraries accepts the zlib compression libraries without any need for adaptation. These libraries are included in many UNIX distributions and are downloadable from the <a class="ulink" href="http://www.zlib.net" target="_blank">zlib home page</a>. If you prefer to use other compression libraries, you need to configure or adapt them to provide the same API as that provided by zlib.</p><p> If a package for zlib is available with your operating system, FIS suggests that you use it rather than building your own.</p><p> By default, GT.M searches for the libz.so shared library in the standard system library directories (for example, /usr/lib, /usr/local/lib, /usr/local/lib64). If the shared library is installed in a non-standard location, before starting replication, you must ensure that the environment variable LIBPATH (AIX) or LD_LIBRARY_PATH (GNU/Linux) includes the directory containing the library. The Source and Receiver Server link the shared library at runtime. If this fails for any reason (such as file not found, or insufficient authorization), the replication logic logs a DLLNOOPEN error and continues with no compression.</p><p>Although GT.M uses a library such as zlib for compression, such libraries are not FIS software and FIS does not support any compression libraries.</p></div></div><div class="sect1" title="Change History"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="GTMchng_hist"></a> Change History</h2></div></div></div><div class="sect2" title="V7.1-004"><div class="titlepage"><div><div><h3 class="title"><a name="GTMtaV71-004ble"></a>V7.1-004</h3></div></div></div><p>Fixes and enhancements specific to V7.1-004:</p><p></p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><thead><tr><th>                <p><span class="bold"><strong>Id</strong></span></p>              </th><th>                <p><span class="bold"><strong>Prior Id</strong></span></p>              </th><th>                <p><span class="bold"><strong>Category</strong></span></p>              </th><th>                <p><span class="bold"><strong>Summary</strong></span></p>              </th></tr></thead><tbody><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE197637141">GTM-9141</a></p></td><td><p>GTM-F135289</p></td><td><p>Admin</p></td><td><p> <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!alert!]"></span>  Improve Source Server memory management</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE197637272">GTM-9272</a></p></td><td><p>GTM-F135238</p></td><td><p>Admin</p></td><td><p> <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!alert!]"></span>  Create database files  with permisions from umask</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE197637653">GTM-9653</a></p></td><td><p>GTM-DE201377</p></td><td><p>Other</p></td><td><p>Include region and database file names in MLKHASHRESIZE, MLKHASHRESIZEFAIL and MLKREHASH messages</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE197637775">GTM-9775</a></p></td><td><p>GTM-DE532807</p></td><td><p>Other</p></td><td><p>Avoid GTMASSERT due to a high rate of MUPIP INTRPTs</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE197637812">GTM-9812</a></p></td><td><p>GTM-DE557990</p></td><td><p>Other</p></td><td><p>Handle asynchronous events more appropriately</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE197637815">GTM-9815</a></p></td><td><p>GTM-DE562037</p></td><td><p>Other</p></td><td><p>Address issue with Direct Mode handling of MUPIP INTRPT and similar signals</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE197637831">GTM-9831</a></p></td><td><p>GTM-DE575840</p></td><td><p>Other</p></td><td><p> <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!alert!]"></span>  Address interaction with C compiler optimization </p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE197637833">GTM-9833</a></p></td><td><p>GTM-DE579226</p></td><td><p>Language</p></td><td><p>Improve $STORAGE</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE197637836">GTM-9836</a></p></td><td><p>GTM-DE582271</p></td><td><p>DB</p></td><td><p>Manage online rollback interaction with concurrent kills appropriately</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE197637839">GTM-9839</a></p></td><td><p>GTM-DE583881</p></td><td><p>Admin</p></td><td><p>Correct encrytion interaction with MUPIP REORG</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE197637841">GTM-9841</a></p></td><td><p>GTM-DE585411</p></td><td><p>Language</p></td><td><p>Compiler Optimization</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE197637855">GTM-9855</a></p></td><td><p>F132375</p></td><td><p>Language</p></td><td><p>READ * from a socket returns -1 if the read fails</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410071">GTM-10071</a></p></td><td><p>GTM-F238637</p></td><td><p>DB</p></td><td><p>Improve wait for database block read in progress</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410076">GTM-10076</a></p></td><td><p>GTM-F239380</p></td><td><p>DB</p></td><td><p>Add database index block statistics <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410081">GTM-10081</a></p></td><td><p>GTM-F240798</p></td><td><p>Admin</p></td><td><p>Include a timestamp in GETADDRINFO error message. <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410098">GTM-10098</a></p></td><td><p>GTM-F249269</p></td><td><p>DB</p></td><td><p> <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!alert!]"></span> Limit TPNOACID retries <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410099">GTM-10099</a></p></td><td><p>GTM-F249271</p></td><td><p>DB</p></td><td><p> <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!alert!]"></span>  Check ZEDIT and external calls for TPNOACID issues <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410123">GTM-10123</a></p></td><td><p>GTM-F266122</p></td><td><p>DB</p></td><td><p>Add $INCREMENT()  statistic <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410150">GTM-10150</a></p></td><td><p>GTM-7163</p></td><td><p>Language</p></td><td><p>Recognize and report DBROLLEDABACK errors in $TEXT() processing</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410541">GTM-10541</a></p></td><td><p>-</p></td><td><p>DB</p></td><td><p>Manage the Journal pool resource appropriately after stressful events</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410554">GTM-10554</a></p></td><td><p>-</p></td><td><p>DB</p></td><td><p>Add sleep timing statistics <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410586">GTM-10586</a></p></td><td><p>-</p></td><td><p>Other</p></td><td><p>Eliminate a rare issue with asynchronous events</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410587">GTM-10587</a></p></td><td><p>-</p></td><td><p>Admin</p></td><td><p>Improve connection try management and IPC management at replication shutdown</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410588">GTM-10588</a></p></td><td><p>-</p></td><td><p>Other</p></td><td><p> <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!alert!]"></span> Improve memory management</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410591">GTM-10591</a></p></td><td><p>-</p></td><td><p>Other</p></td><td><p>Prevent a timer expiration that could cause processes to loop</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410597">GTM-10597</a></p></td><td><p>-</p></td><td><p>Other</p></td><td><p>Prevent rare indefinite looping due to MUPIP STOP or other process kill</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410603">GTM-10603</a></p></td><td><p>-</p></td><td><p>DB</p></td><td><p> <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!alert!]"></span> Provide millisecond accuracy and 60 second limit for $ZMAXTPTIME <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410615">GTM-10615</a></p></td><td><p>-</p></td><td><p>Other</p></td><td><p>Protect against asynchronous events causing LOCKing processes to subsequently terminate with a GTMASSRT2</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410623">GTM-10623</a></p></td><td><p>-</p></td><td><p>DB</p></td><td><p>Inhibit epoch tapering for lone/single updater process</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410670">GTM-10670</a></p></td><td><p>-</p></td><td><p>Admin</p></td><td><p>Deal appropriately with decreases in tree depth in MUPIP REORG </p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410679">GTM-10679</a></p></td><td><p>-</p></td><td><p>Language</p></td><td><p> <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!alert!]"></span>  Maintain $REFERENCE to the last node it successfully processed for ZWRITE of a gvn  <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410684">GTM-10684</a></p></td><td><p>-</p></td><td><p>Admin</p></td><td><p>Fix minor MUPIP INTEG buffer mismangement issue</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410687">GTM-10687</a></p></td><td><p>-</p></td><td><p>Admin</p></td><td><p>Provide a more appropriate value in errors concerning the maximum journal file extension setting</p></td></tr><tr><td><p><a class="link" href="GTM_V7.1-004_Release_Notes.html#GTM-DE1959410688">GTM-10688</a></p></td><td><p>-</p></td><td><p>Language</p></td><td><p>Prevent possible garbage assignments to $ZTRAP and device EXCEPTIONs</p></td></tr></tbody></table></div></div></div><div class="sect1" title="Database"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm45829642220704"></a>Database </h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><a name="GTM-DE197637836"></a> GT.M properly manages concurrent process kills during an online rollback. Previously, a concurrent kill might have induced unwanted transaction restarts during the online rollback. This was only seen in development environments and was never reported by a customer. (GTM-9836)</p></li><li class="listitem"><p><a name="GTM-DE1959410071"></a> GT.M avoids unnecessary delays when one process waits for another process to complete the read from secondary storage of a block in which it is interested. Previously, such cases could result in slowdowns in processing; for example, when the replication update process repeatedly waits for reads initiated by reader helpers. (GTM-10071)</p></li><li class="listitem"><p><a name="GTM-DE1959410076"></a> For regions with BG access method, GT.M provides GVSTATS IDXH which gives the number of index block hits and IDXM which gives the number of index block misses. These statistics may help in determining appropriate sizing for a region's global buffers. The hit ratio may be determined as: IDXH/(IDXH+IDXM). Index blocks hold  metadata GT.M uses to rapidly locate application data. They constitute a very small, but heavily used, portion of a database file. Finding them in the global buffers causes a higher positive impact on database performance than finding data blocks. While these statistics are useful in understanding the role of global buffers, because processes use their own caching of paths to recently referenced data, these statistics underrepresent actual index block usage. IDXM is a subset of DRD. The hit ratio for data blocks may be approximated by: (DTA+GET+KIL+ORD+QRY+SET+ZPR-DRD)/(DTA+GET+KIL+ORD+QRY+SET+ZPR). Previously, GT.M did not provide separate index block statistics. (GTM-10076) <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></li><li class="listitem"><p><a name="GTM-DE1959410098"></a> By default, TPNOTACID retries for a transaction exceed 16, GT.M issues a trappable TPNOTACID error in order to limit livelock. The limit may be adjusted to between four (4) and 100, or set to zero (0) by appropriately defining the gtm_tpnotacidtries environment variable; specifying a value outside the supported values silently reverts to the default. The setting of zero (0) acts like an audit by reporting all encountered operations capable of causing TPNOTACID detection to the syslog but setting the actual error limit to the default. In addition, GT.M suppresses TPNOTACID syslog warning messages that originate from the same action as the last prior message from a given process. Previously, GT.M did not enforce any limit on TPNOTACID retries, had no "audit" capability and could be noisy with informational messages for TPNOTACID retries. (GTM-10098) <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!Alert!]"></span> <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></li><li class="listitem"><p><a name="GTM-DE1959410099"></a> GT.M uses TPNOTACID behavior for all external calls and for ZEDIT; previously, external calls and the ZEDIT command were exempted from TPNOTACID handling. (GTM-10099) <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!Alert!]"></span> <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></li><li class="listitem"><p><a name="GTM-DE1959410123"></a> $VIEW "GVSTAT", ZSHOW "G" and %YGBLSTAT report the count of $INCREMENT() operations labeled INC. $INCREMENT() operations are are still included in the SET count. Previously, these operations were only included in the SET count. (GTM-10123) <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></li><li class="listitem"><p><a name="GTM-DE1959410541"></a> GT.M appropriately manages the journal pool resource control (ftok semaphore IPC) after tracked events lose accuracy for example after simultaneous access of a journal pool by more than more than 32Ki processes. Previously, such a situation could cause inappropriate EINVAL errors when subsequently accessing the journal pool. This was only seen in development environments and was never reported by a customer. (GTM-10541)</p></li><li class="listitem"><p><a name="GTM-DE1959410554"></a> GT.M includes six additional counters tracking milliseconds of time slept while waiting on another process to finish a task. The counters are available as part of all forms of GVSTATs, and have the following mnemonics and descriptions:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">JCS - milliseconds of time slept in crit waiting for another process to finish a write into the journal file.</li><li class="listitem">JNS - milliseconds of time slept outside of crit waiting for another process to finish a write into the journal file.</li><li class="listitem">WPCS - milliseconds of time slept in crit waiting for another process to finish flushing a block to disk.</li><li class="listitem">RCS - milliseconds of time slept in crit waiting for another process to finish reading in a block from disk.</li><li class="listitem">WFCS - milliseconds of time slept in crit while performing a flush of one or more blocks to disk, usually in an epoch.</li><li class="listitem">GCS - milliseconds of time slept in crit while acquiring a global buffer and waiting for another process to finish writing a block to disk.</li></ul></div><p>These counters can help identify the cause of performance degradation. High values per second can indicate I/O throughput issues that are forcing GT.M to perform excessive coordination activity. (GTM-10554) <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></li><li class="listitem"><p><a name="GTM-DE1959410603"></a> $ZMAXTPTIME and its initializing environment variable, $gtm_zmaxtptime, maintain precision to milliseconds (three digits after the decimal point). Also, both ignore values exceeding a maximum of 60 seconds. Previously $ZMAXTPTIME only provided whole seconds, and, while it limited the initial value to 60 seconds, it did not limit the SET value. (GTM-10603) <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!Alert!]"></span> <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></li><li class="listitem"><p><a name="GTM-DE1959410623"></a> GT.M inhibits epoch tapering when epoch tapering is enabled and only one process actively does updates. Previously, in this situation, epoch tapering could reduce performance. (GTM-10623)</p></li></ul></div></div><div class="sect1" title="Language"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm45829642178544"></a>Language </h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><a name="GTM-DE197637833"></a> $STORAGE reports the correct value when there is a restriction on the data segment limit (RLIMIT_DATA) of a process. Previously, $STORAGE inappropriately returned 2GiB in such a case. (GTM-9833)</p></li><li class="listitem"><p><a name="GTM-DE197637841"></a> GT.M avoids processing certain unneeded compiler operations. The optimization originally appeared in V6.3-012, but was ineffective. (GTM-9841)</p></li><li class="listitem"><p><a name="GTM-DE197637855"></a> READ * from a socket returns minus one (-1) if the read fails; previously it returned a zero (0) in that case, which was inconsistent with other devices and with the standard. (GTM-9855)</p></li><li class="listitem"><p><a name="GTM-DE1959410150"></a>  $TEXT() recognizes and reports DBROLLEDABACK error. Previously $TEXT() ignored and did not report DBROLLEDBACK errors. This was only seen in development environments and was never reported by a customer. (GTM-10150)</p></li><li class="listitem"><p><a name="GTM-DE1959410679"></a> ZWRITE of a gvn maintains $REFERENCE to the last node it successfully processed. If you use ZWRITE as a debugging tool, or unlikely, in application code, in a circumstance where preserving $REFERENCE has importance, note $REFERENCE and restore it, as you would for any other command or function that references a global. Previously, ZWRITE restored the $REFERENCE to the value it had prior to the ZWRITE. (GTM-10679) <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!Alert!]"></span> <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></li><li class="listitem"><p><a name="GTM-DE1959410688"></a> SET $ZTRAP appropriately validates the code string provided as a new value. GTM-9480/GTM-DE304273 in V7.0-004, which addressed an issue with $ZTRAP maintenance, introduced a possibility that the compilation of a $ZTRAP during a "SET $ZTRAP=x" operation could result in assigning a garbage value to $ZTRAP. A similar issue, dating to V6.3-001A, also affects certain I/O exception handlers specified as exception device parameters. If your application always uses code vectors rather than labels, a workaround for both issues is to set the gtm_ztrap_form environment variable to "adaptive", which prevents the assignment operation from validating the code. (GTM-10688)</p></li></ul></div></div><div class="sect1" title="System Administration"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm45829642308416"></a>System Administration </h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><a name="GTM-DE197637141"></a> A Source Server more reliably returns memory used to manage journal files to the operating system as it moves from older to newer journal files for a region. The Source Server uses the mmap() and munmap() services rather than malloc() and free(), which may affect the memory limits for the process or the system. Previously, the Source Server deallocated memory for older journal files, but malloc() and free() rely on a system heap implementation that can interfere with attempts to return memory from the process to the operating system. (GTM-9141) <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!Alert!]"></span></p></li><li class="listitem"><p><a name="GTM-DE197637272"></a> MUPIP CREATE gives database files permissions based on the umask setting of the target directory. Previously new database files always took 0666 as their permission regardless umask setting. (GTM-9272) <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!Alert!]"></span></p></li><li class="listitem"><p><a name="GTM-DE197637839"></a> GT.M processes started at the same time as a REORG ENCRYPT correctly load the new encryption key. Previously, processes started at the same time as REORG ENCRYPT could fail to acquire the new key and exit with a CRYPTOPFAILED error message. This issue was only seen in development and not reported by a customer. (GTM-9839)</p></li><li class="listitem"><p><a name="GTM-DE1959410081"></a> Both the Source and Receiver Servers include a timestamp in any GETADDRINFO error messages and the Receiver Server follows that message with a REPLCOMM message. Previously, neither Server included a timestamp in the GETADDRINFO error message, and the Receiver Server omitted the REPLCOMM message. (GTM-10081) <span class="inlinemediaobject"><img src="images/chkmrkg.png" alt="[!New Feature!]"></span></p></li><li class="listitem"><p><a name="GTM-DE1959410587"></a> On replication shutdown GT.M allows sufficient time for all processes to terminate before attempting to clean up shared IPC resources. Previously running peer processes could prevent the resources from being released. This was seen only in internal testing and was not reported in production. Also for replication retries GT.M takes care to check the retry interval. Previously, if an operating system sleep operation returned slightly before expected, GT.M might delay connection retries. This was only seen in internal testing and not reported by any customer. (GTM-10587)</p></li><li class="listitem"><p><a name="GTM-DE1959410670"></a> MUPIP REORG correctly handles concurrent reduction in the depth of a global tree caused by concurrent REORGs or full-global kills. Previously, in rare cases where this situation occurred in a small window, REORG could terminate unexpectedly due to a GVFAIL error or segmentation violation (SIG-11) without any database damage. This issue was only discovered in testing and not reported by any customer. (GTM-10670)</p></li><li class="listitem"><p><a name="GTM-DE1959410684"></a> MUPIP INTEG appropriately manages reporting details of an error in a database block. Previously, INTEG would overwrite between one (1) and four (4) bytes beyond the end of the message buffer when preparing such an error message. This issue was only discovered in testing and not reported by any customer; we not been unable to identify any user-visible symptoms or any security exploit associated with this issue. (GTM-10684)</p></li><li class="listitem"><p><a name="GTM-DE1959410687"></a> GDE and MUPIP report a more appropriate maximum value for journal file extension. This does not change the way the extension logic works, only the value reported by the GDE VALTOOBIG or MUPIP JNLINVEXT messages. Previously the messages reported a maximum that had no relationship with the maximum size of a journal file. (GTM-10687)</p></li></ul></div></div><div class="sect1" title="Other"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm45829642171008"></a>Other </h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><a name="GTM-DE197637653"></a> MLKHASHRESIZE, MLKHASHRESIZEFAIL and MLKREHASH messages include region and database file names. Previously, these error messages did not provide the region and database file names. (GTM-9653)</p></li><li class="listitem"><p><a name="GTM-DE197637775"></a> GT.M appropriately handles a high rate of MUPIP interrupts. Previously, under rare circumstances where a process received many MUPIP INTRPTs in rapid succession, the process could fail with an GTMASSERT error. This issue was only seen in development and not reported by any customer. (GTM-9775)</p></li><li class="listitem"><p><a name="GTM-DE197637812"></a> GT.M appropriately manages processing of asynchronous events, such as MUPIP INTRPT. Previously, when GT.M handled such events it used certain non-reentrant system calls, which, if those calls where coincidentally already in use, could in rare cases lead to memory corruption, resulting in bad behavior typically a missed event or a segmentation violation (SIG-11). (GTM-9812)</p></li><li class="listitem"><p><a name="GTM-DE197637815"></a> Processes in Direct Mode handle local variables appropriately when interrupted by SIGINT or SIGUSR1 signals. Previously, processing such signals in Direct Mode leaked stack space, potentially causing STACKCRIT and/or STACKOFLOW errors. (GTM-9815)</p></li><li class="listitem"><p><a name="GTM-DE197637831"></a>  GT.M properly handles the effects of advanced optimization under newer C compilers during asynchronous signal handling. This issue does not affect any known distributed binaries of GT.M, but can affect versions of GT.M compiled from source with compiler optimizations enabled. The issue can cause database corruption, application-level inconsistency in the form of partially-complete transactions, and hangs. Users of previous versions who compiled from source with compiler optimizations enabled can reduce the likelihood of encountering this issue by increasing the database flush timer. This issue was found in development and was never reported by any customer. (GTM-9831) <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!Alert!]"></span></p></li><li class="listitem"><p><a name="GTM-DE1959410586"></a> Eliminate a rare issue with asynchronous events; previously such an event at in a window that widened in V7.1-003, could cause a process termination with a SIG6. (GTM-10586)</p></li><li class="listitem"><p><a name="GTM-DE1959410588"></a> GT.M more reliably returns physical and virtual memory used to manage its heap to the operating system, using the mmap() and munmap() services rather than malloc() and free(). The change may affect the memory limits for the system. Previously, GT.M deallocated memory when its heap needed to expand, but used malloc() and free() which rely on a system heap implementation that can interfere with attempts to return memory to the operating system. (GTM-10588) <span class="inlinemediaobject"><img src="images/chkmrkb.png" alt="[!Alert!]"></span></p></li><li class="listitem"><p><a name="GTM-DE1959410591"></a> GT.M protects itself against a case where a timer could expire in a vulnerable window of several instructions and cause a process performing a journal operation to loop indefinitely. This issue did not compromise database integrity. Recovery required shutting down processing and restarting journaling. (GTM-10591)</p></li><li class="listitem"><p><a name="GTM-DE1959410597"></a> GT.M protects itself against a rare case where a MUPIP STOP or other process kills could occur in a vulnerable window of a handful of instructions and create an inconsistent state in the journal buffer which could cause GT.M processes to loop indefinitely while trying commit an update. This issue did not compromise database integrity. (GTM-10597)</p></li><li class="listitem"><p><a name="GTM-DE1959410615"></a> GT.M provides protection from asynchronous events during small windows performing state changes to LOCK shared memory. Previously, asynchronous events like MUPIP STOP at inopportune times could leave LOCK shared memory in an out-if-design state, causeing subsequent attempts at using LOCKs to terminate with a GTMASSERT2. The workaround was to close and restart the instance. (GTM-10615)</p></li></ul></div></div><div class="sect1" title="Error and Other Messages"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm45829642158256"></a>Error and Other Messages</h2></div></div></div><div class="sect2" title="MLKHASHRESIZE  "><div class="titlepage"><div><div><h3 class="title"><a name="GTMMLKHASHRESIZE"></a>MLKHASHRESIZE <span class="inlinemediaobject"><img src="images/revised.png" alt="Revised"></span>  </h3></div></div></div><p><span class="bold"><strong>MLKHASHRESIZE, </strong></span>
LOCK hash table for region rrrr (dddd) increased in size from aaaa to bbbb and placed in shared memory (id = mmmm)</p><p>Operator log Information: GT.M needed to expand a hash table for region rrrr mapped to database file dddd used for managing LOCK information.</p><p>Action: No user action is required, but shared memory monitoring will show an additional shared memory segment with id mmmm.</p></div><div class="sect2" title="MLKHASHRESIZEFAIL  "><div class="titlepage"><div><div><h3 class="title"><a name="GTMMLKHASHRESIZEFAIL"></a>MLKHASHRESIZEFAIL <span class="inlinemediaobject"><img src="images/revised.png" alt="Revised"></span>  </h3></div></div></div><p><span class="bold"><strong>MLKHASHRESIZEFAIL, </strong></span>
Failed to increase LOCK hash table for region rrrr (dddd) size from aaaa to bbbb. Will retry with larger size.</p><p>Operator log Warning: GT.M needed to expand a hash table for region rrrr mapped to database file dddd used for managing LOCK information needed to be expanded, but the initial attempt failed, necessitating a retry.</p><p>Action: A subsequent MLKHASHRESIZE indicates that the retry succeeded and no user action is required.</p></div><div class="sect2" title="MLKREHASH  "><div class="titlepage"><div><div><h3 class="title"><a name="GTMMLKREHASH"></a>MLKREHASH <span class="inlinemediaobject"><img src="images/revised.png" alt="Revised"></span>  </h3></div></div></div><p><span class="bold"><strong>MLKREHASH, </strong></span>
LOCK hash table rebuilt for region rrrr (dddd) (seed = ssss)</p><p>Run Time Information: GT.M has detected an issue with the LOCK hash table for region rrrr mapped to database file dddd and regenerated it using a new seed value ssss.</p><p>Action: This information message confirms the success of the rehash operation.</p></div><div class="sect2" title="MUTEXLCKALERT  "><div class="titlepage"><div><div><h3 class="title"><a name="GTMMUTEXLCKALERT"></a>MUTEXLCKALERT <span class="inlinemediaobject"><img src="images/revised.png" alt="Revised"></span>  </h3></div></div></div><p><span class="bold"><strong>MUTEXLCKALERT, </strong></span>
Mutual Exclusion subsystem ALERT - Lock attempt threshold crossed for region rrrr. Process pppp is in crit cycle cccc.</p><p>Run Time Error: This warning indicates that a process could not obtain a critical section lock for region rrrr even after waiting longer than the GT.M determined threshold (approximately 32 seconds) because the critical section lock was held that entire time by another process pppp. cccc is the crit cycle count which GT.M increases by one every time it successfully grants the mutual exclusion (mutex) lock to a process. cccc provides a measure of the frequency of mutex lock use. MUTEXLCKALERT messages indicate that process pppp is blocking access to region rrrr for inappropriately long periods of time and thereby impacting performance for other processes needing access that region.</p><p> GT.M produces this warning when:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> A process owning a critical section dies (most likely because of a kill -9) and the OS gives its PID to another process. To reclaim the inappropriately held critical section, GT.M first checks whether the process is alive and whether it holds hold the critical section. On finding that the process is alive but does not hold the critical section, GT.M concludes that it is not safe to free the critical section and alerts the operator with this message.</p></li><li class="listitem"><p> The process holding the critical section is using a non-Isolated command such as ZSYSTEM, BREAK or a timed command in a way that creates a deadlock or a live-lock. GT.M attempts to limit this by limiting the time a process using one of these commands can hold a critical section, but your use of non-Isolated commands and your settings for $ZMAXTPTIM and / or the environment variable $gtm_tpnotacidtime may be such that you get MUTEXLCKALERT messages. </p></li><li class="listitem"><p> There is an IO bottleneck that caused GT.M to slow down: GT.M detects that process pppp is currently using the critical section lock.</p></li></ul></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Note"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Note]" src="images/note.jpg"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>GT.M blocks signals during MUTEXLCKALERT warnings. This means that GT.M defers error handling as a result of TP timeout ($ZMAXTPTIME), interrupt handler invocation, $ztimeout action, MUPIP STOP, etc. until the mutex is released. For example,a process may have a 10 seconds $ZMAXTIMEOUT but GT.M may execute the error handler at a materially later time, until after the MUTEXLCKALERT condition has cleared. </p></td></tr></table></div><p></p><p>Action: Monitor the system to determine whether there is a process with process id pppp and whether that process is a GT.M process.</p><p> Implement a script to get a stack trace for process pppp or take other appropriate action and use the $gtm_procstuckexec environment variable to activate it before the block process sends the MUTEXLCKALERT message.</p><p> Identify and terminate process pppp to release control of that resource. If the process is a GT.M process, use a MUPIP STOP to terminate it. If a process of another application, use an appropriate mechanism to stop it.</p><p> If this message is due to an IO bottleneck, adopt a strategy that reduces IO. Some of the IO reducing strategies are:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> Revisit your database configuration parameters (especially block size, number of global buffers, journal buffers, and so on) to see if you can make improvements.</p></li><li class="listitem"><p> Create separate region (database) for temporary globals and do not replicate them.</p></li><li class="listitem"><p> Consider whether a different database access method and journaling strategy could improve throughput while satisfying your operational needs.</p></li><li class="listitem"><p> Consider tuning your filesystem</p></li><li class="listitem"><p> For application configurations with large numbers of concurrent processes and/or large process memory footprints, consider placing object code in shared libraries on GT.M editions that support it. This may free system memory which the OS can use for its file system cache, or which you can use to increase the number of global buffers.</p></li></ul></div><div class="important" title="Important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Important]" src="images/important.jpg"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p> Do not apply IO reduction strategies all at once. Try them one at a time and always verify/measure the results of each strategy.</p></td></tr></table></div><p></p></div><div class="sect2" title="TPNOTACID  "><div class="titlepage"><div><div><h3 class="title"><a name="GTMTPNOTACID"></a>TPNOTACID <span class="inlinemediaobject"><img src="images/revised.png" alt="Revised"></span>  </h3></div></div></div><p><span class="bold"><strong>TPNOTACID, </strong></span>
tttt at xxxx in a final TP retry violates ACID properties of a TRANSACTION and could exceed ssss milliseconds and rrrr RESTARTs have occurred</p><p>Run Time Error: GT.M issues this message as a warning to the syslog if it is executing a TP TRANSACTION in the final retry and control gets transferred out of GT.M due to any one of the following conditions: </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>a ZEDIT or ZSYSTEM command </p></li><li class="listitem"><p> Entering direct mode (e.g. due to a BREAK command)</p></li><li class="listitem"><p> An external call</p></li><li class="listitem"><p> a long running command (those which accept timeout specifications) encountered potentially indefinite restarts. </p></li></ul></div><p> The xxxx indicates the $ZPOSITION where the transfer of control occurred and the condition that caused this is identified in tttt.</p><p>GT.M issues this message as an error when it reaches the default limit of 16 or the limit setable by the gtm_tpnotacidtries environment variable</p><p>Action: Review your code to determine whether the non-Isolated commands can be moved outside of transaction encapsulation. Alternatively, ensure that they are minimally disruptive by using $ZMAXTPTIME to prevent transactions from running unreasonably long times and setting gtm_tpnotacidtime to specify the wait period for long running commands before GT.M logs a TPNOTACID message.</p></div></div></div></body></html>
