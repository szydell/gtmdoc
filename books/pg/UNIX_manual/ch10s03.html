<html>
<HEAD><META HTTP-EQUIV="Pragma" CONTENT="no-cache"><META HTTP-EQUIV="Expires" CONTENT="-1">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Conversion Utilities</title>
<link rel="stylesheet" href="gtm.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.75.2">
<link rel="home" href="index.html" title="GT.M Programmer's Guide">
<link rel="up" href="ch10.html" title="Chapter 10. Utility Routines">
<link rel="prev" href="ch10s02.html" title="Date and Time Utilities">
<link rel="next" href="ch10s04.html" title="Mathematic Utilities">
<link rel="copyright" href="ln-idm46578566834096.html" title="Legal Notice">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">
      Conversion Utilities</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="ch10s02.html">Prev</a> </td>
<th width="60%" align="center">Chapter 10. Utility Routines</th>
<td width="20%" align="right"> <a accesskey="n" href="ch10s04.html">Next</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">GT.M Programmer's Guide</a></span> &gt; <span class="breadcrumb-link"><a href="ch10.html">Utility Routines</a></span> &gt; <span class="breadcrumb-node">
      Conversion Utilities</span>
</div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="conversion_utils"></a>
      Conversion Utilities<a class="indexterm" name="idm46578558919216"></a>
</h2></div></div></div>
<p>The conversion utilities are:</p>
<p>%DH: Decimal to hexadecimal conversion.</p>
<p>%DO: Decimal to octal conversion.</p>
<p>%HD: Hexadecimal to decimal conversion.</p>
<p>%HO: Hexadecimal to octal conversion.</p>
<p>%LCASE: Converts a string to all lower case.</p>
<p>%OD: Octal to decimal conversion.</p>
<p>%OH: Octal to hexadecimal conversion.</p>
<p>%UCASE: Converts a string to all upper case.</p>
<p>The conversion utilities can be invoked as extrinsic functions.</p>
<p>While the radix conversions work for very long values, the performance degrades with length and may be impractical beyond some point. If your application limits the input(s) and performance is important, you can get some speed improvement by eliminating behavior on which your code does not rely.</p>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="percent_dh"></a>
      %DH<a class="indexterm" name="idm46578559365456"></a>
</h3></div></div></div>
<p>The %DH utility converts numeric values from decimal to hexadecimal. %DH defaults the length of its output to eight digits. However the input variable %DL overrides the default and controls the length of the output. The routine has entry points for interactive or non-interactive use.</p>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="utli_label_dh"></a>
      Utility Labels<a class="indexterm" name="idm46578558821872"></a>
</h4></div></div></div>
<p>INT: Converts interactively entered decimal number to hexadecimal number with the number of digits specified.</p>
<p>FUNC(d[,l]): Invokes %DH as an extrinsic function returning the hexadecimal equivalent of the argument.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="input_variables_dh"></a>
      Input Variables<a class="indexterm" name="idm46578558946496"></a>
</h4></div></div></div>
<p>%DH: As input, contains input decimal number.</p>
<p>%DL: Specifies how many digits appear in the output, defaults to eight.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="prompts_dh"></a>
      Prompts<a class="indexterm" name="idm46578558812592"></a>
</h4></div></div></div>
<p>Decimal: Requests a decimal number for conversion to hexadecimal.</p>
<p>Digits: Requests the length of the output in digits; eight by default.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="output_variables_dh"></a>
      Output Variables<a class="indexterm" name="idm46578558968848"></a>
</h4></div></div></div>
<p>%DH: As output, contains the converted number in hexadecimal.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="examples_of_dh"></a>
      Examples of %DH<a class="indexterm" name="idm46578559010944"></a>
</h4></div></div></div>
<p>Example:</p>
<pre class="programlisting">GTM&gt;DO INT^%DH 
Decimal: 12
Digits: 1
GTM&gt;ZWRITE 
%DH="C" </pre>
<p>This example invokes %DH interactively with INT^%DH. %DH prompts for a decimal number and output length, then returns the result in the variable %DH. ZWRITE displays the contents of the variables.</p>
<p>Example:</p>
<pre class="programlisting">GTM&gt;SET %DH=12
GTM&gt;DO ^%DH
GTM&gt;ZWRITE
%DH="0000000C"
%DL=8 </pre>
<p>This example sets the read-write variable %DH to 12 and invokes %DH to convert the number to a hexadecimal number. Because the number of digits was not specified, %DH used the default of 8 digits. Set %DL to specify the number of output digits.</p>
<p>Example:</p>
<pre class="programlisting">GTM&gt;WRITE $$FUNC^%DH(12,4)
000C</pre>
<p>This example invokes %DH as an extrinsic function using the FUNC label. The first argument specifies the input decimal number and the optional, second argument specifies the number of output digits. If the extrinsic does not have a second argument, the length of the output defaults to eight characters.</p>
</div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="percent_do"></a>
      %DO<a class="indexterm" name="idm46578558817488"></a>
</h3></div></div></div>
<p>The %DO utility converts numeric values from decimal to octal. The default length of its output is 12 digits. The value assigned to the input variable %DL overrides the default and controls the length of the output. The routine has entry points for interactive or non-interactive use.</p>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="util_labels_do"></a>
      Utility Labels</h4></div></div></div>
<p>INT: Converts the specified decimal number to an octal number with the specified number of digits, interactively.</p>
<p>FUNC(d[,ln]): Invokes %DO as an extrinsic function, returning the octal equivalent of the argument.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="prompts_do"></a>
      Prompts<a class="indexterm" name="idm46578558762320"></a>
</h4></div></div></div>
<p>Decimal: Requests a decimal number for conversion to octal.</p>
<p>Digits: Requests the length of the output in digits; 12 by default.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="input_variables_do"></a>
      Input Variables<a class="indexterm" name="idm46578558901408"></a>
</h4></div></div></div>
<p>%DO: As input, contains input decimal number.</p>
<p>%DL: Specifies the number of digits in the output, defaults to 12.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="output_variables_do"></a>
      Output Variables<a class="indexterm" name="idm46578558925488"></a>
</h4></div></div></div>
<p>%DO: As output, contains the converted number in octal.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="examples_of_do"></a>
      Examples of %DO<a class="indexterm" name="idm46578558769952"></a>
</h4></div></div></div>
<p>Example:</p>
<pre class="programlisting">GTM&gt;DO INT^%DO 
Decimal: 12
Digits: 4
GTM&gt;ZWRITE
%DO="0014"</pre>
<p>This example invokes %DO interactively with INT^%DO. %DO prompts for a decimal number and an output length. If the output value of %DO has leading zeros, the value is a string. ZWRITE displays the contents of the variables.</p>
<p>Example:</p>
<pre class="programlisting">GTM&gt;SET %DO=12 
GTM&gt;DO ^%DO
GTM&gt;ZWRITE
%DO="000000000014"</pre>
<p>This example sets the read-write variable %DO to 12 and invokes %DO to convert the number non-interactively. Because the number of digits was not specified, %DO used the default of 12 digits. Set %DL to specify the number of output digits. ZWRITE displays the contents of the variables.</p>
<p>Example:</p>
<pre class="programlisting">GTM&gt;WRITE $$FUNC^%DO(12,7)
0000014 </pre>
<p>This example invokes %DO as an extrinsic function with the label FUNC. The first argument specifies the number to be converted and the optional, second argument specifies the number of output digits. If the second argument is not specified, %DO uses the default of 12 digits.</p>
</div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="percent_hd"></a>
      %HD<a class="indexterm" name="idm46578558840672"></a>
</h3></div></div></div>
<p>The %HD utility converts numeric values from hexadecimal to decimal. %HD returns the decimal number in the read-write variable %HD. %HD rejects input numbers beginning with a minus (-) sign and returns null (""). The routine has entry points for interactive or non-interactive use.</p>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="util_labels_hd"></a>
      Utility Labels<a class="indexterm" name="idm46578558775664"></a>
</h4></div></div></div>
<p>INT: Converts hexadecimal number entered interactively to decimal number.</p>
<p>FUNC(h): Invokes %HD as an extrinsic function returning the decimal equivalent of the argument.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="prompts_hd"></a>
      Prompts<a class="indexterm" name="idm46578558759616"></a>
</h4></div></div></div>
<p>Hexadecimal: Requests a hexadecimal number for conversion to decimal.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="input_variables_hd"></a>
      Input Variables<a class="indexterm" name="idm46578558755904"></a>
</h4></div></div></div>
<p>%HD: As input, contains input hexadecimal number.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="output_variables_hd"></a>
      Output Variables<a class="indexterm" name="idm46578558754064"></a>
</h4></div></div></div>
<p>%HD: As output, contains the converted number in decimal.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="examples_of_hd"></a>
      Examples of %HD<a class="indexterm" name="idm46578558752032"></a>
</h4></div></div></div>
<p>Example:</p>
<pre class="programlisting">GTM&gt;DO INT^%HD
Hexadecimal:E
GTM&gt;ZWRITE
%HD=14</pre>
<p>This example invokes %HD in interactive mode with INT^%HD. %HD prompts for a hexadecimal number, then returns the converted number in the variable %HD. ZWRITE displays the contents of the variable.</p>
<p>Example:</p>
<pre class="programlisting">GTM&gt;SET %HD="E" 
GTM&gt;DO ^%HD
GTM&gt;ZWRITE
%HD=14</pre>
<p>This example sets the read-write variable %HD to "E" and invokes %HD to convert non-interactively the value of %HD to a decimal number. %HD places the converted value into the read-write variable %HD.</p>
<p>Example:</p>
<pre class="programlisting">GTM&gt;WRITE $$FUNC^%HD("E")
14</pre>
<p>This example invokes %HD as an extrinsic function with the label FUNC and writes the results.</p>
</div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="percent_ho"></a>
      %HO<a class="indexterm" name="idm46578558814960"></a>
</h3></div></div></div>
<p>The %HO utility converts numeric values from hexadecimal to octal. %HO returns the octal number in the read-write variable %HO. %HO rejects input numbers beginning with a minus (-) sign and returns null (""). The routine has entry points for interactive or non-interactive use.</p>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="util_labels_ho"></a>
      Utility Labels<a class="indexterm" name="idm46578558780016"></a>
</h4></div></div></div>
<p>INT: Converts hexadecimal number entered interactively to octal number.</p>
<p>FUNC(h): Invokes %HO as an extrinsic function returning the octal equivalent of the argument.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="prompts_ho"></a>
      Prompts<a class="indexterm" name="idm46578558742208"></a>
</h4></div></div></div>
<p>Hexadecimal: Requests a hexadecimal number for conversion to octal.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="input_varaibles_ho"></a>
      Input Variables<a class="indexterm" name="idm46578558820272"></a>
</h4></div></div></div>
<p>%HO: As input, contains input hexadecimal number.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="output_variables_ho"></a>
      Output Variables<a class="indexterm" name="idm46578558737680"></a>
</h4></div></div></div>
<p>%HO: As output, contains the converted number in octal.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="examples_of_ho"></a>
      Examples of %HO<a class="indexterm" name="idm46578558760272"></a>
</h4></div></div></div>
<p>Example:</p>
<pre class="programlisting">GTM&gt;DO INT^%HO
Hexadecimal:C3
GTM&gt;ZWRITE
%HO=303</pre>
<p>This example invokes %HO in interactive mode using INT^%HO. %HO prompts for a hexadecimal number that it converts to an octal number. ZWRITE displays the contents of the variable.</p>
<p>Example:</p>
<pre class="programlisting">GTM&gt;SET %HO="C3"
GTM&gt;DO ^%HO
GTM&gt;ZWRITE
%HO=303 </pre>
<p>This example sets the read-write variable %HO to "C3" and invokes %HO to convert the value of %HO non-interactively. ZWRITE displays the contents of the variable.</p>
<p>Example:</p>
<pre class="programlisting">GTM&gt;WRITE $$FUNC^%HO("C3")
303</pre>
<p>This example invokes %HO as an extrinsic function with the FUNC label.</p>
</div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="jswrite"></a>%JSWRITE<a class="indexterm" name="idm46578558745008"></a>
</h3></div></div></div>
<p>The ^%JSWRITE utility routine converts a glvn structure or a series of SET @ arguments to a string of JS objects. The format of the ^%JSWRITE utility is:</p>
<pre class="programlisting">^%JSWRITE(glvnode,[expr1,expr2])</pre>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>glvnode specifies the string containing the subscripted/unsubscripted global or local variable name.  When glvnode evaluates to an empty string ("") or there are no arguments, %JSWRITE considers all subscripted local variables in scope for conversion.</p></li>
<li class="listitem"><p>If expr1 specifies "#", ^%JSWRITE displays JS objects of the entire tree starting from the glvnode till the end of the glvn. </p></li>
<li class="listitem"><p>If expr1 specifies "*", ^%JSWRITE displays JS objects for all nodes descending from the specified glvn node.</p></li>
<li class="listitem"><p>Specifying "*" and "#" together produces an ILLEGALEXPR2 error.</p></li>
<li class="listitem"><p>Specifying [expr1], that is, with a leading "["and trailing "]", ^%JSWRITE displays the JSON objects in an array collection. Without [], you need to transform the object strings to the desired destination object format.</p></li>
<li class="listitem"><p>If expr2 specifies "noglvname", ^%JSWRITE excludes the first key containing the name of the glvn root from the JS object output.</p></li>
<li class="listitem"><p>The default $ETRAP for %JSWRITE is <code class="code">if (""=$etrap) new $etrap set $etrap="do errorobj"_"^"_$text(+0),$zstatus=""</code>. To override the default error handler, set $ETRAP to any non-empty value.</p></li>
<li class="listitem"><p>GT.M is not a JavaScript runtime environment. Therefore, we recommend parsing all output of ^%JSWRITE either using a JSON parser such as JSON.parse() in an appropriate JavaScript run-time environment, a web server via setting its response header to <code class="code">'Content-Type:application/json'</code>, or an application where JSON parsing is available. </p></li>
<li class="listitem"><p>When appropriate, enclose invocations of ^%JSWRITE in a TSTART/COMMIT boundary to prevent any blurred copy of data that is actively updated. </p></li>
<li class="listitem"><p>When appropriate, use GT.M alias containers to take appropriate local variables temporarily out of scope and then run the argumentless form of ^%JSWRITE. </p></li>
</ul></div>
<p>Examples:</p>
<pre class="programlisting"># Demo lv
<span class="bold"><strong>GTM&gt;zwrite demodevtest</strong></span>
demodevtest("Developer1","Token1","testSetup")="runtest holt maintest cpipe"
demodevtest("Developer1","Token1","testSetup","65401,11987")=1
demodevtest("Developer1","Token1","testSetup","holt","t")="mtest"
demodevtest("Developer1","Token1","testSetup","holt","t","SendReport",65401,12073)=1
demodevtest("Developer1","Token1","testSetup","holt","t","cpipe",65401,12025)=0
demodevtest("Developer1","Token2","testSetup")="runtest holt maintest tconv"
demodevtest("Developer1","Token2","testSetup","holt","65401,21987")=1
demodevtest("Developer1","Token2","testSetup","holt","t")="mtest"
demodevtest("Developer1","Token2","testSetup","holt","t","SendReport",65401,22073)=1
demodevtest("Developer1","Token2","testSetup","holt","t","tconv",65401,22025)=0
demodevtest("Developer2","Token3","testSetup")="runtest holt maintest tconv"
demodevtest("Developer2","Token3","testSetup","holt","65401,21987")=1
demodevtest("Developer2","Token3","testSetup","holt","t")="mtest"
demodevtest("Developer2","Token3","testSetup","holt","t","SendReport",65401,22073)=1
demodevtest("Developer2","Token3","testSetup","holt","t","tconv",65401,22025)=0
demodevtest("Developer3","Token4","testSetup")="runtest holt maintest tconv"
demodevtest("Developer3","Token4","testSetup","holt","65401,31987")=1
demodevtest("Developer3","Token4","testSetup","holt","t")="mtest"
demodevtest("Developer3","Token4","testSetup","holt","t","SendReport",65401,32073)=1
demodevtest("Developer3","Token4","testSetup","holt","t","tconv",65401,32025)=0
    
<span class="bold"><strong>GTM&gt;set glvn="demodevtest(""Developer2"")" </strong></span>
    
<span class="bold"><strong>GTM&gt;do ^%JSWRITE(glvn,"*") ; JS Object Strings: All descendants of demodevtest("Developer2")</strong></span> 
{"demodevtest":{"Developer2":{"Token3":{"testSetup":"runtest holt maintest tconv"}}}}
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"65401,21987":1}}}}}}
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"t":"mtest"}}}}}}
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"t":{"SendReport":{"65401":{"22073":1}}}}}}}}}
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"t":{"tconv":{"65401":{"22025":0}}}}}}}}}
    
<span class="bold"><strong>GTM&gt;do ^%JSWRITE(glvn,"[*]") ; Array: All descendants of demodevtest("Developer2")</strong></span> 
[{"demodevtest":{"Developer2":{"Token3":{"testSetup":"runtest holt maintest tconv"}}}},
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"65401,21987":1}}}}}},
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"t":"mtest"}}}}}},
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"t":{"SendReport":{"65401":{"22073":1}}}}}}}}},
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"t":{"tconv":{"65401":{"22025":0}}}}}}}}}]
    
<span class="bold"><strong>GTM&gt; do ^%JSWRITE(glvn,"#") ; JS Object Strings: All descendants of demodevtest starting from demodevtest("Developer2")</strong></span> 
{"demodevtest":{"Developer2":{"Token3":{"testSetup":"runtest holt maintest tconv"}}}}
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"65401,21987":1}}}}}}
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"t":"mtest"}}}}}}
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"t":{"SendReport":{"65401":{"22073":1}}}}}}}}}
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"t":{"tconv":{"65401":{"22025":0}}}}}}}}}
{"demodevtest":{"Developer3":{"Token4":{"testSetup":"runtest holt maintest tconv"}}}}
{"demodevtest":{"Developer3":{"Token4":{"testSetup":{"holt":{"65401,31987":1}}}}}}
{"demodevtest":{"Developer3":{"Token4":{"testSetup":{"holt":{"t":"mtest"}}}}}}
{"demodevtest":{"Developer3":{"Token4":{"testSetup":{"holt":{"t":{"SendReport":{"65401":{"32073":1}}}}}}}}}
{"demodevtest":{"Developer3":{"Token4":{"testSetup":{"holt":{"t":{"tconv":{"65401":{"32025":0}}}}}}}}}
    
<span class="bold"><strong>GTM&gt;do ^%JSWRITE(glvn,"[#]") ; Array: All descendants of demodevtest starting from demodevtest("Developer2")</strong></span> 
[{"demodevtest":{"Developer2":{"Token3":{"testSetup":"runtest holt maintest tconv"}}}},
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"65401,21987":1}}}}}},
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"t":"mtest"}}}}}},
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"t":{"SendReport":{"65401":{"22073":1}}}}}}}}},
{"demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"t":{"tconv":{"65401":{"22025":0}}}}}}}}},
{"demodevtest":{"Developer3":{"Token4":{"testSetup":"runtest holt maintest tconv"}}}},
{"demodevtest":{"Developer3":{"Token4":{"testSetup":{"holt":{"65401,31987":1}}}}}},
{"demodevtest":{"Developer3":{"Token4":{"testSetup":{"holt":{"t":"mtest"}}}}}},
{"demodevtest":{"Developer3":{"Token4":{"testSetup":{"holt":{"t":{"SendReport":{"65401":{"32073":1}}}}}}}}},
{"demodevtest":{"Developer3":{"Token4":{"testSetup":{"holt":{"t":{"tconv":{"65401":{"32025":0}}}}}}}}}]
    
<span class="bold"><strong>$ $gtm_dist/mumps -r %XCMD 'ZWRITE ^demodevtest' | $gtm_dist/mumps -r STDIN^%JSWRITE</strong></span>
[{"^demodevtest":{"Developer1":{"Token1":{"testSetup":"runtest holt maintest cpipe"}}}},
{"^demodevtest":{"Developer1":{"Token1":{"testSetup":{"65401,11987":1}}}}},
{"^demodevtest":{"Developer1":{"Token1":{"testSetup":{"holt":{"t":"mtest"}}}}}},
{"^demodevtest":{"Developer1":{"Token1":{"testSetup":{"holt":{"t":{"SendReport":{"65401":{"12073":1}}}}}}}}},
{"^demodevtest":{"Developer1":{"Token1":{"testSetup":{"holt":{"t":{"cpipe":{"65401":{"12025":0}}}}}}}}},
{"^demodevtest":{"Developer1":{"Token2":{"testSetup":"runtest holt maintest tconv"}}}},
{"^demodevtest":{"Developer1":{"Token2":{"testSetup":{"holt":{"65401,21987":1}}}}}},
{"^demodevtest":{"Developer1":{"Token2":{"testSetup":{"holt":{"t":"mtest"}}}}}},
{"^demodevtest":{"Developer1":{"Token2":{"testSetup":{"holt":{"t":{"SendReport":{"65401":{"22073":1}}}}}}}}},
{"^demodevtest":{"Developer1":{"Token2":{"testSetup":{"holt":{"t":{"tconv":{"65401":{"22025":0}}}}}}}}},
{"^demodevtest":{"Developer2":{"Token3":{"testSetup":"runtest holt maintest tconv"}}}},
{"^demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"65401,21987":1}}}}}},
{"^demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"t":"mtest"}}}}}},
{"^demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"t":{"SendReport":{"65401":{"22073":1}}}}}}}}},
{"^demodevtest":{"Developer2":{"Token3":{"testSetup":{"holt":{"t":{"tconv":{"65401":{"22025":0}}}}}}}}},
{"^demodevtest":{"Developer3":{"Token4":{"testSetup":"runtest holt maintest tconv"}}}},
{"^demodevtest":{"Developer3":{"Token4":{"testSetup":{"holt":{"65401,31987":1}}}}}},
{"^demodevtest":{"Developer3":{"Token4":{"testSetup":{"holt":{"t":"mtest"}}}}}},
{"^demodevtest":{"Developer3":{"Token4":{"testSetup":{"holt":{"t":{"SendReport":{"65401":{"32073":1}}}}}}}}},
{"^demodevtest":{"Developer3":{"Token4":{"testSetup":{"holt":{"t":{"tconv":{"65401":{"32025":0}}}}}}}}}]</pre>
<p>
    <span class="bold"><strong>Utility Label:</strong></span>
  </p>
<p>
    <code class="code">STDIN^%JSWRITE [singlesub]</code>
  </p>
<p>With the STDIN, the %JSWRITE utility routine expects a valid SET @ argument (like the one from the ZWRITE command) as its standard input over a named/unnamed pipe device and returns an array of objects. This construct ensures that $ZUSEDSTOR remains consistently low even for processing large data for conversion. STDIN^%JSWRITE automatically terminates the process with a non-zero exit status when it does not receive a READ terminator for 120 seconds from standard input. </p>
<p>When "singlesub" is specified as an argument, ^%JSWRITE expects ZWRITE lines for single subscript glvns. Here ^%JSWRITE implicitly removes the unsubscripted glvn name and returns an array collection of objects in the form of <code class="code">[{"key1":value,"key2":value,...},{"key1":value,"key2":value,...}]</code> where:</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p><code class="code">key1</code> is the subscript </p></li>
<li class="listitem"><p><code class="code">value</code> is the right side of the =.</p></li>
</ul></div>
<p>The subscript first received by STDIN^%JSWRITE singlesub denotes the start of the object. When ^%JSWRITE finds the same subscript, it ends the current object boundary and starts the boundary of a new object.  </p>
<p>Example:</p>
<pre class="programlisting">$ <span class="bold"><strong>$gtm_dist/mumps -r ^RTN</strong></span>
abc("firstname")="John"
abc("lastname")="Doe"
abc("firstname")="Jane"
abc("lastname")="Doe"
  
$ <span class="bold"><strong>$gtm_dist/mumps -r ^RTN | $gtm_dist/mumps -r STDIN^%JSWRITE singlesub</strong></span>
[{"firstname":"John","lastname":"Doe"},
{"firstname":"Jane","lastname":"Doe"}]</pre>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="npmpackagejswrite"></a>The fis-gtm-jswrite.tar.gz npm package </h4></div></div></div>
<div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="aboutnpmjswrite"></a>Overview</h5></div></div></div>
<p>fis-gtm-jswrite.tar.gz is an npm package containing four ^%JSWRITE reference implementations and three examples for the ^%JSWRITE utility routine. It also includes a utility class called <a class="link" href="ch10s03.html#jswritejs" title="JSWRITE Utility Class">JSWRITE.js</a> to help process the output of the ^%JSWRITE utility routine for use in a JavaScript runtime environment and convert JavaScript objects to SET @ arguments.</p>
<p>The fis-gtm-jswrite.tar.gz package is available only for supported GT.M customers from the FIS Client Portal (<a class="ulink" href="https://my.fisglobal.com/products/gtm" target="_top">https://my.fisglobal.com/products/gtm</a>). Being a supported GT.M customer entitles you to receive package patches and upgrades under the terms of your support agreement. Note that the license for the fis-gtm-jswrite.tar.gz does not permit redistribution. You may use the fis-gtm-jswrite.tar.gz package as-is or modify as appropriate to suit your needs. In both the cases, you must adequately test the reference implementations and the utility class before using them in a production environment. Please contact <a class="ulink" href="mailto:gtmsupport@fisglobal.com" target="_top">gtmsupport@fisglobal.com</a> or your support channel for more information on obtaining this package.</p>
<p>The ^%JSWRITE reference implementations are:</p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem"><p><a class="ulink" href="ch10s03.html#jnlmonitor" target="_top">Dynamic Journal File Progress Bar</a>: GTMJSJNLCHAIN.m/gtmjsjnlchain.js</p></li>
<li class="listitem"><p><a class="ulink" href="ch10s03.html#dgblbuffer" target="_top">Global Buffers Dashboard</a>: GTMJSACCESSBG.m/gtmjsaccessbg.js</p></li>
<li class="listitem"><p><a class="ulink" href="ch10s03.html#jnlfilechainjs" target="_top">Journal File Chain Report</a>: GTMJSJNLCHAIN.m/gtmjsdbjnl.js</p></li>
<li class="listitem"><p><a class="ulink" href="ch10s03.html#ygblstatsjswrite" target="_top">%YGBLSTATS Sparkline Chart</a> and <a class="ulink" href="ch10s03.html#gvstatstoexcel" target="_top">%YGBLSTATS to JSON</a>: GTMJSGVSTATS.m/gtmjsgvstats.js</p></li>
</ol></div>
<p>The examples are:</p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem"><p>gtmjstree.js (renders ^sampletree in the form of a tree) </p></li>
<li class="listitem"><p>gtmjs-sql1.js (a simple example) </p></li>
<li class="listitem"><p>gtmjs-sql2.js (a simple example)</p></li>
<li class="listitem"><p>gtmjs-to-gtm.js (example of JSWRITE.js helper class)</p></li>
</ol></div>
</div>
<div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="Installation_npmjswrite"></a>Installation</h5></div></div></div>
<p>
    <span class="bold"><strong>Step 1: Install node.js and npm</strong></span>
  </p>
<pre class="programlisting">curl -sL https://deb.nodesource.com/setup_13.x | sudo -E bash -
sudo apt-get install -y nodejs
curl -L https://www.npmjs.com/install.sh | sh</pre>
<p>
    <span class="bold"><strong>Step 2: Install the fis-gtm-jswrite npm package</strong></span>
  </p>
<pre class="programlisting">cd $project_dir
npm install /path/to/fis-gtm-jswrite.tar.gz # This command installs the @fis-gtm/jswrite package and the relevant %JSWRITE reference implementation dependencies. 
npm audit --fix</pre>
<p>
    <span class="bold"><strong>Step 3: Run the %JSWRITE reference implementations</strong></span>
  </p>
<pre class="programlisting"># The following reference implementations use the "STDIN^%JSWRITE singlesub" entry point and require the gtmposix plugin.
export gtmroutines="node_modules/@fis-gtm/jswrite/reference_implementations $gtmroutines"      # include the reference_implementations directory in the search list
node node_modules/@fis-gtm/jswrite/reference_implementations/gtmjsjnlchain.js  # journal file chain status sheet  
node node_modules/@fis-gtm/jswrite/reference_implementations/gtmjsaccessbg.js  # %dirty buffer dashboard 
node node_modules/@fis-gtm/jswrite/reference_implementations/gtmjsdbjnl.js     # displays the size of the database and journal files 
# Set the environment variable LC_ALL to a UTF8 locale (needed for the %JSWRITE Sparkline Chart (GTMJSGVSTATS.m/gtmjsgvstats.js) reference implementation)
node node_modules/@fis-gtm/jswrite/reference_implementations/gtmjsgvstats.js   # By default, this reference implementation displays a sparkline chart for SETs and GETs. For monitoring other statistics, open gtmjsgvstats.js and update the STAT array to include the list of statistics which require sparkline chart style monitoring.  
</pre>
<p>
    <span class="bold"><strong>Step 4: Run the examples</strong></span>
  </p>
<p>Create a sandbox environment for GT.M and run the following commands:</p>
<pre class="programlisting">$gtm_dist/mupip set -key_size=1019 -region "*"
$gtm_dist/mupip load node_modules/@fis-gtm/jswrite/examples/sample.zwr
$gtm_dist/mupip load node_modules/@fis-gtm/jswrite/examples/sampletree.zwr
export "gtmroutines=node_modules/@fis-gtm/jswrite/examples/ $gtmroutines"
 
# The following example uses the do ^%JSWRITE("^sample","[*]") entry point. This uses the lodash library to merge the nodes coming from %JSWRITE. 
npm install lodash@latest
node node_modules/@fis-gtm/jswrite/examples/gtmjstree.js     # loads sample.zwr in the tree format
# The following two examples use the STDIN^%JSWRITE entry point of the %JSWRITE utility routine and then use the getter methods of the JSWRITE.js helper class to create the SQL queries. 
npm install alasql@latest
node node_modules/@fis-gtm/jswrite/examples/gtmjs-sql1.js
npm install sqlite3@latest
node node_modules/@fis-gtm/jswrite/examples/gtmjs-sql2.js
# The following example uses the @fis-gtm/jswrite helper class (JSWRITE.js) to send data back to GT.M in SET @ argument form using shelljs.
npm install shelljs@latest
node node_modules/@fis-gtm/jswrite/examples/gtmjs-to-gtm.js</pre>
</div>
<div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="jnlmonitor"></a>Dynamic Journal File Progress Bar</h5></div></div></div>
<p>The dynamic journal file progress bar displays the size progress of a journal file till it reaches the autoswitch limit. It also displays an estimation of time and speed at which a journal file reaches its autoswitch limit. This can be use for benchmarking purposes or as a tool for GT.M performance tuning. </p>
<p>This %JSWRITE reference implementation uses the STDIN^%JSWRITE singlesub entrypoint of the %JSWRITE utility routine. </p>
<p>
      <span class="bold"><strong>Example:</strong></span>
    </p>
<pre class="programlisting">$ node node_modules/@fis-gtm/jswrite/reference_implementations/gtmjsjnlprogress.js
Press &lt;Ctrl&gt; + c to terminate. refreshInterval is 3 seconds
DEFAULT [===-------------------------------------] 7% | Size: 303.7 MiB | Autoswitch: 4095 MiB | ETA: 5m40s | Speed: 15.233 MiB/s
REGIONA [=========-------------------------------] 21% | Size: 876 MiB | Autoswitch: 4095 MiB | ETA: 5m15s | Speed: 14 MiB/s
REGIONB [=========-------------------------------] 23% | Size: 962 MiB | Autoswitch: 4095 MiB | ETA: 4m40s | Speed: 15 MiB/s
REGIONC [=========-------------------------------] 21% | Size: 876.12 MiB | Autoswitch: 4095 MiB | ETA: 5m15s | Speed: 14.04 MiB/s</pre>
<p>This %JSWRITE reference implementation monitors the size of the journal files and displays an estimate of time and speed for reaching the autoswitch limit. </p>
</div>
<div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="jnlfilechainjs"></a>Journal File Chain Report</h5></div></div></div>
<p>The journal file chain report display the journal file chain starting from the current journal file for reach region. This reference implementation also displays the "out-of-chain" journal files, that is, those journal files which are broken and do not participate in journal recovery in normal circumstances. These out-of-chain journal files can be removed at the discretion of the GT.M database administrator to make space available. </p>
<p>This %JSWRITE reference implementation uses the STDIN^%JSWRITE singlesub entrypoint of the %JSWRITE utility routine. </p>
<p>
      <span class="bold"><strong>Example:</strong></span>
    </p>
<pre class="programlisting">$ node node_modules/@fis-gtm/jswrite/reference_implementations/gtmjsjnlchain.js
# Journal File Chain Report
| Region     | Journal File                          | Size (MiB) | Switch Date          | Back link                    | Chain status |
| :--------- | :------------------------------------ | ---------: | :------------------- | :--------------------------- | ------------ |
| GTMWIZARDS | /path/to/gtmwizards.mjl               |       0.07 | current              | gtmwizards.mjl_2020063121042 | In chain     |
| GTMWIZARDS | /path/to/gtmwizards.mjl_2020063121042 |       0.07 | 03-MAR-2020 12:10:42 | gtmwizards.mjl_2020063121035 | In chain     |
| GTMWIZARDS | /path/to/gtmwizards.mjl_2020063121035 |       0.07 | 03-MAR-2020 12:10:35 | -                            | In chain     |
| REGIONA    | /path/to/regiona.mjl                  |       0.07 | current              | regiona.mjl_2020063121042    | In chain     |
| REGIONA    | /path/to/regiona.mjl_2020063121042    |       0.07 | 03-MAR-2020 12:10:42 | regiona.mjl_2020063121035    | In chain     |
| REGIONA    | /path/to/regiona.mjl_2020063121035    |       0.07 | 03-MAR-2020 12:10:35 | -                            | In chain     |
| REGIONB    | /path/to/regionb.mjl                  |       0.07 | current              | regionb.mjl_2020063121042    | In chain     |
| REGIONB    | /path/to/regionb.mjl_2020063121042    |       0.07 | 03-MAR-2020 12:10:42 | regionb.mjl_2020063121035    | In chain     |
| REGIONB    | /path/to/regionb.mjl_2020063121035    |       0.07 | 03-MAR-2020 12:10:35 | -                            | In chain     |
| REGIONC    | /path/to/regionc.mjl                  |       0.07 | current              | regionc.mjl_2020063121042    | In chain     |
| REGIONC    | /path/to/regionc.mjl_2020063121042    |       0.07 | 03-MAR-2020 12:10:42 | regionc.mjl_2020063121035    | In chain     |
| REGIONC    | /path/to/regionc.mjl_2020063121035    |       0.07 | 03-MAR-2020 12:10:35 | -                            | In chain     |
| N/A        | /path/to/gtmwizards.mjl_2020063120753 |       0.07 | 03-MAR-2020 12:07:53 | -                            | Out of chain |
| N/A        | /path/to/gtmwizards.mjl_2020063120800 |       0.07 | 03-MAR-2020 12:08:00 | -                            | Out of chain |
| N/A        | /path/to/gtmwizards.mjl_2020063120801 |       0.07 | 03-MAR-2020 12:08:01 | gtmwizards.mjl_2020063120800 | Out of chain |
| N/A        | /path/to/gtmwizards.mjl_2020063120812 |       0.07 | 03-MAR-2020 12:08:12 | gtmwizards.mjl_2020063120801 | Out of chain |
| N/A        | /path/to/gtmwizards.mjl_2020063120822 |       0.07 | 03-MAR-2020 12:08:22 | gtmwizards.mjl_2020063120812 | Out of chain |
| N/A        | /path/to/gtmwizards.mjl_2020063121026 |       0.07 | 03-MAR-2020 12:10:26 | gtmwizards.mjl_2020063120822 | Out of chain |
| N/A        | /path/to/regiona.mjl_2020063120753    |       0.07 | 03-MAR-2020 12:07:53 | -                            | Out of chain |
| N/A        | /path/to/regiona.mjl_2020063120800    |       0.07 | 03-MAR-2020 12:08:00 | -                            | Out of chain |
| N/A        | /path/to/regiona.mjl_2020063120801    |       0.07 | 03-MAR-2020 12:08:01 | regiona.mjl_2020063120800    | Out of chain |
| N/A        | /path/to/regiona.mjl_2020063120812    |       0.07 | 03-MAR-2020 12:08:12 | regiona.mjl_2020063120801    | Out of chain |
| N/A        | /path/to/regiona.mjl_2020063120822    |       0.07 | 03-MAR-2020 12:08:22 | regiona.mjl_2020063120812    | Out of chain |
| N/A        | /path/to/regiona.mjl_2020063121026    |       0.07 | 03-MAR-2020 12:10:26 | regiona.mjl_2020063120822    | Out of chain |
| N/A        | /path/to/regionb.mjl_2020063120753    |       0.07 | 03-MAR-2020 12:07:53 | -                            | Out of chain |
| N/A        | /path/to/regionb.mjl_2020063120800    |       0.07 | 03-MAR-2020 12:08:00 | -                            | Out of chain |
| N/A        | /path/to/regionb.mjl_2020063120801    |       0.07 | 03-MAR-2020 12:08:01 | regionb.mjl_2020063120800    | Out of chain |
| N/A        | /path/to/regionb.mjl_2020063120812    |       0.07 | 03-MAR-2020 12:08:12 | regionb.mjl_2020063120801    | Out of chain |
| N/A        | /path/to/regionb.mjl_2020063120822    |       0.07 | 03-MAR-2020 12:08:22 | regionb.mjl_2020063120812    | Out of chain |
| N/A        | /path/to/regionb.mjl_2020063121026    |       0.07 | 03-MAR-2020 12:10:26 | regionb.mjl_2020063120822    | Out of chain |
| N/A        | /path/to/regionc.mjl_2020063120753    |       0.07 | 03-MAR-2020 12:07:53 | -                            | Out of chain |
| N/A        | /path/to/regionc.mjl_2020063120800    |       0.07 | 03-MAR-2020 12:08:00 | -                            | Out of chain |
| N/A        | /path/to/regionc.mjl_2020063120801    |       0.07 | 03-MAR-2020 12:08:01 | regionc.mjl_2020063120800    | Out of chain |
| N/A        | /path/to/regionc.mjl_2020063120812    |       0.07 | 03-MAR-2020 12:08:12 | regionc.mjl_2020063120801    | Out of chain |
| N/A        | /path/to/regionc.mjl_2020063120822    |       0.07 | 03-MAR-2020 12:08:22 | regionc.mjl_2020063120812    | Out of chain |
| N/A        | /path/to/regionc.mjl_2020063121026    |       0.07 | 03-MAR-2020 12:10:26 | regionc.mjl_2020063120822    | Out of chain |
# Out of chain journal files:
 /path/to/gtmwizards.mjl_2020063120753 /path/to/gtmwizards.mjl_2020063120800 /path/to/gtmwizards.mjl_2020063120801 /path/to/gtmwizards.mjl_2020063120812 /path/to/gtmwizards.mjl_2020063120822 /path/to/gtmwizards.mjl_2020063121026 /path/to/regiona.mjl_2020063120753 /path/to/regiona.mjl_2020063120800 /path/to/regiona.mjl_2020063120801 /path/to/regiona.mjl_2020063120812 /path/to/regiona.mjl_2020063120822 /path/to/regiona.mjl_2020063121026 /path/to/regionb.mjl_2020063120753 /path/to/regionb.mjl_2020063120800 /path/to/regionb.mjl_2020063120801 /path/to/regionb.mjl_2020063120812 /path/to/regionb.mjl_2020063120822 /path/to/regionb.mjl_2020063121026 /path/to/regionc.mjl_2020063120753 /path/to/regionc.mjl_2020063120800 /path/to/regionc.mjl_2020063120801 /path/to/regionc.mjl_2020063120812 /path/to/regionc.mjl_2020063120822 /path/to/regionc.mjl_2020063121026
# Out of chain total        : 1.68 MiB
# Summary
| Region     | Size Total (MiB) | Recoverability up to |
| ---------- | ---------------- | -------------------- |
| GTMWIZARDS | 0.21             | 03-MAR-2020 12:10:35 |
| REGIONA    | 0.21             | 03-MAR-2020 12:10:35 |
| REGIONB    | 0.21             | 03-MAR-2020 12:10:35 |
| REGIONC    | 0.21             | 03-MAR-2020 12:10:35 |</pre>
</div>
<div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="dgblbuffer"></a>Global Buffer Dashboard</h5></div></div></div>
<p>The %dirty global buffer dashboard displays the region-wise percentage of global buffers vs dirty global buffers in a bar graph and the number of global buffers in a table. A large number of global buffers implies a large number of dirty global buffers to be flushed at an epoch. This dashboard along with the dynamic journal file chain can be used to determine an appropriate epoch interval / tapering settings for the application and help troubleshoot I/O spikes and process hangs during high loads. </p>
<p>This %JSWRITE reference implementation uses the STDIN^%JSWRITE singlesub entrypoint of the %JSWRITE utility routine. </p>
<p>
      <span class="bold"><strong>Example:</strong></span>
    </p>
<pre class="programlisting">$ node node_modules/@fis-gtm/jswrite/reference_implementations/gtmjsaccessbg.js</pre>
</div>
<div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="ygblstatsjswrite"></a>^%YGBLSTAT Sparkline Charts</h5></div></div></div>
<p>%YGBLSTAT Sparkline shows region-wise sparkline charts for the specified collection of statistics. Typically, you would group statistics by their relevance, for example, TR0,TR1,TR2,TR3, and TR4 can be grouped together to visualize variations for TP Restarts in a condensed form. </p>
<p>This %JSWRITE reference implementation uses the STDIN^%JSWRITE singlesub entrypoint of the %JSWRITE utility routine. </p>
<p>
      <span class="bold"><strong>Example:</strong></span>
    </p>
<pre class="programlisting"># Set the environment variable LC_ALL to a UTF8 locale (needed for the %JSWRITE Sparkline Chart (GTMJSGVSTATS.m/gtmjsgvstats.js) reference implementation)
node node_modules/@fis-gtm/jswrite/reference_implementations/gtmjsgvstats.js   # By default, this reference implementation displays a sparkline chart for SETs and GETs. For monitoring other statistics, open gtmjsgvstats.js and update the STAT array to include the list of statistics which require sparkline chart style monitoring. </pre>
</div>
<div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="gvstatstoexcel"></a>^%YGBLSTAT to JSON</h5></div></div></div>
<p>GTMJSGVSTATS.m is routine used in the %YGBLSTAT sparkline chart reference implementation. You can use the same routine to create a JSON file which can be imported to spreadsheet software such as Excel. The following command creates gvstats.json which includes all statistics produced with the %YGBLSTAT utility for all regions which have opted for statistics sharing. </p>
<pre class="programlisting">$gtm_dist/mumps -r ^GTMJSGVSTATS | $gtm_dist/mumps -r STDIN^%JSWRITE singlesub &gt; /src/toExcel/gvstats.json</pre>
<p>You can also choose the statistics that you want in the JSON file with the following:</p>
<pre class="programlisting">$gtm_dist/mumps -r ^GTMJSGVSTATS TR0,TR1,TR2,TR3,TR4 | $gtm_dist/mumps -r STDIN^%JSWRITE singlesub &gt; /src/toExcel/gvstats.json</pre>
<p>You can import gvstats.json in Excel using the "Data-&gt;Get Data-&gt;From File-&gt;From JSON" option of Excel. </p>
<p>This %JSWRITE reference implementation uses the STDIN^%JSWRITE singlesub entrypoint of the %JSWRITE utility routine. </p>
</div>
<div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="jswritejs"></a>JSWRITE Utility Class</h5></div></div></div>
<p>JSWRITE.js is a utility class for managing objects created with the ^%JSWRITE utility routine of GT.M.  It helps with object mutation and cases when you need to round-trip data back to GT.M. The use of JSWRITE.js is optional and is provided as a convenience to JavaScript developers working on ^%JSWRITE utility routine. </p>
<p>The constructor of JSWRITE.js takes one argument which can be an array collection object from %JSWRITE(glvn,[#]|[*]), one object string %JSWRITE(glvn,#|*), or an empty object. After  instantiation, the object has the following getter function. </p>
<div class="sect5">
<div class="titlepage"><div><div><h6 class="title">
<a name="gettermethod"></a>Getter Method</h6></div></div></div>
<div class="informaltable"><table border="1" width="70%">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td>
                <p>
                  <span class="bold"><strong>getSubs</strong></span>
                </p>
              </td>
<td colspan="2">
                <p>Returns an array containing the unsubscripted GT.M glvname and their subscripts. The first element of the array is always the glvname.</p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <span class="bold"><strong>getValue</strong></span>
                </p>
              </td>
<td colspan="2">
                <p>Returns the value of the GT.M glvname. </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <span class="bold"><strong>getZWRLines</strong></span>
                </p>
              </td>
<td colspan="2">
                <p>Contains an array of ZWR lines with each element represents one valid argument for use with SET @ in GT.M.</p>
              </td>
</tr>
</tbody>
</table></div>
<p>For example, for following GT.M lv structure:</p>
<pre class="programlisting">GTM&gt;zwrite
A("One","Two","Three","Four")="Demo"
GTM&gt;do ^%JSWRITE("A","*")
{"A":{"One":{"Two":{"Three":{"Four":"Demo"}}}}}</pre>
<p>..instantiate an object as follows:</p>
<pre class="programlisting">&gt; var JSWRITE=require("@fis-gtm/jswrite")
&gt; JSObj=new JSWRITE({"A":{"One":{"Two":{"Three":{"Four":"Demo"}}}}})</pre>
<p>The getter functions return the following values: </p>
<div class="informaltable"><table border="1" width="70%">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td>
                <p>
                  <span class="bold"><strong>JSObj.getSubs</strong></span>
                </p>
              </td>
<td colspan="2">
                <p>
                  <code class="code">[ 'A', 'One', 'Two', 'Three', 'Four' ]</code>
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <span class="bold"><strong>JSObj.getValue</strong></span>
                </p>
              </td>
<td colspan="2">
                <p>
                  <code class="code">'Demo'</code>
                </p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <span class="bold"><strong>JSObj.getZWRLines</strong></span>
                </p>
              </td>
<td colspan="2">
                <p>
                  <code class="code">[ 'A("One","Two","Three","Four")="Demo"' ]</code>
                </p>
              </td>
</tr>
</tbody>
</table></div>
</div>
<div class="sect5">
<div class="titlepage"><div><div><h6 class="title">
<a name="othermethods"></a>Other Methods</h6></div></div></div>
<div class="informaltable"><table border="1" width="70%">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td>
                <p>
                  <span class="bold"><strong>toZWR(JSONobj)</strong></span>
                </p>
              </td>
<td colspan="2">
                <p>Attempts to traverse and convert the JSON paths and their values of JSONObj to a form that can be used with SET @. The argument must be an object. Specifying an array produces an error.  Invoking the .toZWR(JSONObj) method appends the getZWRLines array.</p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <span class="bold"><strong>customZWR(glvName, [subscripts], glvValue)</strong></span>
                </p>
              </td>
<td colspan="2">
                <p>Returns an array containing the unsubscripted GT.M glvname and their subscripts. The first element of the array is always the glvname.</p>
              </td>
</tr>
<tr>
<td>
                <p>
                  <span class="bold"><strong>validateJSON(str)</strong></span>
                </p>
              </td>
<td colspan="2">
                <p>Checks whether the string argument is a valid JSON object. If str is a valid JSON string, it returns the result of JSON.parse(str). </p>
              </td>
</tr>
</tbody>
</table></div>
</div>
<p>
      <span class="bold"><strong>Examples:</strong></span>
    </p>
<p>
      <code class="code">.toZWR() </code>
    </p>
<pre class="programlisting">&gt;var JSWRITE=require("@fis-gtm/jswrite")
undefined
&gt; JSObj=new JSWRITE({})
undefined
&gt; JSObj.toZWR({"A":{"A1":[1,2,{"C":"C3"},4]}})
undefined
&gt; JSObj.getZWRLines
[
  'A("A1","0")="1"',
  'A("A1","1")="2"',
  'A("A1","2","C")="C3"',
  'A("A1","3")="4"'
]
&gt;</pre>
<p>
      <code class="code">.customZWR()</code>
    </p>
<pre class="programlisting">
&gt; JSObj.customZWR("A",[1,2,3,4,5],"ABCD\n")
undefined
&gt; JSObj.getZWRLines
[ 'A(1,2,3,4,5)="ABCD"_$C(10)_""' ]</pre>
</div>
</div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="lcase_percent"></a>
      %LCASE<a class="indexterm" name="idm46578558561312"></a>
</h3></div></div></div>
<p>The %LCASE utility converts a string to all lower-case letters. If a routine uses this function repetitively, put the utility code directly into the M program.</p>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="utils_labels_lcase"></a>
      Utility Labels<a class="indexterm" name="idm46578558524224"></a>
</h4></div></div></div>
<p>INT: Converts interactively a string to lower-case.</p>
<p>FUNC(s): Invokes %LCASE as an extrinsic function returning the lower-case form of the argument.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="prompts_lcase"></a>
      Prompts<a class="indexterm" name="idm46578558526448"></a>
</h4></div></div></div>
<p>String: Requests a string for conversion to lower case.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="input_variables_lcase"></a>
      Input Variables<a class="indexterm" name="idm46578558602816"></a><a class="indexterm" name="idm46578558543296"></a>
</h4></div></div></div>
<p>%S: As input, contains string to be converted to lower case.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="output_vari_lcase"></a>
      Output Variables<a class="indexterm" name="idm46578558587840"></a>
</h4></div></div></div>
<p>%S: As output, contains the converted string in lower case.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="examples_of_lcase"></a>
      Examples of %LCASE<a class="indexterm" name="idm46578558543856"></a>
</h4></div></div></div>
<p>Example:</p>
<pre class="programlisting">GTM&gt;DO INT^%LCASE
String: LABEL
Lower: label</pre>
<p>This example invokes %LCASE in interactive mode using INT^%LCASE. %LCASE prompts for a string that it converts to all lower case.</p>
<p>Example:</p>
<pre class="programlisting">GTM&gt;SET %S="Hello"
GTM&gt;do ^%LCASE
GTM&gt;zwrite
%S="hello" </pre>
<p>This example sets the variable %S to the string "Hello" and invokes %LCASE non-interactively to convert the string.</p>
<p>Example:</p>
<pre class="programlisting">GTM&gt;SET ^X="Hello"
GTM&gt;WRITE $$FUNC^%LCASE(^X)
hello </pre>
<p>This example sets the variable ^X to the string "Hello" and invokes %LCASE as an extrinsic function that returns "hello" in lower case.</p>
</div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="percent_od"></a>
      %OD<a class="indexterm" name="idm46578558684080"></a>
</h3></div></div></div>
<p>The %OD utility converts numeric values from octal to decimal. %OD returns the decimal number in the read-write variable %OD. %OD rejects input numbers beginning with a minus (-) sign and returns null (""). The routine has entry points for interactive or non-interactive use.</p>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="util_labels_od"></a>
      Utility Labels<a class="indexterm" name="idm46578558578448"></a>
</h4></div></div></div>
<p>INT: Converts octal number entered interactively to decimal number.</p>
<p>FUNC(oct): Invokes %OD as an extrinsic function returning the decimal equivalent of the argument.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="prompts_od"></a>
      Prompts<a class="indexterm" name="idm46578558620976"></a>
</h4></div></div></div>
<p>Octal: Requests an octal number for conversion to decimal.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="input_varia_od"></a>
      Input Variables<a class="indexterm" name="idm46578558668208"></a>
</h4></div></div></div>
<p>%OD: As input, contains input octal number.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="output_varai_od"></a>
      Output Variables<a class="indexterm" name="idm46578558554640"></a>
</h4></div></div></div>
<p>%OD: As output, contains the converted number in decimal.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="examples_of_od"></a>
      Examples of %OD<a class="indexterm" name="idm46578558603792"></a>
</h4></div></div></div>
<p>Example:</p>
<pre class="programlisting">GTM&gt;DO INT^%OD
Octal:14
GTM&gt;ZWRITE
%OD=12</pre>
<p>This example invokes INT^%OD to interactively convert the octal number entered. %OD prompts for an octal number that it converts to a decimal. %OD returns the converted value in the variable %OD.</p>
<p>Example:</p>
<pre class="programlisting">GTM&gt;SET %OD=14
GTM&gt;DO ^%OD
GTM&gt;ZWRITE
%OD=12</pre>
<p>This example sets the read-write variable %OD to 14 and invokes %OD to convert the number non-interactively. ZWRITE displays the contents of the variables.</p>
<p>Example:</p>
<pre class="programlisting">GTM&gt;WRITE $$FUNC^%OD(14)
12</pre>
<p>This example invokes %OD as an extrinsic function with the FUNC label. The argument specifies the number to be converted.</p>
</div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="percent_oh"></a>
      %OH<a class="indexterm" name="idm46578558561952"></a>
</h3></div></div></div>
<p>The %OH utility converts numeric values from octal to hexadecimal. %OH returns the hexadecimal number in the read-write variable %OH. %OH rejects input numbers beginning with a minus (-) sign. The routine has entry points for interactive or non-interactive use. In interactive mode, %OH rejects non-octal numbers with the following message, "Input must be an octal number". In non-interactive mode, %OH returns a null string ("") upon encountering a non-octal number.</p>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="util_labels_oh"></a>
      Utility Labels<a class="indexterm" name="idm46578558737296"></a>
</h4></div></div></div>
<p>INT: Converts interactively octal number entered to hexadecimal number.</p>
<p>FUNC(oct): Invokes %OH as an extrinsic function returning the hexadecimal equivalent of the argument.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="prompts_oh"></a>
      Prompts<a class="indexterm" name="idm46578558548320"></a>
</h4></div></div></div>
<p>Octal:Requests an octal number for conversion to hexadecimal.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="input_variables_oh"></a>
      Input Variables<a class="indexterm" name="idm46578558592960"></a>
</h4></div></div></div>
<p>%OH: As input, contains input octal number.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="output_vari_oh"></a>
      Output Variables<a class="indexterm" name="idm46578558546784"></a>
</h4></div></div></div>
<p>%OH: As output, contains the converted number in hexadecimal.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="examples_of_oh"></a>
      Examples of %OH<a class="indexterm" name="idm46578558589984"></a>
</h4></div></div></div>
<p>Example:</p>
<pre class="programlisting">GTM&gt;DO INT^%OH
Octal:16
GTM&gt;ZWRITE
%OH="E"</pre>
<p>This example invokes %OH in interactive mode using INT^%OH. %OH prompts for an octal number that it converts to a hexadecimal number. ZWRITE displays the contents of the variable.</p>
<p>Example:</p>
<pre class="programlisting">GTM&gt;SET %OH=16
GTM&gt;DO ^%OH
GTM&gt;ZWRITE
%OH="E" </pre>
<p>This example sets the read-write variable %OH to 16 and invokes %OH to convert the value of %OH non-interactively. ZWRITE displays the contents of the variable.</p>
<p>Example:</p>
<pre class="programlisting">GTM&gt;WRITE $$FUNC^%OH(16)
E</pre>
<p>This example invokes %OH as an extrinsic function with the FUNC label.</p>
</div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="ucase"></a>
      %UCASE<a class="indexterm" name="idm46578558546272"></a>
</h3></div></div></div>
<p>The %UCASE utility converts a string to all upper-case letters. If a routine uses this function repetitively, put the utility code directly into the M program.</p>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="util_labels_ucase"></a>
      Utility Labels<a class="indexterm" name="idm46578558507696"></a>
</h4></div></div></div>
<p>INT: Converts a string to upper case interactively.</p>
<p>FUNC(s): Invokes %UCASE as an extrinsic function, returning the upper-case form of the argument.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="prompts_ucase"></a>
      Prompts<a class="indexterm" name="idm46578558579824"></a>
</h4></div></div></div>
<p>String: Requests a string for conversion to upper case.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="input_variab_ucase"></a>
      Input Variables<a class="indexterm" name="idm46578558586224"></a>
</h4></div></div></div>
<p>%S: As input, contains string to be converted to upper case.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="output_var_ucase"></a>
      Output Variables<a class="indexterm" name="idm46578558515440"></a>
</h4></div></div></div>
<p>%S: As output, contains the converted string in upper case.</p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="examples_of_ucase"></a>
      Examples of %UCASE<a class="indexterm" name="idm46578558602096"></a>
</h4></div></div></div>
<p>Example:</p>
<pre class="programlisting">GTM&gt;DO INT^%UCASE
String: test
Upper: TEST</pre>
<p>This example invokes %UCASE in interactive mode using INT^%UCASE. %UCASE prompts for a string that it converts to all upper case.</p>
<p>Example:</p>
<pre class="programlisting">GTM&gt;SET ^X="hello"
GTM&gt;WRITE $$FUNC^%UCASE(^X)
HELLO</pre>
<p>This example sets the variable X to the string "hello" and invokes %UCASE as an extrinsic function that returns "HELLO" in upper case.</p>
</div>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch10s02.html">Prev</a> </td>
<td width="20%" align="center"><a accesskey="u" href="ch10.html">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="ch10s04.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">
      Date and Time Utilities </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> 
      Mathematic Utilities</td>
</tr>
</table>
</div>
</body>
</html>
