<html>
<HEAD><META HTTP-EQUIV="Pragma" CONTENT="no-cache"><META HTTP-EQUIV="Expires" CONTENT="-1">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Chapter 11. Maintaining Database Integrity</title>
<link rel="stylesheet" href="gtm.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.75.2">
<link rel="home" href="index.html" title="GT.M Administration and Operations Guide">
<link rel="up" href="index.html" title="GT.M Administration and Operations Guide">
<link rel="prev" href="ch10s03.html" title="DSE Command Summary">
<link rel="next" href="ch11s01.html" title="Verifying Database Integrity">
<link rel="copyright" href="ln-idm45318689877376.html" title="Legal Notice">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">Chapter 11. Maintaining Database Integrity</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="ch10s03.html">Prev</a> </td>
<th width="60%" align="center"> </th>
<td width="20%" align="right"> <a accesskey="n" href="ch11s01.html">Next</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">GT.M Administration and Operations Guide</a></span> &gt; <span class="breadcrumb-node">Maintaining Database Integrity</span>
</div>
<div class="chapter">
<div class="titlepage"><div>
<div><h2 class="title">
<a name="chk_maint_db_integrity"></a>Chapter 11. Maintaining Database Integrity</h2></div>
<div><div class="revhistory"><table border="1" width="100%" summary="Revision history">
<tr><th align="left" valign="top" colspan="3"><b>Revision History</b></th></tr>
<tr>
<td align="left">Revision V7.1-004</td>
<td align="left">27 June 2024</td>
<td align="left"><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In <a class="xref" href="ch11s04.html#i4_file_size_errors" title="I4&#8211;File Size Errors">&#8220;I4&#8211;File Size Errors&#8221;</a>, correct the formula for calculating TOTAL_BLKS</p></li></ul></div></td>
</tr>
<tr>
<td align="left">Revision V7.1-002</td>
<td align="left">19 September 2023</td>
<td align="left"><div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#MUPIP_INTEG_Error_Classification_Table" title="MUPIP INTEG Error Classification Table">&#8220;MUPIP INTEG Error Classification Table&#8221;</a>, document BSIZTOOLARGE informational integ message</p></li>
<li class="listitem"><p>In <a class="xref" href="ch10s03.html" title="DSE Command Summary">&#8220;<span>DSE Command </span>Summary&#8221;</a>, add new -DATA_RESERVED_BYTES and -INDEX_RESERVED_BYTES qualifiers to the dse command table</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html" title="Finding and Fixing Database Errors">&#8220;Finding and Fixing Database Errors&#8221;</a>, document -IMAXBLOCKSIZE and -DMAXBLOCKSIZE INTEG qualifiers</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#o6_block_size_error" title="O6&#8211;Block Size Errors">&#8220;O6&#8211;Block Size Errors&#8221;</a>, Document block-size informational message as a result of -IMAXBLOCKSIZE and -DMAXBLOCKSIZE</p></li>
</ul></div></td>
</tr>
<tr>
<td align="left">Revision V7.0-001</td>
<td align="left">24 November 2021</td>
<td align="left"><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In <a class="xref" href="ch10s03.html" title="DSE Command Summary">&#8220;<span>DSE Command </span>Summary&#8221;</a>, correct  Zqgblmod_T[rans]=sequence-number</p></li></ul></div></td>
</tr>
<tr>
<td align="left">Revision V7.0-000</td>
<td align="left">12 February 2021</td>
<td align="left"><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In <a class="xref" href="ch10s03.html" title="DSE Command Summary">&#8220;<span>DSE Command </span>Summary&#8221;</a>, correct the syntax of the -SIBLING qualifier</p></li></ul></div></td>
</tr>
<tr>
<td align="left">Revision V6.3-013</td>
<td align="left">30 June 2020</td>
<td align="left"><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In <a class="xref" href="ch10s03.html" title="DSE Command Summary">&#8220;<span>DSE Command </span>Summary&#8221;</a>, fix typo: change HARD_SPIN_CPUNT to HARD_SPIN_COUNT and formatting cleanup.</p></li></ul></div></td>
</tr>
<tr>
<td align="left">Revision V6.3-010</td>
<td align="left">31 October 2019</td>
<td align="left"><div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#MUPIP_INTEG_Error_Classification_Table" title="MUPIP INTEG Error Classification Table">&#8220;MUPIP INTEG Error Classification Table&#8221;</a>, add more explanation</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#Run-Time_Database_Restart_Code_Table" title="Run-Time Database Restart Codes">&#8220;Run-Time Database Restart Codes&#8221;</a>, fix section title</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#c1_possible_cache_control_problems" title="C1&#8211;Possible Cache Control Problems">&#8220;C1&#8211;Possible Cache Control Problems&#8221;</a>, add a link to section R3</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#can_be_deferred" title="Can Be Deferred">&#8220;Can Be Deferred&#8221;</a>, update MUPIP INTEG error messages table and give it its own section</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html" title="Finding and Fixing Database Errors">&#8220;Finding and Fixing Database Errors&#8221;</a>, separate mupip integ error table and restart code table into a separate sections</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#h1_process_hangs" title="H1&#8211;Process Hangs">&#8220;H1&#8211;Process Hangs&#8221;</a>, improve the instructions</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#h3_db_access_problems" title="H3&#8211;Database Access Problems">&#8220;H3&#8211;Database Access Problems&#8221;</a>, modify some instructions</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#h7_disk_hardware_problems" title="H7&#8211;Disk Hardware Problems">&#8220;H7&#8211;Disk Hardware Problems&#8221;</a>, remove inappropriate text</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#i1_mupip_integ_errors" title="I1&#8211;MUPIP INTEG Errors">&#8220;I1&#8211;MUPIP INTEG Errors&#8221;</a>, put table in a separate section</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#i3_file_header_errors" title="I3&#8211;File Header Errors">&#8220;I3&#8211;File Header Errors&#8221;</a>, add mupip dumpfhead as a reporter of freecnt</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#i5_more_db_access_problems" title="I5&#8211;More Database Access Problems">&#8220;I5&#8211;More Database Access Problems&#8221;</a>, remove inappropriate text</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#i5_star_key_prblms" title="K5&#8211;Star Key Problems">&#8220;K5&#8211;Star Key Problems&#8221;</a>, more accurate wording</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#i6_transient_errors" title="I6&#8211;Transient Errors">&#8220;I6&#8211;Transient Errors&#8221;</a>, add discussion of the role of startup procedures.</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#i7_db_rundown_prblm" title="I7&#8211;Database Rundown Problem">&#8220;I7&#8211;Database Rundown Problem&#8221;</a>, modify the description to reflect the use of appropriate startup.</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#k3_block_doubly_allocated" title="K3&#8211;Block Doubly Allocated">&#8220;K3&#8211;Block Doubly Allocated&#8221;</a>, improve wording</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#m1_bitmap_errors" title="M1&#8211;Bitmap Errors">&#8220;M1&#8211;Bitmap Errors&#8221;</a>, enhance wording of MAP -MASTER</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#o3_data_block_errors" title="O3&#8211;Data Block Errors">&#8220;O3&#8211;Data Block Errors&#8221;</a>, additional recommendations</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#o4_salvage" title="O4&#8211;Salvage of Data Blocks with Lost Indices">&#8220;O4&#8211;Salvage of Data Blocks with Lost Indices&#8221;</a>, adjust wording</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#p1_process_damage" title="P1&#8211;Process Damage">&#8220;P1&#8211;Process Damage&#8221;</a>, enhance wording</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#r2_structure_db_integ" title="R2&#8211;Structural Database Integrity Errors">&#8220;R2&#8211;Structural Database Integrity Errors&#8221;</a>, additions and adjustments</p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s03.html" title="Repairing the Database with DSE">&#8220;Repairing the Database with DSE&#8221;</a>, additional instructions</p></li>
</ul></div></td>
</tr>
<tr>
<td align="left">Revision V6.3-006</td>
<td align="left">26 October 2018</td>
<td align="left"><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In <a class="xref" href="ch11s04.html#p1_process_damage" title="P1&#8211;Process Damage">&#8220;P1&#8211;Process Damage&#8221;</a>, add clarification.</p></li></ul></div></td>
</tr>
<tr>
<td align="left">Revision V6.3-005</td>
<td align="left">03 July 2018</td>
<td align="left"><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In <a class="xref" href="ch11s04.html#r2_structure_db_integ" title="R2&#8211;Structural Database Integrity Errors">&#8220;R2&#8211;Structural Database Integrity Errors&#8221;</a>, revise wording for H</p></li></ul></div></td>
</tr>
<tr>
<td align="left">Revision V6.3-004</td>
<td align="left">23 March 2018</td>
<td align="left"><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>In <a class="xref" href="ch11s04.html#downloadsalvage" title="Download salvage.m">&#8220;Download salvage.m&#8221;</a>, add section on downloading salvage.m</p></li></ul></div></td>
</tr>
<tr>
<td align="left">Revision V6.3-001</td>
<td align="left">20 March 2017</td>
<td align="left"><div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>In <a class="xref" href="ch10s03.html" title="DSE Command Summary">&#8220;<span>DSE Command </span>Summary&#8221;</a>, added information about the -DUMP and -ALL qualifiers of ALL; add -ALL for DUMP. </p></li>
<li class="listitem"><p>In <a class="xref" href="ch11s04.html#h7_disk_hardware_problems" title="H7&#8211;Disk Hardware Problems">&#8220;H7&#8211;Disk Hardware Problems&#8221;</a>, replaced OpenVMS with OS.</p></li>
</ul></div></td>
</tr>
</table></div></div>
</div></div>
<div class="toc">
<p><b>Table of Contents</b></p>
<dl>
<dt><span class="sect1"><a href="ch11s01.html">Verifying Database Integrity</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="ch11s01.html#regular_scheduled_verfication">Regularly Scheduled Verification</a></span></dt>
<dt><span class="sect2"><a href="ch11s01.html#before_or_after_major_transfer">Before or After Major Transfers</a></span></dt>
<dt><span class="sect2"><a href="ch11s01.html#imm_after_catastrophic_events">Immediately after Catastrophic Events</a></span></dt>
<dt><span class="sect2"><a href="ch11s01.html#imm_after_run_time_errors">Immediately after Run-Time Database Errors </a></span></dt>
<dt><span class="sect2"><a href="ch11s01.html#imm_after_database_repair">Immediately After Database Repairs</a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="ch11s02.html">Approaches to Database Recovery</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="ch11s02.html#recover_frm_jrnls">Recover from Journals</a></span></dt>
<dt><span class="sect2"><a href="ch11s02.html#restore_frm_backup">Restore from Backup</a></span></dt>
<dt><span class="sect2"><a href="ch11s02.html#repair_with_dse">Repair with DSE</a></span></dt>
<dt><span class="sect2"><a href="ch11s02.html#preventive_maintenance">Preventive Maintenance</a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="ch11s03.html">Repairing the Database with DSE</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="ch11s03.html#using_the_proper_db_file">Using the Proper Database File</a></span></dt>
<dt><span class="sect2"><a href="ch11s03.html#locating_struc_with_dse">Locating Structures with DSE</a></span></dt>
<dt><span class="sect2"><a href="ch11s03.html#safety_in_repairs">Safety in Repairs</a></span></dt>
<dt><span class="sect2"><a href="ch11s03.html#discarding_data">Discarding Data</a></span></dt>
<dt><span class="sect2"><a href="ch11s03.html#concurrent_repairs">Concurrent Repairs</a></span></dt>
<dt><span class="sect2"><a href="ch11s03.html#terminate_processes">Terminating Processes</a></span></dt>
<dt><span class="sect2"><a href="ch11s03.html#rec_dam_spa">Recovering data from damaged binary extracts</a></span></dt>
</dl></dd>
<dt><span class="sect1"><a href="ch11s04.html">Finding and Fixing Database Errors</a></span></dt>
<dd><dl>
<dt><span class="sect2"><a href="ch11s04.html#c1_possible_cache_control_problems">C1&#8211;Possible Cache Control Problems</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#h1_process_hangs">H1&#8211;Process Hangs</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#h3_db_access_problems">H3&#8211;Database Access Problems</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#h4_database_cache_problms">H4&#8211;Database Cache Problems</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#h5_critical_section_problems">H5&#8211;Critical Section Problems</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#h6_Unix_problems">H6&#8211;UNIX Problems</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#h7_disk_hardware_problems">H7&#8211;Disk Hardware Problems</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#h8_application_problems">H8&#8211;Application Problems</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#i1_mupip_integ_errors">I1&#8211;MUPIP INTEG Errors</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#MUPIP_INTEG_Error_Classification_Table">MUPIP INTEG Error Classification Table</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#gtm_version_mismatch_chi2">I2&#8211;GT.M Version Mismatch</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#i3_file_header_errors">I3&#8211;File Header Errors</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#i4_file_size_errors">I4&#8211;File Size Errors</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#i5_more_db_access_problems">I5&#8211;More Database Access Problems</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#i6_transient_errors">I6&#8211;Transient Errors</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#i7_db_rundown_prblm">I7&#8211;Database Rundown Problem</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#i8_repair_induced_prblm">I8&#8211;Repair-Induced Problems</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#k1_bad_key">K1&#8211;Bad Key</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#k2_keys_misplaced">K2&#8211;Keys Misplaced</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#k3_block_doubly_allocated">K3&#8211;Block Doubly Allocated</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#k4_pointer_prbl">K4&#8211;Pointer Problems</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#i5_star_key_prblms">K5&#8211;Star Key Problems</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#k6_compression_count_error">K6&#8211;Compression Count Error</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#k7_key_warning">K7&#8211;Key Warning</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#m1_bitmap_errors">M1&#8211;Bitmap Errors</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#m2_bitmap_header_problms">M2&#8211;Bitmap Header Problems</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#O1_bad_block">O1&#8211;Bad Block</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#o2_record_errors">O2&#8211;Record Errors</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#o3_data_block_errors">O3&#8211;Data Block Errors</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#o4_salvage">O4&#8211;Salvage of Data Blocks with Lost Indices</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#sal_dam_spa">O5&#8211;Salvage of a damaged spanning node</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#o6_block_size_error">O6&#8211;Block Size Errors</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#p1_process_damage">P1&#8211;Process Damage</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#q1_restict_db_access">Q1&#8211;Restricting Database Access</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#r1_gtm_run_time_errors">R1&#8211;GT.M Run-Time Errors</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#r2_structure_db_integ">R2&#8211;Structural Database Integrity Errors</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#Run-Time_Database_Restart_Code_Table">Run-Time Database Restart Codes</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#r2_run_time_db_cache">R3&#8211;Run-time Database Cache Problems</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#r4_stopped_processes">R4&#8211;Stopped Processes</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#r5_no_more_room">R5&#8211;No More Room in the File</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#r6_gtmassert_and_gtmcheck_errors">R6&#8211;GTMASSERT and GTMCHECK Errors</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#r7_interlock_q">R7&#8211;Interlocked Queue Hardware Problems</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#r8_db_tree">R8&#8211;Database Tree Maximum Level Exceeded</a></span></dt>
<dt><span class="sect2"><a href="ch11s04.html#r9_read">R9&#8211;Read-only Process Blocked</a></span></dt>
</dl></dd>
</dl>
</div>
<p>This chapter discusses GT.M methods for maintaining data availability and
integrity.</p>
<p>A database that has GDS integrity may not be consistent from the application data
point of view. That is, certain types of failures that do not damage the GDS database
structures may cause logical transactions (consisting of multiple database updates
within an application) to stop in an "illogical" state with some, but not all, of the
updates in place. Transaction processing and database journaling are good methods for
maintaining application data consistency. For more information on transaction
processing, refer to the "General Language Features of M" and "Commands" chapters of the
<a class="ulink" href="../../pg/UNIX_manual/index.html" target="_top">GT.M Programmer's Guide</a>. For more information on journaling, refer to the "GT.M
Journaling" chapter of this manual.</p>
<p>Maintaining database integrity is integral to GT.M operation; you should seldom, if
ever, need the material in this chapter, especially if you use journaling. However,
databases can be corrupted by unusual events such as hardware failures, sudden loss of
power, operating system failure, or improper operator action. All such events should be
followed with database integrity checks.</p>
<p>The chapter describes the following:</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>Suggested times to use MUPIP INTEG for verifying database integrity</p></li>
<li class="listitem"><p>Recommended methods for handling database problems</p></li>
<li class="listitem"><p>General techniques and strategies for using DSE</p></li>
<li class="listitem"><p>Instructions for identifying and repairing errors with DSE</p></li>
</ul></div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch10s03.html">Prev</a> </td>
<td width="20%" align="center"> </td>
<td width="40%" align="right"> <a accesskey="n" href="ch11s01.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">
<span>DSE Command </span>Summary </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> Verifying Database Integrity</td>
</tr>
</table>
</div>
</body>
</html>
