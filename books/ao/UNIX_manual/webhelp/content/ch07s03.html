<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:exsl="http://exslt.org/common" xmlns:ng="http://docbook.org/docbook-ng" xmlns:db="http://docbook.org/ns/docbook"><head>
<meta http-equiv="X-UA-Compatible" content="IE=7"/>
<title>Procedures</title><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"/><link rel="home" href="index.html" title="GT.M Administration and Operations Guide"/><link rel="up" href="ch07.html" title="ChapterA 7.A Database Replication"/><link rel="prev" href="ch07s02.html" title="Implementing Replication and Recovery"/><link rel="next" href="replication.html" title="Commands and Qualifiers"/><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><script type="text/javascript">
            //The id for tree cookie
            var treeCookieId = "treeview-51683";
            var language = "en";
            var w = new Object();
            //Localization
            txt_filesfound = 'Results';
            txt_enter_at_least_1_char = "You must enter at least one character.";
            txt_browser_not_supported = "Your browser is not supported. Use of Mozilla Firefox is recommended.";
            txt_please_wait = "Please wait. Search in progress...";
            txt_results_for = "Results for: ";
        </script><style type="text/css">
            input {
            margin-bottom: 5px;
            margin-top: 2px;
            }

            .folder {
            display: block;
            height: 22px;
            padding-left: 20px;
            background: transparent url(../common/jquery/treeview/images/folder.gif) 0 0px no-repeat;
            }
            
        </style><link rel="shortcut icon" href="../favicon.ico" type="image/x-icon"/><link rel="stylesheet" type="text/css" href="../common/css/positioning.css"/><link rel="stylesheet" type="text/css" href="../common/jquery/theme-redmond/jquery-ui-1.8.2.custom.css"/><link rel="stylesheet" type="text/css" href="../common/jquery/treeview/jquery.treeview.css"/><script type="text/javascript" src="../common/jquery/jquery-1.4.2.min.js"><!----></script><script type="text/javascript" src="../common/jquery/jquery-ui-1.8.2.custom.min.js"><!----></script><script type="text/javascript" src="../common/jquery/jquery.cookie.js"><!----></script><script type="text/javascript" src="../common/jquery/treeview/jquery.treeview.min.js"><!----></script><script type="text/javascript" src="search/htmlFileList.js"><!----></script><script type="text/javascript" src="search/htmlFileInfoList.js"><!----></script><script type="text/javascript" src="search/nwSearchFnt.js"><!----></script><script type="text/javascript" src="search/stemmers/en_stemmer.js"><!--//make this scalable to other languages as well.--></script><script type="text/javascript" src="search/index-1.js"><!----></script><script type="text/javascript" src="search/index-2.js"><!----></script><script type="text/javascript" src="search/index-3.js"><!----></script></head><body><div id="header"><img style="margin-right: 2px; height: 59px; padding-right: 25px; padding-top: 8px" align="right" src="../common/images/logo.png" alt="Company Logo"/><h1 align="center">Procedures<br/>ChapterA 7.A Database Replication</h1><div id="navheader" align="right"><!----><table><tr><td style="height: 28px; width: 16px;"><a id="showHideButton" onclick="showHideToc();" class="pointLeft" title="Hide TOC tree">.
                            </a></td><td><img src="../common/images/highlight-blue.gif" alt="H" height="25px" onclick="toggleHighlight()" id="showHideHighlight" style="cursor:pointer" title="Toggle search result highlighting"/></td><td><a accesskey="p" href="ch07s02.html">Prev</a>
                                        |
                                        <a accesskey="u" href="ch07.html">Up</a>
                                    |
                                    <a accesskey="n" href="replication.html">Next</a></td></tr></table></div></div><div id="content"><!----><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="procedure"/>Procedures</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="downld_repl_ex"/>Download Replication Examples</h3></div></div></div><p><code class="code"><span class="bold"><strong>repl_procedures.tar.gz</strong></span></code> contains a set of replication example scripts. Each script contains a combination of GT.M commands that accomplish a specific task. All examples in the Procedures section use these replication scripts but each example uses different script sequence and script arguments. Always run all replication examples in a test system from a new directory as they create sub-directories and database files in the current directory. No claim of copyright is made with regard to these examples. These example scripts are for explanatory purposes and are not intended for production use. <span class="bold"><strong/></span>YOU MUST UNDERSTAND, AND APPROPRIATELY ADJUST THE COMMANDS GIVEN IN THESE SCRIPTS BEFORE USING IN A PRODUCTION ENVIRONMENT.<span class="bold"><strong/></span> Typically, you would set replication between instances on different systems/data centers and create your own set of scripts with appropriate debugging and error handling to manage replication between them. Click <a class="ulink" href="http://tinco.pair.com/bhaskar/gtm/doc/books/ao/UNIX_manual/webhelp/content/downloadables/repl_procedures.tar.gz" target="_top"><span class="inlinemediaobject"><img src="images/download.png" alt="Download repl_procedures.tar.gz"/></span></a> to download <code class="code"><span class="bold"><strong>repl_procedures.tar.gz</strong></span></code> on a test system. </p><p><code class="code"><span class="bold"><strong>repl_procedures.tar.gz</strong></span></code> includes the following scripts:</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="procenv"/>env</h4></div></div></div><p>Sets a default environment for GT.M replication. It take two arguments: </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">The name of the instance/database directory.</li><li class="listitem">The GT.M version. </li></ul></div><p>Example: <code class="code">source ./env A V6.3-000A_x86_64</code></p><p>Here is the code:</p><pre class="programlisting">
export gtm_dist=/usr/lib/fis-gtm/$2
export gtm_repl_instname=$1
export gtm_repl_instance=$PWD/$gtm_repl_instname/gtm.repl
export gtmgbldir=$PWD/$gtm_repl_instname/gtm.gld
export gtm_principal_editing=EDITING
export gtmroutines="$PWD/$gtm_repl_instname $gtm_dist"
#export gtmroutines="$PWD/$gtm_repl_instname $gtm_dist/libgtmutil.so"
# Here is an example of setting the gtmroutines environment variable:
# if [ -e  "$gtm_dist/libgtmutil.so" ] ; then export gtmroutines="$PWD/$gtm_repl_instname $gtm_dist/libgtmutil.so"
else export gtmroutines="$PWD/$gtm_repl_instname* $gtm_dist" ; fi
# For more examples on setting GT.M related environment variables to reasonable values on POSIX shells, refer to the gtmprofile script.
#export gtmcrypt_config=$PWD/$gtm_repl_instname/config_file
#echo -n "Enter Password for gtmtls_passwd_${gtm_repl_instname}: ";export gtmtls_passwd_${gtm_repl_instname}="`$gtm_dist/plugin/gtmcrypt/maskpass|tail -n 1|cut -f 3 -d " "`"</pre><p>Modify the env script according to your test environment. </p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="dbcreateproc"/>db_create</h4></div></div></div><p>Creates a new sub-directory in the current directory, a global directory file with settings from gdemsr, and the GT.M database file. </p><p>Here is the code:</p><pre class="programlisting">mkdir -p $PWD/$gtm_repl_instname/
  $gtm_dist/mumps -r ^GDE @gdemsr
  $gtm_dist/mupip create</pre><p><code class="code">gdemsr</code> contains:</p><pre class="programlisting">change -segment DEFAULT -file_name=$PWD/$gtm_repl_instname/gtm.dat
  exit</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="backupreplproc"/>backup_repl</h4></div></div></div><p>Creates a backup of the replication instance file. The first argument specifies the location of the backed up replication instance file. </p><p>Here is the code:</p><pre class="programlisting">$gtm_dist/mupip backup -replinst=$1</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="replsetupproc"/>repl_setup</h4></div></div></div><p>Turns on replication for all regions and create the replication instance file with the -noreplace qualifier for a BC instance. </p><p>Here is the code:</p><pre class="programlisting">$gtm_dist/mupip set -replication=on -region "*"
  $gtm_dist/mupip replicate -instance_create -noreplace</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="originstartproc"/>originating_start</h4></div></div></div><p>Starts the Source Server of the originating instance in a BC replication configuration. It takes five arguments:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">The first argument is the name of the originating instance. This argument is also used in the name of the Source Server log file. </li><li class="listitem">The second argument is the name of the BC replicating instance. This argument is also used in the name of the Source Server log file.</li><li class="listitem">The third argument is port number of localhost at which the Receiver Server is waiting for a connection. </li><li class="listitem">The optional fourth and fifth argument specify the -tlsid and -reneg qualifiers used to set up a TLS/SSL connection.</li><li class="listitem">Example:<code class="code">./originating_start A B 4001</code></li></ul></div><p>Here is the code:</p><pre class="programlisting">$gtm_dist/mupip replicate -source -start -instsecondary=$2 -secondary=localhost:$3 -buffsize=1048576 -log=$PWD/$1/$1_$2.log $4 $5
tail -30 $PWD/$1/$1_$2.log
$gtm_dist/mupip replicate -source -checkhealth</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="replstartproc"/>replicating_start</h4></div></div></div><p>Starts the passive Source Server and the Receiver Server in a BC replication configuration. It takes four arguments:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">The first argument is the name of the replicating instance. This argument is also used in the name of the passive Source Server and Receiver Server log file name. </li><li class="listitem">The second argument is port number of localhost at which the Source Server is sending the replication stream for the replicating instance. </li><li class="listitem">The optional third and fourth arguments are used to specify additional qualifiers for the Receiver Server startup command. </li><li class="listitem">Example:<code class="code">./replicating_start B 4001</code></li></ul></div><p>Here is the code:</p><pre class="programlisting">$gtm_dist/mupip replicate -source -start -passive -instsecondary=dummy -buffsize=1048576 -log=$PWD/$1/source$1_dummy.log # creates the Journal Pool
$gtm_dist/mupip replicate -receive -start -listenport=$2 -buffsize=1048576 -log=$PWD/$1/receive.log $3 $4 # starts the Receiver Server
tail -20 $PWD/$1/receive.log
$gtm_dist/mupip replicate -receive -checkhealth</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="supplsetupproc"/>suppl_setup</h4></div></div></div><p>Turns on replication for all regions, create the supplementary replication instance file with the -noreplace qualifier, starts the passive Source Server, starts the Receiver Server of an SI replicating instance, and displays the health status of the Receiver Server and Update Process. Use this to start an SI replicating instance for the first time. It takes four arguments:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">The first argument is the name of the supplementary instance. This argument is also used in the name of the passive Source Server and Receiver Server log files. </li><li class="listitem">The second argument is the path to the backed up replication instance file of the originating instance. </li><li class="listitem">The third argument is port number of localhost at which the Receiver Server is waiting for a connection. </li><li class="listitem">The optional fourth argument is either -updok or -updnotok which determines whether the instance accepts updates. </li><li class="listitem">The optional fifth argument specifies -tlsid which is used in setting up a TLS/SSL replication connection.  </li></ul></div><p>Example: <code class="code">./suppl_setup P startA 4011 -updok</code></p><p>Here is the code:</p><pre class="programlisting">$gtm_dist/mupip set -replication=on -region "*"
$gtm_dist/mupip replicate -instance_create -supplementary -noreplace
$gtm_dist/mupip replicate -source -start -passive -buf=1048576 -log=$PWD/$gtm_repl_instname/$1_dummy.log -instsecondary=dummy $4
$gtm_dist/mupip replicate -receive -start -listenport=$3 -buffsize=1048576 -log=$PWD/$gtm_repl_instname/$1.log -updateresync=$2 -initialize $5
tail -30 $PWD/$1/$1.log
$gtm_dist/mupip replicate -receive -checkhealth</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="replstatusproc1"/>repl_status</h4></div></div></div><p>Displays health and backlog status information for the Source Server and Receiver Server in the current environment.</p><p>Here is the code:</p><pre class="programlisting">echo "-----------------------------------------------------------------"
  echo "Source Server $gtm_repl_instname: "
  echo "-----------------------------------------------------------------"
  $gtm_dist/mupip replicate -source -check
  $gtm_dist/mupip replicate -source -showbacklog
  echo "-----------------------------------------------------------------"
  echo "Receiver Server $gtm_repl_instname: "
  echo "-----------------------------------------------------------------"
  $gtm_dist/mupip replicate -receive -check
  $gtm_dist/mupip replicate -rece -showbacklog</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="rollbackproc11"/>rollback</h4></div></div></div><p>Performs an ONLINE FETCHRESYNC rollback and creates a lost and/or broken transaction file. It takes two arguments:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">The first argument specifies the communication port number that the rollback command uses when fetching the reference point. This is the same port number that the Receiver Server used to communicate with the Source Server.</li><li class="listitem">The second argument specifies either <code class="code">backward</code> or <code class="code">forward</code>.</li></ul></div><p>Example: <code class="code">./rollback 4001 backward</code></p><p>Here is the code:</p><pre class="programlisting">$gtm_dist/mupip journal -rollback -fetchresync=$1 -$2 "*"</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="originstop"/>originating_stop</h4></div></div></div><p>Shuts down the Source Server with a two second timeout and perform a MUPIP RUNDOWN operation.</p><p>The first argument specifies additional qualifiers for the Source Server shutdown command.</p><p>Here is the code:</p><pre class="programlisting">$gtm_dist/mupip replicate -source -shutdown -timeout=2 $1 #Shut down the originating Source Server
  $gtm_dist/mupip rundown -region "*" #Perform database rundown</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="replstopproc"/>replicating_stop</h4></div></div></div><p>Shuts down the Receiver Server with a two seconds timeout and then shuts down the passive Source Server. </p><p>Here is the code:</p><pre class="programlisting">$gtm_dist/mupip replicate -receiver -shutdown -timeout=2 #Shut down the Receiver Server
  $gtm_dist/mupip replicate -source -shutdown -timeout=2 #Shut down the passive Source Server</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="replstartsuppproc"/>replicating_start_suppl_n</h4></div></div></div><p>Starts the passive Source Server and the Receiver Server of the supplementary instance for all startups except the first. It takes three arguments:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">The first argument is the name of the supplementary instance. It is also used in the names of the passive Source Server and the Receiver Server log files. </li><li class="listitem">The second argument is port number of localhost at which the Receiver Server is waiting for a connection. </li><li class="listitem">The optional third argument is an additional qualifier for the passive Source Server startup command. In the examples, the third argument is either <code class="code">-updok</code> or <code class="code">-updnotok</code>.</li><li class="listitem">The optional fourth argument is an additional qualifier for the Receiver Server startup command. In the examples, the fourth argument is either <code class="code">-autorollback</code> or <code class="code">-noresync</code>.</li><li class="listitem">The optional fifth argument is -tlsid which is used to set up a TLS/SSL replication connection.</li></ul></div><p>Example:<code class="code">./replicating_start_suppl_n P 4011 -updok -noresync</code></p><p>Here is the code:</p><pre class="programlisting">$gtm_dist/mupip replicate -source -start -passive -instsecondary=dummy -buffsize=1048576 -log=$PWD/$gtm_repl_instname/$12dummy.log $3 # creates the Journal Pool
  $gtm_dist/mupip replicate -receive -start -listenport=$2 -buffsize=1048576 $4 $5 -log=$PWD/$gtm_repl_instname/$1.log # starts the Receiver Server and the Update Process
  tail -30 $PWD/$1/$1.log
  $gtm_dist/mupip replicate -receiver -checkhealth # Checks the health of the Receiver Server and the Update Process</pre></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="abrepl1"/>Setting up an Aa??B replication configuration with empty databases</h3></div></div></div><p>On A:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Turn on replication.</p></li><li class="listitem"><p>Create the replication instance file.</p></li><li class="listitem"><p>Start the Source Server.</p></li></ul></div><p>On B:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Turn on replication.</p></li><li class="listitem"><p>Create a new replication instance file.</p></li><li class="listitem"><p>Start the passive Source Server.</p></li><li class="listitem"><p>Start the Receiver Server.</p></li></ul></div><p>Example:</p><pre class="programlisting">source ./gtmenv A V6.3-000A_x86_64 
./db_create
./repl_setup
./originating_start A B 4001
source ./gtmenv B V6.3-000A_x86_64
./db_create
./repl_setup
./replicating_start B 4001
./repl_status</pre><p>The shutdown sequence is as follows:</p><pre class="programlisting">source ./gtmenv B V6.3-000A_x86_64
./replicating_stop
source ./env A V6.3-000A_x86_64
./originating_stop</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="abcrepl1"/>Setting up an Aa??Ba??C replication configuration with empty databases</h3></div></div></div><p>On A:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Turn on replication.</p></li><li class="listitem"><p>Create the replication instance file.</p></li><li class="listitem"><p>Start the Source Server.</p></li></ul></div><p>On B:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Turn on replication.</p></li><li class="listitem"><p>Create a new replication instance file.</p></li><li class="listitem"><p>Start the passive Source Server. </p></li><li class="listitem"><p>Start the Receiver Server.</p></li><li class="listitem"><p>Start the Source Server with the -propagateprimary qualifier.</p></li></ul></div><p>On C:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Turn on replication.</p></li><li class="listitem"><p>Create a new replication instance file.</p></li><li class="listitem"><p>Start the passive Source Server .</p></li><li class="listitem"><p>Start the Receiver Server.</p></li></ul></div><p>Example:</p><pre class="programlisting">
source ./gtmenv A V6.3-000A_x86_64 
./db_create
./repl_setup
./originating_start A B 4001
source ./gtmenv B V6.3-000A_x86_64
./db_create
./repl_setup
./replicating_start B 4001
./originating_start B C 4002 -propagateprimary
source ./gtmenv C V6.3-000A_x86_64
./db_create
./repl_setup
./replicating_start C 4002
./repl_status</pre><p>The shutdown sequence is as follows:</p><pre class="programlisting">source ./gtmenv C V6.3-000A_x86_64
./replicating_stop
source ./gtmenv B V6.3-000A_x86_64
./replicating_stop
./originating_stop
source ./gtmenv A V6.3-000A_x86_64
./originating_stop</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="aprepl"/>Setting up an Aa??P replication configuration with empty databases</h3></div></div></div><p>On A:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Turn on replication.</p></li><li class="listitem"><p>Create a new replication instance file.</p></li><li class="listitem"><p>Start the Source Server.</p></li><li class="listitem"><p>Immediately, after starting the Source Server but before making any updates, take a backup of the replication instance file. The instance file has the journal sequence number that corresponds to the database state at the time of starting the instance. This backup instance helps when you need to start a new Supplementary Instance without taking a backup of the Originating Instance. Retain the backup copy of the Originating Instance as you may need it in future as a checkpoint from where its supplementary instance may resume to receive updates. </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Note"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Note]" src="../common/images/note.jpg"/></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Note that while a backed up instance file helps start replication on the P side of Aa??P, it does not prevent the need for taking a backup of the database on A. You need to do a database backup/restore or an extract/load from A to P to ensure P has all of the data as on A at startup.</p></td></tr></table></div></li></ul></div><p>On P:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Turn on replication.</p></li><li class="listitem"><p>Create a new replication instance file with the -supplementary qualifier.</p></li><li class="listitem"><p>Start the passive Source Server.</p></li><li class="listitem"><p>Start the Receiver Server and the Update Process with -updateresync="/path/to/bkup_orig_repl_inst_file" -initialize. Use the -updateresync -initialize qualifiers only once.</p></li><li class="listitem"><p>For subsequent Receiver Server and Update Process start ups, do not use -updateresync -initialize with qualifiers. Either use -autorollback with the Receiver Server startup command or perform an explicit -fetchresync -rollback before starting the Receiver Server. </p></li></ul></div><p>Example:</p><pre class="programlisting">source ./gtmenv A V6.3-000A_x86_64
./db_create
./repl_setup
./originating_start A P 4000
./backup_repl startA
source ./gtmenv P V6.3-000A_x86_64
./db_create
./suppl_setup P startA 4000 -updok
./repl_status
# For subsequent Receiver Server startup for P, use:
# ./replicating_start_suppl_n P 4000 -updok -autorollback
# or 
#./rollback 4000 backward
#./replicating_start_suppl_n P 4000 -updok</pre><p>The shutdown sequence is as follows:</p><pre class="programlisting">source ./gtmenv P V6.3-000A_x86_64
./replicating_stop
source ./gtmenv A V6.3-000A_x86_64
./originating_stop</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="riborg"/>Replicating Instance Starts from Backup of Originating Instance (Aa??B and Aa??P )</h3></div></div></div><p>The more common scenario for bringing up a replicating instance is to take a backup of the originating instance and bring it up as a replicating instance. If the backup is a comprehensive backup, the file headers store the journal sequence numbers.</p><p>On A:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Create a backup using -DATABASE, -REPLINST, -NEWJNLFILE=PREVLINK, and -BKUPDBJNL=DISABLE qualifiers. -DATABASE creates a comprehensive backup of the database file. -REPLINST backs up the replication instance file. -BKUPDBJNL=DISABLE scrubs all journal file information in the backup database file.  As the backup of instance A is comprehensive, -NEWJNLFILE=PREVLINK cuts the back link to prior generation journal files of the database for which you are taking the backup. </p></li><li class="listitem"><p>Copy the backup of the replication instance file to the location of the backed up instance. </p></li><li class="listitem"><p>Start a new Source Server for the backed up replicating instance. </p></li></ul></div><p>On the backed up instance:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Load/restore the database. If the replicating database is not from a comprehensive or database backup from the originating instance, set the journal sequence number from the originating at the instant of the backup for at least one replicated region on the replicating instance.</p></li><li class="listitem"><p>Run MUPIP REPLICATE -EDITINSTANCE command to change the name of the backed up replication instance file.</p></li><li class="listitem"><p>Start the Receiver Server for the BC replicating instance.  Do not use the -UPDATERESYNC qualifier to start the receiver server of a BC replicating instance. -UPDATERESYNC is necessary when you start the Receiver Server of a SI replicating instance for the first time. Without -UDPATERESYNC, the SI replicating instance may refuse to start replication because the journal sequence number in the replicating instance may be higher than what the originating instance expects.</p></li></ul></div><p>Example:</p><p>The following example demonstrates starting a replicating instance from the backup of an originating instance in an Aa??B replication configuration. Note that you do not need to perform an -updateresync when starting a BC replicating instance for the first time. </p><pre class="programlisting">source ./gtmenv A V6.3-000A_x86_64
./db_create
./repl_setup
./originating_start A backupA 4001
./backup_repl startingA   #Preserve the backup of the replicating instance file that represents the state at the time of starting the instance. 
$gtm_dist/mumps -r %XCMD 'for i=1:1:10 set ^A(i)=i'
mkdir backupA   
$gtm_dist/mupip backup -replinst=currentstateA -newjnlfile=prevlink -bkupdbjnl=disable DEFAULT backupA
source ./gtmenv backupA V6.3-000A_x86_64
./db_create
./repl_setup
cp currentstateA backupA/gtm.repl
$gtm_dist/mupip replicate -editinstance -name=backupA backupA/gtm.repl 
./replicating_start backupA 4001 
./repl_status</pre><p>The shutdown sequence is as follows:</p><pre class="programlisting">source ./gtmenv backupA V6.3-000A_x86_64
./replicating_stop
source ./gtmenv A V6.3-000A_x86_64
./originating_stop</pre><p>The following example demonstrates starting a replicating instance from the backup of an originating instance in an Aa??P replication configuration. Note that you need to perform an -updateresync to start a supplementary instance for the first time. </p><pre class="programlisting">source ./gtmenv A V6.3-000A_x86_64
./db_create
./repl_setup
./originating_start A backupA 4011
./backup_repl startingA   
$gtm_dist/mumps -r %XCMD 'for i=1:1:10 set ^A(i)=i'
./backup_repl currentstateA
mkdir backupA
$gtm_dist/mupip backup -newjnlfile=prevlink -bkupdbjnl=disable DEFAULT backupA
source ./gtmenv backupA V6.3-000A_x86_64
./db_create
./suppl_setup backupA currentstateA 4011 -updok
./repl_status</pre><p>The shutdown sequence is as follows:</p><pre class="programlisting">source ./gtmenv backupA V6.3-000A_x86_64
./replicating_stop
source ./gtmenv A V6.3-000A_x86_64
./originating_stop</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="nrml_cutov"/>Switchover possibilities in an Aa??B replication configuration</h3></div></div></div><p>A switchover is the procedure of switching the roles of an originating instance and a replicating instance. A switchover is necessary for various reasons including (but not limited to) testing the replicating instance preparedness to take over the role of an originating instance or bringing the originating instance down for maintenance in a way that there is minimal impact on application availability.</p><p>In an A-&gt;B replication configuration, at any given point there can be two possibilities: </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>A is ahead of B, that is A has updates which are not yet replicated to B. </p></li><li class="listitem"><p>A and B are in sync. This happens where there are no new updates on A and all pending updates are replicated to B. </p></li></ul></div><p>The steps described in this section perform a switchover (A-&gt;B becomes B-&gt;A) under both these possibilities. When A is ahead of B, these steps generate a lost transaction file which must be applied to the new originating instance as soon as possible. The lost transaction file contains transactions which are were not replicated to B. Apply the lost transactions on the new originating instance either manually or in a semi-automated fashion using the M-intrinsic function $ZQGBLMOD(). If you use $ZQGBLMOD(), perform two additional steps (mupip replicate -source -needrestart and mupip replicate -source -losttncomplete) as part of lost transaction processing. Failure to run these steps can cause $ZQGBLMOD() to return false negatives that in turn can result in application data consistency issues.</p><p>First, choose a time when there are no database updates or the rate of updates are low to minimize the chances that your application may time out. There may be a need to hold database updates briefly during the switchover. For more information on holding database updates, refer to Instance Freeze section to configure an appropriate freezing mechanism suitable for your environment. </p><p>In an Aa??B replication configuration, follow these steps:</p><p>On A:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Shut down the Source Server with an appropriate timeout. The timeout should be long enough to replicate pending transactions to the replicating instance but not too long to cause clients to conclude that the application is not available. The GT.M default Source Server wait period is up to 120 seconds. In most cases, the default wait period is sufficient.</p></li></ul></div><p>On B:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Shut down the Receiver Server and the Update Process. </p></li><li class="listitem"><p>Shut down the passive Source Server to bring down the journal pool. Ensure that you shut down the Receiver Server and Update Process first before shutting down the passive Source Server.  </p></li><li class="listitem"><p>Start B as the new originating instance. </p></li></ol></div><p>On A:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Start the passive Source Server. </p></li><li class="listitem"><p>Perform a FETCHRESYNC ROLLBACK BACKWARD.</p></li><li class="listitem"><p>Start the Receiver Server. </p></li><li class="listitem"><p>Process the lost transaction file as soon as possible. </p></li></ol></div><p>The following example runs a switchover in an Aa??B replication configuration.</p><pre class="programlisting">source ./gtmenv A V6.3-000A_x86_64 # creates a simple environment for instance A
./db_create
./repl_setup # enables replication and creates the replication instance file
./originating_start A B 4001 # starts the active Source Server (A-&gt;B)
$gtm_dist/mumps -r %XCMD 'for i=1:1:100 set ^A(i)=i'
./repl_status #-SHOWBACKLOG and -CHECKHEALTH report
source ./gtmenv B V6.3-000A_x86_64 # creates a simple environment for instance B
./db_create
./repl_setup
./replicating_start B 4001 
./repl_status # -SHOWBACKLOG and -CHECKHEATH report 
./replicating_stop # Shutdown the Receiver Server and the Update Process 
source ./gtmenv A V6.3-000A_x86_64 # Creates an environment for A
$gtm_dist/mumps -r %XCMD 'for i=1:1:50 set ^losttrans(i)=i' # perform some updates when replicating instance is not available. 
sleep 2
./originating_stop # Stops the active Source Server 
source ./gtmenv B V6.3-000A_x86_64 # Create an environment for B
./originating_start B A 4001 # Start the active Source Server (B-&gt;A)
source ./gtmenv A V6.3-000A_x86_64 # Create an environment for A
./rollback 4001 backward
./replicating_start A 4001 # Start the replication Source Server 
./repl_status # To confirm whether the Receiver Server and the Update Process started correctly.
cat A/gtm.lost </pre><p>The shutdown sequence is as follows:</p><pre class="programlisting">source ./gtmenv A V6.3-000A_x86_64
./replicating_stop
source ./gtmenv B V6.3-000A_x86_64
./originating_stop</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="recov_bap"/>Switchover possibilities in a Ba??Aa??P replication configuration </h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="a_req_rlbk"/>A requires rollback</h4></div></div></div><p>The following scenario demonstrates a switchover from Ba??Aa??P to Aa??Ba??P when A has unreplicated updates that require rollback before B can become the new originating instance.</p><div class="informaltable"><table border="1"><colgroup><col class="c1"/><col class="c2"/><col class="c3"/><col class="c4"/></colgroup><thead><tr><th>
              <p><span class="bold"><strong>A</strong></span></p>
            </th><th>
              <p><span class="italic">B</span></p>
            </th><th>
              <p><span class="underline">P</span></p>
            </th><th>
              <p>Comments</p>
            </th></tr></thead><tbody><tr><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="bold"><strong>A99</strong></span></p>
            </td><td>
              <p>R: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span></p>
            </td><td>
              <p>S: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">P37</span>, <span class="underline">P38</span></p>
            </td><td>
              <p><span class="bold"><strong>A</strong></span> as an originating primary instance at transaction number <span class="bold"><strong>A99</strong></span>, replicates to <span class="italic">B</span> as a BC replicating secondary instance at transaction number <span class="bold"><strong>A98</strong></span> and <span class="underline">P</span> as a SI that includes transaction number <span class="bold"><strong>A97</strong></span>, interspersed with locally generated updates. Updates are recorded in each instance's journal files using before-image journaling.</p>
            </td></tr><tr><td>
              <p>Crashes</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italic">B61</span></p>
            </td><td>
              <p>... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">P37</span>, <span class="underline">P38</span></p>
            </td><td>
              <p>When an event disables <span class="bold"><strong>A</strong></span>, <span class="italic">B</span> becomes the new originating primary, with <span class="bold"><strong>A98</strong></span> as the latest transaction in its database, and starts processing application logic to maintain business continuity. In this case where <span class="underline">P</span> is not ahead of <span class="italic">B</span>, the Receiver Server at <span class="underline">P</span> can remain up after <span class="bold"><strong>A</strong></span> crashes. When <span class="italic">B</span> connects, its Source Server and <span class="underline">P</span>"s Receiver Server confirms that <span class="italic">B</span> is not behind <span class="underline">P</span> with respect to updates received from <span class="bold"><strong>A</strong></span>, and SI replication from <span class="italic">B</span> picks up where replication from <span class="bold"><strong>A</strong></span> left off.</p>
            </td></tr><tr><td>
              <p>-</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span></p>
            </td><td>
              <p>S: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">P37</span>, <span class="underline">P38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">P39</span>, <span class="italic">B61</span>, <span class="underline">P40</span></p>
            </td><td>
              <p><span class="underline">P</span> operating as a supplementary instance to <span class="italic">B</span> replicates transactions processed on <span class="italic">B</span>, and also applies its own locally generated updates. Although <span class="bold"><strong>A98</strong></span> was originally generated on <span class="bold"><strong>A</strong></span>, <span class="underline">P</span> received it from <span class="italic">B</span> because <span class="bold"><strong>A97</strong></span> was the common point between <span class="italic">B</span> and <span class="underline">P</span>.</p>
            </td></tr><tr><td>
              <p>... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="bold"><strong>A99</strong></span></p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>S: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">P37</span>, <span class="underline">P38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">P39</span>, <span class="italic">B61</span>, <span class="underline">P40</span>, <span class="italic">B62</span>, <span class="italic">B63</span></p>
            </td><td>
              <p><span class="underline">P</span>, continuing as a supplementary instance to <span class="italic">B</span>, replicates transactions processed on <span class="italic">B</span>, and also applies its own locally generated updates. <span class="bold"><strong>A</strong></span> meanwhile has been repaired and brought online. It has to roll transaction <span class="bold"><strong>A99</strong></span> off its database into an Unreplicated Transaction Log before it can start operating as a replicating secondary instance to <span class="italic">B</span>.</p>
            </td></tr><tr><td>
              <p>R: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="italic">B64</span>, B65</p>
            </td><td>
              <p>S: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">P37</span>, <span class="underline">P38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">P39</span>, <span class="italic">B61</span>, <span class="underline">P40</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="underline">P41</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>Having rolled off transactions into an Unreplicated Transaction Log, <span class="bold"><strong>A</strong></span> can now operate as a replicating secondary instance to <span class="italic">B</span>. This is normal BC Logical Multi-Site operation. <span class="italic">B</span> and <span class="underline">P</span> continue operating as originating primary instance and supplementary instance.</p>
            </td></tr></tbody></table></div><p>The following example creates this switchover scenario:</p><pre class="programlisting">source ./gtmenv A V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'set ^A(98)=99'
source ./gtmenv B V6.3-000A_x86_64
./replicating_stop
source ./gtmenv A V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'set ^A(99)=100'
./originating_stop
source ./gtmenv B V6.3-000A_x86_64
./originating_start B A 4010
./originating_start B P 4011
./backup_repl startB
$gtm_dist/mumps -r ^%XCMD 'set ^B(61)=0'
source ./gtmenv P V6.3-000A_x86_64
./suppl_setup M startB 4011 -updok
$gtm_dist/mumps -r ^%XCMD 'for i=39:1:40 set ^P(i)=i'
source ./gtmenv B V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'set ^B(62)=1,^B(63)=1'
source ./gtmenv A V6.3-000A_x86_64
./rollback 4010 backward
./replicating_start A 4010
source ./gtmenv B V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'set ^B(64)=1,^B(65)=1'
cat A/gtm.lost</pre><p>The shutdown sequence is as follows:</p><pre class="programlisting">source ./gtmenv B V6.3-000A_x86_64
./originating_stop
source ./gtmenv A V6.3-000A_x86_64 
./replicating_stop
source ./gtmenv P V6.3-000A_x86_64
./replicating_stop</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="ap_req_rllbk"/>A and P require rollback</h4></div></div></div><p>The following demonstrates a switchover scenario from Ba??Aa??P  to Aa??Ba??P where A and P have unreplicated updates that require rollback before B can become the new originating instance. </p><div class="informaltable"><table border="1"><colgroup><col class="c1"/><col class="c2"/><col class="c3"/><col class="c4"/></colgroup><thead><tr><th>
              <p><span class="bold"><strong>A</strong></span></p>
            </th><th>
              <p><span class="italic">B</span></p>
            </th><th>
              <p><span class="underline">P</span></p>
            </th><th>
              <p>Comments</p>
            </th></tr></thead><tbody><tr><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="bold"><strong>A99</strong></span></p>
            </td><td>
              <p>R: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span></p>
            </td><td>
              <p>S: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">P37</span>, <span class="underline">P38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">P39</span>, <span class="underline">P40</span></p>
            </td><td>
              <p><span class="bold"><strong>A</strong></span> as an originating primary instance at transaction number <span class="bold"><strong>A99</strong></span>, replicates to <span class="italic">B</span> as a BC replicating secondary instance at transaction number <span class="bold"><strong>A97</strong></span> and <span class="underline">P</span> as a SI that includes transaction number <span class="bold"><strong>A98</strong></span>, interspersed with locally generated updates. Updates are recorded in each instance's journal files using before-image journaling.</p>
            </td></tr><tr><td>
              <p>Crashes</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span></p>
            </td><td>
              <p>... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">P37</span>, <span class="underline">P38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">P39</span>, <span class="underline">P40</span></p>
            </td><td>
              <p>When an event disables <span class="bold"><strong>A</strong></span>, <span class="italic">B</span> becomes the new originating primary, with <span class="bold"><strong>A97</strong></span> the latest transaction in its database. <span class="underline">P</span> cannot immediately start replicating from <span class="italic">B</span> because the database states would not be consistent - while <span class="italic">B</span> does not have <span class="bold"><strong>A98</strong></span> in its database and its next update may implicitly or explicitly depend on that absence, <span class="underline">P</span> does, and may have relied on <span class="bold"><strong>A98</strong></span> to compute <span class="underline">P39</span> and <span class="underline">P40</span>.</p>
            </td></tr><tr><td>
              <p>-</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span></p>
            </td><td>
              <p>S: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">P37</span>, <span class="underline">P38</span>, <span class="italic">B61</span></p>
            </td><td>
              <p>For <span class="underline">P</span> to accept replication from <span class="italic">B</span>, it must roll off transactions generated by <span class="bold"><strong>A</strong></span>, (in this case <span class="bold"><strong>A98</strong></span>) that <span class="italic">B</span> does not have in its database, as well as any additional transactions generated and applied locally since transaction number <span class="bold"><strong>A98</strong></span> from <span class="bold"><strong>A</strong></span>.<sup>[<a id="d0e26126" href="ch07s03.html#ftn.d0e26126" class="footnote">a</a>]</sup> This rollback is accomplished with a MUPIP JOURNAL -ROLLBACK -FETCHRESYNC operation on <span class="underline">P</span>.<sup>[<a id="d0e26133" href="ch07s03.html#ftn.d0e26133" class="footnote">b</a>]</sup> These rolled off transactions (<span class="bold"><strong>A98</strong></span>, <span class="underline">P39</span>, <span class="underline">P40</span>) go into the Unreplicated Transaction Log and can be subsequently reprocessed by application code.<sup>[<a id="d0e26164" href="ch07s03.html#ftn.d0e26164" class="footnote">c</a>]</sup> Once the rollback is completed, <span class="underline">P</span> can start accepting replication from <span class="italic">B</span>.<sup>[<a id="d0e26174" href="ch07s03.html#ftn.d0e26174" class="footnote">d</a>]</sup> <span class="italic">B</span> in its Originating Primary role processes transactions and provides business continuity, resulting in transactions <span class="italic">B61</span> and <span class="italic">B62</span>.</p>
            </td></tr><tr><td>
              <p>-</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>S: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">P37</span>, <span class="underline">P38</span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="underline">P39</span>a, <span class="underline">P40</span>a, <span class="italic">B63</span></p>
            </td><td>
              <p><span class="underline">P</span> operating as a supplementary instance to <span class="italic">B</span> replicates transactions processed on <span class="italic">B</span>, and also applies its own locally generated updates. Note that <span class="underline">P39</span>a &amp; <span class="underline">P40</span>a may or may not be the same updates as the <span class="underline">P39</span> &amp; <span class="underline">P40</span> previously rolled off the database.</p>
            </td></tr></tbody><tbody class="footnotes"><tr><td colspan="4"><div class="footnote"><p><sup>[<a id="ftn.d0e26126" href="ch07s03.html#d0e26126" class="para">a</a>] </sup>As this rollback is more complex, may involve more data than the regular LMS rollback, and may involve reading journal records sequentially; it may take longer.</p></div><div class="footnote"><p><sup>[<a id="ftn.d0e26133" href="ch07s03.html#d0e26133" class="para">b</a>] </sup>In scripting for automating operations, there is no need to explicitly test whether <span class="italic">B</span> is behind <span class="underline">P</span> - if it is behind, the Source Server will fail to connect and report an error, which automated shell scripting can detect and effect a rollback on <span class="underline">P</span> followed by a reconnection attempt by <span class="italic">B</span>. On the other hand, there is no harm in <span class="underline">P</span> routinely performing a rollback before having <span class="italic">B</span> connect - if it is not ahead, the rollback will be a no-op. This characteristic of replication is unchanged from releases prior to V5.5-000.</p></div><div class="footnote"><p><sup>[<a id="ftn.d0e26164" href="ch07s03.html#d0e26164" class="para">c</a>] </sup>GT.M's responsibility for them ends once it places them in the Unreplicated Transaction Log.</p></div><div class="footnote"><p><sup>[<a id="ftn.d0e26174" href="ch07s03.html#d0e26174" class="para">d</a>] </sup>Ultimately, business logic must determine whether the rolled off transactions can simply be reapplied or whether other reprocessing is required. GT.M's $ZQGBLMOD() function can assist application code in determining whether conflicting updates may have occurred.</p></div></td></tr></tbody></table></div><p>The following example creates this scenario.</p><pre class="programlisting">source ./gtmenv A V6.3-000A_x86_64
./db_create
./repl_setup
./originating_start A B 4010
./originating_start A P 4011
./backup_repl startA
$gtm_dist/mumps -r ^%XCMD 'for i=1:1:97 set ^A(i)=i'
source ./gtmenv B V6.3-000A_x86_64
./db_create
./repl_setup
./replicating_start B 4010
source ./gtmenv P V6.3-000A_x86_64
./db_create
./suppl_setup P startA 4011 -updok
$gtm_dist/mumps -r ^%XCMD 'for i=1:1:40 set ^P(i)=i'
source ./gtmenv B V6.3-000A_x86_64 
./replicating_stop
source ./gtmenv A V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'set ^A(98)=99'
source ./gtmenv P V6.3-000A_x86_64
./replicating_stop 
source ./gtmenv A V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'set ^A(99)=100'
./originating_stop
source ./gtmenv B V6.3-000A_x86_64
./originating_start B A 4010
./originating_start B P 4011
./backup_repl startB
$gtm_dist/mumps -r ^%XCMD 'set ^B(61)=0,^B(62)=1'
source ./gtmenv P V6.3-000A_x86_64
./rollback 4011 backward
./suppl_setup P startB 4011 -updok
$gtm_dist/mumps -r ^%XCMD 'for i=39:1:40 set ^P(i)=i'
source ./gtmenv A V6.3-000A_x86_64
./rollback 4010 backward
./replicating_start A 4010
source ./gtmenv B V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'set ^B(64)=1,^B(65)=1'
cat A/gtm.lost
cat P/gtm.lost</pre><p>The shutdown sequence is as follows:</p><pre class="programlisting">source ./gtmenv B V6.3-000A_x86_64
./originating_stop
source ./gtmenv A V6.3-000A_x86_64 
./replicating_stop
source ./gtmenv P V6.3-000A_x86_64
./replicating_stop</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="rollbk_nt_req"/>Rollback not required by application design</h4></div></div></div><p>The following scenario demonstrates a switchover from Ba??Aa??P to Aa??Ba??P when A and P have unreplicated updates. By application design, unreplicated updates on P do not require rollback when B becomes the new originating instance. </p><div class="informaltable"><table border="1"><colgroup><col class="c1"/><col class="c2"/><col class="c3"/><col class="c4"/></colgroup><thead><tr><th>
              <p><span class="bold"><strong>A</strong></span></p>
            </th><th>
              <p><span class="italic">B</span></p>
            </th><th>
              <p><span class="underline">P</span></p>
            </th><th>
              <p>Comments</p>
            </th></tr></thead><tbody><tr><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="bold"><strong>A99</strong></span></p>
            </td><td>
              <p>R: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span></p>
            </td><td>
              <p>S: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">P37</span>, <span class="underline">P38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">P39</span>, <span class="underline">P40</span></p>
            </td><td>
              <p><span class="bold"><strong>A</strong></span> as an originating primary instance at transaction number <span class="bold"><strong>A99</strong></span>, replicates to <span class="italic">B</span> as a BC replicating secondary instance at transaction number <span class="bold"><strong>A97</strong></span> and <span class="underline">P</span> as a SI that includes transaction number <span class="bold"><strong>A98</strong></span>, interspersed with locally generated updates. Updates are recorded in each instance's journal files using before-image journaling.</p>
            </td></tr><tr><td>
              <p>Crashes</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span></p>
            </td><td>
              <p>... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">P37</span>, <span class="underline">P38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">P39</span>, <span class="underline">P40</span></p>
            </td><td>
              <p>When an event disables <span class="bold"><strong>A</strong></span>, <span class="italic">B</span> becomes the new originating primary, with <span class="bold"><strong>A97</strong></span> the latest transaction in its database and starts processing application logic. Unlike the previous example, in this case, application design permits (or requires) <span class="underline">P</span> to start replicating from <span class="italic">B</span> even though <span class="italic">B</span> does not have <span class="bold"><strong>A98</strong></span> in its database and <span class="underline">P</span> may have relied on <span class="bold"><strong>A98</strong></span> to compute <span class="underline">P39</span> and <span class="underline">P40</span>.</p>
            </td></tr><tr><td>
              <p>-</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span></p>
            </td><td>
              <p>S: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">P37</span>, <span class="underline">P38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">P39</span>, <span class="underline">P40</span>, <span class="italic">B61</span>, <span class="italic">B62</span></p>
            </td><td>
              <p>With its Receiver Server started with the -noresync option, <span class="underline">P</span> can receive a SI replication stream from <span class="italic">B</span>, and replication starts from the last common transaction shared by <span class="italic">B</span> and <span class="underline">P</span>. Notice that on <span class="italic">B</span> no <span class="bold"><strong>A98</strong></span> precedes <span class="italic">B61</span>, whereas it does on <span class="underline">P</span>, i.e., <span class="underline">P</span> was ahead of <span class="italic">B</span> with respect to the updates generated by <span class="bold"><strong>A</strong></span>.</p>
            </td></tr></tbody></table></div><p>The following example creates this scenario.</p><pre class="programlisting">source ./gtmenv A V6.3-000A_x86_64
./db_create
./repl_setup
./originating_start A B 4010
./originating_start A P 4011
./backup_repl startA
$gtm_dist/mumps -r ^%XCMD 'for i=1:1:97 set ^A(i)=i'
source ./gtmenv B V6.3-000A_x86_64
./db_create
./repl_setup
./replicating_start B 4010 
source ./gtmenv P V6.3-000A_x86_64
./db_create
./suppl_setup P startA 4011 -updok
$gtm_dist/mumps -r ^%XCMD 'for i=1:1:40 set ^P(i)=i'
source ./gtmenv B V6.3-000A_x86_64 
./replicating_stop
source ./gtmenv A V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'set ^A(98)=99'
source ./gtmenv P V6.3-000A_x86_64
./replicating_stop 
source ./gtmenv A V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'set ^A(99)=100'
./originating_stop
source ./gtmenv B V6.3-000A_x86_64
./originating_start B A 4010
./originating_start B P 4011
#./backup_repl startB
$gtm_dist/mumps -r ^%XCMD 'set ^B(61)=0,^B(62)=1'
source ./gtmenv P V6.3-000A_x86_64
./replicating_start_suppl_n P 4011 -updok -noresync
$gtm_dist/mumps -r ^%XCMD 'for i=39:1:40 set ^P(i)=i'
source ./gtmenv A V6.3-000A_x86_64
./rollback 4010 backward
./replicating_start A 4010 
source ./gtmenv B V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'set ^B(64)=1,^B(65)=1'</pre><p>The shutdown sequence is as follows:</p><pre class="programlisting">source ./gtmenv B V6.3-000A_x86_64
./originating_stop
source ./gtmenv A V6.3-000A_x86_64
./replicating_stop
source ./gtmenv P V6.3-000A_x86_64
./replicating_stop</pre></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="automatic_rollback1"/>Rollback automatically</h4></div></div></div><div class="informaltable"><p>This scenario demonstrates the use of the -autorollback qualifier which performs a ROLLBACK ONLINE FETCHRESYNC under the covers.  </p><table border="1"><colgroup><col class="c1"/><col class="c2"/><col class="c3"/><col class="c4"/></colgroup><thead><tr><th>
              <p><span class="bold"><strong>A</strong></span></p>
            </th><th>
              <p><span class="italic">B</span></p>
            </th><th>
              <p><span class="underline">P</span></p>
            </th><th>
              <p>Comments</p>
            </th></tr></thead><tbody><tr><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="bold"><strong>A99</strong></span></p>
            </td><td>
              <p>R: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span></p>
            </td><td>
              <p>S: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">P37</span>, <span class="underline">P38</span>, <span class="bold"><strong>A98</strong></span>, <span class="underline">P39</span>, <span class="underline">P40</span></p>
            </td><td>
              <p><span class="bold"><strong>A</strong></span> as an originating primary instance at transaction number <span class="bold"><strong>A99</strong></span>, replicates to <span class="italic">B</span> as a BC replicating secondary instance at transaction number <span class="bold"><strong>A97</strong></span> and <span class="underline">P</span> as a SI that includes transaction number <span class="bold"><strong>A98</strong></span>, interspersed with locally generated updates. Updates are recorded in each instance"s journal files using before-image journaling.</p>
            </td></tr><tr><td>
              <p>R: Rolls back to <span class="bold"><strong>A97</strong></span> with <span class="bold"><strong>A98</strong></span> and <span class="bold"><strong>A99</strong></span> in the Unreplicated Transaction Log.</p>
            </td><td>
              <p>O: <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span></p>
            </td><td>
              <p>S:Rolls back <span class="bold"><strong>A98</strong></span>, <span class="italicunderline">P38</span>, and <span class="italicunderline">P40</span></p>
            </td><td>
              <p>Instances receiving a replication stream from <span class="bold"><strong>A</strong></span> can be configured to rollback automatically when <span class="bold"><strong>A</strong></span> performs an online rollback by starting the Receiver Server with -autorollback. If <span class="underline">P</span>"s Receiver Server is so configured, it will roll <span class="bold"><strong>A98</strong></span>, <span class="underline">P39</span> and <span class="underline">P40</span> into an Unreplicated Transaction Log. This scenario is straightforward. With the -noresync qualifier, the Receiver Server can be configured to simply resume replication without rolling back.</p>
            </td></tr></tbody></table></div><p>The following example run this scenario.</p><pre class="programlisting">source ./gtmenv A V6.3-000A_x86_64
./db_create
./repl_setup
./originating_start A P 4000
./originating_start A B 4001
source ./gtmenv B V6.3-000A_x86_64
./db_create
./repl_setup
./replicating_start B 4001
source ./gtmenv A V6.3-000A_x86_64
./backup_repl startA 
source ./gtmenv P V6.3-000A_x86_64
./db_create
./suppl_setup P startA 4000 -updok
$gtm_dist/mumps -r %XCMD 'for i=1:1:38 set ^P(i)=i'
source ./gtmenv A V6.3-000A_x86_64
$gtm_dist/mumps -r %XCMD 'for i=1:1:97 set ^A(i)=i'
source ./gtmenv B V6.3-000A_x86_64
./replicating_stop
source ./gtmenv A V6.3-000A_x86_64
$gtm_dist/mumps -r %XCMD 'set ^A(98)=50'
source ./gtmenv P V6.3-000A_x86_64
$gtm_dist/mumps -r %XCMD 'for i=39:1:40 set ^P(i)=i'
./replicating_stop
source ./gtmenv A V6.3-000A_x86_64
$gtm_dist/mumps -r %XCMD 'set ^A(99)=100'
./originating_stop
source ./gtmenv B V6.3-000A_x86_64
./originating_start B A 4001 
./originating_start B P 4000
source ./gtmenv A V6.3-000A_x86_64
./replicating_start A 4001 -autorollback
source ./gtmenv P V6.3-000A_x86_64
#./rollback 4000 backward
./replicating_start_suppl_n P 4000 -updok -autorollback
#./replicating_start_suppl_n P 4000 -updok </pre><p>The shutdown sequence is as follows:</p><pre class="programlisting">source ./gtmenv A V6.3-000A_x86_64
./replicating_stop
source ./gtmenv P V6.3-000A_x86_64
./replicating_stop
source ./gtmenv B V6.3-000A_x86_64
./originating_stop</pre></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="recov_bapq"/>Switchover possibilities in a Ba??Aa??Pa??Q replication configuration </h3></div></div></div><p>Consider a situation where A and P are located in one data center, with BC replication to B and Q respectively, located in another data center. When the first data center fails, the SI replication from A to P is replaced by SI replication from B to Q. The following scenario describes a switchover from Ba??Aa??Pa??Q to Aa??Ba??Qa??P with unreplicated updates on A and P.</p><div class="informaltable"><table border="1"><colgroup><col class="c1"/><col class="c2"/><col class="c3"/><col class="c4"/><col class="c5"/></colgroup><thead><tr><th>
              <p><span class="bold"><strong>A</strong></span></p>
            </th><th>
              <p><span class="italic">B</span></p>
            </th><th>
              <p><span class="underline">P</span></p>
            </th><th>
              <p><span class="italicunderline">Q</span></p>
            </th><th>
              <p>Comments</p>
            </th></tr></thead><tbody><tr><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="bold"><strong>A99</strong></span></p>
            </td><td>
              <p>R: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span></p>
            </td><td>
              <p>S: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">P37</span>, <span class="bold"><strong>A97</strong></span>, <span class="underline">P38</span></p>
            </td><td>
              <p>R: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">P37</span></p>
            </td><td>
              <p><span class="bold"><strong>A</strong></span> as an originating primary instance at transaction number <span class="bold"><strong>A99</strong></span>, replicates to <span class="italic">B</span> as a BC replicating secondary instance at transaction number <span class="bold"><strong>A98</strong></span> and <span class="underline">P</span> as a SI that includes transaction number <span class="bold"><strong>A97</strong></span>, interspersed with locally generated updates. <span class="underline">P</span> in turn replicates to <span class="italicunderline">Q</span>.</p>
            </td></tr><tr><td>
              <p>Goes down with the data center</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span></p>
            </td><td>
              <p>Goes down with the data center</p>
            </td><td>
              <p>... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">P37</span></p>
            </td><td>
              <p>When a data center outage disables <span class="bold"><strong>A</strong></span>, and <span class="underline">P</span>, <span class="italic">B</span> becomes the new originating primary, with <span class="bold"><strong>A98</strong></span> as the latest transaction in its database and starts processing application logic to maintain business continuity. <span class="italicunderline">Q</span> can receive the SI replication stream from <span class="italic">B</span>, without requiring a rollback since the receiver is not ahead of the source.</p>
            </td></tr><tr><td>
              <p>-</p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span></p>
            </td><td>
              <p>-</p>
            </td><td>
              <p>S: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">P37</span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italicunderline">Q73</span>, <span class="italic">B61</span>, <span class="italicunderline">Q74</span>, <span class="italic">B62</span></p>
            </td><td>
              <p><span class="italicunderline">Q</span> receives SI replication from <span class="italic">B</span> and also applies its own locally generated updates. Although <span class="bold"><strong>A97</strong></span> and <span class="bold"><strong>A98</strong></span> were originally generated on <span class="bold"><strong>A</strong></span>, <span class="italicunderline">Q</span> receives them from <span class="italic">B</span>. <span class="italicunderline">Q</span> also computes and applies locally generated updates</p>
            </td></tr><tr><td>
              <p>... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="bold"><strong>A99</strong></span></p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">P37</span>, <span class="bold"><strong>A97</strong></span>,<span class="bold"><strong>A98</strong></span>, <span class="underline">P38</span></p>
            </td><td>
              <p>S: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">P37</span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italicunderline">Q73</span>, <span class="italic">B61</span>, <span class="italicunderline">Q74</span>, <span class="italic">B62</span>, <span class="italicunderline">Q75</span>, <span class="italic">B63</span>, <span class="italicunderline">Q76</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>While <span class="italic">B</span> and <span class="italicunderline">Q</span>, keep the enterprise in operation, the first data center is recovered. Since <span class="bold"><strong>A</strong></span> has transactions in its database that were not replicated to <span class="italic">B</span> when the latter started operating as the originating primary instance, and since <span class="underline">P</span> had transactions that were not replicated to <span class="italicunderline">Q</span> when the latter took over, <span class="bold"><strong>A</strong></span> and <span class="underline">P</span> must now rollback their databases and create Unreplicated Transaction Files before receiving BC replication streams from <span class="italic">B</span> and <span class="italicunderline">Q</span> respectively. <span class="bold"><strong>A</strong></span> rolls off <span class="bold"><strong>A99</strong></span>, <span class="underline">P</span> rolls off <span class="underline">P38</span>.</p>
            </td></tr><tr><td>
              <p>R: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>O: ... <span class="bold"><strong>A95</strong></span>, <span class="bold"><strong>A96</strong></span>, <span class="bold"><strong>A97</strong></span>, <span class="italic">B61</span>, <span class="italic">B62</span>, <span class="italic">B63</span>, <span class="italic">B64</span>, B65</p>
            </td><td>
              <p>R: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">P37</span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italicunderline">Q73</span>, <span class="italic">B61</span>, <span class="italicunderline">Q74</span>, <span class="italic">B62</span>, <span class="italicunderline">Q75</span>, <span class="italic">B63</span>, <span class="italicunderline">Q76</span>, <span class="italic">B64</span></p>
            </td><td>
              <p>S: ... <span class="underline">P34</span>, <span class="bold"><strong>A95</strong></span>, <span class="underline">P35</span>, <span class="underline">P36</span>, <span class="bold"><strong>A96</strong></span>, <span class="underline">P37</span>, <span class="bold"><strong>A97</strong></span>, <span class="bold"><strong>A98</strong></span>, <span class="italicunderline">Q73</span>, <span class="italic">B61</span>, <span class="italicunderline">Q74</span>, <span class="italic">B62</span>, <span class="italicunderline">Q75</span>, <span class="italic">B63</span>, <span class="italicunderline">Q76</span>, <span class="italic">B64</span>, <span class="italicunderline">Q77</span></p>
            </td><td>
<p>Having rolled off their transactions into Unreplicated Transaction Logs, <span class="bold"><strong>A</strong></span> can now operate as a BC replicating instance to <span class="italic">B</span> and <span class="underline">P</span> can operate as the SI replicating instance to <span class="italicunderline">Q</span>. <span class="italic">B</span> and <span class="underline">Q</span> continue operating as originating primary instance and supplementary instance. <span class="italicunderline">P</span> automatically receives M38 after applying the Unreplicated Transaction Log (from <span class="italicunderline">P</span>) to <span class="underline">Q</span>. <span class="italic">A</span> and <span class="italicunderline">P</span> automatically receive A99 after applying the Unreplicated Transaction Log (from <span class="italic">A</span>) to <span class="bold"><strong>B</strong></span>.</p>
            </td></tr></tbody></table></div><p>The following example runs this scenario.</p><pre class="programlisting">source ./gtmenv A V6.3-000A_x86_64
./db_create
./repl_setup
./originating_start A P 4000
./originating_start A B 4001
source ./gtmenv B V6.3-000A_x86_64
./db_create
./repl_setup
./replicating_start B 4001
source ./gtmenv A V6.3-000A_x86_64
./backup_repl startA 
source ./gtmenv P V6.3-000A_x86_64
./db_create
./suppl_setup P startA 4000 -updok
./backup_repl startP
./originating_start P Q 4005
source ./gtmenv Q V6.3-000A_x86_64
./db_create
./suppl_setup Q startP 4005 -updnotok
source ./gtmenv A V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'for i=1:1:96 set ^A(i)=i'
source ./gtmenv P V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'for i=1:1:37 set ^P(i)=i'
source ./gtmenv Q V6.3-000A_x86_64
./replicating_stop
source ./gtmenv P V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'set ^P(38)=1000'
./replicating_stop
source ./gtmenv A V6.3-000A_x86_64 
$gtm_dist/mumps -r ^%XCMD 'set ^A(97)=1000,^A(98)=1000'
source ./gtmenv B V6.3-000A_x86_64
./replicating_stop
source ./gtmenv A V6.3-000A_x86_64 
$gtm_dist/mumps -r ^%XCMD 'set ^A(99)=1000'
./originating_stop 
source ./gtmenv B V6.3-000A_x86_64
backup_repl startB
./originating_start B Q 4008
$gtm_dist/mumps -r ^%XCMD 'for i=1:1:62 set ^B(i)=i'
source ./gtmenv Q V6.3-000A_x86_64
./rollback 4008 backward
./suppl_setup Q startB 4008 -updok
$gtm_dist/mumps -r ^%XCMD 'for i=1:1:74 set ^Q(i)=i'
source ./gtmenv B V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'for i=63:1:64 set ^B(i)=i'
./originating_start B A 4004
source ./gtmenv A V6.3-000A_x86_64
./rollback 4004 backward
./replicating_start A 4004
source ./gtmenv Q V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'for i=75:1:76 set ^Q(i)=i'
./originating_start Q P 4007
./backup_repl startQ
source ./gtmenv P V6.3-000A_x86_64
./rollback 4007 backward
./replicating_start_suppl_n P 4007 -updnotok
source ./gtmenv Q V6.3-000A_x86_64
$gtm_dist/mumps -r ^%XCMD 'set ^Q(77)=1000'
cat A/gtm.lost
cat P/gtm.lost</pre><p>The shutdown sequence is as follows:</p><pre class="programlisting">source ./gtmenv P V6.3-000A_x86_64
./replicating_stop
source ./gtmenv A V6.3-000A_x86_64
./replicating_stop
source ./gtmenv Q V6.3-000A_x86_64
./replicating_stop
./originating_stop
source ./gtmenv B V6.3-000A_x86_64
./originating_stop</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="gldreplupd"/>Changing the global directory in an Aa??B replication configuration</h3></div></div></div><p>In a replication configuration, a global directory provides information to map global updates to their respective database files. As replication processes pick the state of the global directory at process startup, any change made to the global directory requires process restarts (at a minimum) to bring that change into effect. A switchover mechanism can ensure application availability while making global directory changes. </p><p>On B:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Shut down the Receiver Server and the Update Process. </p></li><li class="listitem"><p>Make a copy of the current global directory. </p></li><li class="listitem"><p>If the globals you are moving have triggers, make a copy of their definitions with MUPIP TRIGGER -SELECT and delete them with MUPIP TRIGGER.</p></li><li class="listitem"><p>Update the global directory.</p></li><li class="listitem"><p>If you are rearranging the global name spaces which do not contain any data, skip to step 9. </p></li><li class="listitem"><p>Create a backup copy of B, turn off replication, and cut the previous links of the journal file. </p></li><li class="listitem"><p>Use the MERGE command to copy a global from the prior to the new location. Use extended references (to the prior global directory) to refer to global in the prior location. </p></li><li class="listitem"><p>If the globals you are moving have triggers, apply the definitions saved in step 3.</p></li><li class="listitem"><p>Turn replication on for the region of the new global location. </p></li><li class="listitem"><p>Make B the new originating instance. For more information, refer to <a class="xref" href="ch07s03.html#nrml_cutov" title="Switchover possibilities in an Aa??B replication configuration">a??Switchover possibilities in an Aa??B replication configurationa??</a>.</p></li></ol></div><p>On A: </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Shutdown replication.</p></li><li class="listitem"><p>If the globals you are moving have triggers, make a copy of their definitions with MUPIP TRIGGER -SELECT and delete them with MUPIP TRIGGER; note if the triggers are the same as those on B, which they normally would be for a BC instance you can just delete them and use the definitions saved on B.</p></li><li class="listitem"><p>Update the global directory.</p></li><li class="listitem"><p>If you are rearranging the global name spaces which do not contain any data, skip to step 7. </p></li><li class="listitem"><p>Create a backup copy of A, turn off replication, and cut the previous links of the journal file. </p></li><li class="listitem"><p>Use the MERGE command to copy a global from the prior to the new location. Use extended references (to the prior global directory) to refer to global in the prior location. </p></li><li class="listitem"><p>If the globals you are moving have triggers, apply the definitions saved in step 1.</p></li><li class="listitem"><p>Turn replication on for the region of the new global location. </p></li><li class="listitem"><p>Make A the new replicating instance. </p></li></ol></div><p>Perform a switchover to return to the A-&gt;B configuration. Once normal operation resumes, remove the global from the prior location (using extended references) to release space. </p><p>If a switchover mechanism is not in place and a downtime during the global directory update is acceptable, follow these steps:</p><p>On B:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Perform steps 1 to 9. </p></li><li class="listitem"><p>Restart the Receiver Server and the Update Process.</p></li></ul></div><p>On A:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Bring down the application (or prevent new updates from getting started). </p></li><li class="listitem"><p>Perform Steps 1 to 8. </p></li><li class="listitem"><p>Restart the originating instance.</p></li><li class="listitem"><p>Restart the active Source Server. </p></li><li class="listitem"><p>Bring up the application. </p></li></ul></div><p>This example adds the mapping for global ^A to a new database file A.dat in an A-&gt;B replication configuration. </p><pre class="programlisting">source ./gtmenv A V6.3-000A_x86_64 
./db_create
./repl_setup
./originating_start A B 4001
source ./gtmenv B V6.3-000A_x86_64
./db_create
./repl_setup
./replicating_start B 4001
source ./gtmenv A V6.3-000A_x86_64 
$gtm_dist/mumps -r %XCMD 'for i=1:1:10 set ^A(i)=i'
./repl_status
source ./gtmenv B V6.3-000A_x86_64
./replicating_stop
cp B/gtm.gld B/prior.gld
$gtm_dist/mumps -r ^GDE @updgld
./db_create
mkdir backup_B
$gtm_dist/mupip backup "*" backup_B  -replinst=backup_B/gtm.repl
$gtm_dist/mupip set -journal=on,before_images,filename=B/gtm.mjl -noprevjnlfile -region "DEFAULT"
$gtm_dist/mumps -r %XCMD 'merge ^A=^|"B/prior.gld"|A'
$gtm_dist/mupip set -replication=on -region AREG
./originating_start B A 4001
source ./gtmenv A V6.3-000A_x86_64 
./originating_stop
./rollback 4001 backward
cat A/gtm.lost  #apply lost transaction file on A. 
./replicating_start A 4001
./replicating_stop 
cp A/gtm.gld A/prior.gld
$gtm_dist/mumps -r ^GDE @updgld
./db_create
mkdir backup_A
$gtm_dist/mupip backup "*" backup_A -replinst=backup_A/gtm.repl
$gtm_dist/mupip set -journal=on,before_images,filename=A/gtm.mjl -noprevjnlfile -region "DEFAULT"
$gtm_dist/mumps -r %XCMD 'merge ^A=^|"A/prior.gld"|A'
$gtm_dist/mupip set -replication=on -region AREG
./replicating_start A 4001
./repl_status
#Perform a switchover to return to the A-&gt;B configuration. Remove the global in the prior location to release space with a command like Kill ^A=^|"A/prior.gld"|A'. </pre><p>The shutdown sequence is as follows:</p><pre class="programlisting">source ./gtmenv A V6.3-000A_x86_64
./replicating_stop
source ./gtmenv B V6.3-000A_x86_64
./originating_stop</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="roll_sft_upg"/>Rolling Software Upgrade</h3></div></div></div><p>A rolling software upgrade is the procedure of upgrading an instance in a way that there is minimal impact on the application uptime. An upgrade may consist of changing the underlying database schema, region(s), global directory, database version, application version, triggers, and so on. There are two approaches for a rolling upgrade. The first approach is to upgrade the replicating instance and then upgrade the originating instance. The second approach is to upgrade the originating instance  first while its replicating (standby) instance acts as an originating instance. </p><p>The following two procedures demonstrate these rolling software upgrade approaches for upgrading an Aa??B replication configuration running an application using GT.M V6.1-000_x86_64 to GT.M V6.2-001_x86_64 with minimal (a few seconds) impact on the application downtime. </p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="upg_repl_first"/>Upgrade the replicating instance first (Aa??B)</h4></div></div></div><p>On B:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Shut down the passive Source and Receiver Servers and the application. </p></li><li class="listitem"><p>Turn off replication. </p></li><li class="listitem"><p>Perform a MUPIP RUNDOWN operation and make a backup.</p></li><li class="listitem"><p>Open DSE, run DUMP -FILEHEADER for each region (FIND -REGION=&lt;Region_Name&gt;) and note down the largest Region Seqno. </p></li><li class="listitem"><p>Upgrade the instance. An upgrade may include include adding triggers, adding/removing regions, changing GDE mapping, and so on. </p></li><li class="listitem"><p>Open DSE again, run DSE DUMP -FILEHEADER for each region (FIND -REGION=&lt;Region_Name&gt;) and note down the largest Region Seqno. If the largest Region Seqno noted in step 4 and largest Region Seqno noted in this step are the same, proceed to step 7. Otherwise, execute DSE CHANGE -FILEHEADER -
REG_SEQNO=&lt;Largest_Region_Seqno_from_step_4&gt; for the region having the largest Region Seqno. </p></li><li class="listitem"><p>Cut the back links to the prior generation journal files with a command like: </p><pre class="programlisting">$gtm_dist/mupip set -journal=on,before_images,filename=B/gtm.mjl -noprevjnlfile -region "DEFAULT"</pre></li><li class="listitem"><p>Turn on replication. </p></li><li class="listitem"><p>If the use of replication filters apply to your situation, bring up the replicating instance with the new-to-old filter on the Source Server of A, and the old-to-new filter on the Receiver Server of B. Otherwise, bring up the replicating instance on B. </p></li><li class="listitem"><p>Wait for B to automatically catup up the pending updates from A. </p></li></ol></div><p>on A:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>When there are no/low updates on A, shut down the Source Server. </p></li><li class="listitem"><p>Turn off replication. </p></li><li class="listitem"><p>Perform a MUPIP RUNDOWN and make a backup copy of the database.</p></li><li class="listitem"><p>Perform a switchover to make B the originating instance. Apply lost/broken transactions, if any, on B. </p></li><li class="listitem"><p>Open DSE, run DUMP -FILEHEADER for each region (FIND -REGION=&lt;Region_Name&gt;) and note down the largest Region Seqno. </p></li><li class="listitem"><p>Upgrade the instance. An upgrade may include include adding triggers, adding/removing regions, changing GDE mapping, and so on. </p></li><li class="listitem"><p>Open DSE again, run DSE DUMP -FILEHEADER for each region (FIND -REGION=&lt;Region_Name&gt;) and note down the largest Region Seqno. If the largest Region Seqno noted in step 5 and largest Region Seqno noted in this step are the same, proceed to step 8. Otherwise, execute DSE CHANGE -FILEHEADER -REG_SEQNO=&lt;Largest_Region_Seqno_from_step_5&gt; for the region having the largest Region Seqno. </p></li><li class="listitem"><p>Cut the back links to the prior generation journal files with a command like: </p><pre class="programlisting">$gtm_dist/mupip set -journal=on,before_images,filename=A/gtm.mjl -noprevjnlfile -region DEFAULT</pre></li><li class="listitem"><p>Turn on replication. </p></li><li class="listitem"><p>Start the Receiver Server of A. </p></li></ol></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="upd_orig_first"/>Upgrade the originating instance first (Aa??B)</h4></div></div></div><p>on A:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>When there are no updates on A and both A and B are in sync, shut down the Source Server.</p></li><li class="listitem"><p>Turn off replication. </p></li><li class="listitem"><p>Perform a MUPIP RUNDOWN and make a backup copy of the database.</p></li><li class="listitem"><p>Perform a switchover to make B the originating instance. This ensure application availability during the upgrade of A. </p></li><li class="listitem"><p>Open DSE, run DUMP -FILEHEADER for each region (FIND -REGION=&lt;Region_Name&gt;) and note down the largest Region Seqno. </p></li><li class="listitem"><p>Upgrade the instance. An upgrade may include include adding triggers, adding/removing regions, changing GDE mapping, upgrading the GT.M version, and so on. </p></li><li class="listitem"><p>Open DSE again, run DSE DUMP -FILEHEADER for each region (FIND -REGION=&lt;Region_Name&gt;) and note down the largest Region Seqno. If the largest Region Seqno noted in step 5 and largest Region Seqno noted in this step are the same, proceed to step 8. Otherwise, execute DSE CHANGE -FILEHEADER -REG_SEQNO=&lt;Largest_Region_Seqno_from_step_5&gt; for the region having the largest Region Seqno. </p></li><li class="listitem"><p>Cut the back links to the prior generation journal files with a command like: </p><pre class="programlisting">$gtm_dist/mupip set -journal=on,before_images,filename=A/gtm.mjl -noprevjnlfile -region DEFAULT</pre></li><li class="listitem"><p>Turn on replication. </p></li><li class="listitem"><p>If the use of replication filters apply to your situation, bring up the Receiver Server with the old-to-new filter. Otherwise bring up the Receiver Server. </p></li><li class="listitem"><p>Wait for A to automatically catch up the pending updates from B.  </p></li></ol></div><p>on B:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>When there are no/low updates on A, shut down the Source Server. </p></li><li class="listitem"><p>Turn off replication. </p></li><li class="listitem"><p>Perform a MUPIP RUNDOWN and make a backup copy of the database. </p></li><li class="listitem"><p>Perform a switchover to reinstate A as the originating instance. This ensures application availability during the upgrade of B. </p></li><li class="listitem"><p>Open DSE, run DUMP -FILEHEADER for each region (FIND -REGION=&lt;Region_Name&gt;) and note down the largest Region Seqno.</p></li><li class="listitem"><p>Upgrade the instance. An upgrade may include include adding triggers, adding/removing regions, changing GDE mapping, and so on. </p></li><li class="listitem"><p>Open DSE again, run DSE DUMP -FILEHEADER for each region (FIND -REGION=&lt;Region_Name&gt;) and note down the largest Region Seqno. If the largest Region Seqno noted in step 5 and largest Region Seqno noted in this step are the same, proceed to step 8. Otherwise, execute DSE CHANGE -FILEHEADER -REG_SEQNO=&lt;Largest_Region_Seqno_from_step_5&gt; for the region having the largest Region Seqno. </p></li><li class="listitem"><p>Cut the back links to the prior generation journal files with a command like: </p><pre class="programlisting">$gtm_dist/mupip set -journal=on,before_images,filename=B/gtm.mjl -noprevjnlfile -region DEFAULT</pre></li><li class="listitem"><p>Turn on replication. </p></li><li class="listitem"><p>Start the Receiver Server of B. </p></li><li class="listitem"><p>The upgrade of A and B is complete. </p></li></ol></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Important: Note on Triggers"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Important]" src="../common/images/important.jpg"/></td><th align="left">Note on Triggers</th></tr><tr><td align="left" valign="top"><p>While adding triggers, bear in mind that triggers get replicated if you add them when replication is turned on. However, when you add triggers when replication is turned off, those triggers and the database updates resulting from the executing their trigger code do not get replicated.</p></td></tr></table></div><p>Here is an example to upgrade A and B deployed in an Aa??B replication configuration from V6.1-000_x86_64 to V6.2-001_x86_84. This example uses instructions from the <a class="xref" href="ch07s03.html#upd_orig_first" title="Upgrade the originating instance first (Aa??B)">a??Upgrade the originating instance first (Aa??B)a??</a> procedure. </p><pre class="programlisting">source ./env A V6.1-000_x86_64
./db_create
./repl_setup
./originating_start A B 4001
source ./env B V6.1-000_x86_64
./db_create
./repl_setup
./replicating_start B 4001
source ./env A V6.1-000_x86_64
$gtm_dist/mumps -r %XCMD 'for i=1:1:100 set ^A(i)=i'
./status
source ./env B V6.1-000_x86_64
./replicating_stop
source ./env A V6.1-000_x86_64
./status
./originating_stop 
$gtm_dist/mupip set -replication=off -region "DEFAULT"
$gtm_dist/dse dump -f 2&gt;&amp;1| grep "Region Seqno"
#Perform a switchover to make B the originating instance. 
source ./env A V6.2-001_x86_64
$gtm_dist/mumps -r ^GDE exit
$gtm_dist/mupip set -journal=on,before_images,filename=A/gtm.mjl -noprevjnlfile -region "DEFAULT"
#Perform the upgrade 
$gtm_dist/dse dump -fileheader 2&gt;&amp;1| grep "Region Seqno"
#If Region Seqno is greater than the Region Seqno noted previously, run $gtm_dist/dse change -fileheader -req_seqno=&lt;previously_noted_region_seqno&gt;.
./repl_setup
#A is now upgraded to V6.2-001_x86_64 and is ready to resume the role of the originating instance. Shutdown B and reinstate A as the originating instance. 
./originating_start A B 4001
source ./env B V6.2-001_x86_64
$gtm_dist/mumps -r ^GDE exit
$gtm_dist/mupip set -journal=on,before_images,filename=B/gtm.mjl -noprevjnlfile -region "DEFAULT"
#Perform the upgrade 
$gtm_dist/dse dump -fileheader 2&gt;&amp;1| grep "Region Seqno"
#If Region Seqno is different, run $gtm_dist/dse change -fileheader -req_seqno=&lt;previously_noted_region_seqno&gt;.
$gtm_dist/dse dump -f 2&gt;&amp;1| grep "Region Seqno"
#If Region Seqno is greater than the Region Seqno noted previously, run $gtm_dist/dse change -fileheader -req_seqno=&lt;previously_noted_region_seqno&gt;.
./repl_setup
./replicating_start B 4001</pre><p>The shutdown sequence is as follows:</p><pre class="programlisting">source ./env B V6.2-001_x86_64
./replicating_stop
source ./env A V6.2-001_x86_64
./originating_stop</pre></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="shut_inst"/>Shutting down an instance</h3></div></div></div><p>To shutdown an originating instance:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Shut down all GT.M and mupip processes that might be attached to the Journal Pool.</p></li><li class="listitem"><p>In case the originating instance is also a supplementary instance, shutdown the Receiver Server(s) (there might be more than one Receiver Server in future GT.M versions).</p></li><li class="listitem"><p>Shut down all active and/or passive Source Servers.</p></li><li class="listitem"><p>Execute mupip rundown -region to ensure that the database, Journal Pool, and Receiver Pool shared memory is rundown properly.</p></li></ul></div><p>To shutdown a propagating instance:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Shut down all replicating instance servers (Receiver Server, Update Process and its Helper processes).</p></li><li class="listitem"><p>Shutdown the originating instance servers (all active and/or passive Source Servers).</p></li><li class="listitem"><p>On its replicating instances, ensure that there are no GT.M or MUPIP processes attached to the Journal Pool as updates are disabled (they are enabled only on the originating instance).</p></li><li class="listitem"><p>Execute mupip rundown -region to ensure that the database, Journal Pool, and Receiver Pool shared memory is rundown properly.</p></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="up_re_in_fi"/>Creating a new Replication Instance File</h3></div></div></div><p>You do not need to create a new replication instance file except when you upgrade from a GT.M version prior to V5.5-000. Unless stated in the release notes of your GT.M version, you instance file does not need to be upgraded. If you are creating a new replication instance file for any administration purpose, remember that doing do so will remove history records which may prevent it from resuming replication with other instances. To create a new replication instance file, follow these steps:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Shut down all mumps, MUPIP and DSE processes except Source and Receiver Server processes; then shut down the Receiver Server (and with it, the Update Process) and all Source Server processes. Use MUPIP RUNDOWN to confirm that all database files of the instance are closed and there are no processes accessing them.</p></li><li class="listitem"><p>Create a new replication instance file (you need to provide the instance name and instance file name, either with command line options or in environment variables, as described in other examples of this section):</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>If this is instance is to receive SI replication or to receive BC replication from an instance that receives SI replication, use the command:</p><pre class="programlisting"> mupip replicate -instance_create -supplementary</pre></li><li class="listitem"><p>Otherwise use the command:</p><pre class="programlisting">mupip replicate -instance_create</pre></li><li class="listitem"><p>If a replication instance file already exists, these commands will create a backup copy of the replicating instance and then create a new replication instance file. If you want to prevent accidental overwriting your existing replication instance file, use the -noreplace qualifier with these commands. </p></li></ul></div></li><li class="listitem"><p>Prepare it to accept a replication stream:</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>Start a passive Source Server. If this is an SI replicating instance, use the -updok flag to start the passive Source Server.</p></li><li class="listitem"><p>Start the Receiver Server using the updateresync. For versions prior to V5.5-000 use the -updateresync qualifier and for GT.M versions V5.5-000 or newer use -updateresync=&lt;repl_inst&gt;.For example, mupip replicate -receiver -start -updateresync=&lt;repl_inst&gt; where repl_inst is the prior replication file if the source is V5.5-000 or newer and -updateresync if it is an older GT.M release.</p></li></ul></div></li><li class="listitem"><p>Start a Source Server on a root or propagating primary instance to replicate to this instance. Verify that updates on the source instance are successfully replicated to the receiver instance.</p></li></ul></div><p>The -updateresync qualifier indicates that instead of negotiating a mutually agreed common starting point for synchronization the operator is guaranteeing the receiving instance has a valid state that matches the source instance currently or as some point in the past. Generally this means the receiving instance has just been updated with a backup copy from the source instance.</p><p>On instances with the same endian-ness, follow these steps to create a replication instance file without using the -updateresync qualifier. </p><p>On the source side:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Use the MUPIP BACKUP command with the -REPLINSTANCE qualifier to backup the instance to be copied.  The source server for the instance must be started at least once before backing up the replication instance file.</p></li><li class="listitem"><p>Ship the backed up databases and instance file to the receiving side.</p></li></ul></div><p>On the receiving side:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Run the MUPIP REPLIC -EDITINST command on the backed up instance file to change the instance name to reflect the target instance. This makes the source replication instance file usable on the target instance while preserving the history records in the instance file.</p></li><li class="listitem"><p>Create new journal files, start a passive Source Server and a Receiver Server (without an -updateresync qualifier).</p></li><li class="listitem"><p>Allow a Source Server to connect.</p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Note]" src="../common/images/note.jpg"/></td><th align="left"/></tr><tr><td align="left" valign="top"><p>When the instances have different endian-ness, create a new replication instance file as described in <a class="xref" href="replication.html#create_repl_inst" title="Creating the Replication Instance File">a??<span>Creating the Replication Instance File</span>a??</a></p></td></tr></table></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="tls_repl_proc"/>Setting up a secured TLS replication connection</h3></div></div></div><p>The following example creates two instances (Alice and Bob) and a basic framework required for setting up a TLS replication connection between them. Alice and Bob are fictional characters from <a class="ulink" href="https://en.wikipedia.org/wiki/Alice_and_Bob" target="_top">https://en.wikipedia.org/wiki/Alice_and_Bob</a> and represent two instances who use the certificates signed by the same demo root CA. This example is solely for the purpose of explaining the general steps required to encrypt replication data in motion. You must understand, and appropriately adjust, the scripts before using them in a production environment. Note that all certificates created in this example are for the sake of explaining their roles in a TLS replication environment. For practical applications, use certificates signed by a CA whose authority matches your use of TLS.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Remove the comment tags from the following lines in the gtmenv script:</p><pre class="programlisting">export gtmcrypt_config=$PWD/$gtm_repl_instname/config_file
echo -n "Enter Password for gtmtls_passwd_${gtm_repl_instname}: ";export gtmtls_passwd_${gtm_repl_instname}="`$gtm_dist/plugin/gtmcrypt/maskpass|tail -n 1|cut -f 3 -d " "`"</pre></li><li class="listitem"><p>Execute the gtmenv script as follows:</p><pre class="programlisting">$ source ./gtmenv Alice V6.2-001_x86_64</pre><p>This creates a GT.M environment for replication instance name Alice. When prompted, enter a password for gtmtls_passwd_Alice. </p></li><li class="listitem"><pre class="programlisting">./db_create</pre><p>This creates the global directory and the database for instance Alice. </p></li><li class="listitem"><p>Create a demo root CA, leaf-level certificate, and a $gtmcrypt_config file with a tlsid called Alice for instance Alice. Note that in this example, $gtmcrypt_config is set to $PWD/Alice/config_file. For more information on creating the $gtmcrypt_config file and the demo certificates required to run this example, refer to <a class="xref" href="TLS_Configuration_File.html" title="AppendixA G.A Creating a $gtmcrypt_config file">AppendixA G: a??<em>Creating a $gtmcrypt_config file</em>a??</a>. </p><p>Your $gtmcrypt_config file should look something like:</p><pre class="programlisting">tls: {
    verify-depth: 7;
     CAfile: "/path/to/certs/ca.crt";
     Alice: {
           format: "PEM";
           cert: "/path/to/certs/Alice.crt";
           key: "/path/to/certs/Alice.key";
     };
  };</pre></li><li class="listitem"><p>Turn replication on and create the replication instance file: </p><pre class="programlisting">$ ./repl_setup</pre></li><li class="listitem"><p>Start the originating instance Alice:</p><pre class="programlisting">$ ./originating_start Alice Bob 4001 -tlsid=Alice -reneg=2</pre></li></ol></div><p>On instance Bob:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Execute the gtmenv script as follows:</p><pre class="programlisting">$ source ./gtmenv Bob V6.2-001_x86_64</pre><p>This creates a GT.M environment for replication instance name Bob. When prompted, enter a password for gtmtls_passwd_Bob. </p></li><li class="listitem"><pre class="programlisting">$ ./db_create</pre><p>This creates the global directory and the database for instance Bob. </p></li><li class="listitem"><p>Create a leaf-level certificate and a $gtmcrypt_config file with a tlsid called Bob for instance Bob. Note that in this example, $gtmcrypt_config is set to $PWD/Bob/config_file. Note that you would use the demo CA that you created before to sign this leaf-level certificate. For replication to proceed, both leaf-level certificates must be signed by the same root CA. For more information, refer to <a class="xref" href="TLS_Configuration_File.html" title="AppendixA G.A Creating a $gtmcrypt_config file">AppendixA G: a??<em>Creating a $gtmcrypt_config file</em>a??</a>. </p><p>Your $gtmcrypt_config file should look something like:</p><pre class="programlisting">tls: {
    verify-depth: 7;
     CAfile: "/path/to/certs/ca.crt";
     Bob: {
           format: "PEM";
           cert: "/path/to/certs/Bob.crt";
           key: "/path/to/certs/Bob.key";
     };
  };</pre></li><li class="listitem"><p>Turn replication on and create the replication instance file:</p><pre class="programlisting">$ ./repl_setup</pre></li><li class="listitem"><p>Start the replicating instance Bob.</p><pre class="programlisting">$ ./replicating_start Bob 4001 -tlsid=Bob</pre></li></ol></div><p>For subsequent environment setup, use the following commands:</p><pre class="programlisting">source ./gtmenv Bob V6.2-001_x86_64 or source ./gtmenv Alice V6.2-001_x86_64
./replicating_start Bob 4001 -tlsid=Bob or ./originating_start Alice Bob 4001 -tlsid=Alice -reneg=2</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="schema_chng_filters"/>Schema Change Filters<a id="d0e28037" class="indexterm"/>
</h3></div></div></div><p>Filters between the originating and replicating systems perform rolling upgrades that involve database schema changes. The filters manipulate the data under the different schemas when the software revision levels on the systems differ.</p><p>GT.M provides the ability to invoke a filter; however, an application developer must write the filters specifically as part of each application release upgrade when schema changes are involved. </p><p>Filters should reside on the upgraded system and use logical database updates to update the schema before applying those updates to the database. The filters must invoke the replication Source Server (new schema to old) or the database replication Receiver Server (old schema to new), depending on the system's status as either originatig or replicating. For more information on Filters, refer to <a class="xref" href="ch07s01.html#Filters" title="Filters">a??Filtersa??</a>. </p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="recwason"/>Recovering from the replication WAS_ON state </h3></div></div></div><p>If you notice the replication WAS_ON state, correct the cause that made GT.M turn journaling off and then execute MUPIP SET -REPLICATION=ON.</p><p>To make storage space available, first consider moving unwanted non-journaled and temporary data. Then consider moving the journal files that predate the last backup. Moving the currently linked journal files is a very last resort because it disrupts the back links and a rollback or recover will not be able to get back past this discontinuity unless you are able to return them to their original location.</p><p>If the replication WAS_ON state occurs on the originating side:</p><p>If the Source Server does not reference any missing journal files, -REPLICATION=ON resumes replication with no downtime.</p><p>If the Source Server requires any missing journal file, it produces a REPLBRKNTRANS or NOPREVLINK error and shuts down. Note that you cannot rollback after journaling turned off because there is insufficient information to do such a rollback.</p><p>In this case, proceed as follows:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Take a backup (with MUPIP BACKUP -BKUPDBJNL=OFF -REPLINST=&lt;bckup_inst&gt;) of the originating instance.</p></li><li class="listitem"><p>Because journaling was turned off in the replication WAS_ON state, the originating instance cannot be rolled back to a state prior to the start of the backup. Therefore, cut the previous generation link of the journal files on the originating instance and turn replication back on. Both these operations can be accomplished with  MUPIP SET -REPLICATION="ON".
</p></li><li class="listitem"><p>Restore the replicating instance from the backup of the originating instance. Change the instance name of &lt;bckup_inst&gt; to the name of the replicating instance (with MUPIP REPLIC -EDITINST -NAME).</p></li><li class="listitem"><p>Turn on replication and journaling in the restored replicating instance. Specify the journal file pathname explicitly with MUPIP SET -JOURNAL=filename=&lt;repinst_jnl_location&gt; (as the backup database has the originating instance's journal file pathname).</p></li><li class="listitem"><p>Restart the Source Server process on the originating instance.</p></li><li class="listitem"><p>Start the Receiver Server (with no -UPDATERESYNC) the replicating instance.</p></li></ol></div><p>If the replication WAS_ON state occurs on the receiving side:</p><p>Execute MUPIP SET -REPLICATION=ON to return to the replication ON state. This resumes normal replication on the receiver side. As an additional safety check, extract the journal records of updates that occurred during the replication WAS_ON state on the originating instance and randomly check whether those updates are present in the receiving instance.</p><p>If replication does not resume properly (due to errors in the Receiver Server or Update Process), proceed as follows:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Take a backup (with MUPIP BACKUP -BKUPDBJNL=OFF -REPLINST=&lt;bckup_inst&gt;) of the originating instance.</p></li><li class="listitem"><p>Restore the replicating instance from the backup of the originating instance. Change the instance name of &lt;bckup_inst&gt; to the name of the replicating instance (with MUPIP REPLIC -EDITINST -NAME).</p></li><li class="listitem"><p>Turn on replication and journaling in the restored replicating instance. Specify the journal file pathname explicitly with MUPIP SET -JOURNAL=filename=&lt;repinst_jnl_location&gt; (as the backup database has the originating instance's journal file pathname).</p></li><li class="listitem"><p>Restart the Source Server process on the originating instance. Normally, the Source Server might still be running on the originating side.</p></li><li class="listitem"><p>Start the Receiver Server (with no -UPDATERESYNC) the replicating instance.</p></li></ol></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="rollbidle"/>Rollback data from crashed (idle) regions</h3></div></div></div><p>When a rollback operations fails with CHNGTPRSLVTM, NOPREVLINK, and JNLFILEOPENERR messages, evaluate whether you have a crashed region in your global directory that is seldom used for making updates (idle). The updates in an idle region's current generation journal file may have timestamps and sequence numbers that no longer exist in the prior generation journal file chains of more frequently updated regions because of periodic pruning of existing journal files as part of routine maintenance. MUPIP SET and BACKUP commands can also remove previous generation journal file links.</p><p>Terminating a process accessing an idle region abnormally (say with kill -9 or some other catastrophic event) may leave its journal files improperly closed. In such an case, the discrepancy may go unnoticed until the next database update or rollback. Performing a rollback including such an idle region may then resolve the unified rollback starting time, (reported with a CHNGTPRSLVTM message), to a point in time that does not exist in the journal file chain for the other regions, thus causing the rollback to fail.</p><p>In this rare but possible condition, first perform a rollback selectively for the idle region(s). Here are the steps:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Create a temporary global directory which maps only the idle region(s) by mapping one, often the only, such idle region's file to the default region.</p></li><li class="listitem"><p>Set the environment variable gtmgbldir to point to the temporary global directory.</p></li><li class="listitem"><p>Perform an optimal rollback (MUPIP JOURNAL -ROLLBACK -BACKWARD "*") </p></li><li class="listitem"><p>Analyze and process any broken or lost transaction files that the rollback procedure may generate. </p></li><li class="listitem"><p>Set the environment variable gtmgbldir to point back to the location of the global directory for your application. </p></li><li class="listitem"><p>Perform a normal rollback for your application. </p></li></ol></div><p>You do not need to perform these steps if you have a non-replicated but journaled database because RECOVER operations do not coordinate across regions.</p><p>As a general practice, perform an optimal recovery/rollback every time when starting a GT.M application from quiescence and, depending on the circumstances, after a GT.M process terminates abnormally.</p><p>FIS recommends rotating journal files with MUPIP SET when removing old journal files or ensuring that all regions are periodically updated.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="updateresyncproc1"/>Setting up a new replicating instance of an originating instance (Aa??B,
Pa??Q, or Aa??P)</h3></div></div></div><p>To set up a new replicating instance of an originating instance for the first time or to replace a replicating instance if database and instance file get deleted, you need to create the replicating instance from a backup of the originating instance, or one of its replicating instances. </p><p>If you are running GT.M V5.5-000 or higher:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Take a backup of the database and the replication instance file of the originating instance together at the same time with BACKUP 
-REPLINSTANCE and transfer them to the location of the replicating instance. If the originator's replicating instance file was newly
created, take its backup while the Source Server is running to ensure that the backup contains at least one history record. </p></li><li class="listitem"><p>Use MUPIP REPLICATE -EDITINST -NAME=&lt;secondary-instname&gt; to change the replicating instance's name. </p></li><li class="listitem"><p>Start the replicating instance without -udpateresync. </p></li></ul></div><p>If you are running GT.M pre-V5.5-000:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Create a new replication instance file on the replicating instance.</p></li><li class="listitem"><p>Start the replicating instance with this new replication instance file with the -updateresync qualifier (no value specified).</p></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="updateresyncproc2"/>Replacing the replication instance file of a replicating instance (Aa??B
and Pa??Q)</h3></div></div></div><p>In this case, it is possible that the replicating instance's database files are older than the originating instance. Note that to resume replication there is no need to transfer the backup of the originating instance's database and replication instance files. </p><p>To replace the existing replicating instance file with a new replication instance file, follow these steps: </p><p>If you are running GT.M V5.5-000 or higher:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Take a backup of just the replication instance file (no database files with 
BACKUP -REPLINST=&lt;/path/to/bkup-orig-repl-inst-file&gt;)
and transfer it to the site of the replicating instance.</p></li><li class="listitem"><p>Start the replicating instance with -updateresync=&lt;/path/to/bkup-orig-repl-inst-file&gt;.
</p></li></ul></div><p>In this case, the Receiver Server determines the current instance's journal sequence number by taking a maximum of the Region Sequence Numbers in the database file headers on the replicating instance and uses use the input instance file to locate the history record corresponding to this journal sequence number, and exchanges this
history information with the Source Server.</p><p>If you are running GT.M pre-V5.5-000:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Create a new replication instance file on the replicating instance. </p></li><li class="listitem"><p>Start the replicating instance with this new instance file with the -updateresync qualifier (no value specified).</p></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="updateresyncproc3"/>Replacing the replication instance file of a replicating instance (Aa??P)</h3></div></div></div><p>On P:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Use the -SUPPLEMENTARY qualifier with the MUPIP REPLICATE -INSTANCE_CREATE command to indicate this is a supplementary instance file.</p></li><li class="listitem"><p>Start a Source Server on P with -UPDOK to indicate local updates are enabled on P.</p></li><li class="listitem"><p>Start the Receiver Server on P with the -UPDATERESYNC=&lt;/path/to/bkup-orig-repl-inst-file&gt;
qualifier and -RESUME. -RESUME indicates that A and P had been replicating before. The Receiver Server looks at the local (stream #0) sequence numbers in the database file headers on P and takes the maximum value to determine the journal sequence number of the new stream on P. It then uses this as the instance journal sequence number on A to resume  replication.</p></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="updateresyncproc4"/>Setting up a new replicating instance from a backup of the originating instance
(Aa??P)</h3></div></div></div><p>On A:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Take a backup of the replication instance file and the database together at the same time with BACKUP -REPLINSTANCE and transfer it to P. If the A's replication instance file was also freshly created, then take the backup while the Source Server is running on the originating instance. This ensures that the backed up replication instance file
contains at least one history record.</p></li></ul></div><p>On P:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Create a new replication instance file. Use the -SUPPLEMENTARY qualifier with the MUPIP REPLICATE -INSTANCE_CREATE command to indicate this is a supplementary instance file.</p></li><li class="listitem"><p>Restore the database backups from A to P or use MUPIP LOAD to load the data.</p></li><li class="listitem"><p>Start a Source Server on P with -UPDOK to indicate local updates are enabled on P.</p></li><li class="listitem"><p>Start the Receiver Server on P with the -UPDATERESYNC=&lt;/path/to/bkup-orig-repl-inst-file&gt;
        qualifier and -INITIALIZE. The -INITIALIZE indicates this is the first time A and P are replicating.</p></li></ul></div><p>In this case, the Receiver Server uses the current journal sequence number in the &lt;/path/to/bkup-orig-repl-inst-file&gt; as the point where A starts sending journal records. GT.M updates the
stream sequence number of Stream # 1 in the instance file on P to reflect this value. From this point, GT.M maps the journal sequence number on A to a stream journal sequence number (for example, stream
# 1) on P.</p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="proc4"/>Setting up an Aa??P configuration for the first time if P is an existing instance (having
its own set of updates) </h3></div></div></div><p>On P:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Turn off passive Source Server and Receiver Server (if they are active).</p></li><li class="listitem"><p>Turn off replication and run down the database. </p></li></ul></div><p>On A:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Take
a backup of the replication instance file and the database together with BACKUP -REPLINSTANCE and transfer it to P. If A's instance file was also freshly created, take the backup while the Source Server is running on the originating instance. This ensures that the backed up replication instance file contains at least one history record.</p></li></ul></div><p>On P: </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Do not create a new instance file. Continue using the existing instance file to preserve updates that have already occurred on P.</p></li><li class="listitem"><p>Start the Source Server with -UPDOK to indicate that local updates are enabled on P.</p></li><li class="listitem"><p>Start the Receiver Server  with the -UPDATERESYNC=&lt;/path/to/bkup-orig-repl-inst-file&gt; qualifier and -INITIALIZE. The -INITIALIZE indicates this is the first time A and P are replicating.</p></li></ul></div><p>The Receiver Server uses the current journal sequence number in the &lt;/path/to/bkup-orig-repl-inst-file&gt;
 as the point where A starts sending journal records. GT.M updates the stream sequence number (for example, of Stream # 1) in the instance file on P to reflect this value. Going forward, the journal sequence number on A will always map to a stream journal sequence number (for example, of stream # 1) on P.</p></div></div><script type="text/javascript" src="../common/main.js"><!----></script><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch07s02.html">Prev</a>A </td><td width="20%" align="center"><a accesskey="u" href="ch07.html">Up</a></td><td width="40%" align="right">A <a accesskey="n" href="replication.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">A </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">A </td></tr></table></div></div><div><div id="leftnavigation" style="padding-top:3px; background-color:white;"><div id="tabs"><ul><li><a href="ch07s03.html#treeDiv"><em>Contents</em></a></li><li><a href="ch07s03.html#searchDiv"><em>Search</em></a></li></ul><div id="treeDiv"><img src="../common/images/loading.gif" alt="loading table of contents..." id="tocLoading" style="display:block;"/><div id="ulTreeDiv" style="display:none"><ul id="tree" class="filetree"><li><span class="file"><a href="preface.html">About This Manual </a></span><ul><li><span class="file"><a href="pr01s01.html">Intended Audience</a></span></li><li><span class="file"><a href="pr01s02.html">Purpose of the Manual</a></span></li><li><span class="file"><a href="pr01s03.html">How to Use This Manual</a></span></li><li><span class="file"><a href="pr01s04.html">Overview</a></span></li><li><span class="file"><a href="pr01s05.html">Conventions Used in This Manual</a></span></li></ul></li><li><span class="file"><a href="ch01.html">About GT.M</a></span><ul><li><span class="file"><a href="ch01s01.html">Hardware/Operating System Environment</a></span></li><li><span class="file"><a href="ch01s02.html">Installation</a></span></li><li><span class="file"><a href="ch01s03.html">Security</a></span></li><li><span class="file"><a href="ch01s04.html">Program Development Environment</a></span></li><li><span class="file"><a href="ch01s05.html">Database Subsystem</a></span></li><li><span class="file"><a href="ch01s06.html">GT.M Utility Programs</a></span><ul><li><span class="file"><a href="ch01s06.html#util_prog_gde">GDE</a></span></li><li><span class="file"><a href="ch01s06.html#util_mup">MUPIP</a></span></li><li><span class="file"><a href="ch01s06.html#lke_intr">LKE</a></span></li><li><span class="file"><a href="ch01s06.html#dse_intr">DSE </a></span></li><li><span class="file"><a href="ch01s06.html#comm_quals_utils">Command Qualifiers</a></span></li></ul></li><li><span class="file"><a href="ch01s07.html">Database Integrity</a></span></li><li><span class="file"><a href="ch01s08.html">Interprocess Communication</a></span></li></ul></li><li><span class="file"><a href="ch02.html">Installing GT.M</a></span><ul><li><span class="file"><a href="ch02s01.html">Obtaining GT.M Distribution Media</a></span></li><li><span class="file"><a href="ch02s02.html">Before you begin</a></span></li><li><span class="file"><a href="ch02s03.html">Installation Procedure</a></span><ul><li><span class="file"><a href="ch02s03.html#shr_lib_plu">Compiling the Reference Implementation Plugin </a></span><ul><li><span class="file"><a href="ch02s03.html#recompile_ref_impl">Instructions</a></span></li></ul></li></ul></li><li><span class="file"><a href="ch02s04.html">gtminstall script
  </a></span></li></ul></li><li><span class="file"><a href="ch03.html">Basic Operations</a></span><ul><li><span class="file"><a href="ch03s01.html">GT.M Environment Setup </a></span><ul><li><span class="file"><a href="ch03s01.html#gtmprofile_script">gtmprofile </a></span></li><li><span class="file"><a href="ch03s01.html#gtmcshrc">gtmcshrc</a></span></li><li><span class="file"><a href="ch03s01.html#gtmbase">gtmbase </a></span></li><li><span class="file"><a href="ch03s01.html#gdedefaults">gdedefaults</a></span></li><li><span class="file"><a href="ch03s01.html#gtm_script">gtm </a></span></li></ul></li><li><span class="file"><a href="ch03s02.html">Environment Variables</a></span></li><li><span class="file"><a href="ch03s03.html">Configuring and operating GT.M with UnicodeA(R) support (optional) </a></span><ul><li><span class="file"><a href="ch03s03.html#m_utf8_modes">M mode and UTF-8 mode </a></span></li><li><span class="file"><a href="ch03s03.html#compile_icu_gtm">Compiling ICU </a></span></li></ul></li><li><span class="file"><a href="ch03s04.html">Starting GT.M </a></span></li><li><span class="file"><a href="ch03s05.html">Configuring huge pages for GT.M x86[-64] on Linux</a></span><ul><li><span class="file"><a href="ch03s05.html#huge_use">Using huge pages</a></span><ul><li><span class="file"><a href="ch03s05.html#using_huge_pages">Using huge pages for shared memory</a></span></li><li><span class="file"><a href="ch03s05.html#using_huge_pages_for_ppm">Using huge pages for GT.M process private memory</a></span></li></ul></li></ul></li><li><span class="file"><a href="ch03s06.html">Configuring the Restriction facility</a></span><ul><li><span class="file"><a href="ch03s06.html#zsysfilter">ZSYSTEM and PIPE OPEN command restriction facility</a></span></li><li><span class="file"><a href="ch03s06.html#audit_principal_device">Audit Principal Device restriction facility</a></span><ul><li><span class="file"><a href="ch03s06.html#apd_logging">Logging</a></span></li></ul></li></ul></li></ul></li><li><span class="file"><a href="gdechap.html">Global Directory Editor</a></span><ul><li><span class="file"><a href="glbl_dir_intro.html">Global Directory</a></span></li><li><span class="file"><a href="gde_overview.html">GDE Overview</a></span><ul><li><span class="file"><a href="gde_overview.html#identifygd">Identifying the Current Global Directory</a></span></li><li><span class="file"><a href="gde_overview.html#creategd">Creating a Default Global Directory</a></span></li><li><span class="file"><a href="gde_overview.html#map_glbl">Mapping Global Variables in a Global Directory</a></span></li><li><span class="file"><a href="gde_overview.html#examine_def">Examining the Default Global Directory</a></span></li><li><span class="file"><a href="gde_overview.html#abbrev_gd">Global Directory Abbreviations</a></span></li><li><span class="file"><a href="gde_overview.html#custom_glbldir">Customizing a Global Directory</a></span><ul><li><span class="file"><a href="gde_overview.html#add_jrnl">Adding a Journaling Information Section</a></span></li></ul></li></ul></li><li><span class="file"><a href="using_gde.html">Using GDE</a></span><ul><li><span class="file"><a href="using_gde.html#map_guides">Guidelines for Mapping</a></span><ul><li><span class="file"><a href="using_gde.html#basic_map">Example of a Basic Mapping</a></span></li></ul></li></ul></li><li><span class="file"><a href="gdecmds.html">Global Director Editor Commands</a></span><ul><li><span class="file"><a href="gdecmds.html#specify_file_names_in_cmmd_lines">Specifying File Names in Command Lines</a></span></li><li><span class="file"><a href="gdecmds.html#fonts_conv">Font/Capitalization Conventions Used in this Chapter</a></span></li><li><span class="file"><a href="gdecmds.html#at_sign">@</a></span></li><li><span class="file"><a href="gdecmds.html#gde_add">Add</a></span><ul><li><span class="file"><a href="gdecmds.html#add_name">-Name</a></span></li><li><span class="file"><a href="gdecmds.html#add_seg">-Segment</a></span></li><li><span class="file"><a href="gdecmds.html#add_reg">-Region</a></span></li><li><span class="file"><a href="gdecmds.html#add_gbl">-Gblname</a></span></li></ul></li><li><span class="file"><a href="gdecmds.html#gde_change">Change</a></span></li><li><span class="file"><a href="gdecmds.html#gde_delete">Delete</a></span></li><li><span class="file"><a href="gdecmds.html#gde_exit">Exit</a></span></li><li><span class="file"><a href="gdecmds.html#gde_help">Help</a></span></li><li><span class="file"><a href="gdecmds.html#gde_locks">LOCks</a></span></li><li><span class="file"><a href="gdecmds.html#gde_log">LOG</a></span></li><li><span class="file"><a href="gdecmds.html#gde_quit">Quit</a></span></li><li><span class="file"><a href="gdecmds.html#gde_rename">Rename</a></span></li><li><span class="file"><a href="gdecmds.html#setgd">SEtgd</a></span></li><li><span class="file"><a href="gdecmds.html#gde_show">SHow</a></span></li><li><span class="file"><a href="gdecmds.html#gde_template">Template </a></span></li><li><span class="file"><a href="gdecmds.html#gde_verify">Verify</a></span></li></ul></li><li><span class="file"><a href="nameregseg.html">Name, Region, and Segment Qualifiers</a></span><ul><li><span class="file"><a href="nameregseg.html#name_qualifiers">Name Qualifiers</a></span></li><li><span class="file"><a href="nameregseg.html#region_qual">Region Qualifiers</a></span></li><li><span class="file"><a href="nameregseg.html#segment_quals">Segment Qualifiers</a></span></li><li><span class="file"><a href="nameregseg.html#gblname_qual">Gblname Qualifiers</a></span></li><li><span class="file"><a href="nameregseg.html#instance_qual">Instance Qualifier</a></span></li></ul></li><li><span class="file"><a href="gde_cmmd_summ.html">GDE Command Summary</a></span><ul><li><span class="file"><a href="gde_cmmd_summ.html#qual_summ">GDE Command Qualifier Summary</a></span></li></ul></li></ul></li><li><span class="file"><a href="mupipchap.html">General Database Management</a></span><ul><li><span class="file"><a href="mup_intro.html">Introduction</a></span><ul><li><span class="file"><a href="mup_intro.html#mup_operations">Operations - Standalone and Concurrent Access</a></span></li><li><span class="file"><a href="mup_intro.html#mupip_main">MUPIP</a></span></li></ul></li><li><span class="file"><a href="gdm.html">Commands and Qualifiers</a></span><ul><li><span class="file"><a href="gdm.html#mup_back">BACKUP</a></span><ul><li><span class="file"><a href="gdm.html#backup_bkupdbjnl">-BKupdbjnl</a></span></li><li><span class="file"><a href="gdm.html#backup_bytestream">-Bytestream</a></span></li><li><span class="file"><a href="gdm.html#backup_database">-Database</a></span></li><li><span class="file"><a href="gdm.html#backup_nettimeout">-NETtimeout</a></span></li><li><span class="file"><a href="gdm.html#mup_newjnlfiles">-NEWJNLFILES</a></span></li><li><span class="file"><a href="gdm.html#backup_online">-Online</a></span></li><li><span class="file"><a href="gdm.html#backup_record">-Record</a></span></li><li><span class="file"><a href="gdm.html#backup_replace">-REPLace</a></span></li><li><span class="file"><a href="gdm.html#backup_replinstance">-REPLInstance </a></span></li><li><span class="file"><a href="gdm.html#backup_since">-Since</a></span></li><li><span class="file"><a href="gdm.html#backup_transaction">-Transaction</a></span></li><li><span class="file"><a href="gdm.html#examples_mup_backup">Examples for MUPIP BACKUP</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_create">CREATE</a></span><ul><li><span class="file"><a href="gdm.html#create_region">-Region</a></span></li><li><span class="file"><a href="gdm.html#examples_mup_create">Examples for MUPIP CREATE</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_downgrade">DOWNGRADE</a></span><ul><li><span class="file"><a href="gdm.html#down_ver">-VERSION={V4|V5|V63000A}</a></span></li><li><span class="file"><a href="gdm.html#examples_mup_downgrade">Examples for MUPIP DOWNGRADE</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_dumpfhead">DUMPFHEAD</a></span><ul><li><span class="file"><a href="gdm.html#mup_dumpfhead_file">-FILE=file</a></span></li><li><span class="file"><a href="gdm.html#mup_dumpfhead_region">-REGION=region</a></span></li><li><span class="file"><a href="gdm.html#examples_mup_dumpfhead">Examples for MUPIP DUMPFHEAD</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_endiancvt">ENDIANCVT </a></span><ul><li><span class="file"><a href="gdm.html#endiancvt_override">-OVerride</a></span></li><li><span class="file"><a href="gdm.html#examples_mup_endiancvt">Examples for MUPIP ENDIANCVT</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_exit">EXIT</a></span></li><li><span class="file"><a href="gdm.html#mup_extend">EXTEND</a></span><ul><li><span class="file"><a href="gdm.html#extend_blocks">-Blocks</a></span></li><li><span class="file"><a href="gdm.html#examples_mup_extend">Examples for MUPIP EXTEND</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_extract">EXTRACT</a></span><ul><li><span class="file"><a href="gdm.html#extract_format">-FOrmat</a></span></li><li><span class="file"><a href="gdm.html#extract_freeze">-FReeze</a></span></li><li><span class="file"><a href="gdm.html#extract_label">-LAbel</a></span></li><li><span class="file"><a href="gdm.html#extract_log">-LOg</a></span></li><li><span class="file"><a href="gdm.html#extract_null_iv">-Null_iv</a></span></li><li><span class="file"><a href="gdm.html#extract_region">-Region</a></span></li><li><span class="file"><a href="gdm.html#extract_select">-Select</a></span></li><li><span class="file"><a href="gdm.html#extract_stdout">-STdout</a></span></li><li><span class="file"><a href="gdm.html#examples_mup_extract">Examples for MUPIP EXTRACT</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_freeze">FREEZE
</a></span><ul><li><span class="file"><a href="gdm.html#mup_freeze_off">-OFf</a></span></li><li><span class="file"><a href="gdm.html#mup_freeze_on">-ON</a></span></li><li><span class="file"><a href="gdm.html#mup_freeze_autorelease">-[NO]A[UTORELEASE</a></span></li><li><span class="file"><a href="gdm.html#mup_freeze_online">-ONLine</a></span></li><li><span class="file"><a href="gdm.html#mup_freeze_override">-OVerride</a></span></li><li><span class="file"><a href="gdm.html#mup_freeze_record">-Record</a></span></li><li><span class="file"><a href="gdm.html#examples_mup_freeze">Examples for MUPIP FREEZE</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_ftok">FTOK
</a></span><ul><li><span class="file"><a href="gdm.html#ftok_db">-DB</a></span></li><li><span class="file"><a href="gdm.html#ftok_jnlpool">-JNLPOOL</a></span></li><li><span class="file"><a href="gdm.html#ftok_recvpool">-RECVPOOL</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_hash">HASH</a></span></li><li><span class="file"><a href="gdm.html#mup_integ">INTEG
</a></span><ul><li><span class="file"><a href="gdm.html#integ_adjacency">-ADjacency</a></span></li><li><span class="file"><a href="gdm.html#integ_block">-BLock</a></span></li><li><span class="file"><a href="gdm.html#integ_brief">-BRief</a></span></li><li><span class="file"><a href="gdm.html#integ_fast">-FAst</a></span></li><li><span class="file"><a href="gdm.html#integ_file">-FIle</a></span></li><li><span class="file"><a href="gdm.html#integ_full">-FUll</a></span></li><li><span class="file"><a href="gdm.html#integ_keyranges">-Keyranges</a></span></li><li><span class="file"><a href="gdm.html#integ_map">-MAP</a></span></li><li><span class="file"><a href="gdm.html#integ_maxkeysize">-MAXkeysize</a></span></li><li><span class="file"><a href="gdm.html#integ_online">-Online </a></span></li><li><span class="file"><a href="gdm.html#integ_region">-Region</a></span></li><li><span class="file"><a href="gdm.html#integ_subscript">-Subscript</a></span></li><li><span class="file"><a href="gdm.html#integ_stats">-Stats</a></span></li><li><span class="file"><a href="gdm.html#tn_reset">-TN_reset</a></span></li><li><span class="file"><a href="gdm.html#integ_transaction">-TRansaction</a></span></li><li><span class="file"><a href="gdm.html#examples_mup_integ">Examples for MUPIP INTEG</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_intrpt">INTRPT
</a></span></li><li><span class="file"><a href="gdm.html#mup_journal">JOURNAL</a></span></li><li><span class="file"><a href="gdm.html#mup_load">LOAD</a></span><ul><li><span class="file"><a href="gdm.html#load_format">-FOrmat</a></span></li><li><span class="file"><a href="gdm.html#load_begin">-BEgin</a></span></li><li><span class="file"><a href="gdm.html#load_end">-End</a></span></li><li><span class="file"><a href="gdm.html#load_fillfactor">-FIll_factor</a></span></li><li><span class="file"><a href="gdm.html#load_onerror">-Onerror</a></span></li><li><span class="file"><a href="gdm.html#load_stdin">-Stdin
    </a></span></li><li><span class="file"><a href="gdm.html#examples_mup_load">Examples for MUPIP LOAD</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_rctldump">RCTLDUMP</a></span></li><li><span class="file"><a href="gdm.html#mup_reorg">REORG
</a></span><ul><li><span class="file"><a href="gdm.html#reorg_downgrade">-Downgrade</a></span></li><li><span class="file"><a href="gdm.html#reorg_encrypt">-Encrypt</a></span></li><li><span class="file"><a href="gdm.html#reorg_exclude">-Exclude</a></span></li><li><span class="file"><a href="gdm.html#reorg_fill_factor">-Fill_factor </a></span></li><li><span class="file"><a href="gdm.html#reorg_index_fill_factor">-Index_fill_factor</a></span></li><li><span class="file"><a href="gdm.html#reorg_keep">-Keep</a></span></li><li><span class="file"><a href="gdm.html#reorg_nocoalesce">-NOCOalesce</a></span></li><li><span class="file"><a href="gdm.html#reorg_nosplit">-NOSPlit</a></span></li><li><span class="file"><a href="gdm.html#reorg_noswap">-NOSWap</a></span></li><li><span class="file"><a href="gdm.html#reorg_resume">-Resume</a></span></li><li><span class="file"><a href="gdm.html#reorg_region">-Region</a></span></li><li><span class="file"><a href="gdm.html#reorg_select">-Select</a></span></li><li><span class="file"><a href="gdm.html#reorg_truncate">-Truncate</a></span></li><li><span class="file"><a href="gdm.html#reorg_upgrade">-UPgrade</a></span></li><li><span class="file"><a href="gdm.html#examples_mup_reorg">Examples for MUPIP REORG</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_replicate_cm">REPLICATE</a></span></li><li><span class="file"><a href="gdm.html#mup_restore">RESTORE</a></span><ul><li><span class="file"><a href="gdm.html#mup_restore_extend">-Extend
</a></span></li><li><span class="file"><a href="gdm.html#examples_mup_restore">Examples for MUPIP RESTORE</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_rundown">RUNDOWN</a></span><ul><li><span class="file"><a href="gdm.html#mup_rundown_file">-File</a></span></li><li><span class="file"><a href="gdm.html#mup_rundown_override">-Override</a></span></li><li><span class="file"><a href="gdm.html#mup_rundown_region">-Region</a></span></li><li><span class="file"><a href="gdm.html#mup_rundown_relinkctl">-Relinkctl</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_set">SET</a></span><ul><li><span class="file"><a href="gdm.html#set_file">-File</a></span></li><li><span class="file"><a href="gdm.html#set_jnlfile">-Jnlfile</a></span></li><li><span class="file"><a href="gdm.html#set_region">-Region</a></span></li><li><span class="file"><a href="gdm.html#set_replication">-REPlication</a></span></li><li><span class="file"><a href="gdm.html#set_access_method">-ACcess_method </a></span></li><li><span class="file"><a href="gdm.html#set_asyncio">-ASyncIO </a></span></li><li><span class="file"><a href="gdm.html#set_defer_time">-Defer_time </a></span></li><li><span class="file"><a href="gdm.html#set_deferallocate">-DEFER_Allocate </a></span></li><li><span class="file"><a href="gdm.html#set_epochtaper">-Epochtaper</a></span></li><li><span class="file"><a href="gdm.html#set_encryptable">-ENCRYPTAble</a></span></li><li><span class="file"><a href="gdm.html#set_encryptioncompelte">-ENCRYPTIoncomplete</a></span></li><li><span class="file"><a href="gdm.html#set_extension_count">-EXtension_count</a></span></li><li><span class="file"><a href="gdm.html#set_flush_time">-Flush_time</a></span></li><li><span class="file"><a href="gdm.html#set_global_buffers">-Global_buffers</a></span></li><li><span class="file"><a href="gdm.html#hard_spin_count">-Hard_spin_count</a></span></li><li><span class="file"><a href="gdm.html#inst_freeze_on_error">-INST_freeze_on_error</a></span></li><li><span class="file"><a href="gdm.html#set_journal">-Journal</a></span></li><li><span class="file"><a href="gdm.html#set_key_size">-Key_size </a></span></li><li><span class="file"><a href="gdm.html#set_lock_space">-Lock_space</a></span></li><li><span class="file"><a href="gdm.html#mutex_slots">-Mutex_slots</a></span></li><li><span class="file"><a href="gdm.html#null_subscripts">-Null_subscripts</a></span></li><li><span class="file"><a href="gdm.html#lck_shares_db_crit">-Lck_shares_db_crit</a></span></li><li><span class="file"><a href="gdm.html#set_qdbrundown">-Qdbrundown</a></span></li><li><span class="file"><a href="gdm.html#set_bypass_recov">-PArtial_recov_bypass</a></span></li><li><span class="file"><a href="gdm.html#set_read_only">-Read_only</a></span></li><li><span class="file"><a href="gdm.html#set_record_size">-RECord_size </a></span></li><li><span class="file"><a href="gdm.html#set_reserved_bytes">-REServed_bytes</a></span></li><li><span class="file"><a href="gdm.html#sleep_spin_count">-SLeep_spin_count
</a></span></li><li><span class="file"><a href="gdm.html#spin_sleep_mask">-Spin_sleep_mask</a></span></li><li><span class="file"><a href="gdm.html#set_stats">-STATs </a></span></li><li><span class="file"><a href="gdm.html#set_stdnullcoll">-STDnullcoll </a></span></li><li><span class="file"><a href="gdm.html#set_trigger_flush">-Trigger_flush </a></span></li><li><span class="file"><a href="gdm.html#set_version">-Version</a></span></li><li><span class="file"><a href="gdm.html#set_wait_disk">-WAit_disk </a></span></li><li><span class="file"><a href="gdm.html#set_writes_per_flush">-WRites_per_flush </a></span></li><li><span class="file"><a href="gdm.html#examples_mup_set">Examples for MUPIP SET</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_size">SIZE</a></span></li><li><span class="file"><a href="gdm.html#mup_stop">STOP
</a></span></li><li><span class="file"><a href="gdm.html#mup_trigger">TRIGGER</a></span><ul><li><span class="file"><a href="gdm.html#examples_mup_trigger">Examples for MUPIP TRIGGER</a></span></li></ul></li><li><span class="file"><a href="gdm.html#mup_gupgrade">UPGRADE
</a></span><ul><li><span class="file"><a href="gdm.html#examples_of_mup_upgrade">Example for MUPIP UPGRADE</a></span></li></ul></li></ul></li><li><span class="file"><a href="mup_summary.html">MUPIP Command Summary</a></span></li></ul></li><li><span class="file"><a href="journaling.html">GT.M Journaling</a></span><ul><li><span class="file"><a href="ch06s01.html">Introduction </a></span><ul><li><span class="file"><a href="ch06s01.html#jnl_files_intro">Journal Files </a></span></li><li><span class="file"><a href="ch06s01.html#jnl_recov_file">Recovery from a Journal File</a></span><ul><li><span class="file"><a href="ch06s01.html#for_recv">Forward Recovery</a></span></li><li><span class="file"><a href="ch06s01.html#backward_recovery_jnl">Backward Recovery </a></span></li></ul></li><li><span class="file"><a href="ch06s01.html#rolledback_files">rolled_bak* files</a></span></li><li><span class="file"><a href="ch06s01.html#jnl_fil_acc_auth">Journal Files Access Authorization</a></span></li><li><span class="file"><a href="ch06s01.html#trigg_jnl_fil">Triggers in Journal Files</a></span></li><li><span class="file"><a href="ch06s01.html#before_image_jnl">BEFORE_IMAGE Journaling  </a></span></li><li><span class="file"><a href="ch06s01.html#nobefore_image_jnl">NOBEFORE_IMAGE Journaling  </a></span></li><li><span class="file"><a href="ch06s01.html#choose_be_nobe">Choosing between BEFORE_IMAGE and NOBEFORE_IMAGE </a></span></li><li><span class="file"><a href="ch06s01.html#brk_trns_file">Broken Transaction File</a></span></li><li><span class="file"><a href="ch06s01.html#lost_transact_file">Lost Transaction File</a></span></li><li><span class="file"><a href="ch06s01.html#epoch_definition">Epoch</a></span></li><li><span class="file"><a href="ch06s01.html#jnl_benefits">Journaling Benefits </a></span></li><li><span class="file"><a href="ch06s01.html#backup_jnl_files">Backup Journal Files  </a></span></li><li><span class="file"><a href="ch06s01.html#sel_db_jnling">Select database files for Journaling  </a></span></li><li><span class="file"><a href="ch06s01.html#fencing_trans">Fencing Transactions </a></span></li><li><span class="file"><a href="ch06s01.html#to_jnl_or_no_jnl">Deciding Whether to Use Fencing </a></span><ul><li><span class="file"><a href="ch06s01.html#fencing_advantages">Fencing Advantages </a></span></li><li><span class="file"><a href="ch06s01.html#fencing_disadv">Fencing Disadvantages </a></span></li></ul></li><li><span class="file"><a href="ch06s01.html#jnl_view_keyword">VIEW Keywords</a></span></li><li><span class="file"><a href="ch06s01.html#view_funct_keywords_jnl">$VIEW() Keywords</a></span></li></ul></li><li><span class="file"><a href="mup_jnl_set.html">SET</a></span><ul><li><span class="file"><a href="mup_jnl_set.html#jnl_set_obj">SET Object Identifying Qualifiers </a></span></li><li><span class="file"><a href="mup_jnl_set.html#jnl_set_action">SET Action Qualifiers </a></span><ul><li><span class="file"><a href="mup_jnl_set.html#set_jnl_options">SET -JOURNAL Options </a></span></li></ul></li><li><span class="file"><a href="mup_jnl_set.html#jnl_examples_mup_set">Examples for MUPIP SET</a></span></li></ul></li><li><span class="file"><a href="mup_journal.html">JOURNAL
</a></span><ul><li><span class="file"><a href="mup_journal.html#jnl_action">Journal Action Qualifiers</a></span><ul><li><span class="file"><a href="mup_journal.html#jnl_extractstd">-EXtract[=&lt;file-name&gt;|-stdout]</a></span></li><li><span class="file"><a href="mup_journal.html#jnl_parallel">-PARA[LLEL][=n]</a></span></li><li><span class="file"><a href="mup_journal.html#recover">-RECover
</a></span></li><li><span class="file"><a href="mup_journal.html#rollback">-ROLLBACK [{-ON[LINE]|-NOO[NLINE]}]

</a></span></li><li><span class="file"><a href="mup_journal.html#show">-SHow=show-option-list





</a></span></li><li><span class="file"><a href="mup_journal.html#jnl_verify">-[NO]Verify</a></span></li></ul></li><li><span class="file"><a href="mup_journal.html#jnl_direction">Journal Direction Qualifiers</a></span></li><li><span class="file"><a href="mup_journal.html#jnl_time">Journal Time Qualifiers</a></span></li><li><span class="file"><a href="mup_journal.html#jnl_sequence">Journal Sequence Number Qualifiers</a></span></li><li><span class="file"><a href="mup_journal.html#jnl_ctrl_quals">Journal Control Qualifiers</a></span></li><li><span class="file"><a href="mup_journal.html#jnl_select">Journal Selection Qualifiers</a></span></li></ul></li><li><span class="file"><a href="jnl_ext.html">Journal Extract Formats</a></span></li></ul></li><li><span class="file"><a href="ch07.html">Database Replication</a></span><ul><li><span class="file"><a href="ch07s01.html">Introduction</a></span><ul><li><span class="file"><a href="ch07s01.html#db_trans_no">Database Transaction Number</a></span></li><li><span class="file"><a href="ch07s01.html#jnl_seq_no">Journal Sequence Number</a></span></li><li><span class="file"><a href="ch07s01.html#stm_seq_no">Stream Sequence Number</a></span></li><li><span class="file"><a href="ch07s01.html#repl_gesz">Using Multiple Instances in the same Process</a></span></li><li><span class="file"><a href="ch07s01.html#sppl_exampls">Examples</a></span><ul><li><span class="file"><a href="ch07s01.html#simp_examp">Simple Example</a></span></li><li><span class="file"><a href="ch07s01.html#d0e22224">Ensuring Consistency with Rollback</a></span></li><li><span class="file"><a href="ch07s01.html#rollback_design">Rollback Not Desired or Required by Application Design</a></span></li><li><span class="file"><a href="ch07s01.html#two_ori_pri_fail">Two Originating Primary Failures</a></span></li><li><span class="file"><a href="ch07s01.html#replication_on_rlbk">Replication and Online Rollback</a></span></li></ul></li><li><span class="file"><a href="ch07s01.html#si_repl_limits">Limitations - SI Replication</a></span></li><li><span class="file"><a href="ch07s01.html#Replication_Architecture">Replication Architecture

</a></span><ul><li><span class="file"><a href="ch07s01.html#helper_processes">Helper Processes</a></span></li><li><span class="file"><a href="ch07s01.html#Filters">Filters</a></span></li><li><span class="file"><a href="ch07s01.html#repl_instance_file">Replication Instance File</a></span></li></ul></li></ul></li><li><span class="file"><a href="ch07s02.html">Implementing Replication and Recovery</a></span><ul><li><span class="file"><a href="ch07s02.html#app_arch">Application Architecture</a></span><ul><li><span class="file"><a href="ch07s02.html#mssg">Implement a Message Delivery System</a></span></li></ul></li><li><span class="file"><a href="ch07s02.html#sys_req">System Requirements</a></span><ul><li><span class="file"><a href="ch07s02.html#prim_sec_stat_id">Root Primary Status Identification</a></span></li></ul></li><li><span class="file"><a href="ch07s02.html#failover_repl">Switchover

</a></span></li><li><span class="file"><a href="ch07s02.html#inst_freeze">Instance Freeze</a></span></li><li><span class="file"><a href="ch07s02.html#tls_repl">TLS/SSL Replication</a></span></li><li><span class="file"><a href="ch07s02.html#ntwrk_link">Network Link between Systems</a></span></li><li><span class="file"><a href="ch07s02.html#choosing_between">Choosing between BEFORE_IMAGE and NOBEFORE_IMAGE journaling</a></span><ul><li><span class="file"><a href="ch07s02.html#repl_recovr">Recovery</a></span></li><li><span class="file"><a href="ch07s02.html#comp_othr_recov">Comparison other than Recovery</a></span></li></ul></li><li><span class="file"><a href="ch07s02.html#repl_data_repair">Database Repair</a></span></li></ul></li><li id="webhelp-currentid"><span class="file"><a href="ch07s03.html">Procedures</a></span><ul><li><span class="file"><a href="ch07s03.html#downld_repl_ex">Download Replication Examples</a></span><ul><li><span class="file"><a href="ch07s03.html#procenv">env</a></span></li><li><span class="file"><a href="ch07s03.html#dbcreateproc">db_create</a></span></li><li><span class="file"><a href="ch07s03.html#backupreplproc">backup_repl</a></span></li><li><span class="file"><a href="ch07s03.html#replsetupproc">repl_setup</a></span></li><li><span class="file"><a href="ch07s03.html#originstartproc">originating_start</a></span></li><li><span class="file"><a href="ch07s03.html#replstartproc">replicating_start</a></span></li><li><span class="file"><a href="ch07s03.html#supplsetupproc">suppl_setup</a></span></li><li><span class="file"><a href="ch07s03.html#replstatusproc1">repl_status</a></span></li><li><span class="file"><a href="ch07s03.html#rollbackproc11">rollback</a></span></li><li><span class="file"><a href="ch07s03.html#originstop">originating_stop</a></span></li><li><span class="file"><a href="ch07s03.html#replstopproc">replicating_stop</a></span></li><li><span class="file"><a href="ch07s03.html#replstartsuppproc">replicating_start_suppl_n</a></span></li></ul></li><li><span class="file"><a href="ch07s03.html#abrepl1">Setting up an Aa??B replication configuration with empty databases</a></span></li><li><span class="file"><a href="ch07s03.html#abcrepl1">Setting up an Aa??Ba??C replication configuration with empty databases</a></span></li><li><span class="file"><a href="ch07s03.html#aprepl">Setting up an Aa??P replication configuration with empty databases</a></span></li><li><span class="file"><a href="ch07s03.html#riborg">Replicating Instance Starts from Backup of Originating Instance (Aa??B and Aa??P )</a></span></li><li><span class="file"><a href="ch07s03.html#nrml_cutov">Switchover possibilities in an Aa??B replication configuration</a></span></li><li><span class="file"><a href="ch07s03.html#recov_bap">Switchover possibilities in a Ba??Aa??P replication configuration </a></span><ul><li><span class="file"><a href="ch07s03.html#a_req_rlbk">A requires rollback</a></span></li><li><span class="file"><a href="ch07s03.html#ap_req_rllbk">A and P require rollback</a></span></li><li><span class="file"><a href="ch07s03.html#rollbk_nt_req">Rollback not required by application design</a></span></li><li><span class="file"><a href="ch07s03.html#automatic_rollback1">Rollback automatically</a></span></li></ul></li><li><span class="file"><a href="ch07s03.html#recov_bapq">Switchover possibilities in a Ba??Aa??Pa??Q replication configuration </a></span></li><li><span class="file"><a href="ch07s03.html#gldreplupd">Changing the global directory in an Aa??B replication configuration</a></span></li><li><span class="file"><a href="ch07s03.html#roll_sft_upg">Rolling Software Upgrade</a></span><ul><li><span class="file"><a href="ch07s03.html#upg_repl_first">Upgrade the replicating instance first (Aa??B)</a></span></li><li><span class="file"><a href="ch07s03.html#upd_orig_first">Upgrade the originating instance first (Aa??B)</a></span></li></ul></li><li><span class="file"><a href="ch07s03.html#shut_inst">Shutting down an instance</a></span></li><li><span class="file"><a href="ch07s03.html#up_re_in_fi">Creating a new Replication Instance File</a></span></li><li><span class="file"><a href="ch07s03.html#tls_repl_proc">Setting up a secured TLS replication connection</a></span></li><li><span class="file"><a href="ch07s03.html#schema_chng_filters">Schema Change Filters
</a></span></li><li><span class="file"><a href="ch07s03.html#recwason">Recovering from the replication WAS_ON state </a></span></li><li><span class="file"><a href="ch07s03.html#rollbidle">Rollback data from crashed (idle) regions</a></span></li><li><span class="file"><a href="ch07s03.html#updateresyncproc1">Setting up a new replicating instance of an originating instance (Aa??B,
Pa??Q, or Aa??P)</a></span></li><li><span class="file"><a href="ch07s03.html#updateresyncproc2">Replacing the replication instance file of a replicating instance (Aa??B
and Pa??Q)</a></span></li><li><span class="file"><a href="ch07s03.html#updateresyncproc3">Replacing the replication instance file of a replicating instance (Aa??P)</a></span></li><li><span class="file"><a href="ch07s03.html#updateresyncproc4">Setting up a new replicating instance from a backup of the originating instance
(Aa??P)</a></span></li><li><span class="file"><a href="ch07s03.html#proc4">Setting up an Aa??P configuration for the first time if P is an existing instance (having
its own set of updates) </a></span></li></ul></li><li><span class="file"><a href="replication.html">Commands and Qualifiers</a></span><ul><li><span class="file"><a href="replication.html#trng_repl_on_off">Turning Replication On/Off</a></span></li><li><span class="file"><a href="replication.html#create_repl_inst">Creating the Replication Instance File</a></span></li><li><span class="file"><a href="replication.html#disp_change_repl">Displaying/Changing the attributes of Replication Instance File and Journal Pool</a></span></li><li><span class="file"><a href="replication.html#start_src_srvr">Starting the  Source Server</a></span></li><li><span class="file"><a href="replication.html#sour_srvr_shutdown">Shutting down the Source Server</a></span></li><li><span class="file"><a href="replication.html#activate_passive_src_srvr">Activating a Passive Source Server</a></span></li><li><span class="file"><a href="replication.html#deavtivate_act_src_srvr">Deactivating an Active Source Server</a></span></li><li><span class="file"><a href="replication.html#stop_src_filtr">Stopping the Source Filter</a></span></li><li><span class="file"><a href="replication.html#stop_rec_filtr">Stopping the Receiver Filter</a></span></li><li><span class="file"><a href="replication.html#freeze_src_srv_inst">Freezing an  Instance</a></span></li><li><span class="file"><a href="replication.html#chck_srvr_hlth">Checking Server Health</a></span></li><li><span class="file"><a href="replication.html#chng_log_file">Changing the Log File</a></span></li><li><span class="file"><a href="replication.html#enable_disable_dtld_log">Enabling/Disabling Detailed Logging</a></span></li><li><span class="file"><a href="replication.html#stp_src_srv">Stopping a Source Server</a></span></li><li><span class="file"><a href="replication.html#rprt_current_backlog">Reporting the Current Backlog of Journal Records</a></span></li><li><span class="file"><a href="replication.html#process_lost">Processing Lost Transactions File</a></span><ul><li><span class="file"><a href="replication.html#lost_tn_fmt">Lost Transaction File format</a></span></li></ul></li><li><span class="file"><a href="replication.html#strt_rcvr_srvr">Starting the Receiver Server

</a></span></li><li><span class="file"><a href="replication.html#strt_upd_proc">Starting the Update Process</a></span></li><li><span class="file"><a href="replication.html#stop_upd_proc">Stopping the Update Process and/or the Receiver Server</a></span></li><li><span class="file"><a href="replication.html#chk_srvr_hlth">Checking Server  Health</a></span></li><li><span class="file"><a href="replication.html#chng_log">Changing the Log File</a></span></li><li><span class="file"><a href="replication.html#enable_disable_login">Enabling/Disabling Detailed Logging</a></span></li><li><span class="file"><a href="replication.html#rep_curr_backlog">Reporting the Current Backlog of Journal Records</a></span></li><li><span class="file"><a href="replication.html#rollback_db_after_sys_fail">Rolling Back a Replicated Database </a></span></li></ul></li></ul></li><li><span class="file"><a href="lkechap.html">M Lock Utility (LKE)</a></span><ul><li><span class="file"><a href="introduction.html">Introduction</a></span><ul><li><span class="file"><a href="introduction.html#invoke_exit_LKE">To Invoke and Exit LKE</a></span></li><li><span class="file"><a href="introduction.html#establish_GD">To establish a Global Directory</a></span></li></ul></li><li><span class="file"><a href="lke_comm_quals.html">LKE Commands and Qualifiers
</a></span><ul><li><span class="file"><a href="lke_comm_quals.html#lke_clear">Clear</a></span></li><li><span class="file"><a href="lke_comm_quals.html#lke_clnup">CLNup</a></span></li><li><span class="file"><a href="lke_comm_quals.html#LKE_Show">SHow
</a></span></li><li><span class="file"><a href="lke_comm_quals.html#LKE_Exit">Exit</a></span></li><li><span class="file"><a href="lke_comm_quals.html#Help">Help</a></span></li><li><span class="file"><a href="lke_comm_quals.html#LKE_SPAWN">SPawn
</a></span></li></ul></li><li><span class="file"><a href="lke_command_summ.html">Summary
</a></span></li><li><span class="file"><a href="lke_exercises.html">LKE Exercises</a></span><ul><li><span class="file"><a href="lke_exercises.html#lke_exer1">Exercise 1: Preventing concurrent updates using M Locks</a></span></li><li><span class="file"><a href="lke_exercises.html#lke_exer2">Exercise 2: Rectifying a deadlock situation</a></span></li></ul></li></ul></li><li><span class="file"><a href="ch09.html">GT.M Database Structure(GDS)</a></span><ul><li><span class="file"><a href="ch09s01.html">Database File Organization with GDS  </a></span><ul><li><span class="file"><a href="ch09s01.html#DFH">Database File Header </a></span></li><li><span class="file"><a href="ch09s01.html#FHDE">File Header Data Elements </a></span></li></ul></li><li><span class="file"><a href="ch09s02.html">Local Bitmaps  </a></span></li><li><span class="file"><a href="ch09s03.html">Master Bitmap  </a></span></li><li><span class="file"><a href="ch09s04.html">Database Structure  </a></span><ul><li><span class="file"><a href="ch09s04.html#tree_org">Tree Organization</a></span></li><li><span class="file"><a href="ch09s04.html#gds_blks">GDS Blocks </a></span></li><li><span class="file"><a href="ch09s04.html#Gds_rec">GDS Records </a></span><ul><li><span class="file"><a href="ch09s04.html#spanning_nodes">Using GDS records to hold spanning nodes  </a></span></li></ul></li><li><span class="file"><a href="ch09s04.html#gds_keys_D">GDS Keys </a></span></li><li><span class="file"><a href="ch09s04.html#compression_count">Compression Count </a></span></li><li><span class="file"><a href="ch09s04.html#use_of_keys">Use of Keys  </a></span></li><li><span class="file"><a href="ch09s04.html#character_keys">Characteristics of Keys  </a></span></li><li><span class="file"><a href="ch09s04.html#gvnameD">Global Variable Names </a></span></li><li><span class="file"><a href="ch09s04.html#str_subscr">String Subscripts </a></span></li><li><span class="file"><a href="ch09s04.html#numeric_Subsr">Numeric Subscripts </a></span></li></ul></li></ul></li><li><span class="file"><a href="ch10.html">Database Structure Editor</a></span><ul><li><span class="file"><a href="operate_dse.html">Operating in DSE</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html">DSE Commands and Qualifiers</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#add_dse">ADD</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#add_qualifiers_dse">Qualifiers of ADD</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#dse_exam_add">Examples for ADD</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#all_dse_cmmd">ALL</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#all_qualifiers_dse">Qualifiers</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#dse_example_add2">Examples of ALL</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#buffer_flush_cmmd_dse">Buffer_flush</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#change_dse_cmmd">CHange
</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#change_qualifiers_block">CHANGE -BLock Qualifiers</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#change_qualifiers_file">CHANGE -FIleheader Qualifiers</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#change_example_Dse">Examples for CHANGE</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#dse_cache">CAche
</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#Dse_cache_quals">Qualifiers of CACHE</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#dse_cache_Exampl">Examples for CACHE</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#close_dse_cmmd">CLose</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#critical_dse_cmmd">CRitical

</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#qaulifiers_change_dse">Qualifiers of CRITICAL</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#crit_examp">Examples for CRITICAL</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#dump_dse_cmmd">Dump

</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#dump_dse_qualifiers">Qualifiers of DUMP</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#dump_ex1">Examples for DUMP </a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#evaluate_dse_cmmd">EValuate



</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#evaluate_dse_qualifiers">Qualifiers of Evaluate</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#examp_eval">Examples for EVALUATE
</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#exit_dse_cmmd">EXit
</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#find_cmmd_dse">Find
</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#find_qualifiers_dse">Qualifiers of FIND</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#find_Examp">Examples for FIND
</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#help_dse_cmmd">Help</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#integrit_dse_cmmd">Integrit
</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#integrit_dse_qualifiers">Qualifiers of Integrit</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#maps_dse_cmmd">Maps
</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#map_qualifiers_dse">Qualifiers for MAP</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#exam_maps">Examples</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#open_cmmd_dse">OPen
</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#Open_qaulifier_dse">Qualifiers for OPEN</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#Dse_open_example">Examples for OPEN</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#overwrite_dse_cmmd">OVerwrite
</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#overwrite_dse_qualifier">Qualifiers for OVERWRITE</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#dse_Example_overwrite">Examples for Overwrite</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#page_cmmd_dse">Page
</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#range_dse_cmmd">RAnge
</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#range_dse_qualifiers">Qualifiers of RANGE</a></span></li><li><span class="file"><a href="dse_cmmds_quals.html#example_Range">Examples for RANGE</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#remove_dse_cmmd">REMove
</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#remove_dse_qualifier">Qualifiers of REMOVE</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#restore_dse_cmmd">REStore
</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#qualifiers_restore_dse">Qualifiers of RESTORE</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#save_dse_cmmd">SAve
</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#save_dse_qualifiers">Qualifiers of SAVE</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#shift">SHift
</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#shift_dse_qualifiers">Qualifiers of SHIFT</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#dse_spawnl">SPawn
</a></span><ul><li><span class="file"><a href="dse_cmmds_quals.html#spawn_example_D">Examples of SPAWN</a></span></li></ul></li><li><span class="file"><a href="dse_cmmds_quals.html#wcinit_dse_cmmd">Wcinit
</a></span></li></ul></li><li><span class="file"><a href="dse_summary.html">DSE Command Summary</a></span></li></ul></li><li><span class="file"><a href="ch11.html">Maintaining Database Integrity</a></span><ul><li><span class="file"><a href="ch11s01.html">Verifying Database Integrity</a></span><ul><li><span class="file"><a href="ch11s01.html#regular_scheduled_verfication">Regularly Scheduled Verification</a></span></li><li><span class="file"><a href="ch11s01.html#before_or_after_major_transfer">Before or After Major Transfers</a></span></li><li><span class="file"><a href="ch11s01.html#imm_after_catastrophic_events">Immediately after Catastrophic Events</a></span></li><li><span class="file"><a href="ch11s01.html#imm_after_run_time_errors">Immediately after Run-Time Database Errors </a></span></li><li><span class="file"><a href="ch11s01.html#imm_after_database_repair">Immediately After Database Repairs</a></span></li></ul></li><li><span class="file"><a href="ch11s02.html">Approaches to Database Recovery</a></span><ul><li><span class="file"><a href="ch11s02.html#recover_frm_jrnls">Recover from Journals</a></span></li><li><span class="file"><a href="ch11s02.html#restore_frm_backup">Restore from Backup</a></span></li><li><span class="file"><a href="ch11s02.html#repair_with_dse">Repair with DSE</a></span></li><li><span class="file"><a href="ch11s02.html#preventive_maintenance">Preventive Maintenance</a></span><ul><li><span class="file"><a href="ch11s02.html#determine_the_cause_of_the_problem">Determining the Cause of the Problem</a></span></li><li><span class="file"><a href="ch11s02.html#chp11_mupip_recovery">MUPIP Recovery</a></span></li><li><span class="file"><a href="ch11s02.html#follow_up_chapter11_mupip_recovery">Follow-up</a></span></li></ul></li></ul></li><li><span class="file"><a href="ch11s03.html">Repairing the Database with DSE</a></span><ul><li><span class="file"><a href="ch11s03.html#using_the_proper_db_file">Using the Proper Database File</a></span></li><li><span class="file"><a href="ch11s03.html#locating_struc_with_dse">Locating Structures with DSE</a></span></li><li><span class="file"><a href="ch11s03.html#safety_in_repairs">Safety in Repairs</a></span></li><li><span class="file"><a href="ch11s03.html#discarding_data">Discarding Data</a></span></li><li><span class="file"><a href="ch11s03.html#concurrent_repairs">Concurrent Repairs</a></span></li><li><span class="file"><a href="ch11s03.html#terminate_processes">Terminating Processes</a></span></li><li><span class="file"><a href="ch11s03.html#rec_dam_spa">Recovering data from damaged binary extracts</a></span><ul><li><span class="file"><a href="ch11s03.html#currupt_errors">CORRUPT Errors</a></span></li><li><span class="file"><a href="ch11s03.html#ldspan_errors">LDSPANGLOINCMP Errors</a></span></li><li><span class="file"><a href="ch11s03.html#rep_example">Examplea??Repairing an error in a binary extract </a></span></li></ul></li></ul></li><li><span class="file"><a href="ch11s04.html">Finding and Fixing Database Errors</a></span><ul><li><span class="file"><a href="ch11s04.html#c1_possible_cache_control_problems">C1a??Possible Cache Control Problems</a></span></li><li><span class="file"><a href="ch11s04.html#h1_process_hangs">H1a??Process Hangs</a></span></li><li><span class="file"><a href="ch11s04.html#h3_db_access_problems">H3a??Database Access Problems</a></span></li><li><span class="file"><a href="ch11s04.html#h4_database_cache_problms">H4a??Database Cache Problems</a></span></li><li><span class="file"><a href="ch11s04.html#h5_critical_section_problems">H5a??Critical Section Problems</a></span></li><li><span class="file"><a href="ch11s04.html#h6_Unix_problems">H6a??UNIX Problems</a></span></li><li><span class="file"><a href="ch11s04.html#h7_disk_hardware_problems">H7a??Disk Hardware Problems</a></span></li><li><span class="file"><a href="ch11s04.html#h8_application_problems">H8a??Application Problems</a></span><ul><li><span class="file"><a href="ch11s04.html#persistent_locks">Persistent LOCKs</a></span></li><li><span class="file"><a href="ch11s04.html#deadlocks">Deadlocks</a></span></li><li><span class="file"><a href="ch11s04.html#prevention_of_a_deadlock">Preventing Deadlocks</a></span></li></ul></li><li><span class="file"><a href="ch11s04.html#i1_mupip_integ_errors">I1a??MUPIP INTEG Errors</a></span><ul><li><span class="file"><a href="ch11s04.html#evaluate_danger_level">Evaluating the Danger Level of a Database Problem</a></span><ul><li><span class="file"><a href="ch11s04.html#requires_immed_attention">Requires Immediate Attention</a></span></li><li><span class="file"><a href="ch11s04.html#can_be_deferred">Can Be Deferred</a></span></li></ul></li></ul></li><li><span class="file"><a href="ch11s04.html#MUPIP_INTEG_Error_Classification_Table">MUPIP INTEG Error Classification Table</a></span></li><li><span class="file"><a href="ch11s04.html#gtm_version_mismatch_chi2">I2a??GT.M Version Mismatch</a></span></li><li><span class="file"><a href="ch11s04.html#i3_file_header_errors">I3a??File Header Errors</a></span></li><li><span class="file"><a href="ch11s04.html#i4_file_size_errors">I4a??File Size Errors</a></span></li><li><span class="file"><a href="ch11s04.html#i5_more_db_access_problems">I5a??More Database Access Problems</a></span></li><li><span class="file"><a href="ch11s04.html#i6_transient_errors">I6a??Transient Errors</a></span></li><li><span class="file"><a href="ch11s04.html#i7_db_rundown_prblm">I7a??Database Rundown Problem</a></span></li><li><span class="file"><a href="ch11s04.html#i8_repair_induced_prblm">I8a??Repair-Induced Problems</a></span></li><li><span class="file"><a href="ch11s04.html#k1_bad_key">K1a??Bad Key</a></span></li><li><span class="file"><a href="ch11s04.html#k2_keys_misplaced">K2a??Keys Misplaced</a></span></li><li><span class="file"><a href="ch11s04.html#k3_block_doubly_allocated">K3a??Block Doubly Allocated</a></span></li><li><span class="file"><a href="ch11s04.html#k4_pointer_prbl">K4a??Pointer Problems</a></span></li><li><span class="file"><a href="ch11s04.html#i5_star_key_prblms">K5a??Star Key Problems</a></span></li><li><span class="file"><a href="ch11s04.html#k6_compression_count_error">K6a??Compression Count Error</a></span></li><li><span class="file"><a href="ch11s04.html#k7_key_warning">K7a??Key Warning</a></span></li><li><span class="file"><a href="ch11s04.html#m1_bitmap_errors">M1a??Bitmap Errors</a></span></li><li><span class="file"><a href="ch11s04.html#m2_bitmap_header_problms">M2a??Bitmap Header Problems</a></span></li><li><span class="file"><a href="ch11s04.html#O1_bad_block">O1a??Bad Block</a></span></li><li><span class="file"><a href="ch11s04.html#o2_record_errors">O2a??Record Errors</a></span></li><li><span class="file"><a href="ch11s04.html#o3_data_block_errors">O3a??Data Block Errors</a></span></li><li><span class="file"><a href="ch11s04.html#o4_salvage">O4a??Salvage of Data Blocks with Lost Indices</a></span><ul><li><span class="file"><a href="ch11s04.html#downloadsalvage">Download salvage.m</a></span></li></ul></li><li><span class="file"><a href="ch11s04.html#sal_dam_spa">O5a??Salvage of a damaged spanning node</a></span></li><li><span class="file"><a href="ch11s04.html#p1_process_damage">P1a??Process Damage</a></span></li><li><span class="file"><a href="ch11s04.html#q1_restict_db_access">Q1a??Restricting Database Access</a></span></li><li><span class="file"><a href="ch11s04.html#r1_gtm_run_time_errors">R1a??GT.M Run-Time Errors</a></span></li><li><span class="file"><a href="ch11s04.html#r2_structure_db_integ">R2a??Structural Database Integrity Errors</a></span></li><li><span class="file"><a href="ch11s04.html#Run-Time_Database_Restart_Code_Table">Run-Time Database Restart Codes</a></span></li><li><span class="file"><a href="ch11s04.html#r2_run_time_db_cache">R3a??Run-time Database Cache Problems</a></span></li><li><span class="file"><a href="ch11s04.html#r4_stopped_processes">R4a??Stopped Processes</a></span></li><li><span class="file"><a href="ch11s04.html#r5_no_more_room">R5a??No More Room in the File</a></span></li><li><span class="file"><a href="ch11s04.html#r6_gtmassert_and_gtmcheck_errors">R6a??GTMASSERT and GTMCHECK Errors</a></span></li><li><span class="file"><a href="ch11s04.html#r7_interlock_q">R7a??Interlocked Queue Hardware Problems</a></span></li><li><span class="file"><a href="ch11s04.html#r8_db_tree">R8a??Database Tree Maximum Level Exceeded</a></span></li><li><span class="file"><a href="ch11s04.html#r9_read">R9a??Read-only Process Blocked</a></span></li></ul></li></ul></li><li><span class="file"><a href="ch12.html">Database Encryption</a></span><ul><li><span class="file"><a href="ch12s01.html">Introduction </a></span><ul><li><span class="file"><a href="ch12s01.html#encrypt_overview_desc">Overview </a></span></li><li><span class="file"><a href="ch12s01.html#encrypt_disclaim">Disclaimer </a></span></li><li><span class="file"><a href="ch12s01.html#encryption_limit">Limitations of GT.M Database Encryption </a></span><ul><li><span class="file"><a href="ch12s01.html#dar_nt_prtc">Data Not At Rest Not Protected </a></span></li><li><span class="file"><a href="ch12s01.html#keys_in_prc_Add">Keys in the Process Address Space / Environment</a></span></li><li><span class="file"><a href="ch12s01.html#long_lived_keys">Long Lived Keys </a></span></li><li><span class="file"><a href="ch12s01.html#volumin_sampl_enc_data">Voluminous Samples of Encrypted Data </a></span></li><li><span class="file"><a href="ch12s01.html#Encry_algo_nt_Supprt">Encryption Algorithms Neither Endorsed Nor Supported by FIS </a></span></li><li><span class="file"><a href="ch12s01.html#no_key_recov">No Key Recovery </a></span></li><li><span class="file"><a href="ch12s01.html#human_intervention">Human Intervention Required </a></span></li><li><span class="file"><a href="ch12s01.html#mm_databases">MM Databases </a></span></li></ul></li><li><span class="file"><a href="ch12s01.html#Alternatives_to_Database_Encry">Alternatives to Database Encryption </a></span></li><li><span class="file"><a href="ch12s01.html#Device_IO">Device IO </a></span></li><li><span class="file"><a href="ch12s01.html#Replication_and_GT_CM">GT.CM </a></span></li><li><span class="file"><a href="ch12s01.html#fips">FIPS Mode</a></span></li></ul></li><li><span class="file"><a href="ch12s02.html">Theory of Operation </a></span><ul><li><span class="file"><a href="ch12s02.html#encr_Definitions">Definition of Terms </a></span></li><li><span class="file"><a href="ch12s02.html#encrypt_overview_1">Overview </a></span><ul><li><span class="file"><a href="ch12s02.html#encrwarn">Warning </a></span></li><li><span class="file"><a href="ch12s02.html#data_db_jnl">Data in Database and Journal Files </a></span></li><li><span class="file"><a href="ch12s02.html#Symmetric_and_Asymmetric_Ciphe_">Symmetric and Asymmetric Ciphers </a></span></li><li><span class="file"><a href="ch12s02.html#Key_Ring_on_Disk">Key Ring on Disk </a></span></li><li><span class="file"><a href="ch12s02.html#Master_Key_File_Key_Files">Master Key Configuration File and Encryption Keys </a></span></li><li><span class="file"><a href="ch12s02.html#Memory_Key_Ring">Memory Key Ring </a></span></li><li><span class="file"><a href="ch12s02.html#key_validation_hasing">Key Validation and Hashing </a></span></li><li><span class="file"><a href="ch12s02.html#Database_Operations">Database Operation </a></span></li></ul></li></ul></li><li><span class="file"><a href="ch12s03.html">Examples of use </a></span><ul><li><span class="file"><a href="ch12s03.html#Key_Management">Key Management </a></span></li></ul></li><li><span class="file"><a href="ch12s04.html">Tested Reference Implementations </a></span></li><li><span class="file"><a href="ch12s05.html">Special note - GNU Privacy Guard and Agents</a></span><ul><li><span class="file"><a href="ch12s05.html#use_pinentry_pgm">Using the reference implementation's custom pinentry program</a></span></li></ul></li><li><span class="file"><a href="ch12s06.html">Installation </a></span></li><li><span class="file"><a href="ch12s07.html">
      Administration and Operation of Encrypted Databases </a></span><ul><li><span class="file"><a href="ch12s07.html#util_programs"> Utility Programs </a></span><ul><li><span class="file"><a href="ch12s07.html#encr_gde">GDE </a></span><ul><li><span class="file"><a href="ch12s07.html#format_enr">Format / Upgrade </a></span></li><li><span class="file"><a href="ch12s07.html#noencryption_qual">-[NO]ENcryption</a></span></li></ul></li><li><span class="file"><a href="ch12s07.html#encr_mupip_cm">MUPIP </a></span><ul><li><span class="file"><a href="ch12s07.html#encr_mupip_Cre">MUPIP CREATE </a></span></li><li><span class="file"><a href="ch12s07.html#encr_mup_jnl">MUPIP JOURNAL </a></span></li><li><span class="file"><a href="ch12s07.html#encr_mup_load">MUPIP LOAD </a></span></li></ul></li><li><span class="file"><a href="ch12s07.html#encr_dse">DSE </a></span><ul><li><span class="file"><a href="ch12s07.html#changing_hash">Changing the hash in the database file header </a></span></li></ul></li></ul></li><li><span class="file"><a href="ch12s07.html#changing_encr_keys">Changing the Encryption Keys </a></span></li><li><span class="file"><a href="ch12s07.html#Db_create_encr">Encrypted Database Creation </a></span></li></ul></li><li><span class="file"><a href="ch12s08.html">Plugin Architecture &amp; Interface </a></span><ul><li><span class="file"><a href="ch12s08.html#encr_packaging">Packaging </a></span></li><li><span class="file"><a href="ch12s08.html#extn_gtm_encr">Extensions to the GT.M External Interface </a></span></li><li><span class="file"><a href="ch12s08.html#encr_operation">Operation </a></span></li></ul></li><li><span class="file"><a href="ch12s09.html">Using the Reference Implementation with Older Releases  </a></span></li></ul></li><li><span class="file"><a href="ch13.html">GT.CM Client/Server</a></span><ul><li><span class="file"><a href="ch13s01.html">Introduction</a></span></li><li><span class="file"><a href="ch13s02.html">Overview</a></span><ul><li><span class="file"><a href="ch13s02.html#gtcm_server">GT.CM Server</a></span></li><li><span class="file"><a href="ch13s02.html#gtcm_client">GT.CM Client</a></span></li><li><span class="file"><a href="ch13s02.html#gtcm_stsh">GT.CM Server Startup and Shutdown</a></span><ul><li><span class="file"><a href="ch13s02.html#gtcm_srv_Start">GT.CM Server Startup</a></span></li><li><span class="file"><a href="ch13s02.html#gtcm_srv_Shut">GT.CM Server Shutdown</a></span></li></ul></li><li><span class="file"><a href="ch13s02.html#encry_types_oper">Types of Operations</a></span></li><li><span class="file"><a href="ch13s02.html#gtcp_err_msg">Error Messages</a></span></li><li><span class="file"><a href="ch13s02.html#gtcm_examples">Examples</a></span></li></ul></li></ul></li><li><span class="file"><a href="ipc_usage.html">GT.M's IPC Resource Usage</a></span><ul><li><span class="file"><a href="apas01.html">Examining GT.M's IPC Resources</a></span></li><li><span class="file"><a href="apas02.html">gmtsecshr</a></span></li></ul></li><li><span class="file"><a href="monitoring_gtm.html">Monitoring GT.M </a></span><ul><li><span class="file"><a href="apbs01.html">Monitoring GT.M Messages</a></span></li><li><span class="file"><a href="apbs02.html">Managing core dumps </a></span></li></ul></li><li><span class="file"><a href="build_encry_lib.html">Building Encryption Libraries</a></span><ul><li><span class="file"><a href="apcs01.html">Building Encryption Libraries </a></span><ul><li><span class="file"><a href="apcs01.html#Ubuntu_LTS_x86_64_4182407">Debian, Ubuntu, RedHat and Fedora </a></span></li><li><span class="file"><a href="apcs01.html#IBM_AIX_5_3_pSeries_6214410681">IBM AIX 7.1 (pSeries) </a></span><ul><li><span class="file"><a href="apcs01.html#gpg_error_instr">GPG-ERROR </a></span></li><li><span class="file"><a href="apcs01.html#gcrypt_aix">GCRYPT </a></span></li><li><span class="file"><a href="apcs01.html#crypto_aix">CRYPTO (From OpenSSL) </a></span></li><li><span class="file"><a href="apcs01.html#gpgme_aix">GPGME </a></span></li><li><span class="file"><a href="apcs01.html#aix_gnupg">GNUPG </a></span></li></ul></li></ul></li></ul></li><li><span class="file"><a href="app_security_phil.html">GT.M Security Philosophy</a></span><ul><li><span class="file"><a href="apds01.html">Philosophy</a></span><ul><li><span class="file"><a href="apds01.html#nrml_usrgir">Normal User and Group Id Rule</a></span><ul><li><span class="file"><a href="apds01.html#sec_excep">Exceptions</a></span><ul><li><span class="file"><a href="apds01.html#Sec_shrd_mem">Shared Memory Exception for BG</a></span></li><li><span class="file"><a href="apds01.html#gtmsecshr_excep">gtmsecshr Exception</a></span></li></ul></li><li><span class="file"><a href="apds01.html#Security_Triggers">Triggers</a></span></li></ul></li><li><span class="file"><a href="apds01.html#gtmc_excep">Recommendations</a></span></li></ul></li><li><span class="file"><a href="apds02.html">gtmsecshr commands</a></span></li><li><span class="file"><a href="apds03.html">Shared Resource Authorization Permissions</a></span></li></ul></li><li><span class="file"><a href="ape.html">GTMPCAT - GT.M Process/Core Analysis Tool </a></span><ul><li><span class="file"><a href="apes01.html">Overview</a></span></li><li><span class="file"><a href="apes02.html">Usage</a></span></li><li><span class="file"><a href="apes03.html">Interactive Mode</a></span></li></ul></li><li><span class="file"><a href="Package_GTM_Apps.html">Packaging GT.M Applications</a></span><ul><li><span class="file"><a href="apfs01.html">Setting up a Captive User Application with GT.M</a></span><ul><li><span class="file"><a href="apfs01.html#sample_profile">Sample .profile</a></span></li></ul></li><li><span class="file"><a href="apfs02.html">Invoking GT.M through a C main() program</a></span></li><li><span class="file"><a href="apfs03.html">Defensive Practices</a></span></li><li><span class="file"><a href="apfs04.html">Other</a></span></li></ul></li><li><span class="file"><a href="TLS_Configuration_File.html">Creating a $gtmcrypt_config file</a></span><ul><li><span class="file"><a href="apgs01.html">Why do we need a $gtmcrypt_config file?</a></span></li><li><span class="file"><a href="apgs02.html">OpenSSL Options</a></span></li><li><span class="file"><a href="apgs03.html">Generating demo TLS certificates</a></span><ul><li><span class="file"><a href="apgs03.html#create_root_app">Creating a demo CA (Certification Authority)</a></span></li><li><span class="file"><a href="apgs03.html#create_leaf_app">Creating and signing demo leaf-level certificates</a></span></li><li><span class="file"><a href="apgs03.html#tlsexampledemo">Example: Creating demo certificates </a></span><ul><li><span class="file"><a href="apgs03.html#certsetupproc_app">cert_setup</a></span></li><li><span class="file"><a href="apgs03.html#gencaproc_app">gen_ca</a></span></li><li><span class="file"><a href="apgs03.html#genleafpro_app">gen_leaf</a></span></li><li><span class="file"><a href="apgs03.html#opensslconf_app">example101.cnf</a></span></li></ul></li></ul></li></ul></li></ul></div></div><div id="searchDiv"><div id="search"><form onsubmit="Verifie(ditaSearch_Form);return false" name="ditaSearch_Form" class="searchForm"><fieldset class="searchFieldSet"><legend>Search</legend><center><input id="textToSearch" name="textToSearch" type="text" class="searchText"/> &nbsp; <input onclick="Verifie(ditaSearch_Form)" type="button" class="searchButton" value="Go" id="doSearch"/></center></fieldset></form></div><div id="searchResults"><center/></div></div></div></div></div></body></html>