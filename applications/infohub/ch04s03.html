<html><HEAD><META HTTP-EQUIV="Pragma" CONTENT="no-cache"><META HTTP-EQUIV="Expires" CONTENT="-1"><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Defining an Env Descriptor</title><link rel="stylesheet" href="gtm.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="titlepage.html" title="FIS InfoHub"><link rel="up" href="ch04.html" title="Chapter 4. Configuring an InfoHub"><link rel="prev" href="ch04s02.html" title="Defining an Include Descriptor"><link rel="next" href="ch04s04.html" title="Defining an InfoDict Domain Descriptor"><link rel="copyright" href="ln-idp160629056.html" title="Legal Notice"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Defining an Env Descriptor</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch04s02.html">Prev</a> </td><th width="60%" align="center">Chapter 4. Configuring an InfoHub</th><td width="20%" align="right"> <a accesskey="n" href="ch04s04.html">Next</a></td></tr></table><hr></div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="titlepage.html">FIS InfoHub</a></span> &gt; <span class="breadcrumb-link"><a href="ch04.html">Configuring an InfoHub</a></span> &gt; <span class="breadcrumb-node">Defining an Env Descriptor</span></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="env_descriptor"></a>Defining an Env Descriptor</h2></div></div></div><p>Zero or more Env descriptors can immediately follow the InfoHub descriptor, or start the configuration definition if the InfoHub descriptor is implicit; and zero or more Env descriptors can immediately follow any Publisher descriptor. Those in the first location define common environment variables for all processes used by the InfoHub; those in the second location define common environment variables for all PipeLine generated processes subject to that Publisher. The syntax of an Env Descriptor is:</p><pre class="programlisting">Env:EnvVarName[=[Value]][,,,,] </pre><p>If the configuration processing encounters an Env descriptor that does not follow the InfoHub descriptor or a Publisher descriptor, it produces an IHENVPLACE error. There are three types of Env descriptor&#8212;one sets values in the environment of InfoHub processes, another with an equal-sign but no value ensures environment variables are not set (that is, cleared), and a third to invoke a shell script that manages the target environment. For example:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The InfoHub may itself use an encrypted database. Blocking its obfuscated password in $gtm_passwd from other processes (such as PIPE processes in PipeLine descriptors, which do not need to access its database) is accomplished with an Env:gtmpasswd= descriptor (with an equal-sign, but no value) after the InfoHub descriptor.</p></li><li class="listitem"><p>A Publisher that gathers information from an application deployed on a different version of GT.M than the InfoHub (or with a global directory that uses relative paths to its database files and/or refers to environment variables) needs to have the appropriate environment variables set. If the InfoHub has only read access to the database, ensure that the gtm_tmp and gtm_log environment variables are appropriately set. Note: gtm_log is not used starting with GT.M V6.0-000. If the environment variable IHCD exists, the Pipeline sets its working directory to the value of IHCD. For example, when a global directory uses relative paths: IHCD is set to the base of the relative paths. A set of Env descriptor lines may look like: </p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>
                <code class="code">Env:gtm_dist="/usr/lib/fis-gtm/V5.5-000_x86"</code>
              </p></li><li class="listitem"><p>
                <code class="code">Env:gtmgbldir="/var/myApp/gtm.gld"</code>
              </p></li><li class="listitem"><p>
                <code class="code">... </code>
              </p></li></ul></div><p>and provides the needed environment variables after the Publisher descriptor for PipeLine information gathering by that Publisher.</p></li><li class="listitem"><p> If an application provides a script that can be sourced to set up environment variables, Env:/path/to/script, can be used in lieu of setting them individually. Since this will overwrite the gtmroutines environment variable, please add the paths for the InfoHub back in using an ENV descriptor for gtmroutines environment variable. For example,</p><p>
            <code class="code">Env:/path/to/envscript.sh</code>
          </p><p>
            <code class="code">Env:gtmroutines="$gtmroutines /path/to/infohub /path/to/infohub/pipecommands /path/toinfohub/plugins /path/to/gtmposixplugin "</code>
          </p></li><li class="listitem"><p>If applications that run in both UTF-8 and M mode are involved, please adjust the gtmroutines enviroment variable descriptor accordingly. For example, for the applications using M mode:"</p><p>
            <code class="code">Env:gtmroutines="$gtmroutines /path/to/infohub/M(/path/to/infohub) /path/to/infohub/pipecommands/M(/path/to/infohub/pipecommands) /path/toinfohub/plugins/M(/path/toinfohub/plugins) /path/to/gtmposixplugin/M(/path/to/gtmposixplugin)"</code>
          </p><p>and for the applications using UTF-8 mode:</p><p>
            <code class="code">Env:gtmroutines="$gtmroutines /path/to/infohub/UTF8(/path/to/infohub) /path/to/infohub/pipecommands/UTF8(/path/to/infohub/pipecommands) /path/toinfohub/plugins/UTF8(/path/toinfohub/plugins) /path/to/gtmposixplugin/UTF8(/path/to/gtmposixplugin)"</code>
          </p></li></ul></div><p>Attempting to configure an env descriptor without providing a suitable environment produces an IHBADENV error. Each EnvVarName is a legal POSIX environment variable name, consisting solely of ASCII letters, digits, and underscores ("_"), of which the first character must not be a digit; if configuration processing encounters a failure to meet this criterion, it also produces the IHBADENV error. To allow for permissible, non-graphic values<sup>[<a name="idp161147504" href="ch04s03.html#ftn.idp161147504" class="footnote">1</a>]</sup> of environment variables, and to allow environment variables to reference environment variables of the InfoHub itself (using the $ZTRNLNM() function), each Value is treated as a GT.M expr that the InfoHub evaluates before storing the result in its database.</p><p></p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip: InfoHub Internals"><tr><td rowspan="2" align="center" valign="top" width="12pt"><img alt="[Tip]" src="images/tip.jpg"></td><th align="left">InfoHub Internals</th></tr><tr><td align="left" valign="top"><p>Configuration processing stores Env descriptor information in the following nodes:</p><p>^InfoHubConf(InfoHubID,"EnvSetUp",1,BeginningSequenceNumber)=&#8203;[EndingSquenceNumber]:&#8203;env=[value],..., where the string value of the node is constructed of shell commands that an InfoHub process uses to manage its environment.</p><p>^InfoHubConf(InfoHubID,"Publishers",PublisherID,BeginningSequenceNumber,&#8203;"EnvSetUp")&#8203;=[EndingSquenceNumber]:&#8203;env=[value],..., where the string value of the node is constructed of shell commands that a Publisher process uses to adjust the environment provided to it by its InfoHub to be appropriate for a PipeLine process.</p><p>Expression evaluation (implemented with indirection or XECUTE) also has the potential for side effects that can affect the InfoHub itself.  To protect the InfoHub itself from side effects of evaluated expressions, the InfoHub processes Env descriptors in a routine which protects itself by:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>setting $ZROUTINES to the null string to prevent any new routines from being linked;</p></li><li class="listitem"><p>creating a temporary global directory and database with $ZGBLDIR pointing there;</p></li><li class="listitem"><p>executing an exclusive NEW; and</p></li><li class="listitem"><p>receiving results in $ZTWORMHOLE, it being impossible to modify $ZTWORMHOLE as a side-effect of an expression.  ($ZTWORMHOLE can itself be safely saved and restored in the calling routine to retain its originally intended use for triggers.)</p></li></ul></div></td></tr></table></div><p>Example:</p><pre class="programlisting">Env:LC_TIME='fr_FR.UTF-8'
Env:LANG='en_US.utf-8'</pre><p><span class="bold"><strong>Related Information:</strong></span></p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><a class="xref" href="ch04s02.html" title="Defining an Include Descriptor">&#8220;Defining an Include Descriptor&#8221;</a></li><li class="listitem"><a class="xref" href="ch04s04.html" title="Defining an InfoDict Domain Descriptor">&#8220;Defining an InfoDict Domain Descriptor&#8221;</a></li><li class="listitem"><a class="xref" href="ch04s05.html" title="Defining an InfoDictItem Descriptor">&#8220;Defining an InfoDictItem Descriptor&#8221;</a></li><li class="listitem"><a class="xref" href="ch04s06.html" title="Defining a Publisher Descriptor">&#8220;Defining a Publisher Descriptor&#8221;</a></li><li class="listitem"><a class="xref" href="ch04s07.html" title="Defining a FileLine Descriptor">&#8220;Defining a FileLine Descriptor&#8221;</a></li><li class="listitem"><a class="xref" href="ch04s08.html" title="Defining a PipeLine Descriptor">&#8220;Defining a PipeLine Descriptor&#8221;</a></li><li class="listitem"><a class="xref" href="ch04s09.html" title="Defining a Subscriber Descriptor">&#8220;Defining a Subscriber Descriptor&#8221;</a></li><li class="listitem"><a class="xref" href="ch04s10.html" title="Defining a Subscription Descriptor">&#8220;Defining a Subscription Descriptor&#8221;</a></li></ul></div><div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p><sup>[<a name="ftn.idp161147504" href="ch04s03.html#idp161147504" class="para">1</a>] </sup>Quoting from IEEE Std 1003.1-2008: The values that the environment variables may be assigned are not restricted except that they are considered to end with a null byte and the total space used to store the environment and the arguments to the process is limited to {ARG_MAX} bytes.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch04s02.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch04.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch04s04.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Defining an Include Descriptor </td><td width="20%" align="center"><a accesskey="h" href="titlepage.html">Home</a></td><td width="40%" align="right" valign="top"> Defining an InfoDict Domain Descriptor</td></tr></table></div></body></html>
